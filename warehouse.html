<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>PBK Warehouse Management v18.2</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/recharts@2.7.2/umd/Recharts.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
<script src="https://unpkg.com/lucide@0.263.1/dist/umd/lucide.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<style>body{margin:0;padding:0;}</style>
</head>
<body>
<div id="root"></div>
<script>
const { useState, useEffect, useCallback, useMemo, useRef } = React;
const { Package, Clock, Warehouse, BarChart3, Database, Plus, X, Search, Filter, TrendingUp, AlertTriangle, Upload, FileSpreadsheet, Save, RefreshCw, Scale, Edit2, Check, Download, Play, Pause, Bell, BellOff, Calendar, List, ChevronLeft, ChevronRight, ChevronDown, ChevronUp, ExternalLink, Thermometer, Printer, FileText, Moon, Sun, History, Info, Keyboard, Zap, ArrowRight, Lightbulb, Archive, Box } = lucide;
const { ScatterChart, Scatter, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, ReferenceLine, ComposedChart, Bar, Line, Cell } = Recharts;
const APP_VERSION='v18.0';// safeStorage: localStorage 사용 가능하면 localStorage, 아니면 인메모리 대체
const safeStorage=(()=>{try{localStorage.setItem('__pbk_test__','1');localStorage.removeItem('__pbk_test__');return localStorage;// ✅ localStorage 정상 작동 → 그대로 반환 (데이터 영구 저장)
}catch{// 접근 불가 환경: 인메모리 대체 (세션 내에서만 유지)
const _data={};return{getItem:k=>Object.prototype.hasOwnProperty.call(_data,k)?_data[k]:null,setItem:(k,v)=>{_data[k]=String(v);},removeItem:k=>{delete _data[k];}};}})();// 과거 온습도 데이터 (2022-12 ~ 2026-02)
const HISTORICAL_TEMP_HUMIDITY_DATA={"2024-01-02":{"temp":"21.2","humidity":"36.0"},"2024-01-03":{"temp":"21.4","humidity":"32.0"},"2024-01-04":{"temp":"21.5","humidity":"33.2"},"2024-01-05":{"temp":"20.7","humidity":"34.5"},"2024-01-08":{"temp":"21.2","humidity":"27.0"},"2024-01-09":{"temp":"21.1","humidity":"29.0"},"2024-01-10":{"temp":"21.0","humidity":"29.0"},"2024-01-11":{"temp":"21.4","humidity":"28.1"},"2024-01-12":{"temp":"21.2","humidity":"27.4"},"2024-01-15":{"temp":"21.2","humidity":"27.3"},"2024-01-16":{"temp":"21.4","humidity":"28.2"},"2024-01-17":{"temp":"22.1","humidity":"27.4"},"2024-01-18":{"temp":"22.4","humidity":"24.1"},"2024-01-19":{"temp":"21.7","humidity":"27.2"},"2024-01-22":{"temp":"22.8","humidity":"25.4"},"2024-01-23":{"temp":"21.4","humidity":"21.4"},"2024-01-24":{"temp":"22.1","humidity":"22.3"},"2024-01-25":{"temp":"22.1","humidity":"21.2"},"2024-01-26":{"temp":"22.3","humidity":"20.4"},"2024-01-29":{"temp":"21.4","humidity":"20.2"},"2024-01-30":{"temp":"23.1","humidity":"29.7"},"2024-01-31":{"temp":"23.4","humidity":"30.2"},"2024-02-01":{"temp":"22.0","humidity":"25.8"},"2024-02-02":{"temp":"21.6","humidity":"26.3"},"2024-02-05":{"temp":"21.2","humidity":"28.6"},"2024-02-06":{"temp":"21.2","humidity":"32.6"},"2024-02-07":{"temp":"21.7","humidity":"29.6"},"2024-02-08":{"temp":"21.2","humidity":"29.9"},"2024-02-13":{"temp":"21.3","humidity":"30.4"},"2024-02-14":{"temp":"20.7","humidity":"35.2"},"2024-02-15":{"temp":"21.1","humidity":"43.6"},"2024-02-16":{"temp":"21.4","humidity":"31.9"},"2024-02-19":{"temp":"20.2","humidity":"39.2"},"2024-02-20":{"temp":"21.2","humidity":"38.7"},"2024-02-21":{"temp":"21.6","humidity":"36.6"},"2024-02-22":{"temp":"19.9","humidity":"36.6"},"2024-02-23":{"temp":"20.6","humidity":"34.8"},"2024-02-26":{"temp":"20.0","humidity":"31.3"},"2024-02-27":{"temp":"21.1","humidity":"31.6"},"2024-02-28":{"temp":"21.4","humidity":"28.3"},"2024-02-29":{"temp":"22.0","humidity":"30.0"},"2024-03-04":{"temp":"21.5","humidity":"26.2"},"2024-03-05":{"temp":"21.8","humidity":"23.0"},"2024-03-06":{"temp":"19.8","humidity":"28.0"},"2024-03-07":{"temp":"22.2","humidity":"26.5"},"2024-03-08":{"temp":"22.3","humidity":"24.6"},"2024-03-11":{"temp":"19.2","humidity":"26.2"},"2024-03-12":{"temp":"22.2","humidity":"31.4"},"2024-03-13":{"temp":"22.1","humidity":"30.3"},"2024-03-14":{"temp":"23.1","humidity":"28.4"},"2024-03-15":{"temp":"23.0","humidity":"30.0"},"2024-03-18":{"temp":"21.7","humidity":"22.6"},"2024-03-19":{"temp":"22.2","humidity":"22.8"},"2024-03-20":{"temp":"22.7","humidity":"25.1"},"2024-03-21":{"temp":"22.8","humidity":"21.8"},"2024-03-22":{"temp":"21.9","humidity":"24.1"},"2024-03-25":{"temp":"22.5","humidity":"31.8"},"2024-03-26":{"temp":"23.3","humidity":"33.0"},"2024-03-27":{"temp":"22.4","humidity":"35.7"},"2024-03-28":{"temp":"21.9","humidity":"29.4"},"2024-03-29":{"temp":"20.0","humidity":"30.5"},"2024-04-01":{"temp":"23.1","humidity":"30.0"},"2024-04-02":{"temp":"23.4","humidity":"26.0"},"2024-04-03":{"temp":"23.1","humidity":"40.0"},"2024-04-04":{"temp":"23.0","humidity":"39.0"},"2024-04-05":{"temp":"23.4","humidity":"30.0"},"2024-04-08":{"temp":"23.2","humidity":"31.0"},"2024-04-09":{"temp":"23.9","humidity":"32.3"},"2024-04-11":{"temp":"23.5","humidity":"38.4"},"2024-04-12":{"temp":"24.0","humidity":"39.4"},"2024-04-15":{"temp":"23.6","humidity":"41.1"},"2024-04-16":{"temp":"23.7","humidity":"43.1"},"2024-04-17":{"temp":"24.5","humidity":"39.7"},"2024-04-18":{"temp":"24.9","humidity":"39.8"},"2024-04-19":{"temp":"24.8","humidity":"34.4"},"2024-04-22":{"temp":"24.1","humidity":"38.1"},"2024-04-23":{"temp":"24.4","humidity":"37.4"},"2024-04-24":{"temp":"23.7","humidity":"38.2"},"2024-04-25":{"temp":"24.0","humidity":"39.1"},"2024-04-26":{"temp":"23.4","humidity":"37.2"},"2024-04-29":{"temp":"24.7","humidity":"38.4"},"2024-04-30":{"temp":"24.1","humidity":"39.9"},"2024-05-02":{"temp":"25.3","humidity":"37.4"},"2024-05-03":{"temp":"25.0","humidity":"39.3"},"2024-05-07":{"temp":"24.4","humidity":"45.2"},"2024-05-08":{"temp":"24.7","humidity":"37.7"},"2024-05-09":{"temp":"24.6","humidity":"39.5"},"2024-05-10":{"temp":"24.8","humidity":"41.4"},"2024-05-13":{"temp":"24.1","humidity":"45.0"},"2024-05-14":{"temp":"25.0","humidity":"38.5"},"2024-05-16":{"temp":"24.0","humidity":"36.2"},"2024-05-17":{"temp":"24.0","humidity":"38.6"},"2024-05-20":{"temp":"25.2","humidity":"44.0"},"2024-05-21":{"temp":"25.2","humidity":"47.0"},"2024-05-22":{"temp":"25.4","humidity":"47.8"},"2024-05-23":{"temp":"24.9","humidity":"44.3"},"2024-05-24":{"temp":"25.2","humidity":"47.5"},"2024-05-27":{"temp":"26.6","humidity":"50.1"},"2024-05-28":{"temp":"26.0","humidity":"42.4"},"2024-05-29":{"temp":"25.6","humidity":"42.4"},"2024-05-30":{"temp":"24.6","humidity":"42.7"},"2024-05-31":{"temp":"25.5","humidity":"41.7"},"2024-06-03":{"temp":"26.2","humidity":"39.2"},"2024-06-04":{"temp":"26.1","humidity":"34.0"},"2024-06-05":{"temp":"26.1","humidity":"36.1"},"2024-06-10":{"temp":"27.3","humidity":"44.0"},"2024-06-11":{"temp":"26.6","humidity":"44.1"},"2024-06-12":{"temp":"25.9","humidity":"39.2"},"2024-06-14":{"temp":"26.8","humidity":"43.0"},"2024-06-17":{"temp":"27.7","humidity":"38.9"},"2024-06-18":{"temp":"27.0","humidity":"38.5"},"2024-06-19":{"temp":"26.1","humidity":"39.2"},"2024-06-20":{"temp":"26.1","humidity":"40.9"},"2024-06-21":{"temp":"26.4","humidity":"39.0"},"2024-06-24":{"temp":"26.9","humidity":"49.7"},"2024-06-25":{"temp":"26.1","humidity":"40.7"},"2024-06-26":{"temp":"26.2","humidity":"42.9"},"2024-06-27":{"temp":"26.7","humidity":"41.9"},"2024-06-28":{"temp":"25.4","humidity":"40.8"},"2024-07-01":{"temp":"25.7","humidity":"45.1"},"2024-07-02":{"temp":"25.1","humidity":"43.9"},"2024-07-03":{"temp":"25.8","humidity":"50.8"},"2024-07-04":{"temp":"24.8","humidity":"46.5"},"2024-07-05":{"temp":"25.4","humidity":"49.4"},"2024-07-08":{"temp":"25.3","humidity":"48.0"},"2024-07-09":{"temp":"25.1","humidity":"50.1"},"2024-07-10":{"temp":"26.2","humidity":"53.1"},"2024-07-11":{"temp":"25.2","humidity":"49.0"},"2024-07-12":{"temp":"24.8","humidity":"48.3"},"2024-07-15":{"temp":"26.9","humidity":"46.2"},"2024-07-16":{"temp":"27.2","humidity":"47.7"},"2024-07-17":{"temp":"24.8","humidity":"49.9"},"2024-07-18":{"temp":"25.4","humidity":"52.3"},"2024-07-19":{"temp":"25.0","humidity":"53.4"},"2024-07-22":{"temp":"26.3","humidity":"53.3"},"2024-07-23":{"temp":"25.3","humidity":"49.9"},"2024-07-24":{"temp":"26.2","humidity":"55.7"},"2024-07-25":{"temp":"25.9","humidity":"50.9"},"2024-07-26":{"temp":"26.9","humidity":"54.5"},"2024-07-29":{"temp":"26.6","humidity":"49.7"},"2024-07-30":{"temp":"26.7","humidity":"48.1"},"2024-07-31":{"temp":"26.4","humidity":"48.7"},"2024-08-01":{"temp":"26.7","humidity":"49.1"},"2024-08-02":{"temp":"26.0","humidity":"47.4"},"2024-08-05":{"temp":"27.8","humidity":"48.7"},"2024-08-06":{"temp":"26.1","humidity":"45.5"},"2024-08-07":{"temp":"26.9","humidity":"48.9"},"2024-08-08":{"temp":"26.4","humidity":"49.6"},"2024-08-09":{"temp":"26.6","humidity":"50.8"},"2024-08-12":{"temp":"27.1","humidity":"50.9"},"2024-08-13":{"temp":"26.9","humidity":"47.5"},"2024-08-14":{"temp":"27.0","humidity":"47.0"},"2024-08-19":{"temp":"27.1","humidity":"47.0"},"2024-08-20":{"temp":"27.0","humidity":"43.3"},"2024-08-21":{"temp":"27.1","humidity":"48.2"},"2024-08-22":{"temp":"27.2","humidity":"48.1"},"2024-08-23":{"temp":"27.0","humidity":"47.9"},"2024-08-26":{"temp":"27.7","humidity":"49.7"},"2024-08-27":{"temp":"27.3","humidity":"53.7"},"2024-08-28":{"temp":"27.2","humidity":"47.7"},"2024-08-29":{"temp":"26.6","humidity":"42.9"},"2024-08-30":{"temp":"26.4","humidity":"42.8"},"2024-09-02":{"temp":"27.1","humidity":"43.1"},"2024-09-03":{"temp":"27.2","humidity":"44.0"},"2024-09-04":{"temp":"27.4","humidity":"45.1"},"2024-09-05":{"temp":"27.1","humidity":"47.1"},"2024-09-06":{"temp":"26.2","humidity":"53.9"},"2024-09-09":{"temp":"27.4","humidity":"48.0"},"2024-09-10":{"temp":"27.2","humidity":"48.3"},"2024-09-11":{"temp":"27.2","humidity":"51.3"},"2024-09-12":{"temp":"26.5","humidity":"52.5"},"2024-09-13":{"temp":"27.0","humidity":"64.7"},"2024-09-23":{"temp":"28.3","humidity":"39.0"},"2024-09-24":{"temp":"27.3","humidity":"39.3"},"2024-09-25":{"temp":"27.5","humidity":"42.7"},"2024-09-26":{"temp":"25.7","humidity":"44.9"},"2024-09-27":{"temp":"24.9","humidity":"42.5"},"2024-09-30":{"temp":"27.4","humidity":"41.3"},"2024-10-01":{"temp":"24.0","humidity":"40.0"},"2024-10-07":{"temp":"25.0","humidity":"41.8"},"2024-10-08":{"temp":"24.9","humidity":"43.5"},"2024-10-10":{"temp":"25.5","humidity":"43.4"},"2024-10-11":{"temp":"25.3","humidity":"43.1"},"2024-10-14":{"temp":"25.0","humidity":"42.8"},"2024-10-15":{"temp":"24.5","humidity":"46.8"},"2024-10-16":{"temp":"24.4","humidity":"49.8"},"2024-10-17":{"temp":"24.4","humidity":"46.9"},"2024-10-18":{"temp":"23.0","humidity":"47.3"},"2024-10-21":{"temp":"24.7","humidity":"35.5"},"2024-10-22":{"temp":"24.9","humidity":"46.8"},"2024-10-23":{"temp":"24.5","humidity":"50.3"},"2024-10-24":{"temp":"24.6","humidity":"39.6"},"2024-10-25":{"temp":"24.8","humidity":"40.6"},"2024-10-28":{"temp":"24.7","humidity":"48.2"},"2024-10-29":{"temp":"24.6","humidity":"44.0"},"2024-10-30":{"temp":"24.4","humidity":"46.2"},"2024-10-31":{"temp":"24.0","humidity":"43.5"},"2024-11-01":{"temp":"24.0","humidity":"45.2"},"2024-11-04":{"temp":"25.0","humidity":"48.6"},"2024-11-05":{"temp":"24.6","humidity":"29.6"},"2024-11-06":{"temp":"24.2","humidity":"26.5"},"2024-11-07":{"temp":"24.0","humidity":"24.7"},"2024-11-08":{"temp":"23.8","humidity":"25.8"},"2024-11-11":{"temp":"23.5","humidity":"38.5"},"2024-11-12":{"temp":"23.8","humidity":"39.8"},"2024-11-13":{"temp":"23.3","humidity":"38.0"},"2024-11-14":{"temp":"23.8","humidity":"39.5"},"2024-11-15":{"temp":"23.3","humidity":"42.6"},"2024-11-18":{"temp":"22.6","humidity":"20.6"},"2024-11-19":{"temp":"22.5","humidity":"23.2"},"2024-11-20":{"temp":"22.2","humidity":"28.1"},"2024-11-21":{"temp":"22.3","humidity":"35.5"},"2024-11-22":{"temp":"22.1","humidity":"34.5"},"2024-11-25":{"temp":"21.9","humidity":"31.4"},"2024-11-26":{"temp":"22.2","humidity":"38.3"},"2024-11-27":{"temp":"21.3","humidity":"34.7"},"2024-11-28":{"temp":"20.8","humidity":"36.9"},"2024-11-29":{"temp":"20.5","humidity":"31.5"},"2024-12-02":{"temp":"21.1","humidity":"41.8"},"2024-12-03":{"temp":"20.1","humidity":"34.1"},"2024-12-04":{"temp":"20.2","humidity":"30.1"},"2024-12-05":{"temp":"20.0","humidity":"30.0"},"2024-12-06":{"temp":"20.1","humidity":"29.9"},"2024-12-09":{"temp":"20.8","humidity":"34.2"},"2024-12-10":{"temp":"26.2","humidity":"30.1"},"2024-12-11":{"temp":"20.3","humidity":"28.2"},"2024-12-12":{"temp":"20.1","humidity":"28.1"},"2024-12-13":{"temp":"20.1","humidity":"28.4"},"2024-12-16":{"temp":"20.2","humidity":"27.0"},"2024-12-17":{"temp":"20.5","humidity":"24.4"},"2024-12-18":{"temp":"20.1","humidity":"27.3"},"2024-12-19":{"temp":"21.0","humidity":"24.3"},"2024-12-20":{"temp":"21.1","humidity":"25.4"},"2024-12-23":{"temp":"20.1","humidity":"24.6"},"2024-12-24":{"temp":"20.0","humidity":"27.2"},"2025-01-02":{"temp":"19.3","humidity":"25.9"},"2025-01-03":{"temp":"21.9","humidity":"19.6"},"2025-01-06":{"temp":"19.8","humidity":"34.2"},"2025-01-07":{"temp":"19.0","humidity":"25.6"},"2025-01-08":{"temp":"19.7","humidity":"21.5"},"2025-01-09":{"temp":"19.7","humidity":"19.3"},"2025-01-10":{"temp":"19.9","humidity":"19.1"},"2025-01-13":{"temp":"18.5","humidity":"22.6"},"2025-01-14":{"temp":"21.1","humidity":"29.2"},"2025-01-15":{"temp":"20.4","humidity":"23.4"},"2025-01-16":{"temp":"19.5","humidity":"20.4"},"2025-01-17":{"temp":"18.6","humidity":"24.3"},"2025-01-20":{"temp":"19.7","humidity":"30.0"},"2025-01-21":{"temp":"20.6","humidity":"31.4"},"2025-01-22":{"temp":"20.2","humidity":"33.2"},"2025-01-23":{"temp":"20.6","humidity":"29.7"},"2025-01-24":{"temp":"19.5","humidity":"26.7"},"2025-02-03":{"temp":"17.7","humidity":"31.5"},"2025-02-04":{"temp":"20.2","humidity":"21.6"},"2025-02-05":{"temp":"21.5","humidity":"18.3"},"2025-02-06":{"temp":"18.6","humidity":"23.2"},"2025-02-07":{"temp":"19.6","humidity":"27.2"},"2025-02-10":{"temp":"18.1","humidity":"27.3"},"2025-02-11":{"temp":"20.1","humidity":"27.1"},"2025-02-12":{"temp":"20.8","humidity":"30.4"},"2025-02-13":{"temp":"19.9","humidity":"29.5"},"2025-02-14":{"temp":"23.3","humidity":"30.3"},"2025-02-18":{"temp":"19.3","humidity":"30.7"},"2025-02-19":{"temp":"20.4","humidity":"24.5"},"2025-02-20":{"temp":"19.4","humidity":"19.9"},"2025-02-21":{"temp":"19.6","humidity":"20.8"},"2025-02-24":{"temp":"19.3","humidity":"19.9"},"2025-02-25":{"temp":"18.4","humidity":"26.5"},"2025-02-26":{"temp":"20.1","humidity":"34.1"},"2025-02-27":{"temp":"19.2","humidity":"25.2"},"2025-02-28":{"temp":"20.3","humidity":"25.3"},"2025-03-04":{"temp":"19.6","humidity":"35.9"},"2025-03-05":{"temp":"20.2","humidity":"37.5"},"2025-03-06":{"temp":"21.2","humidity":"34.2"},"2025-03-07":{"temp":"21.7","humidity":"31.5"},"2025-03-10":{"temp":"21.9","humidity":"35.2"},"2025-03-11":{"temp":"21.6","humidity":"34.3"},"2025-03-12":{"temp":"21.5","humidity":"36.0"},"2025-03-13":{"temp":"21.2","humidity":"38.2"},"2025-03-14":{"temp":"21.5","humidity":"32.1"},"2025-03-17":{"temp":"22.0","humidity":"24.1"},"2025-03-18":{"temp":"21.4","humidity":"31.5"},"2025-03-26":{"temp":"23.3","humidity":"38.2"},"2025-03-27":{"temp":"23.2","humidity":"39.6"},"2025-03-28":{"temp":"22.9","humidity":"33.1"},"2025-03-31":{"temp":"22.5","humidity":"26.5"},"2025-04-01":{"temp":"21.7","humidity":"33.1"},"2025-04-02":{"temp":"22.0","humidity":"30.2"},"2025-04-04":{"temp":"23.0","humidity":"45.2"},"2025-04-07":{"temp":"22.7","humidity":"45.1"},"2025-04-08":{"temp":"21.8","humidity":"46.1"},"2025-04-09":{"temp":"22.6","humidity":"44.2"},"2025-04-10":{"temp":"22.9","humidity":"46.2"},"2025-04-11":{"temp":"22.8","humidity":"46.0"},"2025-04-14":{"temp":"21.8","humidity":"40.6"},"2025-04-15":{"temp":"21.7","humidity":"43.7"},"2025-04-16":{"temp":"21.8","humidity":"45.2"},"2025-04-17":{"temp":"22.9","humidity":"47.4"},"2025-04-18":{"temp":"23.5","humidity":"49.9"},"2025-04-21":{"temp":"22.8","humidity":"47.6"},"2025-04-22":{"temp":"23.8","humidity":"50.6"},"2025-04-23":{"temp":"24.2","humidity":"51.4"},"2025-04-24":{"temp":"23.2","humidity":"45.4"},"2025-04-25":{"temp":"23.6","humidity":"43.2"},"2025-04-28":{"temp":"23.6","humidity":"45.6"},"2025-04-29":{"temp":"23.6","humidity":"44.1"},"2025-04-30":{"temp":"23.1","humidity":"41.0"},"2025-05-07":{"temp":"22.5","humidity":"47.2"},"2025-05-08":{"temp":"23.0","humidity":"48.0"},"2025-05-09":{"temp":"23.5","humidity":"48.9"},"2025-05-12":{"temp":"23.2","humidity":"44.8"},"2025-05-13":{"temp":"24.0","humidity":"47.3"},"2025-05-14":{"temp":"23.9","humidity":"46.4"},"2025-05-15":{"temp":"24.0","humidity":"48.3"},"2025-05-16":{"temp":"23.8","humidity":"49.2"},"2025-05-19":{"temp":"23.8","humidity":"39.4"},"2025-05-20":{"temp":"24.0","humidity":"49.8"},"2025-05-21":{"temp":"24.2","humidity":"52.5"},"2025-05-22":{"temp":"24.7","humidity":"56.6"},"2025-05-23":{"temp":"24.1","humidity":"46.5"},"2025-05-26":{"temp":"24.8","humidity":"44.9"},"2025-05-27":{"temp":"24.7","humidity":"43.7"},"2025-05-28":{"temp":"24.3","humidity":"48.5"},"2025-05-29":{"temp":"24.8","humidity":"46.4"},"2025-05-30":{"temp":"24.7","humidity":"44.5"},"2025-06-02":{"temp":"24.9","humidity":"45.5"},"2025-06-04":{"temp":"25.1","humidity":"45.5"},"2025-06-05":{"temp":"24.3","humidity":"42.2"},"2025-06-09":{"temp":"25.9","humidity":"44.9"},"2025-06-10":{"temp":"25.6","humidity":"48.0"},"2025-06-11":{"temp":"21.4","humidity":"47.5"},"2025-06-12":{"temp":"22.5","humidity":"49.0"},"2025-06-16":{"temp":"21.4","humidity":"52.3"},"2025-06-17":{"temp":"22.2","humidity":"54.0"},"2025-06-18":{"temp":"22.0","humidity":"51.4"},"2025-06-20":{"temp":"22.1","humidity":"56.9"},"2025-06-23":{"temp":"22.6","humidity":"49.4"},"2025-06-24":{"temp":"24.1","humidity":"56.2"},"2025-06-25":{"temp":"21.9","humidity":"56.5"},"2025-06-26":{"temp":"22.8","humidity":"57.7"},"2025-06-27":{"temp":"21.0","humidity":"52.9"},"2025-06-30":{"temp":"22.8","humidity":"52.5"},"2025-07-01":{"temp":"22.4","humidity":"56.1"},"2025-07-02":{"temp":"21.4","humidity":"55.3"},"2025-07-03":{"temp":"21.3","humidity":"55.4"},"2025-07-04":{"temp":"21.6","humidity":"56.8"},"2025-07-07":{"temp":"22.8","humidity":"56.9"},"2025-07-08":{"temp":"24.0","humidity":"56.4"},"2025-07-09":{"temp":"23.2","humidity":"55.4"},"2025-07-10":{"temp":"23.4","humidity":"52.6"},"2025-07-11":{"temp":"22.4","humidity":"47.5"},"2025-07-14":{"temp":"24.8","humidity":"46.4"},"2025-07-15":{"temp":"22.8","humidity":"54.3"},"2025-07-16":{"temp":"22.9","humidity":"55.3"},"2025-07-17":{"temp":"21.3","humidity":"55.8"},"2025-07-18":{"temp":"21.7","humidity":"58.9"},"2025-07-21":{"temp":"24.0","humidity":"65.5"},"2025-07-22":{"temp":"23.0","humidity":"54.5"},"2025-07-23":{"temp":"22.7","humidity":"55.9"},"2025-07-24":{"temp":"22.7","humidity":"59.1"},"2025-07-25":{"temp":"23.7","humidity":"54.4"},"2025-07-28":{"temp":"25.3","humidity":"58.2"},"2025-07-29":{"temp":"24.2","humidity":"57.5"},"2025-07-30":{"temp":"24.9","humidity":"59.7"},"2025-07-31":{"temp":"23.1","humidity":"54.8"},"2025-08-01":{"temp":"22.8","humidity":"52.8"},"2025-08-04":{"temp":"22.7","humidity":"53.6"},"2025-08-05":{"temp":"22.6","humidity":"54.5"},"2025-08-06":{"temp":"22.4","humidity":"55.9"},"2025-08-07":{"temp":"23.0","humidity":"57.3"},"2025-08-08":{"temp":"23.0","humidity":"52.8"},"2025-08-11":{"temp":"23.5","humidity":"55.8"},"2025-08-12":{"temp":"23.9","humidity":"54.6"},"2025-08-13":{"temp":"24.4","humidity":"56.6"},"2025-08-14":{"temp":"24.0","humidity":"58.0"},"2025-08-18":{"temp":"24.6","humidity":"58.4"},"2025-08-19":{"temp":"24.3","humidity":"53.0"},"2025-08-20":{"temp":"24.0","humidity":"51.7"},"2025-08-21":{"temp":"24.3","humidity":"56.1"},"2025-08-22":{"temp":"23.8","humidity":"54.9"},"2025-08-25":{"temp":"24.0","humidity":"56.2"},"2025-08-26":{"temp":"24.8","humidity":"53.3"},"2025-08-27":{"temp":"25.0","humidity":"53.8"},"2025-08-28":{"temp":"24.3","humidity":"53.2"},"2025-08-29":{"temp":"23.3","humidity":"55.6"},"2025-09-01":{"temp":"23.9","humidity":"54.3"},"2025-09-02":{"temp":"23.5","humidity":"54.0"},"2025-09-03":{"temp":"23.6","humidity":"50.0"},"2025-09-04":{"temp":"23.4","humidity":"51.9"},"2025-09-05":{"temp":"23.2","humidity":"53.8"},"2025-09-08":{"temp":"24.8","humidity":"50.0"},"2025-09-09":{"temp":"24.3","humidity":"49.1"},"2025-09-10":{"temp":"23.2","humidity":"51.5"},"2025-09-11":{"temp":"23.5","humidity":"50.0"},"2025-09-12":{"temp":"23.7","humidity":"50.8"},"2025-09-15":{"temp":"24.2","humidity":"51.4"},"2025-09-16":{"temp":"23.1","humidity":"51.3"},"2025-09-17":{"temp":"22.5","humidity":"54.2"},"2025-09-18":{"temp":"22.1","humidity":"50.0"},"2025-09-19":{"temp":"22.8","humidity":"49.5"},"2025-09-20":{"temp":"23.7","humidity":"51.5"},"2025-09-21":{"temp":"23.0","humidity":"50.8"},"2025-09-23":{"temp":"22.7","humidity":"45.8"},"2025-09-24":{"temp":"21.9","humidity":"47.4"},"2025-09-25":{"temp":"23.2","humidity":"49.2"},"2025-09-26":{"temp":"22.5","humidity":"48.3"},"2025-09-29":{"temp":"21.9","humidity":"48.3"},"2025-09-30":{"temp":"22.8","humidity":"49.5"},"2025-10-01":{"temp":"23.4","humidity":"47.6"},"2025-10-02":{"temp":"21.7","humidity":"48.5"},"2025-10-10":{"temp":"23.5","humidity":"49.9"},"2025-10-13":{"temp":"21.9","humidity":"50.4"},"2025-10-14":{"temp":"22.6","humidity":"49.6"},"2025-10-15":{"temp":"23.5","humidity":"51.9"},"2025-10-16":{"temp":"22.9","humidity":"55.4"},"2025-10-17":{"temp":"23.6","humidity":"51.8"},"2025-10-20":{"temp":"23.4","humidity":"36.0"},"2025-10-21":{"temp":"22.0","humidity":"31.7"},"2025-10-22":{"temp":"22.0","humidity":"34.2"},"2025-10-23":{"temp":"23.8","humidity":"36.0"},"2025-10-24":{"temp":"23.0","humidity":"35.5"},"2025-10-27":{"temp":"21.0","humidity":"31.5"},"2025-10-28":{"temp":"23.3","humidity":"28.1"},"2025-10-29":{"temp":"23.0","humidity":"35.1"},"2025-10-30":{"temp":"22.5","humidity":"38.1"},"2025-10-31":{"temp":"22.8","humidity":"43.7"},"2025-11-03":{"temp":"22.9","humidity":"23.5"},"2025-11-04":{"temp":"23.9","humidity":"26.0"},"2025-11-05":{"temp":"23.5","humidity":"28.4"},"2025-11-06":{"temp":"23.6","humidity":"26.0"},"2025-11-07":{"temp":"23.4","humidity":"28.0"},"2025-11-10":{"temp":"23.7","humidity":"30.0"},"2025-11-11":{"temp":"25.2","humidity":"26.8"},"2025-11-12":{"temp":"23.2","humidity":"37.1"},"2025-11-13":{"temp":"23.8","humidity":"38.0"},"2025-11-14":{"temp":"22.7","humidity":"29.4"},"2025-11-17":{"temp":"24.2","humidity":"26.0"},"2025-11-18":{"temp":"23.9","humidity":"23.5"},"2025-11-19":{"temp":"23.7","humidity":"20.1"},"2025-11-20":{"temp":"23.3","humidity":"27.3"},"2025-11-21":{"temp":"22.3","humidity":"28.1"},"2025-11-24":{"temp":"20.9","humidity":"42.2"},"2025-11-25":{"temp":"19.8","humidity":"32.0"},"2025-11-26":{"temp":"23.0","humidity":"28.9"},"2025-11-27":{"temp":"22.9","humidity":"34.2"},"2025-11-28":{"temp":"25.0","humidity":"27.2"},"2025-12-01":{"temp":"23.0","humidity":"37.9"},"2025-12-02":{"temp":"23.7","humidity":"38.7"},"2025-12-03":{"temp":"25.4","humidity":"34.6"},"2025-12-04":{"temp":"23.0","humidity":"36.7"},"2025-12-05":{"temp":"24.0","humidity":"35.4"},"2025-12-08":{"temp":"24.7","humidity":"29.4"},"2025-12-09":{"temp":"26.5","humidity":"25.3"},"2025-12-10":{"temp":"23.0","humidity":"34.6"},"2025-12-11":{"temp":"24.3","humidity":"38.1"},"2025-12-12":{"temp":"26.2","humidity":"35.0"},"2025-12-15":{"temp":"22.3","humidity":"31.4"},"2025-12-16":{"temp":"21.8","humidity":"37.5"},"2025-12-17":{"temp":"22.4","humidity":"34.4"},"2025-12-18":{"temp":"23.2","humidity":"27.7"},"2025-12-19":{"temp":"21.3","humidity":"39.2"},"2025-12-22":{"temp":"23.5","humidity":"24.2"},"2025-12-23":{"temp":"24.2","humidity":"24.8"},"2025-12-24":{"temp":"22.8","humidity":"38.0"},"2025-12-26":{"temp":"21.5","humidity":"30.2"},"2025-12-29":{"temp":"20.2","humidity":"40.8"},"2025-12-30":{"temp":"22.6","humidity":"32.6"},"2025-12-31":{"temp":"27.2","humidity":"20.8"},"2026-01-05":{"temp":"21.6","humidity":"30.0"},"2026-01-06":{"temp":"22.7","humidity":"24.2"},"2026-01-07":{"temp":"20.8","humidity":"27.5"},"2026-01-08":{"temp":"20.3","humidity":"25.0"},"2026-01-09":{"temp":"20.5","humidity":"24.8"},"2026-01-12":{"temp":"23.0","humidity":"22.7"},"2026-01-13":{"temp":"21.6","humidity":"32.3"},"2026-01-14":{"temp":"22.9","humidity":"21.1"},"2026-01-15":{"temp":"23.4","humidity":"20.0"},"2026-01-16":{"temp":"21.8","humidity":"22.1"},"2026-01-19":{"temp":"22.6","humidity":"21.8"},"2026-01-20":{"temp":"22.4","humidity":"21.1"},"2026-01-21":{"temp":"22.9","humidity":"18.9"},"2026-01-22":{"temp":"21.2","humidity":"20.5"},"2026-01-23":{"temp":"23.7","humidity":"19.6"},"2026-01-26":{"temp":"22.9","humidity":"20.5"},"2026-01-27":{"temp":"24.6","humidity":"19.7"},"2026-01-28":{"temp":"21.4","humidity":"22.3"},"2026-01-29":{"temp":"22.0","humidity":"20.8"},"2026-01-30":{"temp":"22.9","humidity":"18.9"},"2026-02-02":{"temp":"25.7","humidity":"21.2"},"2026-02-03":{"temp":"22.3","humidity":"22.9"},"2026-02-04":{"temp":"23.2","humidity":"24.9"},"2026-02-05":{"temp":"26.4","humidity":"27.5"}};// Promega 로고 (Base64)
// 로고 제거됨
// v16.0: 랙 스펙 데이터 (물리적 랙 단위)
const RACK_SPEC={'A1':[{rackNum:1,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A1-01',binEnd:'A1-03'},{rackNum:2,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A1-01',binEnd:'A1-03'},{rackNum:3,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A1-04',binEnd:'A1-06'},{rackNum:4,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A1-04',binEnd:'A1-06'}],'A2':[{rackNum:1,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A2-01',binEnd:'A2-02',notes:'A2-02는 2단,3단사용'},{rackNum:2,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A2-01',binEnd:'A2-02'},{rackNum:3,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A2-03',binEnd:'A2-05'},{rackNum:4,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A2-03',binEnd:'A2-05'}],'A3':[{rackNum:1,type:'중량랙',width:1800,depth:450,height:1800,levels:4,maxWeight:300,binStart:'A3-01',binEnd:'A3-04'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:4,maxWeight:300,binStart:'A3-01',binEnd:'A3-04'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:4,maxWeight:300,binStart:'A3-01',binEnd:'A3-04'}],'A5':[{rackNum:1,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A5-01',binEnd:'A5-03'},{rackNum:2,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A5-04',binEnd:'A5-06'}],'A6':[{rackNum:1,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A6-01',binEnd:'A6-03'},{rackNum:2,type:'중량랙',width:1800,depth:450,height:1800,levels:3,maxWeight:300,binStart:'A6-04',binEnd:'A6-06'}],'A7':[{rackNum:1,type:'중량랙',width:1800,depth:450,height:1800,levels:2,maxWeight:300,binStart:'A7-01',binEnd:'A7-01',notes:'A7-01을 2단 사용'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:300,binStart:'A7-02',binEnd:'A7-02'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:300,binStart:'A7-02',binEnd:'A7-02'}],'B1':[{rackNum:1,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'B1-01',binEnd:'B1-05'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'B1-01',binEnd:'B1-05'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'B1-06',binEnd:'B1-10'},{rackNum:4,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'B1-06',binEnd:'B1-10'},{rackNum:5,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:150,binStart:'B1-11',binEnd:'B1-11'},{rackNum:6,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:150,binStart:'B1-12',binEnd:'B1-12'},{rackNum:7,type:'중량랙',width:1800,depth:450,height:1800,levels:1,maxWeight:300,binStart:'B1-14',binEnd:'B1-14',notes:'B1-13은 BIN 없음'}],'B2':[{rackNum:1,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'B2-01',binEnd:'B2-05'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'B2-06',binEnd:'B2-10'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'B2-11',binEnd:'B2-15'},{rackNum:4,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:150,binStart:'B2-18',binEnd:'B2-18',notes:'B2-16~17 없음'}],'B3':[{rackNum:1,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:150,binStart:'B3-01',binEnd:'B3-01'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:150,binStart:'B3-01',binEnd:'B3-01'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:150,binStart:'B3-02',binEnd:'B3-02'},{rackNum:4,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:150,binStart:'B3-02',binEnd:'B3-02'},{rackNum:5,type:'중량랙',width:1800,depth:450,height:1800,levels:1,maxWeight:300,binStart:'B3-03',binEnd:'B3-03'},{rackNum:6,type:'중량랙',width:1800,depth:450,height:1800,levels:1,maxWeight:300,binStart:'B3-04',binEnd:'B3-04'},{rackNum:7,type:'중량랙',width:1800,depth:450,height:1800,levels:1,maxWeight:300,binStart:'B3-05',binEnd:'B3-05'},{rackNum:8,type:'중량랙',width:1800,depth:450,height:1800,levels:1,maxWeight:300,binStart:'B3-06',binEnd:'B3-06'}],'B4':[{rackNum:1,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'B4-01',binEnd:'B4-04',notes:'B4-03은 2단 사용'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:6,maxWeight:150,binStart:'B4-05',binEnd:'B4-10'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:2,maxWeight:150,binStart:'B4-11',binEnd:'B4-12'},{rackNum:4,type:'경량랙',width:900,depth:450,height:1800,levels:2,maxWeight:150,binStart:'B4-13',binEnd:'B4-14'},{rackNum:5,type:'경량랙',width:900,depth:450,height:1800,levels:2,maxWeight:150,binStart:'B4-15',binEnd:'B4-16'},{rackNum:6,type:'경량랙',width:900,depth:450,height:1800,levels:1,maxWeight:150,binStart:'B4-17',binEnd:'B4-17'}],'C1':[{rackNum:1,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C1-01',binEnd:'C1-07'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C1-01',binEnd:'C1-07'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C1-08',binEnd:'C1-14'},{rackNum:4,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C1-08',binEnd:'C1-14'}],'C2':[{rackNum:1,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C2-01',binEnd:'C2-07'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C2-08',binEnd:'C2-14'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:4,maxWeight:150,binStart:'C2-15',binEnd:'C2-18'},{rackNum:4,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'C2-19',binEnd:'C2-23'}],'C3':[{rackNum:1,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C3-01',binEnd:'C3-07'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C3-01',binEnd:'C3-07'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C3-08',binEnd:'C3-14'},{rackNum:4,type:'경량랙',width:900,depth:450,height:1800,levels:7,maxWeight:150,binStart:'C3-08',binEnd:'C3-14'},{rackNum:5,type:'경량랙',width:900,depth:450,height:1800,levels:6,maxWeight:150,binStart:'C3-15',binEnd:'C3-20'},{rackNum:6,type:'경량랙',width:900,depth:450,height:1800,levels:6,maxWeight:150,binStart:'C3-15',binEnd:'C3-20'},{rackNum:7,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'C3-21',binEnd:'C3-25'},{rackNum:8,type:'경량랙',width:900,depth:450,height:1800,levels:5,maxWeight:150,binStart:'C3-21',binEnd:'C3-25'}],'D2':[{rackNum:1,type:'볼트랙',width:0,depth:0,height:0,levels:1,maxWeight:1000,binStart:'D2',binEnd:'D2'}],'E3':[{rackNum:1,type:'경량랙',width:900,depth:450,height:1800,levels:4,maxWeight:150,binStart:'E3',binEnd:'E3'},{rackNum:2,type:'경량랙',width:900,depth:450,height:1800,levels:4,maxWeight:150,binStart:'E3',binEnd:'E3'},{rackNum:3,type:'경량랙',width:900,depth:450,height:1800,levels:4,maxWeight:150,binStart:'E3',binEnd:'E3'},{rackNum:4,type:'경량랙',width:900,depth:450,height:1800,levels:4,maxWeight:150,binStart:'E3',binEnd:'E3'}],'S1':[{rackNum:1,type:'중량랙',width:1800,depth:450,height:1800,levels:1,maxWeight:300,binStart:'S1',binEnd:'S1'},{rackNum:2,type:'중량랙',width:1800,depth:450,height:1800,levels:1,maxWeight:300,binStart:'S1',binEnd:'S1'},{rackNum:3,type:'중량랙',width:1800,depth:450,height:1800,levels:1,maxWeight:300,binStart:'S1',binEnd:'S1'},{rackNum:4,type:'중량랙',width:1800,depth:450,height:1800,levels:1,maxWeight:300,binStart:'S1',binEnd:'S1'}],'F1':[{rackNum:1,type:'Unknown',width:0,depth:0,height:0,levels:1,maxWeight:0,binStart:'F1',binEnd:'F1'}],'LABEL':[{rackNum:1,type:'Unknown',width:0,depth:0,height:0,levels:1,maxWeight:0,binStart:'LABEL',binEnd:'LABEL'}]};// v16.0: 박스 타입 데이터
const BOX_TYPES={'PLASTIC-XL':{name:'특대형 플라스틱',material:'Plastic',color:'YELLOW',width:400,depth:195,height:600,maxStack:30,maxWeight:20},'PLASTIC-M':{name:'중형 플라스틱',material:'Plastic',color:'YELLOW',width:380,depth:100,height:480,maxStack:30,maxWeight:20},'PLASTIC-S':{name:'소형 플라스틱',material:'Plastic',color:'YELLOW',width:240,depth:100,height:380,maxStack:30,maxWeight:20},'PCB BOX-L':{name:'단프라 박스 L',material:'N/A',color:'BLACK',width:510,depth:230,height:615,maxStack:15,maxWeight:20},'PCB BOX-M':{name:'단프라 박스 M',material:'N/A',color:'BLACK',width:440,depth:140,height:605,maxStack:1,maxWeight:20},'PAPER-L':{name:'종이박스',material:'PAPER',color:'',width:0,depth:0,height:0,maxStack:20,maxWeight:10,variable:true},'712896':{name:'Supplier 종이박스',material:'PAPER',width:210,depth:85,height:400,maxStack:1,maxWeight:20},'714420':{name:'Supplier 종이박스',material:'PAPER',width:295,depth:310,height:480,maxStack:1,maxWeight:10},'711110':{name:'Supplier 종이박스',material:'PAPER',width:230,depth:75,height:520,maxStack:1,maxWeight:10},'711956':{name:'Supplier 종이박스',material:'PAPER',width:260,depth:180,height:510,maxStack:1,maxWeight:10},'048-9805':{name:'Supplier 종이박스',material:'PAPER',width:260,depth:150,height:460,maxStack:1,maxWeight:10},'712664':{name:'Supplier 종이박스',material:'PAPER',width:290,depth:195,height:520,maxStack:1,maxWeight:10},'159-9801':{name:'Supplier 종이박스',material:'PAPER',width:290,depth:300,height:485,maxStack:1,maxWeight:10},'714645':{name:'Supplier 종이박스',material:'PAPER',width:360,depth:235,height:550,maxStack:1,maxWeight:10},'716150':{name:'Supplier 종이박스',material:'PAPER',width:320,depth:220,height:320,maxStack:1,maxWeight:10},'712949':{name:'Supplier 종이박스',material:'PAPER',width:300,depth:300,height:190,maxStack:1,maxWeight:10}};// v16.1: Material별 박스 타입 매핑 (엑셀 4_Material_Box 기준, 290개)
const MATERIAL_BOX_MAP={'712626':'PLASTIC-XL','712944':'PLASTIC-XL','712591':'PLASTIC-XL','712630':'PLASTIC-XL','714162':'PLASTIC-XL','712624':'PLASTIC-XL','712613':'PLASTIC-XL','712618':'PLASTIC-XL','712627':'PLASTIC-XL','712608':'PLASTIC-XL','712602':'PLASTIC-XL','712603':'PLASTIC-XL','712606':'PLASTIC-XL','712607':'PLASTIC-XL','712604':'PLASTIC-XL','712620':'PLASTIC-XL','712929':'PLASTIC-XL','712696':'712696','714420':'714420','715713':'PLASTIC-XL','715715':'PLASTIC-XL','714060':'PLASTIC-XL','KB0781':'PAPER-L','712594':'PLASTIC-XL','712611':'PLASTIC-XL','712664':'712664','712896':'712896','714413':'PAPER-L','710343':'PLASTIC-XL','710344':'PLASTIC-XL','710359':'PLASTIC-XL','710375':'PLASTIC-XL','710347':'PLASTIC-XL','710335':'PLASTIC-XL','710362':'PLASTIC-XL','710361':'PLASTIC-XL','710318':'PLASTIC-XL','710346':'PLASTIC-XL','710350':'PLASTIC-XL','710348':'PLASTIC-XL','710339':'PLASTIC-XL','710338':'PLASTIC-XL','710337':'PLASTIC-XL','710333':'PLASTIC-XL','710334':'PLASTIC-XL','710332':'PLASTIC-XL','710336':'PLASTIC-XL','711124':'PLASTIC-XL','711102':'PLASTIC-XL','711103':'PLASTIC-XL','711101':'PLASTIC-XL','711111':'PLASTIC-XL','711114':'PLASTIC-XL','711142':'PLASTIC-XL','711131':'PLASTIC-XL','711950':'PLASTIC-XL','711110':'711110','711956':'711956','048-9805':'048-9805','9800-830':'PCB BOX-M','KB0746':'PCB BOX-M','KB0838':'PCB BOX-L','712589':'PLASTIC-XL','712590':'PLASTIC-XL','712592':'PLASTIC-XL','712593':'PLASTIC-XL','712605':'PLASTIC-XL','712955':'PLASTIC-XL','712628':'PLASTIC-XL','712588':'PLASTIC-XL','712609':'PLASTIC-XL','715045':'PLASTIC-XL','714421':'PLASTIC-XL','712647':'PLASTIC-XL','714422':'PLASTIC-XL','714164':'PLASTIC-XL','714165':'PLASTIC-XL','712622':'PLASTIC-XL','714163':'PLASTIC-XL','KB0798':'PLASTIC-XL','9800-880':'PCB BOX-M','KB0784':'PCB BOX-M','711115':'PLASTIC-XL','711112':'PLASTIC-XL','711126':'PLASTIC-XL','711132':'PLASTIC-XL','711951':'PLASTIC-XL','711107':'PLASTIC-XL','711130':'PLASTIC-XL','711109':'PLASTIC-XL','711108':'PLASTIC-XL','715046':'PLASTIC-XL','159-9801':'159-9801','KB0782':'PCB BOX-M','KB0783':'PCB BOX-M','KB0785':'PCB BOX-M','KB0786':'PCB BOX-M','KB0837':'PCB BOX-L','711919':'PLASTIC-M','710319':'PLASTIC-M','710345':'PLASTIC-M','SP1083':'PLASTIC-M','710395':'PLASTIC-M','710331':'PLASTIC-M','710420':'PLASTIC-M','710407':'PLASTIC-M','710376':'PLASTIC-M','710403':'PLASTIC-M','710394':'PLASTIC-M','710367':'PLASTIC-M','710371':'PLASTIC-M','710408':'PCB BOX-M','710409':'PCB BOX-M','710410':'PCB BOX-M','710411':'PCB BOX-M','710360':'PLASTIC-M','710364':'PLASTIC-M','710366':'PLASTIC-M','710365':'PLASTIC-M','711201':'PLASTIC-S','9000-375':'PLASTIC-S','716152':'PLASTIC-S','711293':'PLASTIC-S','712771':'PLASTIC-S','711190':'PLASTIC-S','711116':'PLASTIC-S','711117':'PLASTIC-S','081-9801':'PLASTIC-S','711104':'PLASTIC-S','711105':'PLASTIC-S','711214':'PLASTIC-S','712621':'PLASTIC-S','711192':'PLASTIC-S','711133':'PLASTIC-S','711134':'PLASTIC-S','712623':'PLASTIC-S','711119':'PLASTIC-S','711136':'PLASTIC-S','KB0801':'PLASTIC-S','711143':'PLASTIC-S','KB0800':'PLASTIC-S','711194':'PLASTIC-S','711191':'PLASTIC-S','711193':'PLASTIC-S','711123':'PLASTIC-S','711198':'PLASTIC-S','711196':'PLASTIC-S','114-9804':'PLASTIC-S','711113':'PLASTIC-S','711120':'PLASTIC-S','711144':'PLASTIC-S','711138':'PLASTIC-S','711121':'PLASTIC-S','711157':'PLASTIC-S','021-0608':'PLASTIC-S','711275':'PLASTIC-S','716652':'PLASTIC-S','713730':'PLASTIC-S','091-0190':'PLASTIC-S','021-9804':'PLASTIC-S','711195':'PLASTIC-S','712021':'PLASTIC-S','711141':'PLASTIC-S','711135':'PLASTIC-S','021-1006':'PLASTIC-S','201-9802':'PLASTIC-S','711203':'PLASTIC-S','711957':'PLASTIC-S','716430':'PLASTIC-S','KB0673':'PLASTIC-S','710326':'PLASTIC-S','710322':'PLASTIC-S','710340':'PLASTIC-S','710341':'PLASTIC-S','710353':'PLASTIC-S','710342':'PLASTIC-S','710349':'PLASTIC-S','710356':'PLASTIC-S','710354':'PLASTIC-S','710355':'PLASTIC-S','710368':'PLASTIC-S','710363':'PLASTIC-S','710369':'PLASTIC-S','710396':'PLASTIC-S','710393':'PLASTIC-S','710398':'PLASTIC-S','710399':'PLASTIC-S','710397':'PLASTIC-S','710402':'PLASTIC-S','710400':'PLASTIC-S','710401':'PLASTIC-S','710405':'PLASTIC-S','710404':'PLASTIC-S','710406':'PLASTIC-S','710412':'PLASTIC-S','710357':'PLASTIC-S','710413':'PLASTIC-S','710439':'PLASTIC-S','710358':'PLASTIC-S','710438':'PLASTIC-S','713683':'PLASTIC-S','KB0382':'PLASTIC-S','KB0381':'PLASTIC-S','KB0379':'PLASTIC-S','KB0436':'PLASTIC-S','KB0402':'PLASTIC-S','9FB134':'PLASTIC-S','017785':'PLASTIC-S','710317':'PLASTIC-S','710316':'PLASTIC-S','KB0446':'PLASTIC-S','713682':'PLASTIC-S','712581':'PLASTIC-S','712583':'PLASTIC-S','712580':'PLASTIC-S','712600':'PLASTIC-S','712587':'PLASTIC-S','712586':'PLASTIC-S','712636':'PLASTIC-S','712612':'PLASTIC-S','712584':'PLASTIC-S','712585':'PLASTIC-S','KB0802':'PLASTIC-S','712634':'PLASTIC-S','712635':'PLASTIC-S','712633':'PLASTIC-S','712632':'PLASTIC-S','712640':'PLASTIC-S','712639':'PLASTIC-S','714027':'PLASTIC-S','712631':'PLASTIC-S','712821':'PLASTIC-S','712701':'PLASTIC-S','712668':'PLASTIC-S','712595':'PLASTIC-S','712682':'PLASTIC-S','712669':'PLASTIC-S','712686':'PLASTIC-S','712667':'PLASTIC-S','712697':'PLASTIC-S','712687':'PLASTIC-S','712681':'PLASTIC-S','712680':'PLASTIC-S','712649':'PLASTIC-S','712055':'PLASTIC-S','712689':'PLASTIC-S','712683':'PLASTIC-S','714406':'PLASTIC-S','712691':'PLASTIC-S','715047':'PLASTIC-S','712934':'PLASTIC-S','712933':'PLASTIC-S','715714':'PLASTIC-S','716151':'PLASTIC-S','714063':'PLASTIC-S','713412':'PLASTIC-S','712949':'712949','712930':'PLASTIC-S','715851':'PLASTIC-S','712935':'PLASTIC-S','714157':'PLASTIC-S','714167':'PLASTIC-S','714820':'PLASTIC-S','716150':'716150','714995':'PLASTIC-S','713790':'PLASTIC-S','714682':'PLASTIC-S','714686':'PLASTIC-S','714681':'PLASTIC-S','714087':'PLASTIC-S','714981':'PLASTIC-S','712685':'PLASTIC-S','714646':'PLASTIC-S','714647':'PLASTIC-S','714645':'714645','714352':'PLASTIC-XL','714350':'PLASTIC-XL','714378':'PLASTIC-XL','714356':'PLASTIC-XL','714355':'PLASTIC-XL','714373':'PLASTIC-XL','714377':'PLASTIC-XL','714372':'PLASTIC-XL','714375':'PLASTIC-XL','714370':'PLASTIC-XL','714376':'PLASTIC-XL','714371':'PLASTIC-XL','714351':'PLASTIC-XL','714353':'PLASTIC-XL','KB0840':'PLASTIC-XL','KB0835':'PLASTIC-XL','KB0778':'PLASTIC-XL','KB0768':'PLASTIC-XL','KB0749':'PLASTIC-XL','KB0731':'PLASTIC-XL','711202':'PLASTIC-S','KB0776':'PLASTIC-XL','KB0770':'PLASTIC-XL','KB0780':'PLASTIC-XL','KB0771':'PLASTIC-XL','KB0775':'PLASTIC-XL','KB0727':'PLASTIC-XL','KB0733':'PLASTIC-XL','KB0737':'PLASTIC-XL','KB0724':'PLASTIC-XL','KB0788':'PLASTIC-XL'};// v16.0: Material별 박스당 수량 (Qty/Box)
// v16.1: Material별 Qty/Box (엑셀 4_Material_Box 시트 기준, 290개)
const MATERIAL_QTY_PER_BOX={'712626':20,'712944':40,'712591':5,'712630':20,'714162':10,'712624':20,'712613':10,'712618':10,'712627':10,'712608':10,'712602':20,'712603':20,'712606':20,'712607':20,'712604':10,'712620':10,'712929':20,'712696':5,'714420':12,'715713':20,'715715':20,'714060':20,'KB0781':10,'712594':20,'712611':20,'712664':50,'712896':20,'714413':50,'710343':20,'710344':20,'710359':20,'710375':20,'710347':20,'710335':20,'710362':5,'710361':5,'710318':5,'710346':20,'710350':20,'710348':20,'710339':20,'710338':20,'710337':20,'710333':20,'710334':20,'710332':20,'710336':3,'711124':10,'711102':20,'711103':20,'711101':5,'711111':20,'711114':20,'711142':20,'711131':20,'711950':20,'711110':40,'711956':18,'048-9805':12,'9800-830':60,'KB0746':70,'KB0838':20,'712589':40,'712590':40,'712592':40,'712593':40,'712605':40,'712955':100,'712628':40,'712588':80,'712609':40,'715045':20,'714421':30,'712647':60,'714422':30,'714164':80,'714165':80,'712622':40,'714163':40,'KB0798':40,'9800-880':40,'KB0784':40,'711115':50,'711112':50,'711126':40,'711132':50,'711951':50,'711107':40,'711130':50,'711109':50,'711108':40,'715046':40,'159-9801':50,'KB0782':15,'KB0783':15,'KB0785':15,'KB0786':15,'KB0837':10,'711919':50,'710319':50,'710345':50,'SP1083':50,'710395':50,'710331':50,'710420':50,'710407':50,'710376':50,'710403':50,'710394':50,'710367':50,'710371':50,'710408':12,'710409':20,'710410':20,'710411':20,'710360':4,'710364':4,'710366':4,'710365':4,'711201':200,'9000-375':200,'716152':200,'711293':400,'712771':200,'711190':200,'711116':5000,'711117':10000,'081-9801':1000,'711104':200,'711105':200,'711214':200,'712621':5000,'711192':200,'711133':200,'711134':200,'712623':50000,'711119':5000,'711136':200,'KB0801':200,'711143':200,'KB0800':200,'711194':5000,'711191':10000,'711193':200,'711123':200,'711198':200,'711196':200,'114-9804':200,'711113':200,'711120':200,'711144':200,'711138':200,'711121':200,'711157':200,'021-0608':200,'711275':200,'716652':400,'713730':200,'091-0190':200,'021-9804':200,'711195':200,'712021':200,'711141':200,'711135':1000,'021-1006':200,'201-9802':200,'711203':200,'711957':200,'716430':10,'KB0673':2000,'710326':100,'710322':100,'710340':100,'710341':100,'710353':100,'710342':100,'710349':100,'710356':100,'710354':100,'710355':100,'710368':100,'710363':100,'710369':100,'710396':100,'710393':100,'710398':100,'710399':100,'710397':100,'710402':100,'710400':100,'710401':100,'710405':100,'710404':100,'710406':100,'710412':100,'710357':100,'710413':100,'710439':100,'710358':100,'710438':100,'713683':100,'KB0382':100,'KB0381':100,'KB0379':100,'KB0436':100,'KB0402':100,'9FB134':100,'017785':100,'710317':100,'710316':100,'KB0446':1000,'713682':1000,'712581':50,'712583':50,'712580':50,'712600':1000,'712587':50,'712586':50,'712636':50,'712612':400,'712584':400,'712585':50,'KB0802':500,'712634':400,'712635':40,'712633':400,'712632':50,'712640':200,'712639':500,'714027':500,'712631':200,'712821':500,'712701':500,'712668':200,'712595':50,'712682':150,'712669':200,'712686':200,'712667':500,'712697':300,'712687':300,'712681':500,'712680':500,'712649':300,'712055':100000,'712689':200,'712683':150,'714406':150,'712691':100,'715047':1000,'712934':50,'712933':150,'715714':200,'716151':150,'714063':50,'713412':500,'712949':100,'712930':200,'715851':300,'712935':350,'714157':50,'714167':150,'714820':50,'716150':400,'714995':100,'713790':100,'714682':100,'714686':100,'714681':100,'714087':100,'714981':400,'712685':200,'714646':200,'714647':200,'714645':200,'714352':500,'714350':500,'714378':500,'714356':500,'714355':500,'714373':500,'714377':500,'714372':500,'714375':500,'714370':500,'714376':500,'714371':500,'714351':500,'714353':500,'KB0840':10,'KB0835':10,'KB0778':10,'KB0768':10,'KB0749':10,'KB0731':10,'711202':4000,'KB0776':10,'KB0770':10,'KB0780':10,'KB0771':10,'KB0775':10,'KB0727':10,'KB0733':10,'KB0737':10,'KB0724':10,'KB0788':10};// v16.1 FINAL: Bin별 랙 정보
// Bin = 1개 선반(1단). rackCount = 같은 Bin을 공유하는 랙 수
// 최대 박스/Bin = BOXES_PER_SHELF[rackType][boxType] × rackCount
const BIN_RACK_INFO={'A1-01':{rackType:'중량랙',rackCount:2},'A1-02':{rackType:'중량랙',rackCount:2},'A1-03':{rackType:'중량랙',rackCount:2},'A1-04':{rackType:'중량랙',rackCount:2},'A1-05':{rackType:'중량랙',rackCount:2},'A1-06':{rackType:'중량랙',rackCount:2},'A2-01':{rackType:'중량랙',rackCount:2,shelves:2},// Notes: 1단,2단사용
'A2-02':{rackType:'중량랙',rackCount:2,shelves:1},// A2-01이 2단 쓰므로 나머지 1단
'A2-03':{rackType:'중량랙',rackCount:2},'A2-04':{rackType:'중량랙',rackCount:2},'A2-05':{rackType:'중량랙',rackCount:2},'A3-01':{rackType:'mixed',rackCount:3,mixed:[{type:'중량랙',count:1},{type:'경량랙',count:2}]},'A3-02':{rackType:'mixed',rackCount:3,mixed:[{type:'중량랙',count:1},{type:'경량랙',count:2}]},'A3-03':{rackType:'mixed',rackCount:3,mixed:[{type:'중량랙',count:1},{type:'경량랙',count:2}]},'A3-04':{rackType:'mixed',rackCount:3,mixed:[{type:'중량랙',count:1},{type:'경량랙',count:2}]},'A5-01':{rackType:'중량랙',rackCount:1},'A5-02':{rackType:'중량랙',rackCount:1},'A5-03':{rackType:'중량랙',rackCount:1},'A5-04':{rackType:'중량랙',rackCount:1},'A5-05':{rackType:'중량랙',rackCount:1},'A5-06':{rackType:'중량랙',rackCount:1},'A6-01':{rackType:'중량랙',rackCount:1},'A6-02':{rackType:'중량랙',rackCount:1},'A6-03':{rackType:'중량랙',rackCount:1},'A6-04':{rackType:'중량랙',rackCount:1},'A6-05':{rackType:'중량랙',rackCount:1},'A6-06':{rackType:'중량랙',rackCount:1},'A7-01':{rackType:'중량랙',rackCount:1,shelves:2},// Notes: 2단 사용
'A7-02':{rackType:'경량랙',rackCount:2},'B1-01':{rackType:'경량랙',rackCount:4},'B1-02':{rackType:'경량랙',rackCount:4},'B1-03':{rackType:'경량랙',rackCount:4},'B1-04':{rackType:'경량랙',rackCount:4},'B1-05':{rackType:'경량랙',rackCount:4},'B1-06':{rackType:'경량랙',rackCount:4},'B1-07':{rackType:'경량랙',rackCount:4},'B1-08':{rackType:'경량랙',rackCount:4},'B1-09':{rackType:'경량랙',rackCount:4},'B1-10':{rackType:'경량랙',rackCount:4},'B1-11':{rackType:'경량랙',rackCount:1},'B1-12':{rackType:'경량랙',rackCount:1},'B1-14':{rackType:'중량랙',rackCount:1},'B2-01':{rackType:'경량랙',rackCount:1},'B2-02':{rackType:'경량랙',rackCount:1},'B2-03':{rackType:'경량랙',rackCount:1},'B2-04':{rackType:'경량랙',rackCount:1},'B2-05':{rackType:'경량랙',rackCount:1},'B2-06':{rackType:'경량랙',rackCount:1},'B2-07':{rackType:'경량랙',rackCount:1},'B2-08':{rackType:'경량랙',rackCount:1},'B2-09':{rackType:'경량랙',rackCount:1},'B2-10':{rackType:'경량랙',rackCount:1},'B2-11':{rackType:'경량랙',rackCount:1},'B2-12':{rackType:'경량랙',rackCount:1},'B2-13':{rackType:'경량랙',rackCount:1},'B2-14':{rackType:'경량랙',rackCount:1},'B2-15':{rackType:'경량랙',rackCount:1},'B2-18':{rackType:'경량랙',rackCount:1},'B3-01':{rackType:'경량랙',rackCount:2,maxBoxes:16},// 100%=20, 80%=16
'B3-02':{rackType:'경량랙',rackCount:2,maxBoxes:16},// 100%=20, 80%=16
'B3-03':{rackType:'중량랙',rackCount:1,maxBoxes:24},// 100%=30, 80%=24
'B3-04':{rackType:'중량랙',rackCount:1,maxBoxes:24},// 100%=30, 80%=24
'B3-05':{rackType:'중량랙',rackCount:2,maxBoxes:29},// 100%=36, 80%=29
'B4-01':{rackType:'경량랙',rackCount:1},'B4-02':{rackType:'경량랙',rackCount:1},'B4-03':{rackType:'경량랙',rackCount:1,shelves:2},// Notes: 2단 사용
'B4-04':{rackType:'경량랙',rackCount:1},'B4-05':{rackType:'경량랙',rackCount:1},'B4-06':{rackType:'경량랙',rackCount:1},'B4-07':{rackType:'경량랙',rackCount:1},'B4-08':{rackType:'경량랙',rackCount:1},'B4-09':{rackType:'경량랙',rackCount:1},'B4-10':{rackType:'경량랙',rackCount:1},'B4-11':{rackType:'경량랙',rackCount:1},'B4-12':{rackType:'경량랙',rackCount:1},'B4-13':{rackType:'경량랙',rackCount:1},'B4-14':{rackType:'경량랙',rackCount:1},'B4-15':{rackType:'경량랙',rackCount:1},'B4-16':{rackType:'경량랙',rackCount:1},'B4-17':{rackType:'경량랙',rackCount:1},'C1-01':{rackType:'경량랙',rackCount:2},'C1-02':{rackType:'경량랙',rackCount:2},'C1-03':{rackType:'경량랙',rackCount:2},'C1-04':{rackType:'경량랙',rackCount:2},'C1-05':{rackType:'경량랙',rackCount:2},'C1-06':{rackType:'경량랙',rackCount:2},'C1-07':{rackType:'경량랙',rackCount:2},'C1-08':{rackType:'경량랙',rackCount:2},'C1-09':{rackType:'경량랙',rackCount:2},'C1-10':{rackType:'경량랙',rackCount:2},'C1-11':{rackType:'경량랙',rackCount:2},'C1-12':{rackType:'경량랙',rackCount:2},'C1-13':{rackType:'경량랙',rackCount:2},'C1-14':{rackType:'경량랙',rackCount:2},'C2-01':{rackType:'경량랙',rackCount:1},'C2-02':{rackType:'경량랙',rackCount:1},'C2-03':{rackType:'경량랙',rackCount:1},'C2-04':{rackType:'경량랙',rackCount:1},'C2-05':{rackType:'경량랙',rackCount:1},'C2-06':{rackType:'경량랙',rackCount:1},'C2-07':{rackType:'경량랙',rackCount:1},'C2-08':{rackType:'경량랙',rackCount:1},'C2-09':{rackType:'경량랙',rackCount:1},'C2-10':{rackType:'경량랙',rackCount:1},'C2-11':{rackType:'경량랙',rackCount:1},'C2-12':{rackType:'경량랙',rackCount:1},'C2-13':{rackType:'경량랙',rackCount:1},'C2-14':{rackType:'경량랙',rackCount:1},'C2-15':{rackType:'경량랙',rackCount:1},'C2-16':{rackType:'경량랙',rackCount:1},'C2-17':{rackType:'경량랙',rackCount:1},'C2-18':{rackType:'경량랙',rackCount:1},'C2-19':{rackType:'경량랙',rackCount:1},'C2-20':{rackType:'경량랙',rackCount:1},'C2-21':{rackType:'경량랙',rackCount:1},'C2-22':{rackType:'경량랙',rackCount:1},'C2-23':{rackType:'경량랙',rackCount:1},'C3-01':{rackType:'경량랙',rackCount:2},'C3-02':{rackType:'경량랙',rackCount:2},'C3-03':{rackType:'경량랙',rackCount:2},'C3-04':{rackType:'경량랙',rackCount:2},'C3-05':{rackType:'경량랙',rackCount:2},'C3-06':{rackType:'경량랙',rackCount:2},'C3-07':{rackType:'경량랙',rackCount:2},'C3-08':{rackType:'경량랙',rackCount:2},'C3-09':{rackType:'경량랙',rackCount:2},'C3-10':{rackType:'경량랙',rackCount:2},'C3-11':{rackType:'경량랙',rackCount:2},'C3-12':{rackType:'경량랙',rackCount:2},'C3-13':{rackType:'경량랙',rackCount:2},'C3-14':{rackType:'경량랙',rackCount:2},'C3-15':{rackType:'경량랙',rackCount:2},'C3-16':{rackType:'경량랙',rackCount:2},'C3-17':{rackType:'경량랙',rackCount:2},'C3-18':{rackType:'경량랙',rackCount:2},'C3-19':{rackType:'경량랙',rackCount:2},'C3-20':{rackType:'경량랙',rackCount:2},'C3-21':{rackType:'경량랙',rackCount:2},'C3-22':{rackType:'경량랙',rackCount:2},'C3-23':{rackType:'경량랙',rackCount:2},'C3-24':{rackType:'경량랙',rackCount:2},'C3-25':{rackType:'경량랙',rackCount:2},'D2':{rackType:'볼트랙',rackCount:1},'E3':{rackType:'경량랙',rackCount:4},'S1':{rackType:'중량랙',rackCount:6,maxBoxes:72}// 6랙×3단×8개=144, 50%적용(제품별 분리보관)
};// v16.1 FINAL: 1개 랙의 1단(1선반)에 들어가는 박스 수
const BOXES_PER_SHELF={'중량랙':{'PLASTIC-XL':8,'PLASTIC-M':16,'PLASTIC-S':28,'PCB BOX-L':3,'PCB BOX-M':12,'PAPER-L':10,'712696':32,'712896':40,'714420':6,'711110':20,'711956':10,'048-9805':15,'712664':12,'159-9801':6,'714645':5,'716150':10,'712949':6},'경량랙':{'PLASTIC-XL':2,'PLASTIC-M':8,'PLASTIC-S':2,'PCB BOX-L':1,'PCB BOX-M':6,'PAPER-L':4,'712696':16,'712896':20,'714420':3,'711110':10,'711956':5,'048-9805':7,'712664':6,'159-9801':3,'714645':2,'716150':4,'712949':3},'볼트랙':{'PLASTIC-XL':4,'PLASTIC-M':10,'PLASTIC-S':20,'PCB BOX-L':2,'PCB BOX-M':3,'PAPER-L':4,'712696':20,'712896':20,'714420':3,'711110':24,'711956':6,'048-9805':9,'712664':6,'159-9801':3,'714645':4,'716150':6,'712949':3}};// 랙 스펙 기반 Bin별 단수(l) + 단 위치(p) 매핑
const BIN_LEVEL_MAP={'A1-01':{l:3,p:1},'A1-02':{l:3,p:2},'A1-03':{l:3,p:3},'A1-04':{l:3,p:1},'A1-05':{l:3,p:2},'A1-06':{l:3,p:3},'A2-01':{l:3,p:1},'A2-02':{l:3,p:2},'A2-03':{l:3,p:1},'A2-04':{l:3,p:2},'A2-05':{l:3,p:3},'A3-01':{l:4,p:1},'A3-02':{l:4,p:2},'A3-03':{l:4,p:3},'A3-04':{l:4,p:4},'A3-05':{l:4,p:1},'A3-06':{l:4,p:2},'A3-07':{l:4,p:3},'A3-08':{l:4,p:4},'A5-01':{l:3,p:1},'A5-02':{l:3,p:2},'A5-03':{l:3,p:3},'A5-04':{l:3,p:1},'A5-05':{l:3,p:2},'A5-06':{l:3,p:3},'A6-01':{l:3,p:1},'A6-02':{l:3,p:2},'A6-03':{l:3,p:3},'A6-04':{l:3,p:1},'A6-05':{l:3,p:2},'A6-06':{l:3,p:3},'A7-01':{l:2,p:1},'A7-02':{l:1,p:1},'B1-01':{l:5,p:1},'B1-02':{l:5,p:2},'B1-03':{l:5,p:3},'B1-04':{l:5,p:4},'B1-05':{l:5,p:5},'B1-06':{l:5,p:1},'B1-07':{l:5,p:2},'B1-08':{l:5,p:3},'B1-09':{l:5,p:4},'B1-10':{l:5,p:5},'B1-11':{l:1,p:1},'B1-12':{l:1,p:1},'B1-14':{l:1,p:1},'B2-01':{l:5,p:1},'B2-02':{l:5,p:2},'B2-03':{l:5,p:3},'B2-04':{l:5,p:4},'B2-05':{l:5,p:5},'B2-06':{l:5,p:1},'B2-07':{l:5,p:2},'B2-08':{l:5,p:3},'B2-09':{l:5,p:4},'B2-10':{l:5,p:5},'B2-11':{l:5,p:1},'B2-12':{l:5,p:2},'B2-13':{l:5,p:3},'B2-14':{l:5,p:4},'B2-15':{l:5,p:5},'B2-18':{l:1,p:1},'B3-01':{l:1,p:1},'B3-02':{l:1,p:1},'B3-03':{l:1,p:1},'B3-04':{l:1,p:1},'B3-05':{l:1,p:1},'B4-01':{l:5,p:1},'B4-02':{l:5,p:2},'B4-03':{l:5,p:3},'B4-04':{l:5,p:4},'B4-05':{l:6,p:1},'B4-06':{l:6,p:2},'B4-07':{l:6,p:3},'B4-08':{l:6,p:4},'B4-09':{l:6,p:5},'B4-10':{l:6,p:6},'B4-11':{l:2,p:1},'B4-12':{l:2,p:2},'B4-13':{l:2,p:1},'B4-14':{l:2,p:2},'B4-15':{l:2,p:1},'B4-16':{l:2,p:2},'B4-17':{l:1,p:1},'C1-01':{l:7,p:1},'C1-02':{l:7,p:2},'C1-03':{l:7,p:3},'C1-04':{l:7,p:4},'C1-05':{l:7,p:5},'C1-06':{l:7,p:6},'C1-07':{l:7,p:7},'C1-08':{l:7,p:1},'C1-09':{l:7,p:2},'C1-10':{l:7,p:3},'C1-11':{l:7,p:4},'C1-12':{l:7,p:5},'C1-13':{l:7,p:6},'C1-14':{l:7,p:7},'C2-01':{l:7,p:1},'C2-02':{l:7,p:2},'C2-03':{l:7,p:3},'C2-04':{l:7,p:4},'C2-05':{l:7,p:5},'C2-06':{l:7,p:6},'C2-07':{l:7,p:7},'C2-08':{l:7,p:1},'C2-09':{l:7,p:2},'C2-10':{l:7,p:3},'C2-11':{l:7,p:4},'C2-12':{l:7,p:5},'C2-13':{l:7,p:6},'C2-14':{l:7,p:7},'C2-15':{l:4,p:1},'C2-16':{l:4,p:2},'C2-17':{l:4,p:3},'C2-18':{l:4,p:4},'C2-19':{l:5,p:1},'C2-20':{l:5,p:2},'C2-21':{l:5,p:3},'C2-22':{l:5,p:4},'C2-23':{l:5,p:5},'C3-01':{l:7,p:1},'C3-02':{l:7,p:2},'C3-03':{l:7,p:3},'C3-04':{l:7,p:4},'C3-05':{l:7,p:5},'C3-06':{l:7,p:6},'C3-07':{l:7,p:7},'C3-08':{l:7,p:1},'C3-09':{l:7,p:2},'C3-10':{l:7,p:3},'C3-11':{l:7,p:4},'C3-12':{l:7,p:5},'C3-13':{l:7,p:6},'C3-14':{l:7,p:7},'C3-15':{l:6,p:1},'C3-16':{l:6,p:2},'C3-17':{l:6,p:3},'C3-18':{l:6,p:4},'C3-19':{l:6,p:5},'C3-20':{l:6,p:6},'C3-21':{l:5,p:1},'C3-22':{l:5,p:2},'C3-23':{l:5,p:3},'C3-24':{l:5,p:4},'C3-25':{l:5,p:5},'D2':{l:1,p:1},'E3':{l:1,p:1},'S1':{l:3,p:1}};// 모델별 BOM 무게 (kg) - 실제 BOM 계산값
const MODEL_WEIGHTS={// 48 시리즈
'RSC48':{name:'Maxwell RSC48',code:'AS8500',avgWeight:40.66,bomItems:234,series:'48'},'CSC48':{name:'Maxwell CSC48',code:'AS8000',avgWeight:41.09,bomItems:235,series:'48'},// 16 시리즈
'RSC16':{name:'Maxwell RSC16',code:'AS4500',avgWeight:18.47,bomItems:159,series:'16'},'FSC16':{name:'Maxwell FSC16',code:'AS4600',avgWeight:18.29,bomItems:158,series:'16'},'CSC16':{name:'Maxwell CSC16',code:'AS6000',avgWeight:18.35,bomItems:160,series:'16'},// HSM
'Sub-com.':{name:'Sub-com.',code:'KB',avgWeight:0,bomItems:0,series:'KB'}};const SUBCOM_INFO={'KB0064':'16','KB0132':'16','KB0438':'16/48','KB0673':'16/48','KB0768':'48','KB0770':'48','KB0771':'48','KB0775':'48','KB0776':'48','KB0778':'16','KB0780':'16/48','KB0782':'16/48','KB0783':'16/48','KB0784':'16/48','KB0785':'16/48','KB0786':'16/48','KB0798':'16/48','KB0802':'16/48','KB0835':'48','KB0837':'48','KB0840':'48'};// 모델별 BOM 데이터 (Material: 필요수량) - BOM최종_020426 기준
const MODEL_BOM_DATA={'RSC48':{'712582':1,'716652':4,'712586':1,'712696':3,'712636':1,'712701':3,'712821':3,'712655':38,'715024':1,'KB0673':3,'712588':2,'712587':1,'712635':1,'712641':10,'712646':2,'713646':1,'712634':1,'712583':1,'712680':3,'712585':1,'712584':1,'712929':1,'712896':2,'712930':2,'081-9801':2,'KB0438':56,'712658':65,'712660':43,'710381':8,'KB0132':20,'711106':7,'714027':3,'714028':3,'714930':3,'712591':1,'KB0782':1,'800-0430':400,'712600':8,'712662':24,'KB0783':1,'712589':1,'711135':6,'712590':1,'712592':1,'712593':1,'712682':1,'712647':2,'712598':8,'710389':25,'710385':10,'712653':8,'713123':1,'713124':1,'713722':6.5,'711673':8,'712618':1,'712664':2,'081-0802':2,'075-9821':16,'712613':1,'714162':1,'714163':2,'712640':2,'714164':1,'714165':1,'712639':6,'712632':1,'712631':1,'714157':2,'KB0798':2,'713942':4,'714167':4,'075-9822':4,'KB0064':8,'712580':4,'712581':4,'713046':8,'712633':4,'712612':4,'713645':4,'KB0802':4,'712661':6,'712657':48,'71242':15,'712607':1,'712606':1,'712603':1,'712602':1,'KB0768':1,'712608':1,'712609':2,'712669':2,'712667':2,'099-9303':28.74,'711202':48,'712604':1,'712659':16,'712630':1,'KB0835':1,'712627':1,'716150':1,'712695':2,'KB0837':1,'716151':1,'712683':1,'714420':1,'714422':1,'714413':1,'712654':56,'714406':1,'714421':1,'716153':70,'KB0775':1,'712628':1,'KB0784':1,'712697':1,'712681':2,'711293':2,'712687':1,'712945':1,'711125':4,'712772':6,'712624':1,'711204':19,'079-0800':19,'017678':1,'KB0771':1,'715045':1,'715047':2,'9800-880':1,'712689':1,'712948':2,'712691':1,'712622':1,'712935':6,'713412':4,'712937':2,'713413':2,'712939':1,'712940':1,'713125':4,'017680':1,'018141':1,'017681':1,'017677':1,'017899':1,'712941':1,'712942':1,'712943':1,'712944':2,'KB0780':1,'712932':1,'712626':1,'KB0785':1,'712686':1,'712947':2,'712955':2,'KB0840':1,'714060':1,'712949':1,'714400':4,'715713':1,'715714':1,'715715':1,'714444':2,'715298':1,'715299':1,'KB0770':2,'712605':2,'712621':48,'711119':48,'711118':96,'712623':48,'711251':1,'712648':6,'KB0776':1,'712611':1,'712668':2,'712055':800,'712649':2,'712595':2,'711191':48,'711194':48,'711143':4,'050-0029':4,'71885':2,'713139':2,'KB0778':1,'712594':1,'715851':1,'712620':1,'KB0786':1,'714645':1,'714646':1,'714647':1,'714087':1,'714681':1,'714682':1,'714683':2,'714684':2,'714686':1,'714981':6,'711668':4,'710377':6,'712685':1,'713780':1,'710437':1,'713129':1,'713130':1,'713131':1,'713132':1,'713133':1,'713134':1,'713135':1,'713136':1,'713137':1,'713138':1,'713140':1,'713141':1,'713220':4,'050-9811':1,'71331':1,'713142':1,'050-0040':2,'71790':1,'713242':4,'9LT314':1,'9BR300':1,'9FB216':1,'9GE817':1,'713682':1,'714904':1,'716551':1,'72410':1},'CSC48':{'712582':1,'716652':4,'712586':1,'712696':3,'712636':1,'712701':3,'712821':3,'712655':38,'715024':1,'KB0673':3,'712588':2,'712587':1,'712635':1,'712641':10,'712646':2,'713646':1,'712634':1,'712583':1,'712680':3,'712585':1,'712584':1,'712929':1,'712896':2,'712930':2,'081-9801':2,'KB0438':56,'712658':65,'712660':43,'710381':8,'KB0132':20,'711106':7,'714027':3,'714028':3,'714930':3,'712591':1,'KB0782':1,'800-0430':400,'712600':8,'712662':24,'KB0783':1,'712589':1,'711135':6,'712590':1,'712592':1,'712593':1,'712682':1,'712647':2,'712598':8,'710389':25,'710385':10,'712653':8,'713123':1,'713124':1,'713722':6.5,'711673':8,'712618':1,'712664':2,'081-0802':2,'075-9821':16,'712613':1,'714162':1,'714163':2,'712640':2,'714164':1,'714165':1,'712639':6,'712632':1,'712631':1,'714157':2,'KB0798':2,'713942':4,'714167':4,'075-9822':4,'KB0064':8,'712580':4,'712581':4,'713046':8,'712633':4,'712612':4,'713645':4,'KB0802':4,'712661':6,'712657':48,'71242':15,'712607':1,'712606':1,'712603':1,'712602':1,'KB0768':1,'712608':1,'712609':2,'712669':2,'712667':2,'099-9303':28.74,'711202':48,'712604':1,'712659':16,'712630':1,'KB0835':1,'712627':1,'716150':1,'712695':2,'KB0837':1,'716151':1,'712683':1,'714420':1,'714422':1,'714413':1,'712654':56,'714406':1,'714421':1,'716153':70,'KB0775':1,'712628':1,'KB0784':1,'712697':1,'712681':2,'711293':2,'712687':1,'712945':1,'711125':4,'712772':6,'712624':1,'711204':19,'079-0800':19,'017678':1,'KB0771':1,'715045':1,'715047':2,'9800-880':1,'712689':1,'712948':2,'712691':1,'712622':1,'712935':6,'713412':4,'712937':2,'713413':2,'714141':1,'712940':1,'713125':4,'017680':1,'018141':1,'017681':1,'017677':1,'017899':1,'71385':1,'714140':1,'714158':1,'714159':1,'712944':2,'KB0780':1,'712932':1,'712626':1,'KB0785':1,'712686':1,'712947':2,'712955':2,'KB0840':1,'714060':1,'712949':1,'714400':4,'715713':1,'715714':1,'715715':1,'714444':2,'715298':1,'715299':1,'KB0770':2,'712605':2,'712621':48,'711119':48,'711118':96,'712623':48,'711251':1,'712648':6,'KB0776':1,'712611':1,'712668':2,'712055':800,'712649':2,'712595':2,'711191':48,'711194':48,'711143':4,'050-0029':4,'71885':2,'713139':2,'KB0778':1,'712594':1,'715851':1,'712620':1,'KB0786':1,'714645':1,'714646':1,'714647':1,'714087':1,'714681':1,'714682':1,'714683':2,'714684':2,'714686':1,'714981':6,'711668':4,'710377':6,'712685':1,'713780':1,'710437':1,'713129':1,'713130':1,'713131':1,'713132':1,'713133':1,'713134':1,'713135':1,'713136':1,'713137':1,'713138':1,'713140':1,'713141':1,'713220':4,'050-9811':1,'71331':1,'713142':1,'73727':2,'713242':4,'713682':1,'714904':1,'716551':1,'72320':1,'9FB231':1,'9LT312':1,'9BR320':1,'72410':1,'9FDC008':1},'RSC16':{'050-0040':2,'050-0029':3,'71300':1,'71242':16,'KB0788':1,'711115':1,'712621':16,'712623':16,'711118':32,'711119':16,'711251':0.25,'KB0125':3,'KB0737':1,'711142':1,'711191':16,'711194':16,'711201':1,'075-9805':23,'711141':1,'KB0438':8,'711143':2,'71290':1,'712055':250,'71885':1,'715851':1,'716655':1,'716648':1,'711101':1,'711102':1,'711103':1,'711104':2,'711105':2,'711106':19,'716652':4,'711120':1,'9000-375':1,'KB0392':23,'KB0749':1,'711123':1,'711956':1,'712658':46,'711121':1,'711190':1,'711192':1,'074-9802':1,'079-9803':2,'712660':9,'081-9801':1,'711131':1,'711135':2,'711132':1,'711133':3,'711134':3,'710388':3,'9800-830':1,'082-0306':11,'711214':1,'711136':2,'KB0389':8,'201-9802':1,'711203':1,'075-9815':32,'132-9800':1,'800-0430':150,'711138':2,'KB0140':4,'KB0800':1,'073-9800':1,'KB0801':1,'711137':4,'075-9822':4,'KB0724':1,'711114':1,'048-9805':2,'713046':28,'711107':1,'711108':1,'711109':1,'711110':4,'711111':1,'114-9804':1,'099-9303':10,'711202':16,'711193':1,'711112':1,'075-9825':14,'711113':1,'711144':2,'KB0733':1,'715046':1,'715047':2,'9800-880':1,'711130':1,'021-0608':1,'712948':2,'091-0190':1,'713047':14,'711196':1,'711157':2,'711293':2,'KB0731':1,'711124':1,'716150':1,'159-9801':1,'711126':1,'129-9800':2,'713730':1,'716152':1,'081-0802':4,'021-9804':1,'037-0055':2,'716153':70,'711125':3,'KB0838':1,'711139':2,'KB0673':2,'021-1006':1,'KB0746':1,'711950':1,'017678':1,'079-0800':5,'711204':5,'059-9800':1,'711100':1,'711140':1,'019-9803':2,'017680':1,'018141':1,'017681':1,'017677':1,'017899':1,'078-9800':2,'711195':2,'711198':4,'712021':1,'711957':1,'71286':1,'71289':1,'71321':1,'711145':1,'711146':1,'711147':1,'711151':1,'711152':1,'9FB168':1,'9BR264':1,'9LT311':1,'050-9811':1,'712959':1,'71331':1,'E6150':1,'711638':1,'71443':1,'71444':1,'71445':1,'713683':1,'714904':1,'716551':1,'72410':1},'FSC16':{'050-0040':2,'71242':16,'KB0788':1,'711115':1,'712621':16,'712623':16,'711118':32,'711119':16,'711251':0.25,'KB0125':3,'KB0737':1,'711142':1,'711191':16,'711194':16,'711201':1,'075-9805':23,'711141':1,'KB0438':8,'711143':2,'71290':1,'050-0029':3,'712055':250,'71885':1,'715851':1,'716655':1,'716648':1,'711101':1,'711102':1,'711103':1,'711104':2,'711105':2,'711106':19,'716652':4,'711120':1,'9000-375':1,'KB0392':23,'KB0749':1,'711123':1,'711956':1,'712658':46,'711121':1,'711190':1,'711192':1,'074-9802':1,'079-9803':2,'712660':9,'081-9801':1,'711131':1,'711135':2,'711132':1,'711133':3,'711134':3,'710388':3,'9800-830':1,'082-0306':11,'711214':1,'711136':2,'KB0389':8,'201-9802':1,'711203':1,'075-9815':32,'132-9800':1,'800-0430':150,'711138':2,'KB0140':4,'KB0800':1,'073-9800':1,'KB0801':1,'711137':4,'075-9822':4,'KB0724':1,'711114':1,'048-9805':2,'713046':28,'711107':1,'711108':1,'711109':1,'711110':4,'711111':1,'114-9804':1,'099-9303':10,'711202':16,'711193':1,'711112':1,'075-9825':14,'711113':1,'711144':2,'KB0733':1,'715046':1,'715047':2,'9800-880':1,'711130':1,'021-0608':1,'712948':2,'091-0190':1,'713047':14,'711196':1,'711157':2,'711293':2,'KB0731':1,'711124':1,'716150':1,'159-9801':1,'711126':1,'129-9800':2,'713730':1,'716152':1,'081-0802':4,'021-9804':1,'037-0055':2,'716153':70,'711125':3,'KB0838':1,'711139':2,'KB0673':2,'021-1006':1,'KB0746':1,'711950':1,'017678':1,'079-0800':5,'711204':5,'059-9800':1,'711100':1,'712290':1,'712021':1,'019-9803':2,'017680':1,'018141':1,'017681':1,'017677':1,'017899':1,'078-9800':2,'711195':2,'711198':4,'711957':1,'71286':1,'711638':1,'71289':1,'71321':1,'711145':1,'711146':1,'711147':1,'711151':1,'711152':1,'050-9811':1,'712959':1,'71331':1,'71443':1,'71444':1,'71445':1,'713780':1,'71654':1,'9BR283':1,'9FB194':1,'9LT313':1,'713683':1,'714904':1,'72410':1},'CSC16':{'73727':2,'050-0029':3,'050-9809':1,'71242':16,'KB0125':3,'KB0737':1,'711142':1,'711191':16,'711194':16,'711201':1,'075-9805':23,'711141':1,'KB0438':8,'711143':2,'71290':1,'712055':250,'71885':1,'715298':1,'715851':1,'715299':1,'711101':1,'711102':1,'711103':1,'711104':2,'711105':2,'711106':19,'716652':4,'711120':1,'9000-375':1,'KB0392':23,'KB0749':1,'711123':1,'711956':1,'712658':46,'711121':1,'711190':1,'711192':1,'074-9802':1,'079-9803':2,'712660':9,'081-9801':1,'711131':1,'711135':2,'711951':1,'711133':3,'711134':3,'710388':3,'9800-830':1,'082-0306':11,'711214':1,'711136':2,'KB0389':8,'201-9802':1,'711203':1,'075-9815':32,'132-9800':1,'800-0430':150,'711138':2,'KB0140':4,'KB0800':1,'073-9800':1,'KB0801':1,'711137':4,'075-9822':4,'KB0724':1,'711114':1,'048-9805':2,'713046':28,'711107':1,'711108':1,'711109':1,'711110':4,'711111':1,'114-9804':1,'099-9303':10,'711202':16,'711193':1,'711112':1,'075-9825':14,'711113':1,'711144':2,'KB0733':1,'715046':1,'715047':2,'9800-880':1,'711130':1,'021-0608':1,'712948':2,'091-0190':1,'713047':14,'711196':1,'711157':2,'711293':2,'KB0731':1,'711124':1,'716150':1,'159-9801':1,'711126':1,'129-9800':2,'713730':1,'716152':1,'081-0802':4,'021-9804':1,'037-0055':2,'716153':70,'711125':3,'KB0838':1,'711139':2,'KB0673':2,'021-1006':1,'KB0746':1,'711950':1,'017678':1,'079-0800':5,'711204':5,'059-9800':1,'711473':1,'711474':1,'712021':1,'019-9803':2,'017680':1,'018141':1,'017681':1,'017677':1,'017899':1,'078-9800':2,'711195':2,'711198':4,'71385':1,'711957':1,'KB0727':1,'711115':1,'711116':16,'711117':16,'711118':32,'711119':16,'711251':0.25,'71286':1,'711638':1,'71289':1,'71321':1,'711145':1,'711146':1,'711147':1,'711151':1,'711152':1,'050-9811':1,'712959':1,'71331':1,'71443':1,'71444':1,'71445':1,'9LT308':1,'9FB179':1,'9FDC007':1,'713683':1,'714904':1,'713780':1,'716551':1,'72410':1},'HSM3':{'71140':1,'017810':1,'71242':9,'710364':1,'710365':1,'KB0438':18,'710366':1,'710376':2,'017677':1,'017678':1,'017680':1,'017681':1,'017682':1,'017899':1,'710362':1,'710318':1,'710405':1,'710406':2,'710407':1,'710363':2,'710421':4,'710413':4,'KB0677':12,'710403':1,'710404':1,'710361':1,'KB0391':8,'KB0511':4,'017679':1,'KB0133':5,'710530':3,'710394':1,'017916':1,'018263':1,'018264':1,'710423':1,'710424':1,'710425':1,'710426':1,'710427':4,'710428':2,'710429':2,'710430':2,'710431':1,'710432':1,'710433':2,'710434':1,'710435':2,'710437':1,'710438':1,'710439':1,'710336':1,'710316':1,'710317':1,'710319':4,'710322':1,'710326':1,'710329':4,'710330':36,'710331':2,'710332':1,'710333':1,'710334':1,'710335':2,'710337':1,'710338':1,'710339':1,'710340':1,'710341':1,'710342':1,'710343':1,'710344':1,'710345':2,'710346':4,'710347':1,'710348':4,'710349':1,'710350':1,'710353':1,'710354':1,'710355':1,'710356':1,'710357':8,'710358':2,'710359':1,'710360':1,'710367':1,'710368':1,'710369':1,'710370':7,'710372':2,'710373':2,'710374':4,'710375':2,'710377':24,'710378':2,'710379':4,'710380':4,'710381':45,'710382':16,'710383':5,'710386':8,'710388':4,'710389':7,'710390':6,'710391':4,'710393':1,'710395':1,'710396':1,'710397':1,'710398':1,'710399':1,'710400':1,'710401':1,'710402':4,'710408':1,'710409':1,'710410':1,'710411':1,'710412':8,'710420':4,'KB0379':1,'KB0381':3,'KB0382':1,'KB0389':5,'KB0390':19,'KB0402':4,'KB0408':2,'KB0436':1,'KB0485':4,'KB0140':12,'KB0145':2,'KB0146':2,'KB0177':15,'KB0183':2,'KB0132':1,'710385':16,'711139':3,'716652':4,'711125':9,'71141':1,'71142':1,'9FB134':1,'SP1083':1,'711919':1}};// 랙 설정 (최대 중량, Bin 크기 등) - 나중에 수정 가능
const RACK_CONFIG={maxWeightPerBin:50,// kg
maxWeightPerRack:500,// kg
binDimensions:{width:40,depth:60,height:30}// cm
};// 무게 데이터 (원자재_무게_측정_등록_작업.xlsx 기준 - 515개 Material)
// d: Description, w: Weight(kg), b: Bin
// 총 515개 Material
const DEFAULT_WEIGHT_DATA={'712626':{d:'LED INDICATOR BRACKET',w:0.244,b:'A1-01'},'712944':{d:'Bracket, Main Enclosure, MX48',w:0.086,b:'A1-01'},'712591':{d:'DECK LOW, PLATE , MX48',w:1.82,b:'A1-02'},'712630':{d:'Board Cover, MX48',w:0.3035,b:'A1-02'},'714162':{d:'Vertical, Motor Plate Top, MX48_CSC',w:0.509,b:'A1-03'},'712624':{d:'BACK PLATE, MX48',w:0.4635,b:'A1-03'},'712613':{d:'VERTICAL, LEFT PLATE, MX48',w:0.4195,b:'A1-04'},'712618':{d:'VERTICAL, RIGHT PLATE, MX48',w:0.42,b:'A1-04'},'712627':{d:'SHELF, MAIN BOARD, MX48',w:0.317,b:'A1-04'},'712608':{d:'PLUNGER BAR, MX48',w:0.343,b:'A1-05'},'712602':{d:'Magnet Bar,Left, MX48',w:0.145,b:'A1-05'},'712603':{d:'Magnet Bar, Right , MX48',w:0.152,b:'A1-05'},'712606':{d:'PLUNGER BAR, LEFT, MX48',w:0.1535,b:'A1-05'},'712607':{d:'Plunger Bar, Right, MX48',w:0.1475,b:'A1-05'},'712604':{d:'Magnet Bar,MX48',w:0.439,b:'A1-06'},'712620':{d:'Vision, lighting bracket, MX48',w:0.403,b:'A1-06'},'712929':{d:'Back Plate, Bottom, MX48',w:0.1115,b:'A1-06'},'712696':{d:'ST.Motor With Encoder, MX-48',w:0.427,b:'A2-01'},'714420':{d:'LPS365M Power Supply',w:0.4055,b:'A2-02'},'715713':{d:'Back Plate, New Tablet, MX48',w:0.2745,b:'A2-03'},'715715':{d:'Bottom grip, New Tablet, MX48',w:0.073,b:'A2-03'},'714060':{d:'Support bar, Tablet, SM',w:0.0995,b:'A2-03'},'KB0781':{d:'Machine Vision ASM,MX48',w:0.587,b:'A2-04'},'712594':{d:'Tray Back, Low Profile, MX48',w:0.7085,b:'A2-04'},'712611':{d:'Tray Front, Low Profile, MX48',w:0.704,b:'A2-04'},'712664':{d:'LM Guide, MX48',w:0.0905,b:'A2-05'},'712896':{d:'SPEED GUIDE, MX48',w:0.983,b:'A2-05'},'714413':{d:'DC FAN for LPS365-M',w:0.057,b:'A2-05'},'710343':{d:'Spindle AL6061-T6 / Anodizing(White',w:0.3675,b:'A3-01'},'710344':{d:'Spindle Coupling AL6061-T6 / Anodiz',w:0.1485,b:'A3-01'},'710359':{d:'Board Bracket AL5052P / Spray(Silve',w:0.2,b:'A3-01'},'710375':{d:'Shaft PSSFGW8-275-M4-N4',w:0.1061,b:'A3-01'},'710347':{d:'Heat Block Lower ACETAL / Black',w:0.588,b:'A3-02'},'710335':{d:'Magnet Holder AL6061-T6 / Anodizing',w:0.17314,b:'A3-02'},'710362':{d:'Power Supply Case Bottom AL5052P / ',w:0.2905,b:'A3-02'},'710361':{d:'Power Supply Case Cover AL5052P / P',w:0.36769,b:'A3-02'},'710318':{d:'Power Supply Input : 85~264VAC, 47~',w:1.123,b:'A3-03'},'710346':{d:'Heat Block AL6061-T6 / Anodizing(Wh',w:0.37334,b:'A3-04'},'710350':{d:'Heat Block Metal Cover AL6061-T6 / ',w:0.65548,b:'A3-04'},'710348':{d:'Heat Block Gasket ACETAL / Black',w:0.05619,b:'A3-05'},'710339':{d:'Shaft SUS303',w:0.076765,b:'A3-05'},'710338':{d:'Eccentric Shaft SUS303',w:0.05852,b:'A3-05'},'710337':{d:'Eccentric Wheel Brass/Nickel Platin',w:0.43134,b:'A3-06'},'710333':{d:'Magnet Back Wall AL6061-T6 / Anodiz',w:0.27985,b:'A3-06'},'710334':{d:'Magnet Front Wall AL6061-T6 / Anodi',w:0.29998,b:'A3-07'},'710332':{d:'BLDC Motor Housing AL6061-T6 / Anod',w:0.1,b:'A3-07'},'710336':{d:'Base Plate SUS304',w:7.8,b:'A3-08'},'711124':{d:'Shelf MLB, Ares',w:0.2315,b:'A5-01'},'711102':{d:'Vertical Side -R, Ares',w:0.4175,b:'A5-02'},'711103':{d:'Vertical Side -L, Ares',w:0.4185,b:'A5-02'},'711101':{d:'Base Plate, Ares',w:2.1085,b:'A5-03'},'711111':{d:'Plunger Bar, Ares',w:0.256,b:'A5-05'},'711114':{d:'Magnet Bar, Ares',w:0.1895,b:'A5-05'},'711142':{d:'Tray, Low Profile, Ares',w:0.4815,b:'A5-06'},'711131':{d:'Deck Low Profile, Ares',w:0.4505,b:'A6-01'},'711950':{d:'Back Panel, CSC',w:0.3805,b:'A6-03'},'711110':{d:'LM Guide ML9, Pre-Load, 110mm',w:0.055,b:'A6-04'},'711956':{d:'Horizontal Motor, End cut',w:0.4175,b:'A6-05'},'048-9805':{d:'Vertical Motor, Leadscrew&Nut, Ares',w:0.3975,b:'A6-06'},'9800-830':{d:'PCBA-Heater Assy, Ares',w:0.027,b:'A7-01'},'KB0746':{d:'PCBA, USB Hub 4 Port Out, CSC',w:0.0285,b:'A7-01'},'KB0838':{d:'Instrument Platform Maxwell LLC',w:0.1465,b:'A7-02'},'712589':{d:'Deck Low, Back-F, MX48',w:0.1615,b:'B1-01'},'712590':{d:'Deck Low, Back-B, MX48',w:0.156,b:'B1-01'},'712592':{d:'DECK LOW, SIDE-L, MX48',w:0.088,b:'B1-02'},'712593':{d:'DECK LOW, SIDE-R, MX48',w:0.088,b:'B1-02'},'712605':{d:'MAGNET ROD, BLOCK, MX48',w:0.1165,b:'B1-03'},'712955':{d:'Support Tablet, MX48',w:0.025,b:'B1-03'},'712628':{d:'USB Terminal Board Bracket',w:0.1935,b:'B1-04'},'712588':{d:'BASE, SLIDE RAIL, MX48',w:0.0355,b:'B1-04'},'712609':{d:'PLUNGER, COVER, MX48',w:0.0785,b:'B1-05'},'715045':{d:'New UV Lamp, Hood, MX48',w:0.1935,b:'B1-05'},'714421':{d:'LPS365M Power Supply Plate',w:0.053,b:'B1-06'},'712647':{d:'Deck, Guide Line, MX48',w:0.031,b:'B1-07'},'714422':{d:'Cover LPS365M Power supply',w:0.079,b:'B1-07'},'714164':{d:'Vertical, Motor Plate-L, MX48_CSC',w:0.12,b:'B1-08'},'714165':{d:'Vertical, Motor Plate-R, MX48_CSC',w:0.1195,b:'B1-08'},'712622':{d:'Support Hinge, Door, MX48',w:0.131,b:'B1-09'},'714163':{d:'Vertical, Motor Housing, MX48_CSC',w:0.043,b:'B1-09'},'KB0798':{d:'Shaft 450mm with Bearing inserted',w:0.2565,b:'B1-10'},'9800-880':{d:'PCBA-UV Lamp Converter Assy, Ares',w:0.038,b:'B1-11'},'KB0784':{d:'PCBA-USB TERMINAL, MX-48',w:0.016,b:'B1-14'},'711115':{d:'Interchange Block, Ares',w:0.0615,b:'B2-01'},'711112':{d:'Spacer Plunger Cover, Ares',w:0.112,b:'B2-03'},'711126':{d:'Shield, Power Supply, Ares',w:0.105,b:'B2-05'},'711132':{d:'Heater Block, Ares',w:0.1595,b:'B2-06'},'711951':{d:'Heater Block, CSC',w:0.16,b:'B2-07'},'711107':{d:'Vertical Back, Ares',w:0.5645,b:'B2-08'},'711130':{d:'UV Lamp Hood, Ares',w:0.0585,b:'B2-10'},'711109':{d:'LM Cover, Ares',w:0.032,b:'B2-11'},'711108':{d:'Vertical Upper, Ares',w:0.207,b:'B2-12'},'715046':{d:'New UV Lamp, Reflector, MX16',w:0.117,b:'B2-14'},'159-9801':{d:'Power Supply, 24V/150W/Open FRM, Me',w:0.1815,b:'B2-18'},'KB0782':{d:'PCBA-HEAT Front, MX-48',w:0.2225,b:'B3-01'},'KB0783':{d:'PCBA-HEAT Back, MX-48',w:0.2225,b:'B3-02'},'KB0785':{d:'PCBA-LED INDICATOR, MX-48',w:0.053,b:'B3-03'},'KB0786':{d:'PCBA-V.LIGHT, MX-48',w:0.0465,b:'B3-04'},'KB0837':{d:'Instrument Platform Maxwell 48 LLC',w:0.199,b:'B3-05'},'711919':{d:'Dsub Serial Cable, 3M',w:0.16753,b:'B4-01'},'710319':{d:'Kapton Flim Heater 24V/80W',w:0.010162,b:'B4-02'},'710345':{d:'Spring Mount AL6061-T6 / Anodizing(',w:0.04402,b:'B4-02'},'SP1083':{d:'RS-232 USB Adaptor, Maxwell®16',w:0.11745,b:'B4-03'},'710395':{d:'Panel Mount HSM \"Wire : AWG20, 300',w:0.024273,b:'B4-04'},'710331':{d:'Bearing 3202ANT9(SKF)',w:0.06396,b:'B4-04'},'710420':{d:'Ceramic Paper 55×250 / 1300 PAPER #',w:0.008932,b:'B4-05'},'710407':{d:'Power Entry Module (KMF1.1191.11) 1',w:0.05658,b:'B4-06'},'710376':{d:'Trim TRAT2.4-B-5 (400mm)',w:0.02028,b:'B4-06'},'710403':{d:'Panel Mount_PowerSupply \"Wire : AW',w:0.06627,b:'B4-07'},'710394':{d:'24V Power Cable \"Cable : AWG16, 60',w:0.44247,b:'B4-08'},'710367':{d:'T/Pulley P84-3GT-9-33F',w:0.14663,b:'B4-09'},'710371':{d:'Foot  FBFS33-8-30',w:0.04184,b:'B4-09'},'710330':{d:'Magnet 15x15, 150\'C',w:0.01941,b:'B4-10'},'710408':{d:'Main Board Size : 80 * 99,  6 Layer',w:0.05431,b:'B4-11'},'710409':{d:'Motor Drive Board Size : 65 * 80 (m',w:0.03611,b:'B4-12'},'710410':{d:'Terminal Board Size : 180 * 25 (mm)',w:0.02242,b:'B4-13'},'710411':{d:'LED Board Size : 34 * 16 (mm), 2 La',w:0.001833,b:'B4-14'},'710360':{d:'Case EGI 1.2T /Powder Coating(Silve',w:1.56864,b:'B4-16'},'710364':{d:'Rack Cover AL5052P / Anodizing(blac',w:0.19021,b:'B4-17'},'710366':{d:'Rack Stand SUS304',w:1.52458,b:'B4-17'},'710365':{d:'Rack Inner AL5052P / Anodizing(blac',w:0.16294,b:'B4-17'},'711201':{d:'Guide E-Tube Tray, Ares',w:0.016,b:'C1-01'},'9000-375':{d:'Unsealed Opto Sensor Assy, 19\"',w:0.00646,b:'C1-01'},'716152':{d:'Cable-Earth Ground_MX16',w:0.01939,b:'C1-01'},'711202':{d:'Roller Lock, Plunger, Ares',w:5e-05,b:'C1-01'},'711293':{d:'Nut, Sensor Bracket',w:0.00038,b:'C1-01'},'712771':{d:'Cable-Earth Ground, MX-48',w:0.00423,b:'C1-01'},'711190':{d:'Adapter Fitting, Ares',w:0.00647,b:'C1-02'},'711116':{d:'Magnet Shaft, Ares',w:0.006,b:'C1-02'},'711117':{d:'Magnet, Ares',w:0.00038,b:'C1-02'},'081-9801':{d:'Flat Tie Wrap Holder, 4.582 Long, Ø',w:0.01022,b:'C1-02'},'711104':{d:'Shaft Holder -L, Ares',w:0.01652,b:'C1-03'},'711105':{d:'Shaft Holder -R, Ares',w:0.01654,b:'C1-03'},'711214':{d:'Ribbon Cable, 10Pos, 22\"',w:0.01374,b:'C1-03'},'712621':{d:'Magnet Shaft, DP5.5',w:0.00614,b:'C1-03'},'711192':{d:'Anti Rotation Pin Lock, Ares',w:0.00178,b:'C1-03'},'711133':{d:'Unthreaded Spacer, Ares',w:0.00066,b:'C1-04'},'711134':{d:'Flat Head Spacer, Ares',w:0.00036,b:'C1-04'},'712623':{d:'MAGNET, Φ2.5',w:0.00033,b:'C1-04'},'711119':{d:'Coil Spring, Ø6-10L, Ares',w:0.00034,b:'C1-04'},'711136':{d:'Door Cam, Ares',w:0.0095,b:'C1-05'},'KB0801':{d:'Fork Block ASM, Ares',w:0.013,b:'C1-05'},'711143':{d:'Pin Support Tray, Ares',w:0.0032,b:'C1-05'},'KB0800':{d:'Glide Pin ASM, Ares',w:0.000376,b:'C1-05'},'711194':{d:'Tri-Spring, E-Tube, Ares',w:0.00013,b:'C1-05'},'711191':{d:'Gasket Filter, .5\"Dia X .375\"Dia ',w:0.0001,b:'C1-05'},'711193':{d:'Spring Plunger, Light, Ares',w:0.0039,b:'C1-06'},'711123':{d:'Mount Motor Tray, Ares',w:0.0353,b:'C1-06'},'711198':{d:'Pivot Hinge, Door, Ares',w:0.0035,b:'C1-06'},'711196':{d:'Bracket, Sensor Door, Ares',w:0.0197,b:'C1-06'},'114-9804':{d:'Music Wire, 0.024\"Dia, 304SS',w:0.0007,b:'C1-06'},'711113':{d:'Tapper Bar Cartridge, Ares',w:0.007,b:'C1-07'},'711120':{d:'Mount Sensor, Ares',w:0.01233,b:'C1-07'},'711144':{d:'Unsealed Opto Sensor Assy 12.6\"',w:0.00497,b:'C1-07'},'711138':{d:'Shaft, 270L SS, SSFJ-10-270',w:0.16293,b:'C1-07'},'711121':{d:'Bracket Angle Drive, Ares',w:0.01905,b:'C1-08'},'711157':{d:'Switch Opto Sensor Assy, 9.4\"',w:0.00428,b:'C1-08'},'021-0608':{d:'Cable - Flex 1mm Pitch, 8\"',w:0.00094,b:'C1-08'},'711275':{d:'Foot, FBFS33-8-10',w:0.03115,b:'C1-09'},'716652':{d:'Foot, M8x12',w:0.039188,b:'C1-09'},'713730':{d:'Power Input Cable,RSC',w:0.0084,b:'C1-09'},'091-0190':{d:'Lamp, Germicidal, UV G4T5, 254NM, 4',w:0.0132,b:'C1-10'},'021-9804':{d:'Cable 24V Assy, 8\", Ares',w:0.01094,b:'C1-10'},'711195':{d:'Spring Door Hinge, Ares',w:0.00274,b:'C1-11'},'712021':{d:'Support Hinge, Door',w:0.03556,b:'C1-12'},'711141':{d:'Spring-Cartridge Tray, Ares',w:0.01019,b:'C1-12'},'711135':{d:'Ball-Nose Spring Plungers Ø0.25\"',w:0.00192,b:'C1-12'},'021-1006':{d:'Cable-USB Hub, 10Pos, 6\"',w:0.00565,b:'C1-12'},'201-9802':{d:'Linear Bushing 10mm, LMKW10G',w:0.0435,b:'C1-13'},'711203':{d:'Clamp Bearing, Ares',w:0.033,b:'C1-13'},'711957':{d:'Support, Horizontal Motor',w:0.003315,b:'C1-13'},'716430':{d:'Fixture, Calibration',w:0.94054,b:'C1-14'},'KB0673':{d:'Ferrite Core ZCAT 2035-0930',w:0.02068,b:'C1-14'},'710326':{d:'Home Sensor(L180) Photo Sensor, 5VD',w:0.003394,b:'C2-01'},'710322':{d:'T/Belt 540-3GT-9',w:0.011887,b:'C2-01'},'710340':{d:'BLDC Motor Tensioner AL6061-T6 / An',w:0.006787,b:'C2-02'},'710341':{d:'Sensing Bar AL6061-T6 / Anodizing(W',w:0.000505,b:'C2-02'},'710353':{d:'Bearing cover',w:0.022935,b:'C2-03'},'710342':{d:'Sensing Cam AL6061-T6 / Anodizing(W',w:0.002,b:'C2-03'},'710349':{d:'LED Bracket ACETAL / White',w:0.005616,b:'C2-03'},'710356':{d:'Stepper Motor Housing AL5052P',w:0.01862,b:'C2-04'},'710354':{d:'BLDC Home Sensor Bracket AL5052P / ',w:0.00667,b:'C2-04'},'710355':{d:'Magnet Cam Bracket AL5052P / No Spr',w:0.00359,b:'C2-04'},'710368':{d:'T/Pulley P28-3GT-12-33F',w:0.02041,b:'C2-05'},'710363':{d:'Power connector Mount AL5052P / No ',w:0.00381,b:'C2-05'},'710369':{d:'T/Belt B114-S3M-5',w:0.00105,b:'C2-05'},'710396':{d:'Board InterConnect Cable \"Ribbon C',w:0.01995,b:'C2-06'},'710393':{d:'D_Sub-9 female 9P Serial Connector,',w:0.008595,b:'C2-06'},'710398':{d:'FAN Right \"DC 24V, 0.07A, 5000RPM,',w:0.018157,b:'C2-07'},'710399':{d:'FAN Left \"DC 24V, 0.07A, 5000RPM, ',w:0.017378,b:'C2-07'},'710397':{d:'LED Board to M.Board Cable \"Ribbon',w:0.006794,b:'C2-07'},'710402':{d:'Temperature Sensor ASSY \"Temperatu',w:0.001942,b:'C2-08'},'710400':{d:'Heater Board to M.Board Cable \"Wir',w:0.02326,b:'C2-08'},'710401':{d:'Sensor Board to M.Board Cable \"Wir',w:0.008534,b:'C2-08'},'710405':{d:'Fuse Drawer (4301.1403) 2-Pole, 110',w:0.00371,b:'C2-09'},'710404':{d:'FG Cable to Power Entry Wire : AWG2',w:0.00232,b:'C2-09'},'710406':{d:'Fuse (0216008.HXP) 250V, 8A',w:0.001035,b:'C2-09'},'710412':{d:'Leaf Spring SUS304/T=0.5',w:0.004477,b:'C2-10'},'710357':{d:'Square Washers SUS304',w:0.001349,b:'C2-10'},'710413':{d:'Foot PR1-3',w:0.001065,b:'C2-10'},'710439':{d:'Spanner 13mm(M8 Nut)',w:0.088432,b:'C2-11'},'710358':{d:'Fan Mount Bracket AL5052P / No Spra',w:0.00534,b:'C2-11'},'710438':{d:'Allen Key 6mm',w:0.0285,b:'C2-11'},'713683':{d:'Window Protect Tape, Ares',w:0.0075,b:'C2-11'},'KB0382':{d:'T/Pulley P 10-S30-500-C',w:0.002133,b:'C2-12'},'KB0381':{d:'T/Pulley P 20-S30-500-BF',w:0.006918,b:'C2-12'},'KB0379':{d:'T/Belt S3M-273-5',w:0.002462,b:'C2-12'},'KB0436':{d:'Home Sensor (L570)',w:0.00682,b:'C2-13'},'KB0402':{d:'Bearing 696 ZZ',w:0.003698,b:'C2-13'},'9FB134':{d:'HSM 3.0 Instrument Quick Protocol C',w:0.004772,b:'C2-14'},'017785':{d:'Box, Maxwell® Accessory Pack',w:0.04564,b:'C2-15'},'710317':{d:'BLDC Motor 24V/3.6A Max RPM : 4500',w:0.58833,b:'C2-17'},'710316':{d:'Stepper Motor 24V/1A, Angle : 1.8 d',w:0.145,b:'C2-18'},'KB0446':{d:'UV Bulb Box 40*30*152 ,SC350g',w:0.01584,b:'C2-22'},'713682':{d:'Window Protect Tape, MX48',w:0.010366,b:'C2-23'},'712581':{d:'BAR, BELT GRIPPER, MX48',w:0.003855,b:'C3-01'},'712583':{d:'BASE, BEARING TENSIONER, MX48',w:0.02327,b:'C3-01'},'712580':{d:'BAR, BELT GRIPPER COVER, MX48',w:0.00314,b:'C3-01'},'712600':{d:'HEAT BLOCK, SPACER, MX48',w:0.000648,b:'C3-01'},'712587':{d:'BASE, PULLY HOUSING, MX48',w:0.0367,b:'C3-02'},'712586':{d:'BASE, MOUNT MOTOR TRAY, MX48',w:0.03676,b:'C3-02'},'712636':{d:'Pulley, Deck Motor, MX48',w:0.004877,b:'C3-02'},'712612':{d:'VERTICAL, BEARING HOUSING, MX48',w:0.00808,b:'C3-03'},'712584':{d:'BASE, BELT GRIPPER DOWN, MX48',w:0.005764,b:'C3-03'},'712585':{d:'BASE, BELT GRIPPER UP, MX48',w:0.030707,b:'C3-03'},'KB0802':{d:'Pulley, Vertical Bearing ASM, MX48',w:0.00491,b:'C3-03'},'712634':{d:'BELT, DECK, MX48',w:0.015,b:'C3-03'},'712635':{d:'Pulley, Deck Bearing, MX48',w:0.00276,b:'C3-04'},'712633':{d:'BELT, VERTICAL, MX48',w:0.00455,b:'C3-04'},'712632':{d:'BELT, MAGNET, MX48',w:0.00426,b:'C3-04'},'712640':{d:'Pulley, Vertical Motor, MX48',w:0.00961,b:'C3-05'},'712639':{d:'Pulley-B, Vertical shaft, MX48',w:0.00493,b:'C3-05'},'714027':{d:'Urethane Washers',w:0.00242,b:'C3-05'},'712631':{d:'BELT, PLUNGER, MX48',w:0.00281,b:'C3-05'},'712821':{d:'Cable-Encoder, MX-48',w:0.00427,b:'C3-06'},'712701':{d:'Cable-ST.Motor, MX-48',w:0.00637,b:'C3-07'},'712668':{d:'Spring, Cartridge Tray, MX48',w:0.01606,b:'C3-08'},'712595':{d:'Guide E-Tube Tray, MX48',w:0.023517,b:'C3-08'},'712682':{d:'Cable-Heater, MX-48',w:0.028277,b:'C3-09'},'712669':{d:'Spring, Plunger, MX48',w:0.006018,b:'C3-09'},'712686':{d:'Cable-LED Indicator, MX-48',w:0.029516,b:'C3-09'},'712667':{d:'Music Wire, Dia. 0.6mm',w:0.000816,b:'C3-09'},'712697':{d:'Switch-Power, Push Button',w:0.024704,b:'C3-10'},'712687':{d:'Cable-USB Terminal, MX-48',w:0.019825,b:'C3-10'},'712681':{d:'Sensor-Door, MX-48',w:0.007503,b:'C3-11'},'712680':{d:'Sensor-M.Home, MX-48',w:0.005289,b:'C3-11'},'712649':{d:'Locating Pins, Tray, MX48',w:0.000411,b:'C3-11'},'712055':{d:'Rod Plastic, 1/8\"Dia',w:0.0041,b:'C3-11'},'712689':{d:'Cable-FFC 10\"',w:0.00076,b:'C3-12'},'712683':{d:'Cable-24VDC, MX-48',w:0.009736,b:'C3-13'},'714406':{d:'Cable-Power Signal, LPS365-M',w:0.003027,b:'C3-13'},'712691':{d:'UV Lamp, TUV 6W FAM',w:0.0185,b:'C3-14'},'715047':{d:'UV Lamp socket, SK-F-1220',w:0.005544,b:'C3-14'},'712934':{d:'Vision Camera Bracket, MX48',w:0.025477,b:'C3-15'},'712933':{d:'Vision Camera Spacer, MX48',w:0.026843,b:'C3-15'},'715714':{d:'Top grip, New Tablet, MX48',w:0.006274,b:'C3-16'},'716151':{d:'PowerInputHarness_MX48',w:0.0844,b:'C3-16'},'714063':{d:'Mount, Tablet, SM',w:0.003554,b:'C3-16'},'713412':{d:'Door Hinge Spring, MX48',w:0.004278,b:'C3-16'},'712949':{d:'Flat Torque Hinge',w:0.12217,b:'C3-17'},'712930':{d:'Shaft-One End Threaded One End Tapp',w:0.0163,b:'C3-17'},'715851':{d:'Cable, USB B-C for SP9',w:0.054,b:'C3-18'},'712935':{d:'Door, PIvot Hinge Base, MX48',w:0.00532,b:'C3-18'},'714157':{d:'Vertical, Motor Tensioner, MX48_CSC',w:0.007663,b:'C3-19'},'714167':{d:'Vertical Bearing Cover, MX48_CSC',w:0.008766,b:'C3-19'},'714820':{d:'MV30 Lens cover_V430-AF10',w:0.00327,b:'C3-20'},'716150':{d:'PowerEntryModule_nonshield',w:0.07056,b:'C3-20'},'714995':{d:'USB ethernet adapter_UE306',w:0.02568,b:'C3-20'},'713790':{d:'Tablet Power Cord, Korea, 2.5A/250V',w:0.07446,b:'C3-20'},'714682':{d:'M/V Camera Rolling block',w:0.02551,b:'C3-21'},'714686':{d:'M/V Camera Rotation block',w:0.008877,b:'C3-21'},'714681':{d:'M/V Camera Bracket',w:0.07811,b:'C3-22'},'714087':{d:'USB2.0 A/M To Mini B/M Angle Cable',w:0.028824,b:'C3-22'},'714981':{d:'Socket Head Knurled Knobs M4-11.6',w:0.011702,b:'C3-22'},'712685':{d:'Cable-MV.Light, MX-48',w:0.009806,b:'C3-22'},'714646':{d:'Lens_TBL 2.5 5MP',w:0.011887,b:'C3-24'},'714647':{d:'Lens holder_TLH CS-F',w:0.006254,b:'C3-24'},'714645':{d:'Vision Camera_DMK42AUC03',w:0.05562,b:'C3-25'},'715299':{d:'Windows 10 Enterprise IoT LTSC 2021',w:0.0005,b:'D2'},'713655':{d:'TOUCH STYLUS',w:0.004,b:'D2'},'716551':{d:'TOUCH STYLUS',w:0.01528,b:'D2'},'712937':{d:'Hinge Shaft, Door, MX48',w:0.01992,b:'D2'},'713646':{d:'Base, Screw for bearing, MX48',w:0.0035,b:'D2'},'714683':{d:'M/V Camera Stepper screw',w:0.003158,b:'D2'},'72320':{d:'Label, Shipper, Foil, Maxwell CSC 4',w:0.0005,b:'D2'},'KB0125':{d:'Knob Screw [NKOS4-16]',w:0.00864,b:'D2'},'71141':{d:'Label, Fuse, 250V 8AT',w:0.0001,b:'D2'},'713413':{d:'Door Hinge Pipes, MX48',w:0.0015,b:'D2'},'712648':{d:'KNOB SCREW, MX48',w:0.00349,b:'D2'},'71790':{d:'Label, Foil, Maxwell RSC48',w:0.0035,b:'D2'},'050-9809':{d:'LABEL - FOIL, MAXWELL CSC SP5051',w:0.0005,b:'D2'},'71300':{d:'Label, foil, Maxwell RSC Instr Box',w:0.004,b:'D2'},'710329':{d:'Set Screw M4×6 / SBPPS4-6',w:0.0005,b:'D2'},'71654':{d:'Label, foil, Maxwell® Instr Box, FS',w:0.0005,b:'D2'},'017682':{d:'Safety Label, Crush French/Eng',w:0.0001,b:'D2'},'019-9803':{d:'Pin, Clevis 3/16\" X 3\" With E-Rin',w:0.01117,b:'D2'},'710437':{d:'Allen Key 2.5mm',w:0.005137,b:'D2'},'710372':{d:'Wahsers FWS-D20-V6.0-T1.5',w:0.0005,b:'D2'},'050-9811':{d:'Label, Cord Wrap, Ares',w:0.004,b:'D2'},'712641':{d:'BEARING, B684ZZ',w:0.001014,b:'D2'},'710427':{d:'Hex Flange Bolt M8X30',w:0.017,b:'D2'},'713942':{d:'Bearing 625DDU',w:0.004627,b:'D2'},'017916':{d:'Label, Two person Lift, Maxwell Ins',w:0.0001,b:'D2'},'018141':{d:'Labels-UV Size D-0.69 Base X 0.60\"',w:0.00018,b:'D2'},'710373':{d:'Low head Bolt CBSTS6-12',w:0.0005,b:'D2'},'714400':{d:'Screw, M6×10mm, SOC Cap (Plastic)',w:0.000955,b:'D2'},'018140':{d:'Labels-UV Do Not Handle ISO (Size D',w:0.0001,b:'D2'},'71385':{d:'Medallion, Maxwell Instr, IVD',w:6e-05,b:'D2'},'712598':{d:'Heat Block, Washer, MX48',w:0.000118,b:'D2'},'712772':{d:'Cable Clip',w:0.002303,b:'D2'},'037-0055':{d:'Fuse, 2.5A/5×20 Glass, UL/CSA/VDE',w:0.000837,b:'D2'},'KB0408':{d:'Washer SSWA9-2.0',w:0.0005,b:'D2'},'712695':{d:'Fuse, MX-48',w:0.000849,b:'D2'},'713645':{d:'Vertical, Screw for bearing, MX48',w:0.0018,b:'D2'},'017677':{d:'Safety Label, Exclamation Point',w:0.00018,b:'D2'},'017681':{d:'Safety Label, Hand Crush',w:0.00018,b:'D2'},'711139':{d:'Cable Clamp, Ø5, Nylon',w:0.0015,b:'D2'},'017899':{d:'Safety Label, Biohazard, 0.69\" Bas',w:0.00018,b:'D2'},'017680':{d:'Safety Label, Hot Surface',w:0.00018,b:'D2'},'017678':{d:'Safety Label, Lightning Bolt',w:0.00018,b:'D2'},'018263':{d:'Label, Safety, Magnet, Size D-0.69x',w:0.0001,b:'D2'},'018264':{d:'Label, Safety, Pacemaker Size D-0.7',w:0.0001,b:'D2'},'714684':{d:'M/V Camera Bushing',w:0.000165,b:'D2'},'073-9800':{d:'O-Ring, Silicone(S469-40)',w:2e-05,b:'D2'},'017679':{d:'Safety Label, Grounding',w:0.00018,b:'D2'},'099-9303':{d:'Tubing, Fep 1/16\"OD X 0.03\" ID',w:0.0015,b:'D2'},'081-0802':{d:'Saddle Clamp, #4 Mount 931x Platfor',w:0.000219,b:'D2'},'712646':{d:'Bushing, Deck Bearing, MX48',w:0.000356,b:'D2'},'710374':{d:'Wahsers WSJJ10-4-3',w:0.0005,b:'D2'},'713242':{d:'Shipping Knob screw, MX48',w:0.013,b:'D2'},'KB0511':{d:'Socket Button Head Cap Screw [M4x4L',w:0.0005,b:'D2'},'712653':{d:'Screw, M4×25mm, LOW SOC HD',w:0.00279,b:'D2'},'074-9802':{d:'Nut, Hex 3/8-32×3/32',w:0.0005,b:'D2'},'710421':{d:'Flat Head Wrench Bolt SCM435(B) / M',w:0.0005,b:'D2'},'129-9800':{d:'Wire Saddle, Nylon 6/6, UL94 V-2',w:0.000678,b:'D2'},'KB0177':{d:'Socket Button Head Cap Screw [M4x8L',w:0.0005,b:'D2'},'711204':{d:'Screw, M4×10mm, LOW SOC HD',w:0.001185,b:'D2'},'714930':{d:'Cable clip flat c-type',w:0.002897,b:'D2'},'710390':{d:'Flat Head Wrench Bolt SUS, M5×8',w:0.0015,b:'D2'},'711251':{d:'Compound - Loctite 638',w:5e-05,b:'D2'},'710370':{d:'Wire Band KR5G5-100P',w:0.0005,b:'D2'},'078-9800':{d:'Flange, #10 × 0.75\", Nylon, Ares',w:6e-05,b:'D2'},'712947':{d:'Washer, 6mm ID',w:0.004,b:'D2'},'082-0306':{d:'Tape, .045\"THK X .75\", BLK FOAM, ',w:0.002,b:'D2'},'075-9822':{d:'Screw, M4×12mm, FLT HDSS(SOC)',w:0.001135,b:'D2'},'KB0391':{d:'Flat Head Wrench Bolt SUS, M4×6',w:0.001,b:'D2'},'710388':{d:'Flat Head Wrench Bolt SUS, M4×20',w:0.0017,b:'D2'},'713722':{d:'3M DUAL LOCK Fasteners',w:0.0025,b:'D2'},'KB0145':{d:'Nut [?4]',w:0.0005,b:'D2'},'KB0133':{d:'Tooth Washer',w:2e-05,b:'D2'},'712661':{d:'Screw-with S_W, M5×15mm, SOC Cap SS',w:0.00378,b:'D2'},'72410':{d:'For Lithium Ion Battery label_UN348',w:0.0025,b:'D2'},'079-0800':{d:'Washer, #8, Internal Tooth SS',w:0.000105,b:'D2'},'079-9803':{d:'Washer Fiber,0.5\"Od×0.375\"Id×0.03',w:6e-05,b:'D2'},'KB0146':{d:'Support [#4*5L]',w:0.0005,b:'D2'},'713125':{d:'Screw flange, M3×10mm, BTN HD BLK(S',w:0.00065,b:'D2'},'075-9808':{d:'Screw, M3×8mm,BTN HD SS(SOC)',w:0.000515,b:'D2'},'KB0485':{d:'Wrench Bolt M3*10L,SUS',w:0.00075,b:'D2'},'710383':{d:'Wrench Bolt SUS / M5×20',w:0.004,b:'D2'},'712660':{d:'Screw-with S_W, M4×12mm, SOC Cap SS',w:0.001969,b:'D2'},'712659':{d:'Screw-with S_W, M4×10mm, SOC Cap SS',w:0.001803,b:'D2'},'714444':{d:'Screw, M5×15mm, FLT HD SS(SOC)',w:0.0023,b:'D2'},'710379':{d:'Wrench Bolt SUS / M2.5×4',w:0.0005,b:'D2'},'710380':{d:'Wrench Bolt SUS / M2.5×8',w:0.0005,b:'D2'},'712655':{d:'Screw-with S_W, M4×8mm, SOC Cap SS(',w:0.001672,b:'D2'},'711673':{d:'Flat Head Wrench Bolt SUS, M5×10',w:0.0018,b:'D2'},'714904':{d:'Tablet Charging Label',w:0.0015,b:'D2'},'075-9805':{d:'Screw, M2.5×6mm, FLT HDSS (PHIL)',w:0.0003,b:'D2'},'075-9825':{d:'Screw, M2.5×10mm, FLT HDSS (PHIL)',w:0.0002,b:'D2'},'713047':{d:'Screw-with S_W, M3×12mm, SOC Cap SS',w:0.0003,b:'D2'},'710381':{d:'Wrench Bolt SUS / M4×10',w:0.001679,b:'D2'},'711106':{d:'Screw, M4×12mm, SOC Cap SS(SOC)',w:0.001727,b:'D2'},'711137':{d:'Screw, M3×25mm, SOC Cap SS(SOC)',w:0.0014,b:'D2'},'712658':{d:'Screw-with S_W, M3×8mm, SOC Cap SS(',w:0.000815,b:'D2'},'713046':{d:'Screw-with S_W, M3×10mm, SOC Cap SS',w:0.000896,b:'D2'},'712657':{d:'Screw-with S_W, M3×6mm, SOC Cap SS(',w:0.000762,b:'D2'},'710382':{d:'Wrench Bolt SUS / M4×15',w:0.002,b:'D2'},'714028':{d:'Screw, M4×6mm, SOC Cap SS(SOC)',w:0.0015,b:'D2'},'712662':{d:'Set screw, M4*3L',w:0.000134,b:'D2'},'KB0064':{d:'Wrench Bolt [M3*12L,SUS]',w:0.001,b:'D2'},'KB0140':{d:'Set screw [M4*4L]',w:0.00015,b:'D2'},'075-9815':{d:'Screw, M3×8mm, SOC CAP SS(SOC)',w:0.0002,b:'D2'},'KB0390':{d:'Flat Head Wrench Bolt SUS, M4×10',w:0.0015,b:'D2'},'714354':{d:'Self tapping screw, M3 x 10mm',w:0.000446,b:'D2'},'715024':{d:'Set screw (flat type), M4x5',w:0.000275,b:'D2'},'075-9821':{d:'Screw, M3×6mm, SOC CAP SS(SOC)',w:0.00069,b:'D2'},'KB0392':{d:'Socket Button Head Cap Screw [M3x6L',w:0.00015,b:'D2'},'710389':{d:'Flat Head Wrench Bolt SUS, M4×8',w:0.000844,b:'D2'},'711125':{d:'Tie Wrap(Zip Ties), 2.5 X 100mm, NA',w:0.00029,b:'D2'},'710386':{d:'Flat Head Wrench Bolt SUS, M3×15',w:0.00075,b:'D2'},'KB0677':{d:'Wrench Bolt SUS,M3x6',w:0.0005,b:'D2'},'710378':{d:'Spring Washers M6',w:0.0005,b:'D2'},'710385':{d:'Flat Head Wrench Bolt SUS, M3×10',w:0.00052,b:'D2'},'711668':{d:'Flat Head Wrench Bolt SUS, M3×8',w:0.000575,b:'D2'},'KB0438':{d:'Socket button Head Cap Screw, BHSS,',w:0.000434,b:'D2'},'712654':{d:'Screw, M3×5mm, FLT HD SS (SOC)',w:0.000326,b:'D2'},'KB0389':{d:'Flat Head Wrench Bolt SUS, M3×6',w:0.00014,b:'D2'},'714379':{d:'Seal label',w:0.0001,b:'D2'},'710391':{d:'Spring Washers SUS/M5',w:0.0005,b:'D2'},'716153':{d:'PowerEntryModule_Tape',w:0.00355,b:'D2'},'KB0132':{d:'Washer [M4]',w:0.000253,b:'D2'},'710530':{d:'Nut M4',w:0.0005,b:'D2'},'711118':{d:'Retainer Ring, E-Type-Ø3',w:2e-05,b:'D2'},'712948':{d:'Flat Washers, M3',w:0.0005,b:'D2'},'KB0183':{d:'WASHER [M3 ,Plastic]',w:0.0005,b:'D2'},'710377':{d:'Spring Washers M4',w:0.000205,b:'D2'},'800-0430':{d:'Compound - Heat Transfer, Silicone',w:0.00015,b:'D2'},'9BR264':{d:'Maxwell® RSC Set Up Guide (Brochure',w:0.0185,b:'D2'},'9BR283':{d:'Maxwell® FSC Set Up Guide',w:0.01484,b:'D2'},'9BR300':{d:'Maxwell® RSC 48 Instrument Setup Gu',w:0.0185,b:'D2'},'9BR320':{d:'Maxwell CSC 48 Quick Setup Guide',w:0.01846,b:'D2'},'9FB168':{d:'Maxwell® RSC Quick Start Guide',w:0.0185,b:'D2'},'9FB179':{d:'Maxwell® CSC 1.1 Quick Start Guide',w:0.01838,b:'D2'},'9FB194':{d:'Maxwell® FSC Quick Start Guide',w:0.01853,b:'D2'},'9FB216':{d:'Maxwell® RSC 48 Inst Quick Start Gu',w:0.0185,b:'D2'},'9FB231':{d:'Maxwell CSC 48 Quick Start Guide',w:0.01811,b:'D2'},'9FB233':{d:'Maxwell Elution Tube Quick Start Gu',w:0.00919,b:'D2'},'9GE817':{d:'Maxwell RSC 48 SM Package Insert',w:0.002,b:'D2'},'9LT308':{d:'Maxwell® 16 CSC Thank You Letter',w:0.01816,b:'D2'},'9LT311':{d:'Maxwell® RSC Welcome Letter',w:0.0075,b:'D2'},'9LT312':{d:'Maxwell CSC 48 Welcome/Thank you Le',w:0.0064,b:'D2'},'9LT313':{d:'Maxwell® FSC Welcome Letter',w:0.00754,b:'D2'},'9LT314':{d:'Maxwell® RSC 48: Welcome/Thank You ',w:0.008,b:'D2'},'715298':{d:'SURFACE PRO 9',w:1.128,b:'E'},'716655':{d:'SURFACE PRO 13 INCH, ARM CPU',w:1.1,b:'E'},'E6150':{d:'Quantus™ Fluorometer',w:0.44834,b:'E'},'713780':{d:'GD4590 Barcode Scanner',w:0.2859,b:'E'},'712582':{d:'BASE, BASE PLATE, MX48',w:4.4,b:'E'},'711473':{d:'Main Cover, White, CSC 1.1',w:1.77937,b:'E'},'711100':{d:'Main Cover, Metalic Silver, RSC',w:1.72974,b:'E'},'714140':{d:'Top, Main Enclosure, MX48_CSC',w:1.86193,b:'E'},'714141':{d:'Door, Enclosure, MX48_CSC',w:0.59642,b:'E'},'712941':{d:'Top, Main Enclosure, MX48',w:1.84924,b:'E'},'712939':{d:'Door, Enclosure, MX48',w:0.56994,b:'E'},'711474':{d:'Door White, CSC 1.1',w:0.32077,b:'E'},'711140':{d:'Door Metalic Silver, Ares',w:0.32089,b:'E'},'712942':{d:'Right, Main Enclosure, MX48',w:0.79719,b:'E'},'714158':{d:'Right, Main enclosure, MX48_CSC',w:0.79483,b:'E'},'712943':{d:'Left, Main Enclosure, MX48',w:0.82525,b:'E'},'714159':{d:'Left, Main enclosure, MX48_CSC',w:0.82945,b:'E'},'712290':{d:'Door Metalic Silver, FSC',w:0.31146,b:'E'},'712959':{d:'Just-Mobile ST-858 Encore iPad Stan',w:0.21267,b:'E'},'713129':{d:'Foam, Base Frame, MX48',w:0.64354,b:'E'},'710423':{d:'HSM 3.0 BOX KLB/DW 4K , 615X490X510',w:3.5,b:'E'},'713123':{d:'Heater Cover Front, MX48',w:0.07538,b:'E'},'713124':{d:'Heater Cover Back, MX48',w:0.0751,b:'E'},'713140':{d:'Shipper top, MX48',w:4.25,b:'E'},'713131':{d:'Foam, Right Frame, MX48',w:0.38511,b:'E'},'713132':{d:'Foam, Left Frame, MX48',w:0.38895,b:'E'},'710424':{d:'Secondary_box KLB/DW 4K , 590X465X2',w:1.5,b:'E'},'710428':{d:'Primary Scored pad KLB/DW 4K , 1317',w:0.15331,b:'E'},'712945':{d:'Switch cover, MX48',w:0.05126,b:'E'},'710425':{d:'Primary box KLB.K.K / A , 450X320X2',w:0.45,b:'E'},'710431':{d:'Power Supply Box KLB.K.K / A , 590×',w:0.75,b:'E'},'710433':{d:'Power Spacer KLB.K.K / A , 617×450',w:0.17096,b:'E'},'710434':{d:'Rack Spacer KLB.K.K / A , 1144×230',w:0.15626,b:'E'},'712940':{d:'Window , Enclosure, MX48',w:0.1558,b:'E'},'710426':{d:'Wood Tray Core Plywood 24T',w:0.92594,b:'E'},'711638':{d:'Shipper Box, Ares',w:2.05,b:'E'},'710432':{d:'Accessory_Box G\'TYPE,  KLB/B 255×2',w:0.1315,b:'E'},'132-9800':{d:'Cover Heater, Ares',w:0.05421,b:'E'},'713138':{d:'BOX accessary, MX48',w:0.64544,b:'E'},'712932':{d:'Indicator Window, MX48',w:0.14024,b:'E'},'715171':{d:'Foam, Machine vision bottom, MX48',w:0.10531,b:'E'},'713141':{d:'Shipper Bottom, MX48',w:1.48699,b:'E'},'710429':{d:'Secondary_Foam_Lower 445×280×30+30+',w:0.12575,b:'E'},'059-9800':{d:'Window, Ares',w:0.14628,b:'E'},'715170':{d:'Foam, M_V _COVER,ASM',w:0.10156,b:'E'},'711145':{d:'Foam Die Cut, Lower, Ares',w:0.1578,b:'E'},'710430':{d:'Secondary_Foam_Upper 445×200×30+30+',w:0.08127,b:'E'},'71289':{d:'Accessory Box, Ares',w:0.62853,b:'E'},'71321':{d:'Foam Die Cut, Upper, Ares',w:0.14094,b:'E'},'713133':{d:'Foam, Rod & Deck, MX48',w:0.10151,b:'E'},'713135':{d:'Foam, Die cut A/B #1,MX48',w:0.071,b:'E'},'713137':{d:'Foam, Die cut A/B #3,MX48',w:0.059,b:'E'},'713130':{d:'Foam, Top, MX48',w:0.22385,b:'E'},'710435':{d:'Foam Power 210×160×30+30+20T',w:0.06663,b:'E'},'713139':{d:'Box Tray, MX48',w:0.107845,b:'E'},'711147':{d:'Foam Die Cut, A/B #2, Ares',w:0.0475,b:'E'},'713134':{d:'Foam, Inner top, MX48',w:0.03062,b:'E'},'713136':{d:'Foam, Die cut A/B #2,MX48',w:0.014,b:'E'},'71443':{d:'Foam Die Cut A/B #3, CSC',w:0.033,b:'E'},'71444':{d:'Foam Die Cut A/B #4, CSC',w:0.0265,b:'E'},'71445':{d:'Foam Die Cut A/B #5, CSC',w:0.0255,b:'E'},'711146':{d:'Foam Die Cut, A/B #1, Ares',w:0.033,b:'E'},'711151':{d:'Foam Die Cut, Deck, Ares',w:0.035,b:'E'},'710450':{d:'HSM 2.0 Rack Box Kraft paper-258X40',w:0.09259,b:'E'},'71290':{d:'Tray Box, Ares',w:0.08925,b:'E'},'711152':{d:'Foam Die Cut, Rod, Ares',w:0.02,b:'E'},'713220':{d:'Plastic Clips, HP601-W3',w:0.017765,b:'E'},'710451':{d:'HSM 2.0 Rack Stand Box Kraft paper-',w:0.13825,b:'E'},'713142':{d:'Poly Bags, 1000X1000mm, 0.1T',w:0.17118,b:'E'},'71286':{d:'Poly Bags, 700X700mm, 0.1T',w:0.07931,b:'E'},'71331':{d:'PE Foam lami Bag, 300X300mm, 1T',w:0.00656,b:'E'},'714352':{d:'Magnet bar 24 positions Bottom plat',w:0.04491,b:'E3'},'714350':{d:'Magnet bar 24 positions Top',w:0.08061,b:'E3'},'714378':{d:'Foam insert for 24 positions Top',w:0.01615,b:'E3'},'714356':{d:'Magnet bar 16 positions Bottom plat',w:0.03013,b:'E3'},'714355':{d:'Magnet bar 16 positions Top',w:0.05586,b:'E3'},'714373':{d:'Foam insert for 16 positions Top',w:0.01804,b:'E3'},'714377':{d:'Foam insert for 24 positions Bottom',w:0.01448,b:'E3'},'714372':{d:'Foam insert for 16 positions Bottom',w:0.02107,b:'E3'},'714375':{d:'24 position box top',w:0.04276,b:'E3'},'714370':{d:'16 position box top',w:0.03289,b:'E3'},'714376':{d:'24 position box bottom',w:0.04136,b:'E3'},'714371':{d:'16 position box bottom',w:0.03106,b:'E3'},'714351':{d:'Magnet 8-8',w:0.003,b:'E3'},'714353':{d:'Silicone rubber guide custom',w:0.003314,b:'E3'},'71142':{d:'Label, HSM 3.0 Power Supply',w:0.0001,b:'LABEL'},'71140':{d:'Label, HSM 3.0 Instrument',w:0.0001,b:'LABEL'},'017810':{d:'Outer Box Label, Maxwell® White',w:0.0001,b:'LABEL'},'050-0040':{d:'Instrument Label,3\"x2\",blank silv',w:6e-05,b:'LABEL'},'71242':{d:'Label, 1” x .25”, blank white',w:5e-05,b:'LABEL'},'71839':{d:'Label, 1.875\"x2.5\"-Yellow, non-ha',w:5e-05,b:'LABEL'},'71885':{d:'Label, 1.75\"x0.25\", white',w:5e-05,b:'LABEL'},'050-0029':{d:'Label, 3” x 3”, blank white',w:0.0001,b:'LABEL'}};// 초기 랙 설정 (최대하중 등 - 사용자가 수정 가능)
const DEFAULT_RACK_CONFIG={// Maxwell 48 시리즈
'A1':{maxBins:6,maxWeight:1200},// 중량 4개 × 300kg
'A2':{maxBins:5,maxWeight:1200},// 중량 4개 × 300kg
'B1':{maxBins:14,maxWeight:1800},// 경량 12개 × 150kg
'B3':{maxBins:6,maxWeight:1800},// 중량 4개 + 경량 4개
'C3':{maxBins:25,maxWeight:1200},// 경량 8개 × 150kg
// Maxwell 16 시리즈
'A5':{maxBins:6,maxWeight:600},// 중량 2개 × 300kg
'A6':{maxBins:6,maxWeight:600},// 중량 2개 × 300kg
'A7':{maxBins:2,maxWeight:600},// 중량 2개 × 300kg
'B2':{maxBins:18,maxWeight:600},// 경량 4개 × 150kg
'C1':{maxBins:14,maxWeight:600},// 경량 4개 × 150kg
// HSM 3.0
'A3':{maxBins:8,maxWeight:1200},// 중량 4개 × 300kg
'B4':{maxBins:17,maxWeight:600},// 경량 4개 × 150kg
'C2':{maxBins:25,maxWeight:600},// 경량 4개 × 150kg
// 기타 구역
'D2':{maxBins:1,maxWeight:1000},// 약 1톤
'E':{maxBins:1,maxWeight:99999},// 무제한
'E3':{maxBins:4,maxWeight:600},// 경량 4개 × 150kg
'Tablet':{maxBins:1,maxWeight:600},// 중량 2개 × 300kg
'Stand':{maxBins:1,maxWeight:600},// 중량 2개 × 300kg
'S1':{maxBins:4,maxWeight:1200},// 중량 4개 × 300kg
'F1':{maxBins:1,maxWeight:99999},// 팔레트, 무제한
'LABEL':{maxBins:1,maxWeight:99999}// 무제한
};// 모델 시리즈별 적정 재고 기준 (대수)
const TARGET_UNITS_BY_SERIES={'Maxwell 48':40,// 40대분
'Maxwell 16':40,// 40대분
'HSM 3.0':15,// 15대분
'Others':99999// 기타는 무제한
};// 랙별 모델 시리즈 매핑
const RACK_MODEL_SERIES={// Maxwell 16 시리즈 (RSC16, CSC16, FSC16) - 파란색
'A5':'Maxwell 16','A6':'Maxwell 16','A7':'Maxwell 16','B2':'Maxwell 16','C1':'Maxwell 16',// Maxwell 48 시리즈 (RSC48, CSC48) - 초록색  
'A1':'Maxwell 48','A2':'Maxwell 48','B1':'Maxwell 48','B3':'Maxwell 48','C3':'Maxwell 48',// HSM 3.0 - 주황색
'A3':'HSM 3.0','B4':'HSM 3.0','C2':'HSM 3.0'};// 2025~2027 한국 공휴일 (주말 제외, 대체공휴일 포함)
const KR_HOLIDAYS=new Set([// 2025
'2025-01-01','2025-01-28','2025-01-29','2025-01-30','2025-03-01','2025-05-05','2025-05-06','2025-06-06','2025-08-15','2025-10-03','2025-10-06','2025-10-07','2025-10-08','2025-10-09','2025-12-25',// 2026
'2026-01-01',// 신정
'2026-02-14','2026-02-15','2026-02-16','2026-02-17','2026-02-18',// 설연휴 (토~수, 대체공휴일 18수)
'2026-03-01','2026-03-02',// 삼일절(일) + 대체공휴일(월)
'2026-05-05',// 어린이날(화)
'2026-05-24','2026-05-25',// 석가탄신일(일) + 대체공휴일(월)
'2026-06-03',// 지방선거일(수)
'2026-06-06',// 현충일(토)
'2026-08-15','2026-08-17',// 광복절(토) + 대체공휴일(월)
'2026-09-24','2026-09-25','2026-09-26','2026-09-27',// 추석연휴 (목~일)
'2026-10-03','2026-10-05',// 개천절(토) + 대체공휴일(월)
'2026-10-09',// 한글날(금)
'2026-12-25',// 크리스마스(금)
// 2027
'2027-01-01','2027-02-02','2027-02-03','2027-02-04','2027-03-01','2027-05-05','2027-05-13','2027-06-06','2027-08-15','2027-10-03','2027-10-09','2027-12-25']);// 영업일 수 계산 (주말 + 공휴일 제외)
function getBusinessDays(startDate,endDate){const start=new Date(startDate);const end=new Date(endDate);if(isNaN(start)||isNaN(end)||end<=start)return 0;// 한국시간 기준 날짜 문자열 (YYYY-MM-DD)
function toKRDate(d){const kr=new Date(d.getTime()+9*60*60*1000);// UTC+9
return kr.toISOString().slice(0,10);}function getKRDay(d){const kr=new Date(d.getTime()+9*60*60*1000);return kr.getUTCDay();}// 시작일 ~ 완료일 사이 영업일 카운트
let count=0;const cur=new Date(start);cur.setDate(cur.getDate()+1);while(cur<=end){const day=getKRDay(cur);const dateStr=toKRDate(cur);if(day!==0&&day!==6&&!KR_HOLIDAYS.has(dateStr)){count++;}cur.setDate(cur.getDate()+1);}// 시작일이 영업일이면 시작일 남은 근무시간 비율 추가
const startDay=getKRDay(start);const startDateStr=toKRDate(start);if(startDay!==0&&startDay!==6&&!KR_HOLIDAYS.has(startDateStr)){const krHour=(start.getUTCHours()+9)%24;const hoursWorked=Math.max(0,17-krHour);// 17시(퇴근)까지 남은 시간
count+=Math.min(hoursWorked/8,1);}return Math.round(count*10)/10;}export default function PBKWarehouseSystem(){const[activeTab,setActiveTab]=useState('dashboard');const[searchTerm,setSearchTerm]=useState('');const[selectedZone,setSelectedZone]=useState('all');// 모바일 메뉴
const[showMobileMenu,setShowMobileMenu]=useState(false);// 재고 목록 정렬 - safeStorage에서 복원 (C2 개선)
const[inventorySortBy,setInventorySortBy]=useState(()=>{return safeStorage.getItem('pbk_filter_inventorySortBy')||'bin';});const[inventorySortOrder,setInventorySortOrder]=useState(()=>{return safeStorage.getItem('pbk_filter_inventorySortOrder')||'asc';});// 무게 정보 정렬 - safeStorage에서 복원
const[weightSortBy,setWeightSortBy]=useState(()=>{return safeStorage.getItem('pbk_filter_weightSortBy')||'bin';});const[weightSortOrder,setWeightSortOrder]=useState(()=>{return safeStorage.getItem('pbk_filter_weightSortOrder')||'asc';});// 이전 데이터 저장 (C1 대시보드 증감 표시용)
const[previousStats,setPreviousStats]=useState(()=>{const saved=safeStorage.getItem('pbk_previous_stats');return saved?JSON.parse(saved):null;});// TO DO 리스트
const[todoList,setTodoList]=useState(()=>{const saved=safeStorage.getItem('pbk_todo_list');return saved?JSON.parse(saved):[{id:1,text:'랙별 최대 하중량 데이터 입력',category:'data',priority:'high',completed:false,createdAt:'2026-02-01',dueDate:'2026-02-10'},{id:2,text:'MIGO 처리 시간 단축 방안 검토',category:'process',priority:'medium',completed:false,createdAt:'2026-02-01',dueDate:'2026-02-15'},{id:3,text:'Kitting Lead Time KPI 기준 수립',category:'kpi',priority:'high',completed:false,createdAt:'2026-02-01',dueDate:'2026-02-08'}];});const[newTodo,setNewTodo]=useState('');const[newTodoCategory,setNewTodoCategory]=useState('general');const[newTodoPriority,setNewTodoPriority]=useState('medium');const[newTodoDueDate,setNewTodoDueDate]=useState('');const[todoFilter,setTodoFilter]=useState('active');const[dueSoonTodos,setDueSoonTodos]=useState([]);const[showDueSoonAlert,setShowDueSoonAlert]=useState(true);const[notificationPermission,setNotificationPermission]=useState('default');const[fullBins,setFullBins]=useState([]);// Bin 100% 알림용
// 재고 데이터 (SAP 엑셀에서 로드)
const[inventoryData,setInventoryData]=useState([]);const[rackSummary,setRackSummary]=useState([]);const[lastUpdated,setLastUpdated]=useState(null);const[isLoading,setIsLoading]=useState(false);const[uploadError,setUploadError]=useState(null);// Open PO 데이터 (발주 진행 중인 자재)
const[openPOData,setOpenPOData]=useState(()=>{const saved=safeStorage.getItem('pbk_open_po');return saved?JSON.parse(saved):[];});const[openPOLastUpdated,setOpenPOLastUpdated]=useState(()=>{return safeStorage.getItem('pbk_open_po_updated')||null;});const[showOpenPOModal,setShowOpenPOModal]=useState(false);const[openPOError,setOpenPOError]=useState(null);// BOM 데이터 (사용자 업로드 가능)
const[customBomData,setCustomBomData]=useState(()=>{const saved=safeStorage.getItem('pbk_custom_bom');return saved?JSON.parse(saved):null;});// Sub-component BOM 데이터
const[subComponentBomData,setSubComponentBomData]=useState(()=>{const saved=safeStorage.getItem('pbk_subcom_bom');return saved?JSON.parse(saved):null;});const[bomLastUpdated,setBomLastUpdated]=useState(()=>{return safeStorage.getItem('pbk_bom_updated')||null;});// 통합 업로드 모달
const[showDataUploadModal,setShowDataUploadModal]=useState(false);// 랙 설정 - 항상 최신 DEFAULT_RACK_CONFIG 사용 (무게 기준 업데이트됨)
const[rackConfig,setRackConfig]=useState(()=>{// 기존 safeStorage 삭제하고 새 설정 적용
safeStorage.removeItem('pbk_rack_config');return DEFAULT_RACK_CONFIG;});// 무게 데이터 (수정 가능) - 항상 기본 515개 데이터로 시작
const[weightData,setWeightData]=useState(()=>{// safeStorage 데이터가 있어도 개수가 다르면 기본값 사용
const saved=safeStorage.getItem('pbk_weight_data');if(saved){const parsed=JSON.parse(saved);// 515개 미만이면 기본값으로 리셋
if(Object.keys(parsed).length<500){safeStorage.removeItem('pbk_weight_data');return DEFAULT_WEIGHT_DATA;}return parsed;}return DEFAULT_WEIGHT_DATA;});// 무게 편집 모달
const[showWeightModal,setShowWeightModal]=useState(false);const[editingWeight,setEditingWeight]=useState(null);const[newMaterial,setNewMaterial]=useState({material:'',desc:'',weight:'',bin:''});// Cycle Time 기록 (safeStorage에 저장)
const[pickCycles,setPickCycles]=useState(()=>{const saved=safeStorage.getItem('pbk_pick_cycles');if(saved){return JSON.parse(saved).map(p=>{if(p.materialNum&&SUBCOM_INFO[p.materialNum]&&p.model!=='Sub-com.')p.model='Sub-com.';if(p.status==='completed'&&p.completed){// NaN 포함된 경우 → startTime + cycleMin으로 재계산
if(String(p.completed).includes('NaN')){if(p.startTime&&p.cycleMin){try{const start=new Date(p.startTime);const end=new Date(start.getTime()+p.cycleMin*60000);p.completed=end.toLocaleString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',hour12:false}).replace(/\. /g,'-').replace('.','');}catch(e){p.completed='-';}}else{p.completed='-';}}}return p;});}return[{id:1,orderId:'PO-2026-001',model:'MX48',received:'2026-01-28 09:00',completed:'2026-01-28 09:45',cycleMin:45,status:'completed'},{id:2,orderId:'PO-2026-002',model:'RSC48',received:'2026-01-28 10:30',completed:'2026-01-28 11:00',cycleMin:30,status:'completed'}];});const[receiveCycles,setReceiveCycles]=useState(()=>{const saved=safeStorage.getItem('pbk_receive_cycles');return saved?JSON.parse(saved):[{id:1,poNo:'PUR-2026-001',vendor:'Metal Tech',delivery:'2026-01-27 10:00',migo:'2026-01-27 11:30',cycleMin:90,status:'completed'},{id:2,poNo:'PUR-2026-002',vendor:'PCB Korea',delivery:'2026-01-28 09:30',migo:'2026-01-28 10:15',cycleMin:45,status:'completed'}];});const[showPickModal,setShowPickModal]=useState(false);const[showReceiveModal,setShowReceiveModal]=useState(false);const[showUploadModal,setShowUploadModal]=useState(false);const[newPick,setNewPick]=useState({productionOrder:'',model:'RSC48',received:'',worker:'Z01',isUrgent:false});const[newReceive,setNewReceive]=useState({poNo:'',vendor:'',delivery:''});const[showVendorSuggestions,setShowVendorSuggestions]=useState(false);// 공간 분석 상태
const[spaceAnalysisModal,setSpaceAnalysisModal]=useState(null);const[spaceAnalysisSortBy,setSpaceAnalysisSortBy]=useState('urgency');// urgency, alphabet
const[binDetailModal,setBinDetailModal]=useState(null);// Bin 품목 상세 모달
const[binOverloadExpanded,setBinOverloadExpanded]=useState(false);// Bin별 과적 현황 토글
// 다중 선택 상태
const[selectedPicks,setSelectedPicks]=useState(new Set());const[selectedReceives,setSelectedReceives]=useState(new Set());// 수정 모달 상태
const[editingPick,setEditingPick]=useState(null);const[editingReceive,setEditingReceive]=useState(null);// 불출 정렬/필터 상태 - safeStorage에서 복원 (C2 개선)
const[pickSortBy,setPickSortBy]=useState(()=>{return safeStorage.getItem('pbk_filter_pickSortBy')||'productionOrder';});const[pickSortOrder,setPickSortOrder]=useState(()=>{return safeStorage.getItem('pbk_filter_pickSortOrder')||'asc';});const[pickFilterModel,setPickFilterModel]=useState(()=>{return safeStorage.getItem('pbk_filter_pickFilterModel')||'all';});const[pickFilterStatus,setPickFilterStatus]=useState(()=>{return safeStorage.getItem('pbk_filter_pickFilterStatus')||'all';});const[pickFilterWorker,setPickFilterWorker]=useState(()=>{return safeStorage.getItem('pbk_filter_pickFilterWorker')||'all';});const[pickFilterUrgent,setPickFilterUrgent]=useState(()=>{return safeStorage.getItem('pbk_filter_pickFilterUrgent')||'all';});const[pickSearchTerm,setPickSearchTerm]=useState('');const[pickFilterMonth,setPickFilterMonth]=useState(new Date().toISOString().slice(0,7));// YYYY-MM
// 입고 정렬/필터 상태 - safeStorage에서 복원
const[receiveSortBy,setReceiveSortBy]=useState(()=>{return safeStorage.getItem('pbk_filter_receiveSortBy')||'delivery';});const[receiveSortOrder,setReceiveSortOrder]=useState(()=>{return safeStorage.getItem('pbk_filter_receiveSortOrder')||'desc';});const[receiveFilterStatus,setReceiveFilterStatus]=useState(()=>{return safeStorage.getItem('pbk_filter_receiveFilterStatus')||'all';});const[receiveSearchTerm,setReceiveSearchTerm]=useState('');const[receiveFilterMonth,setReceiveFilterMonth]=useState(new Date().toISOString().slice(0,7));// YYYY-MM
// Kitting 현황 데이터
const[kittingData,setKittingData]=useState(()=>{const saved=safeStorage.getItem('pbk_kitting_data');if(saved){let needSave=false;const parsed=JSON.parse(saved).map(k=>{if(k.materialNum&&SUBCOM_INFO[k.materialNum]&&k.model!=='Sub-com.')k.model='Sub-com.';if(k.completedAt&&k.status==='completed'){try{if(/^\d{2}-\d{2} /.test(k.completedAt)){k.completedAt='2026-'+k.completedAt.split(' ')[0];}if(k.completedAt.includes('T')||k.completedAt.length>10){const d=new Date(k.completedAt);if(!isNaN(d.getTime())){k.completedAt=d.toLocaleDateString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit'}).replace(/\. /g,'-').replace('.','');}}}catch(e){}}// 완료된 항목의 leadTimeDays를 영업일 기준으로 재계산
if(k.status==='completed'&&k.startedAt){try{let startTime=new Date(k.startedAt);if(isNaN(startTime.getTime())&&typeof k.startedAt==='string'&&/^\d{2}-\d{2}/.test(k.startedAt)){startTime=new Date('2026-'+k.startedAt.replace(' ','T')+':00');}let endTime=null;if(k.completedAt){endTime=typeof k.completedAt==='string'&&k.completedAt.length<=10?new Date(k.completedAt+'T17:00:00+09:00'):new Date(k.completedAt);}else{endTime=new Date();}if(startTime&&endTime&&!isNaN(startTime.getTime())&&!isNaN(endTime.getTime())&&endTime>startTime){const newLT=getBusinessDays(startTime,endTime);if(Math.abs(newLT-(k.leadTimeDays||0))>0.05){k.leadTimeDays=newLT;needSave=true;}}}catch(e){console.error('LT recalc error:',k.productionOrder,e);}}return k;});// 재계산된 값을 즉시 safeStorage에 저장
if(needSave){try{safeStorage.setItem('pbk_kitting_data',JSON.stringify(parsed));}catch(e){}}return parsed;}return[];});const[showKittingModal,setShowKittingModal]=useState(false);const[newKitting,setNewKitting]=useState({productionOrder:'',model:'RSC48',basicStartDate:'',worker:'Z01',isUrgent:false});const[selectedKittings,setSelectedKittings]=useState(new Set());const[kittingFilterMonth,setKittingFilterMonth]=useState(new Date().toISOString().slice(0,7));const[kittingFilterModel,setKittingFilterModel]=useState('all');const[kittingFilterStatus,setKittingFilterStatus]=useState('all');const[kittingSearchTerm,setKittingSearchTerm]=useState('');const[kittingSortBy,setKittingSortBy]=useState('basicStartDate');const[kittingSortOrder,setKittingSortOrder]=useState('asc');const[editingKitting,setEditingKitting]=useState(null);const[showKittingGraphModal,setShowKittingGraphModal]=useState(false);const[showReceiveGraphModal,setShowReceiveGraphModal]=useState(false);// 대시보드 상세 보기 모달
const[showPickDetailModal,setShowPickDetailModal]=useState(false);const[showReceiveDetailModal,setShowReceiveDetailModal]=useState(false);const[showLeadTimeDetailModal,setShowLeadTimeDetailModal]=useState(false);// 랙 상세 보기 모달
const[selectedRackDetail,setSelectedRackDetail]=useState(null);// 창고 레이아웃 상태
const[selectedLayoutRack,setSelectedLayoutRack]=useState(null);// 랙 배치도 에디터 HTML (인라인 임베딩)
const LAYOUT_EDITOR_HTML=`<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PBK 창고 랙 배치도</title>
<style>
/* fonts loaded from parent */
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#0d1424;color:#e2e8f0;min-height:100vh;overflow:hidden}
.topbar{height:40px;background:#1e293b;border-bottom:1px solid #1e293b;display:flex;align-items:center;justify-content:space-between;padding:0 10px;z-index:200}
.topbar h1{font-size:13px;font-weight:700;color:#f1f5f9}
.tb-g{display:flex;align-items:center;gap:4px}
.tb{background:#1e293b;border:1px solid #334155;color:#94a3b8;font-size:10px;font-family:inherit;padding:4px 8px;border-radius:5px;cursor:pointer;transition:all .12s;white-space:nowrap}
.tb:hover{background:#263043;border-color:#475569;color:#e2e8f0}
.tb.act{background:#1e3a5f;border-color:#3b82f6;color:#60a5fa}
.tb.grn{background:#065f46;border-color:#059669;color:#6ee7b7}
.tb.red{background:#7f1d1d;border-color:#dc2626;color:#fca5a5}
.tb.blu{background:#1e3a5f;border-color:#3b82f6;color:#93c5fd}
.sep{width:1px;height:20px;background:#334155;margin:0 2px}
.zc{display:flex;align-items:center;gap:4px;font-size:10px;color:#94a3b8}
.zc input{width:55px;accent-color:#3b82f6}
.zv{font-weight:600;color:#60a5fa;min-width:26px;text-align:center;font-size:10px}
.modebar{height:34px;background:#1e293b;border-bottom:1px solid #1e293b;display:flex;align-items:center;padding:0 10px;gap:3px}
.mbtn{background:#1e293b;border:1px solid #334155;color:#94a3b8;font-size:11px;font-family:inherit;padding:4px 14px;border-radius:6px;cursor:pointer;transition:all .12s;display:flex;align-items:center;gap:5px}
.mbtn:hover{background:#263043;color:#e2e8f0}
.mbtn.active{font-weight:700}
.mbtn.active[data-m=move]{background:#064e3b;border-color:#10b981;color:#6ee7b7}
.mbtn.active[data-m=select]{background:#172554;border-color:#3b82f6;color:#93c5fd}
.mbtn.active[data-m=ruler]{background:#451a03;border-color:#d97706;color:#fcd34d}
.mbtn.active[data-m=text]{background:#2e1065;border-color:#7c3aed;color:#c4b5fd}
.mbtn .key{font-size:8px;background:rgba(255,255,255,.08);padding:1px 4px;border-radius:3px;color:rgba(255,255,255,.35)}
.mode-desc{margin-left:12px;font-size:10px;color:#475569;flex:1}
.lg{display:flex;gap:3px;font-size:9px;color:#64748b;align-items:center}
.lg-s{width:10px;height:7px;border-radius:1px;display:inline-block}
#CA{position:relative;width:100%;height:calc(100vh - 40px - 34px - 26px);overflow:auto;background:#111a2e}
#CA.m-move{cursor:grab}#CA.m-move.panning{cursor:grabbing}
#CA.m-select{cursor:default}#CA.m-ruler{cursor:crosshair}#CA.m-text{cursor:text}
#CV{position:relative;transform-origin:0 0}
.bld{position:absolute;border:2.5px solid rgba(255,255,255,.7);border-radius:3px;background:rgba(20,30,50,.2);z-index:1;pointer-events:none}
.blbl{position:absolute;font-size:9px;color:#4b5c73;font-weight:500;pointer-events:none;white-space:nowrap}
.defect{position:absolute;border:2.5px solid rgba(239,68,68,.6);background:rgba(239,68,68,.15);border-radius:4px;z-index:2;display:flex;align-items:center;justify-content:center;pointer-events:none}
.defect b{font-size:11px;font-weight:700;color:rgba(239,68,68,.8);text-shadow:0 0 10px rgba(239,68,68,.4)}
.prod{position:absolute;border:2px dashed rgba(255,255,255,.5);background:rgba(30,41,59,.25);border-radius:3px;z-index:1;display:flex;align-items:center;justify-content:center;pointer-events:none}
.prod span{font-size:11px;color:#475569;font-weight:600;letter-spacing:2px}
.zone{position:absolute;z-index:5;border-radius:4px;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:1px;user-select:none}
.m-select .zone{cursor:move}.m-move .zone{cursor:grab}.zone:hover{box-shadow:0 0 0 1px rgba(255,255,255,.2)}
.zn{font-size:11px;white-space:nowrap;font-weight:700;color:rgba(255,255,255,.6);pointer-events:none;text-align:center}
.zd{font-size:9px;color:rgba(255,255,255,.3);pointer-events:none}
.zone .rh{position:absolute;bottom:0;right:0;width:14px;height:14px;cursor:nwse-resize;z-index:10}
.zone .rh::after{content:'';position:absolute;bottom:2px;right:2px;width:6px;height:6px;border-right:2px solid rgba(255,255,255,.25);border-bottom:2px solid rgba(255,255,255,.25)}
.rk{position:absolute;z-index:15;border-radius:2px;display:flex;align-items:center;justify-content:center;font-weight:600;color:rgba(255,255,255,.9);text-shadow:0 1px 2px rgba(0,0,0,.4);white-space:nowrap;user-select:none}
.m-select .rk{cursor:pointer}.m-select .rk.sel{cursor:grab}
.m-move .rk{cursor:grab}.m-move .rk.dragging{cursor:grabbing}.rk:hover{z-index:60;box-shadow:0 0 0 1.5px rgba(255,255,255,.3)}
.rk.dragging{z-index:100;opacity:.85;box-shadow:0 0 0 2px #3b82f6,0 6px 20px rgba(0,0,0,.5)!important}
.rk.sel{box-shadow:0 0 0 2px #10b981,0 0 8px rgba(16,185,129,.25);z-index:55}
.rk .rot{position:absolute;top:-12px;right:-12px;width:24px;height:24px;background:#334155;border:1px solid #475569;border-radius:50%;cursor:pointer!important;display:none;align-items:center;justify-content:center;font-size:14px;color:#94a3b8;z-index:20;line-height:24px;text-align:center}
.rk:hover .rot{display:flex}.rk .rot:hover{background:#3b82f6;color:#fff}
.rk.mx48{background:rgba(220,38,38,.85);border:1.5px solid #fca5a5}
.rk.mx16{background:rgba(37,99,235,.85);border:1.5px solid #93c5fd}
.rk.hsm{background:rgba(217,119,6,.85);border:1.5px solid #fcd34d}
.rk.semi{background:rgba(234,179,8,.85);border:1.5px solid #fef08a}
.rk.spare{background:rgba(124,58,237,.85);border:1.5px solid #c4b5fd}
.rk.etc{background:rgba(100,116,139,.75);border:1.5px solid #94a3b8}
.selbox{position:absolute;border:1.5px solid rgba(59,130,246,.6);background:rgba(59,130,246,.08);z-index:90;pointer-events:none;border-radius:2px;display:none}
.rl-line{position:absolute;z-index:80;pointer-events:none;left:0;top:0}
.dl-svg{position:absolute;z-index:78;pointer-events:none;left:0;top:0}
.dl-handle{position:absolute;z-index:79;width:14px;height:14px;border-radius:50%;transform:translate(-7px,-7px);cursor:grab;transition:transform .15s;pointer-events:all}
.dl-handle:hover{transform:translate(-7px,-7px) scale(1.6)}
.dl-handle.dragging{cursor:grabbing;transform:translate(-7px,-7px) scale(1.4);box-shadow:0 0 0 3px rgba(255,255,255,.4)}
.dl-ep{position:absolute;z-index:80;width:10px;height:10px;border-radius:50%;transform:translate(-5px,-5px);cursor:grab;pointer-events:all;border:2px solid rgba(255,255,255,.6);background:rgba(255,255,255,.15);transition:transform .15s}
.dl-ep:hover{transform:translate(-5px,-5px) scale(1.5);background:rgba(255,255,255,.4)}
.dl-preview{position:absolute;z-index:83;pointer-events:none;left:0;top:0}
.area-sel{position:absolute;z-index:85;border:2px solid #22d3ee;background:rgba(34,211,238,.08);pointer-events:none;border-radius:2px}
.area-label{position:absolute;z-index:86;background:rgba(15,23,42,.92);border:1.5px solid #22d3ee;color:#22d3ee;font-size:11px;font-weight:700;padding:5px 10px;border-radius:6px;white-space:nowrap;pointer-events:all;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.5);font-family:inherit}
#spPanel{position:fixed;right:0;top:34px;width:400px;height:calc(100vh - 34px);background:#0f172a;border-left:1px solid #1e293b;z-index:200;overflow-y:auto;transform:translateX(100%);transition:transform .3s;font-family:inherit;font-size:11px}
#spPanel.open{transform:translateX(0)}
.sp-hd{background:#1e293b;padding:10px 12px;font-weight:700;color:#e2e8f0;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:10}
.sp-sect{padding:10px 12px;border-bottom:1px solid #1e293b}
.sp-title{font-size:10px;color:#64748b;font-weight:600;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.sp-row{display:flex;justify-content:space-between;align-items:center;margin:3px 0;font-size:11px}
.sp-val{font-weight:700;color:#e2e8f0}
.sp-bar{height:8px;background:#1e293b;border-radius:4px;margin:4px 0;overflow:hidden}
.sp-bar-fill{height:100%;border-radius:4px;transition:width .4s}
.sp-ok{color:#10b981}.sp-warn{color:#f59e0b}.sp-bad{color:#ef4444}
.sp-badge{display:inline-block;padding:1px 6px;border-radius:3px;font-size:10px;font-weight:600;margin-left:4px}
.sp-badge-ok{background:rgba(16,185,129,.2);color:#10b981}
.sp-badge-warn{background:rgba(245,158,11,.2);color:#f59e0b}
.sp-badge-bad{background:rgba(239,68,68,.2);color:#ef4444}
.sp-aisle{margin:3px 0;padding:4px 6px;border-radius:4px;font-size:10px}
.sp-aisle-ok{background:rgba(16,185,129,.1);border-left:3px solid #10b981;color:#a7f3d0}
.sp-aisle-warn{background:rgba(245,158,11,.1);border-left:3px solid #f59e0b;color:#fde68a}
.sp-aisle-bad{background:rgba(239,68,68,.1);border-left:3px solid #ef4444;color:#fca5a5}
.sp-tip{background:rgba(99,102,241,.12);border-left:3px solid #6366f1;color:#a5b4fc;padding:5px 8px;border-radius:0 4px 4px 0;font-size:10px;margin:3px 0;line-height:1.5}
#spToggle{position:fixed;right:0;top:50%;transform:translateY(-50%);background:#3b82f6;color:#fff;border:none;border-radius:6px 0 0 6px;padding:8px 5px;cursor:pointer;z-index:201;font-size:16px;writing-mode:vertical-rl;font-family:inherit;font-size:10px;font-weight:700;letter-spacing:1px}
.aisle-overlay{position:absolute;pointer-events:none;z-index:77}
.sp-collapsible{cursor:pointer;user-select:none;display:flex;justify-content:space-between;align-items:center}
.sp-collapsible::after{content:"▼";font-size:9px;color:#64748b;transition:transform .2s;margin-left:4px}
.sp-collapsible.collapsed::after{transform:rotate(-90deg)}
.sp-collapse-body{overflow:hidden;transition:max-height .3s;max-height:500px}
.sp-collapse-body.hidden{max-height:0}
.sp-issue-item{margin:3px 0;padding:4px 8px;border-radius:4px;font-size:10px;cursor:pointer;transition:all .15s}
.sp-issue-item:hover{filter:brightness(1.3);transform:translateX(2px)}
.sp-highlight-overlay{position:absolute;z-index:88;pointer-events:none;border-radius:2px;animation:sp-pulse 1.5s ease-in-out infinite}
@keyframes sp-pulse{0%,100%{opacity:.9}50%{opacity:.4}}
@keyframes spPulse{0%{opacity:.5}100%{opacity:1}}
.sp-ai-click:hover{background:rgba(139,92,246,.1)!important;border-color:rgba(139,92,246,.3)!important}
.sp-focus-badge{position:absolute;z-index:89;background:#fbbf24;color:#000;font-size:9px;font-weight:700;padding:1px 5px;border-radius:3px;pointer-events:none;white-space:nowrap}
.area-overlay{position:absolute;z-index:84;pointer-events:none;left:0;top:0}
#areaOpts{display:none;align-items:center;gap:6px;margin-left:6px}
#areaOpts.visible{display:flex}
.aopt{background:#1e293b;border:1px solid #22d3ee;border-radius:4px;color:#22d3ee;font-size:11px;padding:2px 8px}
#lineOpts{display:none;align-items:center;gap:6px;margin-left:6px}
#lineOpts.visible{display:flex}
.lopt{background:#1e293b;border:1px solid #334155;border-radius:4px;color:#94a3b8;font-size:11px;padding:2px 8px;cursor:pointer;transition:all .15s}
.lopt.active{background:#3b82f6;border-color:#3b82f6;color:#fff}
#lineColor{width:26px;height:22px;padding:1px;border:1px solid #334155;border-radius:4px;cursor:pointer;background:none}
#lineWidth{width:46px;background:#1e293b;border:1px solid #334155;border-radius:4px;color:#e2e8f0;font-size:11px;padding:2px 4px}
#lineArrow{background:#1e293b;border:1px solid #334155;border-radius:4px;color:#94a3b8;font-size:11px;padding:2px 8px;cursor:pointer}
#lineArrow.active{background:#7c3aed;border-color:#7c3aed;color:#fff}
.rl-label{position:absolute;z-index:81;background:#1e293b;border:1px solid #f59e0b;color:#fcd34d;font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px;white-space:nowrap;font-family:inherit;cursor:pointer}
.rl-label:hover{background:#f59e0b;color:#1e293b}
.rl-dot{position:absolute;width:8px;height:8px;background:#f59e0b;border-radius:50%;z-index:82;pointer-events:none;transform:translate(-4px,-4px)}
.txl{position:absolute;z-index:18;user-select:none;font-size:10px;font-weight:600;color:rgba(255,255,255,.7);padding:2px 6px;border:1px dashed rgba(255,255,255,.15);border-radius:3px;background:rgba(255,255,255,.03);white-space:nowrap}
.m-select .txl{cursor:move}.m-move .txl{cursor:grab}.txl:hover{border-color:rgba(255,255,255,.35)}
.txl .xb{position:absolute;top:-6px;right:-6px;width:12px;height:12px;background:#dc2626;border-radius:50%;color:#fff;font-size:8px;cursor:pointer;display:none;line-height:12px;text-align:center}
.txl:hover .xb{display:block}
.tooltip{position:fixed;background:#1e293b;border:1px solid #475569;border-radius:7px;padding:8px 12px;font-size:10px;color:#e2e8f0;pointer-events:none;z-index:300;display:none;box-shadow:0 6px 20px rgba(0,0,0,.6);min-width:160px}
.ttn{font-weight:700;font-size:12px;margin-bottom:4px;padding-bottom:3px;border-bottom:1px solid #334155}
.ttr{display:flex;justify-content:space-between;gap:8px;padding:1px 0}.ttl{color:#94a3b8}.ttv{font-weight:600;color:#f1f5f9}
.statusbar{height:26px;background:#1e293b;border-top:1px solid #1e293b;display:flex;align-items:center;justify-content:space-between;padding:0 12px;font-size:9px;color:#64748b}
.gl{position:absolute;pointer-events:none;z-index:0}.glv{width:1px;background:rgba(45,58,79,.5)}.glh{height:1px;background:rgba(45,58,79,.5)}
.panel{position:fixed;top:74px;right:0;width:195px;background:#1e293b;border-left:1px solid #1e293b;border-bottom:1px solid #1e293b;padding:10px;z-index:150;display:none;border-radius:0 0 0 8px;max-height:calc(100vh - 120px);overflow-y:auto}
.panel.show{display:block}.panel h3{font-size:11px;font-weight:700;color:#e2e8f0;margin-bottom:8px;display:flex;justify-content:space-between}
.panel h3 .xb{cursor:pointer;color:#64748b;font-size:14px}.panel h3 .xb:hover{color:#e2e8f0}
.pr{display:flex;gap:4px;margin-bottom:5px;align-items:center}.pr label{font-size:9px;color:#94a3b8;min-width:38px}
.pr select,.pr input{background:#1e293b;border:1px solid #334155;color:#e2e8f0;font-size:10px;font-family:inherit;padding:3px 5px;border-radius:4px;flex:1}
.pbtn{width:100%;padding:5px;font-size:10px;font-weight:600;font-family:inherit;border-radius:5px;cursor:pointer;margin-top:3px;background:#065f46;border:1px solid #059669;color:#6ee7b7}.pbtn:hover{background:#047857}
.hs{font-size:9px;font-weight:700;color:#475569;letter-spacing:.5px;padding:4px 0 2px;border-bottom:1px solid #1e293b;margin:4px 0 2px}
.hr{display:flex;align-items:center;gap:8px;padding:3px 0}.hr .hk{min-width:60px;text-align:right}
.hr kbd{background:#1e293b;border:1px solid #334155;color:#94a3b8;font-size:9px;font-family:inherit;padding:2px 5px;border-radius:3px}.hr .hd{font-size:10px;color:#94a3b8}

.edit-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);z-index:500;display:flex;align-items:center;justify-content:center}
.edit-box{background:#1e293b;border:1px solid #475569;border-radius:10px;padding:16px;min-width:250px;color:#e2e8f0;font-family:inherit}
.edit-box h4{font-size:13px;font-weight:700;margin-bottom:10px;color:#f1f5f9}
.edit-box label{font-size:10px;color:#94a3b8;display:block;margin-bottom:2px;margin-top:8px}
.edit-box input{width:100%;background:#0f172a;border:1px solid #334155;color:#e2e8f0;padding:5px 8px;border-radius:4px;font-size:11px;font-family:inherit}
.edit-box .ebtn{display:flex;gap:6px;margin-top:12px}
.edit-box button{flex:1;padding:6px;border:none;border-radius:5px;font-size:11px;font-weight:600;cursor:pointer;font-family:inherit}
.edit-box .ok{background:#059669;color:#fff}
.edit-box .cancel{background:#475569;color:#e2e8f0}
</style>
</head>
<body>
<div class="topbar"><h1>🏭 PBK 창고 랙 배치도</h1><div class="tb-g"><div class="zc">줌<input type="range" id="zoomR" min="30" max="200" value="75" step="5"><span class="zv" id="zoomV">75%</span></div><div class="sep"></div><button class="tb act" id="bG" onclick="tog('grid')">▦ 그리드</button><button class="tb act" id="bS" onclick="tog('snap')">⊞ 스냅</button><div class="sep"></div><button class="tb blu" onclick="toggleP('ap')">＋ 추가</button><button class="tb red" onclick="delSel()">✕ 삭제</button><button class="tb" onclick="undo()" style="background:#1e293b;border-color:#475569;color:#94a3b8;font-size:12px" title="Ctrl+Z">&#x21A9; \ub418\ub3cc\ub9ac\uae30</button><div class="sep"></div><button class="tb grn" onclick="save()">💾 저장</button><button class="tb" onclick="exportJSON()" style="background:#1e3a5f;border-color:#3b82f6;color:#93c5fd">📤 내보내기</button><button class="tb" onclick="document.getElementById('importFile').click()" style="background:#4c1d95;border-color:#7c3aed;color:#c4b5fd">📥 불러오기</button><input type="file" id="importFile" accept=".json" style="display:none" onchange="importJSON(event)"><button class="tb red" onclick="doReset()">↺ 초기화</button><div class="sep"></div><button class="tb" onclick="toggleP('hp')" style="font-size:12px">❓</button><div class="sep"></div><label style="color:#94a3b8;font-size:9px;display:flex;align-items:center;gap:4px;cursor:pointer">🎨 배경<input type="color" id="bgPick" value="#0a1628" style="width:24px;height:20px;border:none;cursor:pointer;background:none;padding:0" onchange="try{document.getElementById('CA').style.background=this.value;document.body.style.background=this.value}catch(e){}"></label></div></div>
<div class="modebar"><button class="mbtn active" data-m="move" onclick="setMode('move')">🖐 이동<span class="key">V</span></button><button class="mbtn" data-m="select" onclick="setMode('select')">⬚ 선택<span class="key">S</span></button><button class="mbtn" data-m="ruler" onclick="setMode('ruler')">📏 측정<span class="key">M</span></button><button class="mbtn" data-m="text" onclick="setMode('text')">T 텍스트<span class="key">T</span></button><button class="mbtn" data-m="line" onclick="setMode('line')">✏ 선 그리기<span class="key">L</span></button><button class="mbtn" data-m="area" onclick="setMode('area')">⬜ 면적<span class="key">A</span></button><span id="lineOpts"><button class="lopt active" id="lsBtn" onclick="setLineStyle('solid')">━ 실선</button><button class="lopt" id="ldBtn" onclick="setLineStyle('dashed')">┅ 점선</button><input type="color" id="lineColor" value="#ffffff" title="선 색상"><input type="number" id="lineWidth" value="2" min="1" max="10" title="선 두께(px)"><button id="lineArrow" onclick="toggleArrow()" title="화살표">→ 화살표</button></span><span class="mode-desc" id="md">🖐 화면을 드래그하여 스크롤합니다</span><div class="lg"><span class="lg-s" style="background:rgba(220,38,38,.85)"></span>RSC48 <span class="lg-s" style="background:rgba(37,99,235,.85)"></span>RSC16 <span class="lg-s" style="background:rgba(217,119,6,.85)"></span>HSM <span class="lg-s" style="background:rgba(234,179,8,.85)"></span>Semi <span class="lg-s" style="background:rgba(124,58,237,.85)"></span>SP</div></div>
<button id="spToggle" onclick="toggleSpPanel()">📊 공간분석</button>
<div id="spPanel">
  <div class="sp-hd">
    <span>📊 공간 활용 분석</span>
    <button onclick="toggleSpPanel()" style="background:none;border:none;color:#94a3b8;cursor:pointer;font-size:14px">✕</button>
  </div>
  <div class="sp-sect">
    <div class="sp-title">🏢 기준 공간</div>
    <div class="sp-row"><span>생산 창고 기준</span><span class="sp-val" id="sp-base">117.91평 (389.83m²)</span></div>
    <div class="sp-row"><span>선택 영역</span><span class="sp-val" id="sp-sel">-</span></div>
  </div>
  <div class="sp-sect">
    <div class="sp-title">📦 1단계 · 점유 면적</div>
    <!-- 랙 점유 접기 -->
    <div class="sp-row sp-collapsible" onclick="spToggleSection('rack-detail')" id="sp-rack-toggle">
      <span>🟥 랙 점유</span><span class="sp-val" id="sp-rack">-</span>
    </div>
    <div class="sp-collapse-body" id="rack-detail">
      <div style="margin:3px 0 3px 10px;color:#94a3b8;font-size:10px" id="sp-rack-list">-</div>
    </div>
    <!-- 존 점유 접기 -->
    <div class="sp-row sp-collapsible" onclick="spToggleSection('zone-detail')" id="sp-zone-toggle" style="margin-top:4px">
      <span>🟦 존 점유</span><span class="sp-val" id="sp-zone">-</span>
    </div>
    <div class="sp-collapse-body" id="zone-detail">
      <div id="sp-zone-detail" style="margin:3px 0 3px 10px;color:#94a3b8;font-size:10px"></div>
    </div>
    <div class="sp-row sp-collapsible" onclick="spToggleSection('excl-detail')" style="margin-top:4px">
      <span>⬜ 제외 영역</span><span class="sp-val sp-bad" id="sp-excl">-</span>
    </div>
    <div class="sp-collapse-body hidden" id="excl-detail">
      <div id="sp-excl-detail" style="margin:3px 0 3px 10px;color:#94a3b8;font-size:10px"></div>
    </div>
    <div class="sp-row sp-collapsible" onclick="spToggleSection('aisle-detail')" style="font-weight:700;margin-top:6px;padding-top:6px;border-top:1px solid #1e293b">
      <span>🚶 계획 통로 (유효)</span><span class="sp-val sp-ok" id="sp-aisle-area">-</span>
    </div>
    <div class="sp-collapse-body hidden" id="aisle-detail">
      <div id="sp-aisle-detail" style="margin:3px 0 3px 10px;color:#94a3b8;font-size:10px"></div>
    </div>
    <div class="sp-row" style="color:#94a3b8">
      <span>⬜ 미활용 빈공간</span><span class="sp-val" id="sp-free">-</span>
    </div>
    <div class="sp-row" style="font-weight:700;margin-top:6px;padding-top:6px;border-top:1px solid #1e293b">
      <span>📊 총 점유</span><span class="sp-val" id="sp-total-occ" style="color:#e2e8f0">-</span>
    </div>
    <div style="display:flex;gap:6px;font-size:9px;color:#64748b;margin-top:4px">
      <span style="color:#ef4444">■ 랙</span>
      <span style="color:#3b82f6">■ 존</span>
      <span style="color:#6b7280">■ 제외</span>
      <span style="color:#06b6d4">■ 통로</span>
      <span style="color:#1e293b;border:1px solid #334155">■ 미활용</span>
    </div>
    <div style="height:10px;border-radius:4px;overflow:hidden;display:flex;margin-top:3px" id="sp-stacked"></div>
  </div>
  <div class="sp-sect">
    <div class="sp-title">🚶 2단계 · 통로 검증 <span style="color:#f59e0b">(최소1m / 권장1.3m)</span></div>
    <div style="display:flex;gap:4px;margin:4px 0 6px">
      <button id="sp-ov-rack" onclick="setOvMode(1)" style="flex:1;font-size:9px;padding:3px 6px;border-radius:3px;border:1px solid #334155;background:#1e293b;color:#94a3b8;cursor:pointer">랙 간 통로</button>
      <button id="sp-ov-total" onclick="setOvMode(2)" style="flex:1;font-size:9px;padding:3px 6px;border-radius:3px;border:1px solid #334155;background:#1e293b;color:#94a3b8;cursor:pointer">전체 통로</button>
    </div>
    <div id="sp-aisle-result"><div class="sp-tip" style="color:#64748b">분석 중...</div></div>
  </div>
  <div class="sp-sect">
    <div class="sp-title">💡 3단계 · 개선 포인트</div>
    <div id="sp-tips"><div class="sp-tip" style="color:#64748b">분석 중...</div></div>
  </div>
  <div class="sp-sect">
    <div class="sp-title">🔄 실시간 분석 <span id="sp-rt-badge" class="sp-badge sp-badge-ok">ON</span></div>
    <div class="sp-row"><span>마지막 업데이트</span><span class="sp-val" id="sp-updated">-</span></div>
    <div class="sp-row"><span>기준 면적 설정</span>
      <span><input id="sp-base-input" type="number" value="117.91" step="0.01"
        style="width:70px;background:#1e293b;border:1px solid #334155;color:#e2e8f0;padding:2px 5px;border-radius:3px;font-size:10px"
        onchange="updateSpBase()"> 평</span>
    </div>
    <div class="sp-row"><span>그룹 판별 기준</span>
      <span><input id="sp-group-input" type="number" value="300" step="50" min="0" max="1000"
        style="width:60px;background:#1e293b;border:1px solid #334155;color:#e2e8f0;padding:2px 5px;border-radius:3px;font-size:10px"
        onchange="updateGroupThresh()"> mm 이하 = 그룹</span>
    </div>
  </div>
</div>
<div id="CA" class="m-move"><div id="CV"><div class="selbox" id="SB"></div></div></div>
<div class="statusbar"><span id="coords">X:0 Y:0</span><span id="stats"></span><span id="snapSt">스냅 ON</span></div>
<div class="tooltip" id="tip"></div>
<div class="panel" id="ap"><h3>＋ 랙 추가<span class="xb" onclick="toggleP('ap')">×</span></h3><div class="pr"><label>영역</label><input id="aA" value="A1"></div><div class="pr"><label>타입</label><select id="aT" onchange="document.getElementById('customSize').style.display=this.value==='custom'?'block':'none'"><option value="heavy">중량랙 (1800mm)</option><option value="light">경량랙 (900mm)</option><option value="custom">커스텀 크기</option></select></div><div id="customSize" style="display:none"><div class="pr"><label>가로mm</label><input id="aCW" type="number" value="1800" min="100" max="10000"></div><div class="pr"><label>세로mm</label><input id="aCH" type="number" value="450" min="100" max="10000"></div></div><div class="pr"><label>시리즈</label><select id="aS"><option value="mx48">RSC48</option><option value="mx16">RSC16</option><option value="hsm">HSM</option><option value="semi">Semi</option><option value="spare">SP</option><option value="etc">기타</option></select></div><div class="pr"><label>색상</label><select id="aC"><option value="">시리즈 기본</option><option value="rgba(34,197,94,.4)">초록</option><option value="rgba(96,165,250,.4)">파랑</option><option value="rgba(249,115,22,.4)">주황</option><option value="rgba(239,68,68,.4)">빨강</option><option value="rgba(168,85,247,.4)">보라</option><option value="rgba(202,138,4,.4)">노랑</option><option value="rgba(148,163,184,.35)">회색</option></select></div><button class="pbtn" onclick="addRack()">랙 추가</button><div style="border-top:1px solid #334155;margin-top:8px;padding-top:8px"><div style="font-size:9px;color:#94a3b8;margin-bottom:4px;font-weight:700">공간/구역 추가</div><div class="pr"><label>이름</label><input id="aZN" value="새 구역"></div><div class="pr"><label>가로mm</label><input id="aZW" type="number" value="2000"></div><div class="pr"><label>세로mm</label><input id="aZH" type="number" value="1000"></div><div class="pr"><label>색상</label><select id="aZC"><option value="rgba(34,197,94,.15)">초록</option><option value="rgba(96,165,250,.12)">파랑</option><option value="rgba(249,115,22,.12)">주황</option><option value="rgba(239,68,68,.15)">빨강</option><option value="rgba(168,85,247,.12)">보라</option><option value="rgba(202,138,4,.15)">노랑</option><option value="rgba(148,163,184,.12)">회색</option></select></div><button class="pbtn" onclick="addZone()" style="background:#4c1d95;border-color:#7c3aed;color:#c4b5fd">구역 추가</button></div><div style="border-top:1px solid #334155;margin-top:8px;padding-top:8px"><div style="font-size:9px;color:#94a3b8;margin-bottom:6px;font-weight:700">\ud504\ub9ac\uc14b \ucd94\uac00</div><button class="pbtn" onclick="addPreset('table')" style="background:#1e293b;border-color:#475569;color:#94a3b8;margin-bottom:4px">\ud14c\uc774\ube14 (1.2m x 4.5m)</button><button class="pbtn" onclick="addPreset('pillar')" style="background:#1e293b;border-color:#475569;color:#94a3b8;margin-bottom:4px">\uae30\ub465 (0.5m x 0.5m)</button><button class="pbtn" onclick="addPreset('equip')" style="background:#1e293b;border-color:#475569;color:#94a3b8;margin-bottom:4px">\uc7a5\ube44 (2m x 1m)</button><button class="pbtn" onclick="addPreset('desk')" style="background:#1e293b;border-color:#475569;color:#94a3b8;margin-bottom:4px">\uc791\uc5c5\ub300 (1.8m x 0.6m)</button><button class="pbtn" onclick="addPreset('conveyor')" style="background:#1e293b;border-color:#475569;color:#94a3b8;margin-bottom:4px">\ucee8\ubca0\uc774\uc5b4 (3m x 0.5m)</button><button class="pbtn" onclick="addPreset('wall')" style="background:#1e293b;border-color:#475569;color:#94a3b8;margin-bottom:4px">\ubcbd/\ud30c\ud2f0\uc158 (3m x 0.1m)</button><button class="pbtn" onclick="addPreset('pallet')" style="background:#1e293b;border-color:#475569;color:#94a3b8;margin-bottom:4px">\ud30c\ub808\ud2b8 (1.1m x 1.1m)</button><button class="pbtn" onclick="addPreset('door')" style="background:#1e293b;border-color:#475569;color:#94a3b8">\ucd9c\uc785\uad6c (1.5m x 0.2m)</button></div></div>
<div class="panel" id="hp"><h3>\u2328 \ub3c4\uc6c0\ub9d0<span class="xb" onclick="toggleP('hp')">\xc3\x97</span></h3><div style="max-height:calc(100vh - 180px);overflow-y:auto;padding-right:4px"><div class="hs">\ubaa8\ub4dc \uc804\ud658</div><div class="hr"><div class="hk"><kbd>V</kbd></div><div class="hd">\ud83d\udd90 \uc774\ub3d9 - \ud654\uba74 \ub4dc\ub798\uadf8 \uc2a4\ud06c\ub864</div></div><div class="hr"><div class="hk"><kbd>S</kbd></div><div class="hd">\u2b1c \uc120\ud0dd - \ub799 \uc120\ud0dd/\uc774\ub3d9/\ubc94\uc704\uc120\ud0dd</div></div><div class="hr"><div class="hk"><kbd>M</kbd></div><div class="hd">\ud83d\udccf \uce21\uc815 - \ub450 \uc810 \uac70\ub9ac \uce21\uc815</div></div><div class="hr"><div class="hk"><kbd>T</kbd></div><div class="hd">T \ud14d\uc2a4\ud2b8 \ucd94\uac00</div></div><div class="hs">\uc120\ud0dd</div><div class="hr"><div class="hk"><kbd>\ud074\ub9ad</kbd></div><div class="hd">\ub2e8\uc77c \uc120\ud0dd</div></div><div class="hr"><div class="hk"><kbd>Shift+\ud074\ub9ad</kbd></div><div class="hd">\ub2e4\uc911 \uc120\ud0dd (\ucd94\uac00\ub9cc)</div></div><div class="hr"><div class="hk"><kbd>Ctrl+\ud074\ub9ad</kbd></div><div class="hd">\ud1a0\uae00 \uc120\ud0dd (\ucd94\uac00/\ud574\uc81c)</div></div><div class="hr"><div class="hk"><kbd>Ctrl+A</kbd></div><div class="hd">\uc804\uccb4 \uc120\ud0dd</div></div><div class="hr"><div class="hk"><kbd>Esc</kbd></div><div class="hd">\uc120\ud0dd \ud574\uc81c / \uc774\ub3d9 \ubaa8\ub4dc</div></div><div class="hs">\ud3b8\uc9d1</div><div class="hr"><div class="hk"><kbd>\ub354\ube14\ud074\ub9ad</kbd></div><div class="hd">\uc774\ub984/\ud06c\uae30/\uc0c9\uc0c1 \uc218\uc815</div></div><div class="hr"><div class="hk"><kbd>R</kbd></div><div class="hd">\uc120\ud0dd \ub799 90\xc2\xb0 \ud68c\uc804</div></div><div class="hr"><div class="hk"><kbd>Delete</kbd></div><div class="hd">\uc120\ud0dd \ud56d\ubaa9 \uc0ad\uc81c</div></div><div class="hr"><div class="hk"><kbd>Ctrl+C</kbd></div><div class="hd">\ubcf5\uc0ac</div></div><div class="hr"><div class="hk"><kbd>Ctrl+V</kbd></div><div class="hd">\ubd99\uc5ec\ub123\uae30</div></div><div class="hr"><div class="hk"><kbd>Ctrl+Z</kbd></div><div class="hd">\ub418\ub3cc\ub9ac\uae30 (\ucd5c\ub300 50\ub2e8\uacc4)</div></div><div class="hs">\ubcf4\uae30</div><div class="hr"><div class="hk"><kbd>Ctrl+\ud720</kbd></div><div class="hd">\ud655\ub300/\ucd95\uc18c</div></div><div class="hr"><div class="hk"><kbd>\ud720</kbd></div><div class="hd">\uc0c1\ud558 \uc2a4\ud06c\ub864</div></div><div class="hs">\uc2a4\ucf00\uc77c</div><div class="hr"><div class="hk">\ud83d\udcd0</div><div class="hd">1mm = 0.06px<br>\uadf8\ub9ac\ub4dc 1\uce78 = 0.5m<br>\uc911\ub7c9\ub799 1800\xc3\x97450mm<br>\uacbd\ub7c9\ub799 900\xc3\x97450mm<br>\ucc3d\uace0 9.4\xc3\x97 31.5m(\ubc15\uc2a4) | \uc0dd\uc0b0\ucc3d\uace0 117.91\ud3c9</div></div></div>
<script>let safeStorage=(()=>{try{return localStorage.setItem("__t__","1"),localStorage.removeItem("__t__"),localStorage}catch(e){let a={};return{getItem:e=>Object.prototype.hasOwnProperty.call(a,e)?a[e]:null,setItem:(e,t)=>{a[e]=String(t)},removeItem:e=>{delete a[e]}}}})(),S=.06,mm=e=>Math.round(e*S),SNAP=8,BX=50,BY=50,WHW=mm(9400),WHH=mm(31500),CW=BX+WHW+mm(19900)+80,CH=BY+WHH+80,Z=.75,O={grid:!0,snap:!0},mode="move",CA=document.getElementById("CA"),CV=document.getElementById("CV"),SB=document.getElementById("SB"),MD={move:"🖐 화면을 드래그하여 스크롤합니다",select:"⬚ 랙 클릭=선택 · 선택랙 드래그=이동 · 빈곳 드래그=범위선택",ruler:"📏 두 점을 클릭하여 거리 측정",text:"T 클릭으로 텍스트 추가",line:"✏ 첫 번째 점 클릭 → 두 번째 점 클릭으로 선 그리기 · 선 클릭 = 삭제",area:"⬜ 두 점을 클릭하여 직사각형 면적 계산 (L자 건물 내부만 집계) · 클릭으로 삭제"},SN={mx48:"RSC48",mx16:"RSC16",hsm:"HSM 3.0",semi:"Semi",spare:"SP",etc:"기타"},R=[],nid=1,sel=new Set,selZ=new Set,zones=[{id:"defect",n:"Defect Area",x:0,y:0,w:264,h:222,c:"rgba(239,68,68,.15)",b:"rgba(239,68,68,.6)"},{id:"pkg",n:"Packaging Foam",x:3,y:350,w:50,h:800,c:"rgba(34,197,94,.15)",b:"rgba(34,197,94,.35)"},{id:"inj",n:"Injection",x:264,y:150,w:300,h:222,c:"rgba(96,165,250,.12)",b:"rgba(96,165,250,.3)"},{id:"bp",n:"Base Plate",x:60,y:1550,w:200,h:50,c:"rgba(168,85,247,.12)",b:"rgba(168,85,247,.3)"},{id:"sp",n:"Spare Part Box",x:3,y:1250,w:50,h:300,c:"rgba(148,163,184,.12)",b:"rgba(148,163,184,.3)"},{id:"test",n:"Test Area",x:936,y:774,w:300,h:210,c:"rgba(96,165,250,.12)",b:"rgba(96,165,250,.3)"},{id:"fqc",n:"Final QC Area",x:936,y:1254,w:300,h:180,c:"rgba(96,165,250,.12)",b:"rgba(96,165,250,.3)"},{id:"stand",n:"Stand",x:684,y:954,w:90,h:36,c:"rgba(202,138,4,.15)",b:"rgba(202,138,4,.35)"},{id:"tablet",n:"Tablet",x:684,y:990,w:90,h:36,c:"rgba(202,138,4,.15)",b:"rgba(202,138,4,.35)"},{id:"ybox",n:"Yellow Box",x:5,y:5,w:80,h:50,c:"rgba(234,179,8,.15)",b:"rgba(234,179,8,.4)"}],txts=[],ntid=1,rulers=[],lines=[],areas=[],nlid=1,naid=1,drag=null,rulerPt=null,linePt=null,areaPt=null,lineStyle="solid",lineArrow=!1;function rpx(e){var t,a;return a="custom"===e.t?(t=mm(e.cw||1800),mm(e.ch||450)):(t=mm("heavy"===e.t?1800:900),mm(450)),!0!==e.rot&&90!==e.rot&&270!==e.rot||(e=t,t=a,a=e),{w:t,h:a}}function exy(e){var t=CV.getBoundingClientRect();return{x:(e.clientX-t.left)/Z,y:(e.clientY-t.top)/Z}}function initR(){R=[],[{a:"A1",t:"heavy",s:"mx48",n:4,c:2,x:80,y:420},{a:"A2",t:"heavy",s:"mx48",n:4,c:2,x:80,y:510},{a:"A5",t:"heavy",s:"mx16",n:2,c:nid=1,x:310,y:420},{a:"A6",t:"heavy",s:"mx16",n:2,c:1,x:310,y:490},{a:"A7",m:[{t:"heavy",n:1},{t:"light",n:2}],s:"mx16",c:1,x:310,y:570},{a:"B1",m:[{t:"light",n:10},{t:"heavy",n:1}],s:"mx48",c:4,x:70,y:610},{a:"B2",t:"light",s:"mx16",n:4,c:1,x:310,y:700},{a:"B3",m:[{t:"light",n:4},{t:"heavy",n:4}],s:"mx48",c:2,x:70,y:830},{a:"B4",t:"light",s:"hsm",n:6,c:1,x:345,y:20},{a:"C1",t:"light",s:"mx16",n:4,c:2,x:310,y:840},{a:"C2",t:"light",s:"hsm",n:4,c:1,x:285,y:30},{a:"C3",t:"light",s:"mx48",n:8,c:2,x:70,y:1060},{a:"A3",m:[{t:"heavy",n:1},{t:"light",n:2}],s:"hsm",c:1,x:285,y:220},{a:"S1",t:"heavy",s:"semi",n:6,c:2,x:470,y:420},{a:"E3",t:"light",s:"etc",n:4,c:2,x:480,y:630},{a:"D2",t:"heavy",s:"etc",n:1,c:1,x:350,y:1600},{a:"F1",t:"light",s:"spare",n:1,c:1,x:800,y:50}].forEach(t=>{let a=[];if(t.m)t.m.forEach(t=>{for(let e=0;e<t.n;e++)a.push(t.t)});else for(let e=0;e<t.n;e++)a.push(t.t);let n=0,r=0,o=0,s=0;a.forEach(e=>{R.push({id:nid++,a:t.a,t:e,s:t.s,x:t.x+r,y:t.y+o,rot:!1}),r+=mm("heavy"===e?1800:900)+3,s=Math.max(s,mm(450)),++n>=t.c&&(n=0,r=0,o+=s+3,s=0)}),R.push({id:nid++,a:"TBL1",t:"custom",s:"etc",x:1070,y:904,rot:!0,cw:1200,ch:4500,cc:"rgba(20,20,20,.85)"}),R.push({id:nid++,a:"TBL2",t:"custom",s:"etc",x:1070,y:1274,rot:!0,cw:1200,ch:4500,cc:"rgba(20,20,20,.85)"}),R.push({id:nid++,a:"TBL3",t:"custom",s:"etc",x:1270,y:904,rot:!0,cw:1200,ch:4500,cc:"rgba(20,20,20,.85)"}),R.push({id:nid++,a:"TBL4",t:"custom",s:"etc",x:1270,y:1274,rot:!0,cw:1200,ch:4500,cc:"rgba(20,20,20,.85)"}),R.push({id:nid++,a:"TBL5",t:"custom",s:"etc",x:1470,y:904,rot:!0,cw:1200,ch:4500,cc:"rgba(20,20,20,.85)"}),R.push({id:nid++,a:"TBL6",t:"custom",s:"etc",x:1470,y:1274,rot:!0,cw:1200,ch:4500,cc:"rgba(20,20,20,.85)"}),R.push({id:nid++,a:"TBL7",t:"custom",s:"etc",x:1670,y:904,rot:!0,cw:1200,ch:4500,cc:"rgba(20,20,20,.85)"}),R.push({id:nid++,a:"TBL8",t:"custom",s:"etc",x:1670,y:1274,rot:!0,cw:1200,ch:4500,cc:"rgba(20,20,20,.85)"}),R.push({id:nid++,a:"TBL9",t:"custom",s:"etc",x:1340,y:1674,rot:!0,cw:800,ch:2e3,cc:"rgba(20,20,20,.85)"}),R.push({id:nid++,a:"TBL10",t:"custom",s:"etc",x:1540,y:1674,rot:!0,cw:800,ch:2e3,cc:"rgba(20,20,20,.85)"})})}let SK="pbk_v9";function load(){try{var e=safeStorage.getItem(SK);if(e){var t=JSON.parse(e);if(t.R&&t.R.length)return R=t.R,nid=Math.max.apply(null,R.map(function(e){return e.id}))+1,t.zones&&(zones=t.zones),t.txts&&(txts=t.txts,ntid=txts.length?Math.max.apply(null,txts.map(function(e){return e.id}))+1:1),t.rulers&&(rulers=t.rulers),t.lines&&(lines=t.lines,nlid=lines.length?Math.max.apply(null,lines.map(function(e){return e.id||0}))+1:1),t.areas&&(areas=t.areas,naid=areas.length?Math.max.apply(null,areas.map(function(e){return e.id||0}))+1:1),!0}}catch(e){console.error("Layout load error:",e);try{safeStorage.removeItem(SK)}catch(e){}}return!1}function loadFromData(e){return!!(e.R&&5<e.R.length)&&(R=e.R,nid=Math.max.apply(null,R.map(function(e){return e.id}))+1,e.zones&&(zones=e.zones),e.txts&&(txts=e.txts,ntid=txts.length?Math.max.apply(null,txts.map(function(e){return e.id}))+1:1),e.rulers&&(rulers=e.rulers),e.lines&&(lines=e.lines,nlid=lines.length?Math.max.apply(null,lines.map(function(e){return e.id||0}))+1:1),e.areas&&(areas=e.areas,naid=areas.length?Math.max.apply(null,areas.map(function(e){return e.id||0}))+1:1),sel.clear(),render(),!0)}function save(){autoSave(),toast("✅ 저장")}var _history=[],_redo=[],_maxHist=50;function pushHistory(){var e=JSON.stringify({R:R,zones:zones,txts:txts,rulers:rulers,lines:lines,areas:areas});_history.length>=_maxHist&&_history.shift(),_history.push(e),_redo=[]}function undo(){var e;_history.length<2||(e=_history.pop(),_redo.push(e),(e=_history[_history.length-1])&&(e=JSON.parse(e),R=e.R,nid=Math.max.apply(null,R.map(function(e){return e.id}))+1,zones=e.zones,txts=e.txts||[],rulers=e.rulers||[],lines=e.lines||[],areas=e.areas||[],sel.clear(),render(),autoSaveNoHist(),toast("되돌리기")))}function redo(){var e;_redo.length&&(e=_redo.pop(),_history.push(e),e=JSON.parse(e),R=e.R,nid=Math.max.apply(null,R.map(function(e){return e.id}))+1,zones=e.zones,txts=e.txts||[],rulers=e.rulers||[],lines=e.lines||[],areas=e.areas||[],sel.clear(),render(),autoSaveNoHist(),toast("다시 실행"))}function autoSave(){pushHistory();var e=JSON.stringify({R:R,zones:zones,txts:txts,rulers:rulers,lines:lines,areas:areas});try{safeStorage.setItem(SK,e)}catch(e){}window.parent!==window&&window.parent.postMessage({type:"layoutSave",data:e},"*")}function autoSaveNoHist(){var e=JSON.stringify({R:R,zones:zones,txts:txts,rulers:rulers,lines:lines,areas:areas});try{safeStorage.setItem(SK,e)}catch(e){}window.parent!==window&&window.parent.postMessage({type:"layoutSave",data:e},"*"),spPanelOpen&&setTimeout(runSpAnalysis,50)}function exportJSON(){try{var e=JSON.stringify({R:R,zones:zones,txts:txts,rulers:rulers,lines:lines,areas:areas,_exported:(new Date).toISOString(),_version:"v9"},null,2),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download="PBK_Layout_"+(new Date).toISOString().slice(0,10)+".json",document.body.appendChild(n),n.click(),document.body.removeChild(n),setTimeout(function(){URL.revokeObjectURL(a)},500),toast("📤 파일 내보내기 완료")}catch(e){toast("⚠ 내보내기 실패: "+e.message)}}function importJSON(e){var t,a=e.target.files[0];a&&((t=new FileReader).onload=function(e){try{var t=JSON.parse(e.target.result);t.R&&t.R.length?(R=t.R,nid=Math.max.apply(null,R.map(function(e){return e.id}))+1,t.zones&&(zones=t.zones),t.txts&&(txts=t.txts,ntid=txts.length?Math.max.apply(null,txts.map(function(e){return e.id}))+1:1),t.rulers&&(rulers=t.rulers),t.lines&&(lines=t.lines,nlid=lines.length?Math.max.apply(null,lines.map(function(e){return e.id||0}))+1:1),t.areas&&(areas=t.areas,naid=areas.length?Math.max.apply(null,areas.map(function(e){return e.id||0}))+1:1),sel.clear(),render(),toast("📥 불러오기 완료 (랙 "+R.length+"개)")):toast("⚠ 유효하지 않은 파일")}catch(e){toast("⚠ 파일 오류: "+e.message)}},t.readAsText(a),e.target.value="")}function doReset(){showConfirm("정말 초기화하시겠습니까?",function(){safeStorage.removeItem(SK),window.parent!==window&&window.parent.postMessage({type:"layoutClear"},"*"),initR(),txts=[],rulers=[],lines=[],areas=[],sel.clear(),zones=[{id:"defect",n:"Defect Area",x:0,y:0,w:264,h:222,c:"rgba(239,68,68,.15)",b:"rgba(239,68,68,.6)"},{id:"pkg",n:"Packaging Foam",x:3,y:350,w:50,h:800,c:"rgba(34,197,94,.15)",b:"rgba(34,197,94,.35)"},{id:"inj",n:"Injection",x:264,y:150,w:300,h:222,c:"rgba(96,165,250,.12)",b:"rgba(96,165,250,.3)"},{id:"bp",n:"Base Plate",x:60,y:1550,w:200,h:50,c:"rgba(168,85,247,.12)",b:"rgba(168,85,247,.3)"},{id:"sp",n:"Spare Part Box",x:3,y:1250,w:50,h:300,c:"rgba(148,163,184,.12)",b:"rgba(148,163,184,.3)"},{id:"test",n:"Test Area",x:936,y:774,w:300,h:210,c:"rgba(96,165,250,.12)",b:"rgba(96,165,250,.3)"},{id:"fqc",n:"Final QC Area",x:936,y:1254,w:300,h:180,c:"rgba(96,165,250,.12)",b:"rgba(96,165,250,.3)"},{id:"stand",n:"Stand",x:684,y:954,w:90,h:36,c:"rgba(202,138,4,.15)",b:"rgba(202,138,4,.35)"},{id:"tablet",n:"Tablet",x:684,y:990,w:90,h:36,c:"rgba(202,138,4,.15)",b:"rgba(202,138,4,.35)"},{id:"ybox",n:"Yellow Box",x:5,y:5,w:80,h:50,c:"rgba(234,179,8,.15)",b:"rgba(234,179,8,.4)"}],render(),autoSave(),toast("ì´ê¸°í ìë£")})}function toast(e){let t=document.createElement("div");t.textContent=e,Object.assign(t.style,{position:"fixed",bottom:"40px",left:"50%",transform:"translateX(-50%)",background:"#065f46",color:"#6ee7b7",padding:"6px 16px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",zIndex:"400",fontFamily:"inherit"}),document.body.appendChild(t),setTimeout(()=>t.remove(),1500)}function setLineStyle(e){lineStyle=e,document.getElementById("lsBtn").className="lopt"+("solid"===e?" active":""),document.getElementById("ldBtn").className="lopt"+("dashed"===e?" active":"")}function toggleArrow(){lineArrow=!lineArrow;var e=document.getElementById("lineArrow");e&&(e.className=lineArrow?"active":"")}function setMode(t){var e=mode,a=(mode=t,rulerPt=null,linePt=null,areaPt=null,document.getElementById("rulerStartMk")),a=(a&&(a.style.display="none"),document.getElementById("rulerPreviewSvg")),a=(a&&a.remove(),document.querySelectorAll(".mbtn").forEach(e=>e.classList.toggle("active",e.dataset.m===t)),CA.className="m-"+("line"===t?"ruler":t),document.getElementById("lineOpts"));a&&(a.className="line"===t?"visible":""),document.getElementById("md").textContent=MD[t]||"","area"===t?document.querySelectorAll(".sp-corridor-ov,.sp-total-ov,.sp-area-highlight").forEach(function(e){e.style.display="none"}):(document.querySelectorAll(".sp-corridor-ov,.sp-total-ov,.sp-area-highlight").forEach(function(e){e.style.display=""}),"area"===e&&spPanelOpen&&setTimeout(runSpAnalysis,50))}function render(){if(CV.innerHTML="",CV.appendChild(SB),CV.style.width=CW+"px",CV.style.height=CH+"px",CV.style.transform="scale("+Z+")",SB.style.display="none",O.grid){for(var e=mm(500),t=WHW+mm(19900)+20,a=BX;a<=BX+t;a+=e)el("gl glv",CV,{left:a,top:BY,width:1,height:WHH});for(var n=BY;n<=BY+WHH;n+=e)el("gl glh",CV,{left:BX,top:n,width:t,height:1})}var r="M "+BX+" "+BY+" L "+(BX+WHW)+" "+BY+" L "+(BX+WHW)+" "+(BY+mm(12900))+" L "+(BX+WHW+10+mm(19900))+" "+(BY+mm(12900))+" L "+(BX+WHW+10+mm(19900))+" "+(BY+WHH)+" L "+BX+" "+(BY+WHH)+" Z",o=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=(o.style.cssText="position:absolute;left:0;top:0;width:"+CW+"px;height:"+CH+"px;z-index:1;pointer-events:none",o.innerHTML='<path d="'+r+'" fill="rgba(20,30,50,.15)" stroke="rgba(255,255,255,.7)" stroke-width="2.5" stroke-linejoin="round"/>',CV.appendChild(o),el("blbl",CV,{left:BX+WHW/2,top:BY+WHH+10})),o=(r.textContent="9.4m",r.style.transform="translateX(-50%)",el("blbl",CV,{left:BX-14,top:BY+WHH/2})),r=(o.textContent="31.5m",o.style.transform="rotate(-90deg) translateX(-50%)",o.style.transformOrigin="0 0",el("blbl",CV,{left:BX+WHW/2,top:BY+12})),o=(r.textContent="창고 박스 9.4m×31.5m (직사각형 기준) | 생산창고 117.91평 | 생산라인+창고 195.01평",r.style.transform="translateX(-50%)",r.style.fontSize="8px",r.style.color="#64748b",zones.forEach((e,t)=>{var a=el("zone",CV,{left:BX+e.x,top:BY+e.y,width:e.w,height:e.h});if(a.style.background=e.c,a.style.border="1.5px dashed "+e.b,a.dataset.zi=t,a.dataset.zid=e.id||"z"+t,selZ.has(e.id||"z"+t)&&(a.style.outline="2px solid #f59e0b"),a.innerHTML='<span class="zn" style="font-size:'+(e.fs||11)+"px;"+(e.fc?"color:"+e.fc:"")+'">'+e.n+(e.excl?' <span style="font-size:8px;background:rgba(239,68,68,.5);color:#fff;border-radius:3px;padding:0 3px;vertical-align:middle">제외</span>':"")+"</span>",e.rot)for(var n=a.querySelectorAll(".zn"),r=0;r<n.length;r++)n[r].style.transform="rotate("+e.rot+"deg)"}),R.forEach((e,t)=>{var a=rpx(e),n=el("rk "+e.s,CV,{left:e.x,top:e.y,width:a.w,height:a.h}),t=(n.dataset.ri=t,n.dataset.id=e.id,n.style.fontSize=(a.w<40?7:8)+"px",n.style.lineHeight=a.h+"px",sel.has(e.id)&&n.classList.add("sel"),e.cc&&(n.style.background=e.cc,n.style.borderColor=e.cc),document.createElement("span")),a=(t.textContent=e.a,t.style.pointerEvents="none",t.style.textShadow="0 1px 3px rgba(0,0,0,.7)",Math.min(e.fs||11,Math.floor(.7*Math.min(a.w,a.h)))),a=(t.style.fontSize=Math.max(a,8)+"px",t.style.fontWeight="700",t.style.color=e.fc||"#fff",n.appendChild(t),document.createElement("div"));a.className="rot",a.textContent="↻",a.dataset.rotid=e.id,n.appendChild(a)}),txts.forEach((e,t)=>{var a=el("txl",CV,{left:e.x,top:e.y}),n=(a.dataset.ti=t,e.fs&&(a.style.fontSize=e.fs+"px"),e.fc&&(a.style.color=e.fc),e.rot&&(a.style.transform="rotate("+e.rot+"deg)"),document.createElement("span")),e=(n.textContent=e.text,n.style.pointerEvents="none",a.appendChild(n),document.createElement("div"));e.className="xb",e.textContent="×",e.dataset.dtx=t,a.appendChild(e)}),rulers.forEach((e,t)=>{var a=e.x2-e.x1,n=e.y2-e.y1,a=Math.sqrt(a*a+n*n),n=Math.round(a/S),a=(n/1e3).toFixed(2),r=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=(r.setAttribute("class","rl-line"),r.style.width=CW+"px",r.style.height=CH+"px",r.innerHTML='<line x1="'+e.x1+'" y1="'+e.y1+'" x2="'+e.x2+'" y2="'+e.y2+'" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="4,3"/>',CV.appendChild(r),el("rl-dot",CV,{left:e.x1,top:e.y1}),el("rl-dot",CV,{left:e.x2,top:e.y2}),el("rl-label",CV,{left:(e.x1+e.x2)/2,top:(e.y1+e.y2)/2-18}));r.textContent=a+"m ("+n.toLocaleString()+"mm)",r.style.transform="translateX(-50%)",r.dataset.drl=t}),document.getElementById("linePreviewSvg")),r=(o&&(o.innerHTML=""),document.getElementById("areaPreview"));r&&(r.innerHTML=""),areas.forEach(function(e,t){var a={x1:BX,y1:BY,x2:BX+WHW,y2:BY+WHH},n={x1:BX+WHW,y1:BY+mm(12900),x2:BX+WHW+mm(19900),y2:BY+WHH};function r(e,t,a,n,r,o,s,i){e=Math.max(e,r),r=Math.max(t,o),t=Math.min(a,s),o=Math.min(n,i);return t<=e||o<=r?null:{x1:e,y1:r,x2:t,y2:o}}var o,i=Math.min(e.x1,e.x2),l=Math.min(e.y1,e.y2),d=Math.max(e.x1,e.x2),c=Math.max(e.y1,e.y2),e=r(i,l,d,c,a.x1,a.y1,a.x2,a.y2),a=r(i,l,d,c,n.x1,n.y1,n.x2,n.y2),s=0,p="",u=([e,a].forEach(function(e){var t,a,n,r;e&&(t=e.x2-e.x1,a=e.y2-e.y1,n=t/S,r=a/S,s+=n*r,p+='<rect x="'+e.x1+'" y="'+e.y1+'" width="'+t+'" height="'+a+'" fill="rgba(34,211,238,.05)" stroke="rgba(34,211,238,.25)" stroke-width="1"/>')}),0),x=[],n=(zones.forEach(function(e){var t,a,n,r,o,s;e.excl&&(t=BX+e.x,a=BY+e.y,n=BX+e.x+e.w,r=BY+e.y+e.h,t=Math.max(i,t),a=Math.max(l,a),n=Math.min(d,n),r=Math.min(c,r),n<=t||r<=a||(r=r-a,o=(n=n-t)/S,s=r/S,u+=o*s,x.push(e.n),p=p+'<rect x="'+t+'" y="'+a+'" width="'+n+'" height="'+r+'" fill="rgba(239,68,68,.08)" stroke="rgba(239,68,68,.4)" stroke-width="1"/><text x="'+(t+n/2)+'" y="'+(a+r/2)+'" text-anchor="middle" dominant-baseline="middle" fill="rgba(239,68,68,.8)" font-size="10" font-family="inherit">✕제외</text>'))}),(s-=u)<0&&(s=0),p+='<rect x="'+i+'" y="'+l+'" width="'+(d-i)+'" height="'+(c-l)+'" fill="none" stroke="rgba(34,211,238,.15)" stroke-width="0.8"/>',document.createElementNS("http://www.w3.org/2000/svg","svg")),e=(n.setAttribute("class","area-overlay"),n.style.width=CW+"px",n.style.height=CH+"px",n.innerHTML=p,CV.appendChild(n),(s/1e6).toFixed(2)),a=(s/1e6/3.30579).toFixed(2),n=(i+d)/2,h=(l+c)/2,n=el("area-label",CV,{left:n,top:h}),h=(n.style.transform="translate(-50%,-50%)",0<u?'<br><span style="font-size:9px;color:rgba(239,68,68,.9)">-'+(u/1e6).toFixed(2)+"m² ("+x.join(", ")+") 제외됨</span>":"");n.innerHTML="📐 <b>"+e+"m²</b> ("+a+"평)"+h+'<br><span style="font-size:9px;opacity:.6">클릭하여 삭제 ✕</span>',n.dataset.dai=t,o=t,n.addEventListener("click",function(e){e.stopPropagation(),areas.splice(o,1),render(),autoSave(),toast("면적 삭제됨")})}),lines.forEach(function(e,t){var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=(a.setAttribute("class","dl-svg"),a.style.width=CW+"px",a.style.height=CH+"px","dashed"===e.style?'stroke-dasharray="8,5"':""),r=e.color||"#ffffff",o="arr"+t,n=(a.innerHTML=(e.arrow?'<defs><marker id="'+o+'" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto"><path d="M0,0 L0,6 L8,3 Z" fill="'+r+'"/></marker></defs>':"")+'<line x1="'+e.x1+'" y1="'+e.y1+'" x2="'+e.x2+'" y2="'+e.y2+'" stroke="'+r+'" stroke-width="'+(e.width||2)+'" '+n+' stroke-linecap="round" '+(e.arrow?'marker-end="url(#'+o+')"':"")+"/>",CV.appendChild(a),(e.x1+e.x2)/2),o=(e.y1+e.y2)/2,a=document.createElement("div"),n=(a.className="dl-handle",a.style.left=n+"px",a.style.top=o+"px",a.style.background=r,a.style.border="2px solid rgba(255,255,255,.5)",a.dataset.dli=t,a.dataset.dltype="move",a.title="드래그: 이동 · 더블클릭: 삭제",CV.appendChild(a),document.createElement("div")),o=(n.className="dl-ep",n.style.left=e.x1+"px",n.style.top=e.y1+"px",n.style.borderColor=r,n.dataset.dli=t,n.dataset.dltype="p1",n.title="드래그: 시작점 이동",CV.appendChild(n),document.createElement("div"));o.className="dl-ep",o.style.left=e.x2+"px",o.style.top=e.y2+"px",o.style.borderColor=r,o.dataset.dli=t,o.dataset.dltype="p2",o.title="드래그: 끝점 이동",CV.appendChild(o)}),upStats()}function el(e,t,a){var n=document.createElement("div");return n.className=e,a&&(n.style.left=a.left+"px",n.style.top=a.top+"px",a.width&&(n.style.width=a.width+"px"),a.height)&&(n.style.height=a.height+"px"),t&&t.appendChild(n),n}function updSel(){document.querySelectorAll(".rk").forEach(e=>e.classList.toggle("sel",sel.has(+e.dataset.id))),document.querySelectorAll(".zone").forEach(e=>{var t=e.dataset.zid;e.style.outline=selZ.has(t)?"2px solid #f59e0b":""})}var spBasePyeong=117.91,spBaseM2=3.30579*spBasePyeong,spPanelOpen=!1,spOvMode=0,rackM2_global=0,zoneM2_global=0,exclM2_global=0,selM2_global=0,MIN_AISLE=1e3,OPT_AISLE=1300,GROUP_THRESH=300;function spToggleSection(e){var t,e=document.getElementById(e);e&&(t=e.previousElementSibling,e.classList.contains("hidden")?(e.classList.remove("hidden"),t&&t.classList.remove("collapsed")):(e.classList.add("hidden"),t&&t.classList.add("collapsed")))}function spHighlightAisle(e){var t,a,n,r;document.querySelectorAll(".sp-highlight-overlay,.sp-focus-badge").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)}),e&&e.ra&&e.rb&&([e.ra,e.rb].forEach(function(e,t){var a=document.createElement("div");a.className="sp-highlight-overlay",a.style.cssText="left:"+e.x+"px;top:"+e.y+"px;width:"+e.w+"px;height:"+e.h+"px;background:rgba(251,191,36,.35);border:2px solid #fbbf24;",CV.appendChild(a)}),(t=document.createElement("div")).className="sp-highlight-overlay","X"===e.dir?(a=e.ra.x+e.ra.w,n=e.rb.x,r=(e.ra.y+e.ra.y+e.ra.h)/2,n<a&&(a=e.rb.x+e.rb.w,n=e.ra.x),t.style.cssText="left:"+a+"px;top:"+(r-8)+"px;width:"+(n-a)+"px;height:16px;background:rgba(239,68,68,.25);border:1px dashed #ef4444;"):(r=e.ra.y+e.ra.h,n=e.rb.y,a=(e.ra.x+e.ra.x+e.ra.w)/2,n<r&&(r=e.rb.y+e.rb.h,n=e.ra.y),t.style.cssText="left:"+(a-8)+"px;top:"+r+"px;width:16px;height:"+(n-r)+"px;background:rgba(239,68,68,.25);border:1px dashed #ef4444;"),CV.appendChild(t),(a=document.createElement("div")).className="sp-focus-badge",a.style.cssText="left:"+Math.min(e.ra.x,e.rb.x)+"px;top:"+(Math.min(e.ra.y,e.rb.y)-18)+"px;",a.textContent=(e.gap/1e3).toFixed(2)+"m",CV.appendChild(a),n=(e.ra.x+e.rb.x)/2*Z-CA.clientWidth/2,r=(e.ra.y+e.rb.y)/2*Z-CA.clientHeight/2,CA.scrollLeft=Math.max(0,n),CA.scrollTop=Math.max(0,r),setTimeout(function(){document.querySelectorAll(".sp-highlight-overlay,.sp-focus-badge").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},3e3))}function spFocusRacks(t){document.querySelectorAll(".sp-highlight-overlay,.sp-focus-badge").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)});var e=R.filter(function(e){return e.a.replace(/[0-9]/g,"")===t});e.forEach(function(e){var t=rpx(e),a=document.createElement("div");a.className="sp-highlight-overlay",a.style.cssText="left:"+e.x+"px;top:"+e.y+"px;width:"+t.w+"px;height:"+t.h+"px;background:rgba(99,102,241,.35);border:2px solid #6366f1;",CV.appendChild(a)}),0<e.length&&(e=e[0],CA.scrollLeft=e.x*Z-CA.clientWidth/2,CA.scrollTop=e.y*Z-CA.clientHeight/2),setTimeout(function(){document.querySelectorAll(".sp-highlight-overlay,.sp-focus-badge").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},3e3)}function spFocusZone(a){document.querySelectorAll(".sp-highlight-overlay,.sp-focus-badge").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)}),zones.forEach(function(e){var t;e.n===a&&((t=document.createElement("div")).className="sp-highlight-overlay",t.style.cssText="left:"+(BX+e.x)+"px;top:"+(BY+e.y)+"px;width:"+e.w+"px;height:"+e.h+"px;background:rgba(59,130,246,.3);border:2px solid #3b82f6;",CV.appendChild(t),CA.scrollLeft=(BX+e.x)*Z-CA.clientWidth/2,CA.scrollTop=(BY+e.y)*Z-CA.clientHeight/2)}),setTimeout(function(){document.querySelectorAll(".sp-highlight-overlay,.sp-focus-badge").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},3e3)}function toggleSpPanel(){spPanelOpen=!spPanelOpen;var e=document.getElementById("spPanel");e&&(e.className=spPanelOpen?"open":""),spPanelOpen||(spOvMode=0,document.querySelectorAll(".sp-corridor-ov,.sp-total-ov").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})),runSpAnalysis()}function setOvMode(e){spOvMode=spOvMode===e?0:e,updateOvButtons(),spPanelOpen&&runSpAnalysis()}function updateOvButtons(){var e=document.getElementById("sp-ov-rack"),t=document.getElementById("sp-ov-total");e&&(e.style.background=1===spOvMode?"rgba(6,182,212,.15)":"#1e293b",e.style.color=1===spOvMode?"#67e8f9":"#94a3b8",e.style.borderColor=1===spOvMode?"rgba(6,182,212,.4)":"#334155"),t&&(t.style.background=2===spOvMode?"rgba(139,92,246,.15)":"#1e293b",t.style.color=2===spOvMode?"#a78bfa":"#94a3b8",t.style.borderColor=2===spOvMode?"rgba(139,92,246,.4)":"#334155")}function spHighlightArea(e,t,a,n,r,o){document.querySelectorAll(".sp-area-highlight").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)});var s=document.createElement("div");s.className="sp-area-highlight",s.style.cssText="position:absolute;z-index:17;pointer-events:none;border-radius:4px;left:"+e+"px;top:"+t+"px;width:"+(a-e)+"px;height:"+(n-t)+"px;background:"+(o||"rgba(251,191,36,.12)")+";border:2px dashed "+(o?o.replace(".12",".6"):"rgba(251,191,36,.5)")+";animation:spPulse 1s infinite alternate",r&&((o=document.createElement("div")).style.cssText="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:11px;font-weight:700;white-space:nowrap;text-shadow:0 1px 3px rgba(0,0,0,.9);pointer-events:none;color:#fbbf24;background:rgba(15,23,42,.85);padding:3px 10px;border-radius:4px",o.textContent=r,s.appendChild(o)),CV.appendChild(s),CA.scrollLeft=(e+a)/2*Z-CA.clientWidth/2,CA.scrollTop=(t+n)/2*Z-CA.clientHeight/2,setTimeout(function(){document.querySelectorAll(".sp-area-highlight").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},4e3)}function updateSpBase(){var e=parseFloat(document.getElementById("sp-base-input").value)||117.69,t=(spBaseM2=3.30579*(spBasePyeong=e),document.getElementById("sp-base"));t&&(t.textContent=e.toFixed(2)+"평 ("+spBaseM2.toFixed(2)+"m²)"),runSpAnalysis()}function updateGroupThresh(){var e=parseInt(document.getElementById("sp-group-input").value);!isNaN(e)&&0<=e&&(GROUP_THRESH=e),runSpAnalysis()}function getIntersectArea(e,t,a,n,r,o,s,i){e=Math.max(e,r),r=Math.max(t,o),t=Math.min(a,s),o=Math.min(n,i);return t<=e||o<=r?0:(t-e)/S*((o-r)/S)}function runSpAnalysis(){var s,i,l,d,P,c=[],p=[],u=0,x=0,h=0,y=[],e=0<areas.length?areas[areas.length-1]:null,t=e?(s=Math.min(e.x1,e.x2),i=Math.min(e.y1,e.y2),l=Math.max(e.x1,e.x2),d=Math.max(e.y1,e.y2),t={x1:BX,y1:BY,x2:BX+WHW,y2:BY+WHH},a={x1:BX+WHW,y1:BY+mm(12900),x2:BX+WHW+mm(19900),y2:BY+WHH},t=getIntersectArea(s,i,l,d,t.x1,t.y1,t.x2,t.y2),a=getIntersectArea(s,i,l,d,a.x1,a.y1,a.x2,a.y2),P=0,zones.forEach(function(e){e.excl&&(P+=getIntersectArea(s,i,l,d,BX+e.x,BY+e.y,BX+e.x+e.w,BY+e.y+e.h))}),(t+a-P)/1e6):(s=BX,i=BY,l=982,d=BY+WHH,spBaseM2),a=t/3.30579,n=document.getElementById("sp-sel"),Y=(n&&(n.textContent=t.toFixed(2)+"m² ("+a.toFixed(2)+"평)"+(e?"":" [전체창고]")),0),X=0,m={},n=(R.forEach(function(e){var t=rpx(e),t=getIntersectArea(s,i,l,d,e.x,e.y,e.x+t.w,e.y+t.h);0<t&&(Y+=t,X++,t=e.a.replace(/[0-9]/g,""),m[t]||(m[t]=[]),m[t].push(e))}),Y/1e6),_=0,F={},V=0,a=(zones.forEach(function(e){var t=getIntersectArea(s,i,l,d,BX+e.x,BY+e.y,BX+e.x+e.w,BY+e.y+e.h);t<=0||(e.excl?V+=t:(_+=t,F[e.n]=(F[e.n]||0)+t))}),_/1e6),e=V/1e6,r=(rackM2_global=n,zoneM2_global=a,exclM2_global=e,selM2_global=t,Math.max(0,t-n-a-e)),K=0,o=(R.forEach(function(e){e=rpx(e),e=e.w/S*2+e.h/S*2;K+=e*MIN_AISLE*.5}),Math.min(K/1e6,.8*r)),r=Math.max(0,r-o),f=0<t?n/t*100:0,q=0<t?a/t*100:0,g=0<t?e/t*100:0,j=0<t?o/t*100:0,b=0<t?r/t*100:0,v=0<t?(n+a+o)/t*100:0;function w(e,t){e=document.getElementById(e);e&&(e.innerHTML=t)}w("sp-rack",n.toFixed(2)+"m² ("+f.toFixed(1)+"%) ▾ "+X+"개");var D,U,J,G,C,Q=document.getElementById("sp-rack-list"),$=(Q&&(Q.innerHTML="",Object.keys(m).forEach(function(e){var t,a=m[e].length,n=rpx(m[e][0]),r=Math.round(n.w/S),n=Math.round(n.h/S),o=document.createElement("div"),s=(o.style.cssText="display:flex;justify-content:space-between;padding:2px 0",document.createElement("span")),a=(s.style.cssText="cursor:pointer;color:#93c5fd",s.textContent=e+" 계열 ("+a+"개)",s.title="클릭: 해당 랙 하이라이트",s.onclick=(t=e,function(){spFocusRacks(t)}),document.createElement("span"));a.style.color="#64748b",a.textContent=r+"×"+n+"mm",o.appendChild(s),o.appendChild(a),Q.appendChild(o)}),Q.children.length||(Q.innerHTML='<span style="color:#475569">낙 없음</span>')),w("sp-zone",a.toFixed(2)+"m² ("+q.toFixed(1)+"%) ▾"),document.getElementById("sp-zone-detail")),ee=($&&($.innerHTML="",Object.keys(F).forEach(function(e){var t,a=document.createElement("div"),n=(a.style.cssText="display:flex;justify-content:space-between;padding:2px 0;cursor:pointer",a.title="클릭: 해당 존 하이라이트",document.createElement("span")),r=(n.style.color="#93c5fd",n.textContent="└ "+e,document.createElement("span"));r.style.color="#64748b",r.textContent=(F[e]/1e6).toFixed(1)+"m²",a.appendChild(n),a.appendChild(r),a.onclick=(t=e,function(){spFocusZone(t)}),$.appendChild(a)}),$.children.length||($.innerHTML='<span style="color:#475569">존 없음</span>')),w("sp-excl",'<span class="sp-bad">'+e.toFixed(2)+"m² ("+g.toFixed(1)+"%) 제외</span>"),document.getElementById("sp-excl-detail")),E=(ee&&(ee.innerHTML="",zones.forEach(function(e){var t,a,n,r,o=getIntersectArea(s,i,l,d,BX+e.x,BY+e.y,BX+e.x+e.w,BY+e.y+e.h);!e.excl||o<=0||((t=document.createElement("div")).style.cssText="display:flex;justify-content:space-between;padding:2px 0;cursor:pointer",(a=document.createElement("span")).style.color="#f87171",a.textContent="✕ "+e.n,(n=document.createElement("span")).style.color="#6b7280",n.textContent=(o/1e6).toFixed(1)+"m²",t.appendChild(a),t.appendChild(n),t.onclick=(r=e.n,function(){spFocusZone(r)}),ee.appendChild(t))}),ee.children.length||(ee.innerHTML='<span style="color:#475569">제외 존 없음</span>')),w("sp-aisle-area",'<span class="sp-ok">'+o.toFixed(2)+"m² ("+j.toFixed(1)+"%)</span>"),b<20?"sp-ok":b<40?"sp-warn":"sp-bad"),E=(w("sp-free",'<span class="'+E+'">'+r.toFixed(2)+"m² ("+b.toFixed(1)+"%)</span>"),n+a),M=0<t?E/t*100:0,E=(w("sp-total-occ",E.toFixed(2)+"m² ("+M.toFixed(1)+"%)"),document.getElementById("sp-stacked")),te=(E&&(E.innerHTML='<div style="width:'+f.toFixed(1)+'%;background:#ef4444;height:100%"></div><div style="width:'+q.toFixed(1)+'%;background:#3b82f6;height:100%"></div><div style="width:'+g.toFixed(1)+'%;background:#6b7280;height:100%"></div><div style="width:'+j.toFixed(1)+'%;background:#06b6d4;height:100%"></div><div style="width:'+b.toFixed(1)+'%;background:#1e3a5f;height:100%"></div>'),p=[],h=x=u=0,c=[],y=R.filter(function(e){var t=rpx(e);return 0<getIntersectArea(s,i,l,d,e.x,e.y,e.x+t.w,e.y+t.h)}),["DOOR","PILLAR","WALL","CONV","TBL","DESK","EQUIP","PLT"]),ae={},ne=(y.forEach(function(t){var a,e,n;"custom"===t.t||(a=!1,te.forEach(function(e){0<=t.a.toUpperCase().indexOf(e)&&(a=!0)}),a)||(e=rpx(t),ae[t.a]||(ae[t.a]={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,s:t.s}),(n=ae[t.a]).x1=Math.min(n.x1,t.x),n.y1=Math.min(n.y1,t.y),n.x2=Math.max(n.x2,t.x+e.w),n.y2=Math.max(n.y2,t.y+e.h))}),[]),re=(Object.keys(ae).forEach(function(n){var e=y.filter(function(e){return e.a===n&&"custom"!==e.t});if(e.length){var t=!1;if(te.forEach(function(e){0<=n.toUpperCase().indexOf(e)&&(t=!0)}),!t){e.sort(function(e,t){return e.y-t.y});for(var r=[],a=[e[0]],o=1;o<e.length;o++){var s=a[a.length-1],i=rpx(s);2e3<(e[o].y-(s.y+i.h))/S?(r.push(a),a=[e[o]]):a.push(e[o])}r.push(a),r.forEach(function(e,t){var a={name:n+(1<r.length?"_"+(t+1):""),s:e[0].s,x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};e.forEach(function(e){var t=rpx(e);a.x1=Math.min(a.x1,e.x),a.y1=Math.min(a.y1,e.y),a.x2=Math.max(a.x2,e.x+t.w),a.y2=Math.max(a.y2,e.y+t.h)}),ne.push(a)})}}}),zones.forEach(function(e){var t,a,n,r;e.excl||(t=BX+e.x,a=BY+e.y,n=BX+e.x+e.w,r=BY+e.y+e.h,0<getIntersectArea(s,i,l,d,t,a,n,r)&&ne.push({name:e.n,s:"zone",x1:t,y1:a,x2:n,y2:r}))}),{}),M=(ne.forEach(function(a){var e,t,n,r,o=null,s=1/0,i=(ne.forEach(function(e){var t;e===a||e.name===a.name||Math.min(a.y2,e.y2)-Math.max(a.y1,e.y1)<=0||e.x1>=a.x2&&(t=(e.x1-a.x2)/S)<s&&(s=t,o=e)}),o&&GROUP_THRESH<s&&(e=[a.name,o.name].sort().join("_X_"),re[e]||(re[e]=!0,n=Math.max(a.y1,o.y1),t=Math.min(a.y2,o.y2),r=s<.95*MIN_AISLE?"bad":s<OPT_AISLE?"warn":"ok","bad"===(r="zone"===a.s&&"zone"===o.s?"ok":r)?h++:"warn"===r?x++:u++,"ok"!==r&&p.push({type:r,gap:Math.round(s),dir:"X",a:a.name,b:o.name,ra:{x:a.x1,y:a.y1,w:a.x2-a.x1,h:a.y2-a.y1},rb:{x:o.x1,y:o.y1,w:o.x2-o.x1,h:o.y2-o.y1}}),c.push({x:a.x2,y:n,w:o.x1-a.x2,h:t-n,gapMM:Math.round(s),dir:"X",status:r,la:a.name,lb:o.name}))),null),l=1/0;ne.forEach(function(e){var t;e===a||e.name===a.name||Math.min(a.x2,e.x2)-Math.max(a.x1,e.x1)<=0||e.y1>=a.y2&&(t=(e.y1-a.y2)/S)<l&&(l=t,i=e)}),i&&GROUP_THRESH<l&&(e=[a.name,i.name].sort().join("_Y_"),re[e]||(re[e]=!0,t=Math.max(a.x1,i.x1),n=Math.min(a.x2,i.x2),r=l<.95*MIN_AISLE?"bad":"ok","bad"===(r="zone"===a.s&&"zone"===i.s?"ok":r)?h++:u++,"ok"!==r&&p.push({type:r,gap:Math.round(l),dir:"Y",a:a.name,b:i.name,ra:{x:a.x1,y:a.y1,w:a.x2-a.x1,h:a.y2-a.y1},rb:{x:i.x1,y:i.y1,w:i.x2-i.x1,h:i.y2-i.y1}}),c.push({x:t,y:a.y2,w:n-t,h:i.y1-a.y2,gapMM:Math.round(l),dir:"Y",status:r,la:a.name,lb:i.name})))}),document.getElementById("sp-aisle-result")),B=(M&&(M.innerHTML="",0===y.length?((E=document.createElement("div")).className="sp-tip",E.textContent="선택 영역 내 랙이 없습니다",M.appendChild(E)):(0<h&&((E=document.createElement("div")).className="sp-aisle sp-aisle-bad sp-collapsible",E.textContent="🚨 위험 "+h+"곳 최소(1m) 미달 — 클릭 상세",E.style.cursor="pointer",(D=document.createElement("div")).className="sp-collapse-body hidden",D.id="aisle-bad-list",E.onclick=function(){spToggleSection("aisle-bad-list")},M.appendChild(E),p.filter(function(e){return"bad"===e.type}).sort(function(e,t){return e.gap-t.gap}).forEach(function(e){var t,a=document.createElement("div");a.className="sp-issue-item sp-aisle-bad",a.innerHTML="<b>"+e.a+"</b> ↔ <b>"+e.b+'</b>: <span style="color:#f87171;font-weight:700">'+(e.gap/1e3).toFixed(2)+'m</span> <span style="color:#6b7280;font-size:9px">(클릭: 위치 보기)</span>',a.onclick=(t=e,function(){spHighlightAisle(t)}),D.appendChild(a)}),M.appendChild(D)),0<x&&((E=document.createElement("div")).className="sp-aisle sp-aisle-warn sp-collapsible",E.textContent="⚠️ 주의 "+x+"곳 권장(1.5m) 미달 — 클릭 상세",E.style.cursor="pointer",(U=document.createElement("div")).className="sp-collapse-body hidden",U.id="aisle-warn-list",E.onclick=function(){spToggleSection("aisle-warn-list")},M.appendChild(E),p.filter(function(e){return"warn"===e.type}).sort(function(e,t){return e.gap-t.gap}).slice(0,20).forEach(function(e){var t,a=document.createElement("div");a.className="sp-issue-item sp-aisle-warn",a.innerHTML="<b>"+e.a+"</b> ↔ <b>"+e.b+'</b>: <span style="color:#fbbf24;font-weight:700">'+(e.gap/1e3).toFixed(2)+'m</span> <span style="color:#6b7280;font-size:9px">(클릭: 위치 보기)</span>',a.onclick=(t=e,function(){spHighlightAisle(t)}),U.appendChild(a)}),M.appendChild(U)),0<u&&((E=document.createElement("div")).className="sp-aisle sp-aisle-ok",E.textContent="✅ 적정 "+u+"곳 1.3m 이상",M.appendChild(E))),E=Math.max(0,t-n-a-e),e=0<t?E/t*100:0,(k=document.createElement("div")).style.cssText="margin-top:8px;padding:6px 8px;background:rgba(139,92,246,.06);border:1px solid rgba(139,92,246,.15);border-radius:4px",k.innerHTML='<div style="font-size:10px;font-weight:700;color:#a78bfa;margin-bottom:3px">📊 전체 통로 면적</div><div style="font-size:10px;color:#cbd5e1">배치도 내 모든 배치 요소(랙, 구역, 제외 영역) 제외</div><div style="font-size:12px;color:#a78bfa;font-weight:700;margin:3px 0"><b>'+E.toFixed(1)+'m²</b> <span style="font-size:10px;font-weight:400;color:#94a3b8">('+e.toFixed(1)+'%)</span></div><div style="font-size:9px;color:#64748b">→ 전체 통로 버튼으로 배치도에서 시각적 확인 가능</div>',M.appendChild(k)),document.getElementById("sp-aisle-detail")),e=(B&&(B.innerHTML="",J={},c.filter(function(e){e=e.x+"_"+e.y+"_"+e.w+"_"+e.h;return!J[e]&&(J[e]=!0)}).sort(function(e,t){return("X"===e.dir?0:1)-("X"===t.dir?0:1)||e.gapMM-t.gapMM}).forEach(function(e,t){var a,n=document.createElement("div"),r=(n.style.cssText="display:flex;justify-content:space-between;align-items:center;padding:3px 4px;margin:2px 0;border-radius:3px;cursor:pointer","bad"===e.status?"🚨":"warn"===e.status?"⚠️":"✅"),o="bad"===e.status?"rgba(239,68,68,.1)":"warn"===e.status?"rgba(245,158,11,.1)":"rgba(6,182,212,.08)",s="bad"===e.status?"#f87171":"warn"===e.status?"#fbbf24":"#67e8f9",o=(n.style.background=o,"X"===e.dir?"가로":"세로"),i=e.w/S/1e3*(e.h/S/1e3),l=document.createElement("span"),s=(l.style.cssText="color:"+s+";font-size:10px",l.textContent=r+" "+e.la+"↔"+e.lb+" ("+o+")",document.createElement("span"));s.style.cssText="color:#94a3b8;font-size:10px;text-align:right",s.textContent=(e.gapMM/1e3).toFixed(2)+"m · "+i.toFixed(1)+"m²",n.appendChild(l),n.appendChild(s),n.title="클릭: 위치 보기",n.onclick=(a=e,function(){1!==spOvMode&&setOvMode(1),CA.scrollLeft=(a.x+a.w/2)*Z-CA.clientWidth/2,CA.scrollTop=(a.y+a.h/2)*Z-CA.clientHeight/2}),B.appendChild(n)}),B.children.length||(B.innerHTML='<span style="color:#475569">감지된 통로 없음</span>'),1<r)&&((E=document.createElement("div")).style.cssText="border-top:1px solid #1e293b;margin:4px 0;padding-top:4px;color:#94a3b8;font-size:9px",E.textContent="미활용: ~"+r.toFixed(1)+"m²",B.appendChild(E)),[]),M=100,k=[],E=(v<20?(e.push({t:"bad",msg:"🏜️ 공간 활용도 매우 낮음 ("+v.toFixed(1)+"%)"}),M-=30,k.push({d:-30,r:"활용률 20% 미만"})):v<40?(e.push({t:"warn",msg:"⚠️ 공간 활용도 낮음 ("+v.toFixed(1)+"%)"}),M-=15,k.push({d:-15,r:"활용률 40% 미만"})):90<v?(e.push({t:"bad",msg:"🚨 공간 과밀 ("+v.toFixed(1)+"%)"}),M-=25,k.push({d:-25,r:"활용률 90% 초과: 과밀"})):80<v?(e.push({t:"warn",msg:"⚠️ 공간 포화 접근 ("+v.toFixed(1)+"%)"}),M-=10,k.push({d:-10,r:"활용률 80% 초과"})):70<v?(e.push({t:"ok",msg:"✅ 공간 활용도 다소 높음 ("+v.toFixed(1)+"%)"}),M-=5,k.push({d:-5,r:"활용률 70~80%: 포화 접근 구간"})):55<=v?(e.push({t:"ok",msg:"✅ 공간 활용도 최적 ("+v.toFixed(1)+"%)"}),k.push({d:0,r:"활용률 55~70%: 배치와 동선 균형 최적"})):(e.push({t:"ok",msg:"✅ 공간 활용도 다소 낮음 ("+v.toFixed(1)+"%)"}),M-=5,k.push({d:-5,r:"활용률 40~55%: 여유 있으나 활용 가능"})),0<h&&(e.push({t:"bad",msg:"🚨 최소 통로(1m) 미달 "+h+"곳",action:"aisle-bad-list"}),M-=25,k.push({d:-25,r:"안전거리(1m) 미달 "+h+"곳"})),0<x&&(e.push({t:"warn",msg:"⚠️ 권장 통로(1.3m) 미달 "+x+"곳",action:"aisle-warn-list"}),M-=10,k.push({d:-10,r:"권장거리(1.3m) 미달 "+x+"곳"})),0===h&&0===x&&0<u&&k.push({d:0,r:"모든 통로("+u+"곳) 기준 충족"}),50<f?(e.push({t:"warn",msg:"📦 랙 점유율 과다 ("+f.toFixed(1)+"%)"}),M-=10,k.push({d:-10,r:"랙 점유 50% 초과"})):0<f&&f<10?(e.push({t:"ok",msg:"📦 랙 점유율 여유 ("+f.toFixed(1)+"%)"}),k.push({d:0,r:"랙 점유율 낮음"})):10<=f&&k.push({d:0,r:"랙 점유율 "+f.toFixed(1)+"%: 적정"}),20<g&&(e.push({t:"warn",msg:"⬛ 제외 영역("+g.toFixed(1)+"%) 큰"}),M-=5,k.push({d:-5,r:"제외 영역 20% 초과"})),80<=(M=Math.max(0,M))?"sp-badge-ok":60<=M?"sp-badge-warn":"sp-badge-bad"),z=document.getElementById("sp-tips");if(z){z.innerHTML="";var g=document.createElement("div"),oe=(g.className="sp-row",g.style.marginBottom="6px",g.innerHTML='<span>종합 점수</span><span class="sp-badge '+E+'" style="font-size:13px">'+M+"점</span>",z.appendChild(g),document.createElement("div")),se=(oe.style.cssText="font-size:9px;color:#67e8f9;cursor:pointer;margin:4px 0;user-select:none",oe.textContent="📊 점수 산출 근거 ▸",document.createElement("div")),A=(se.style.cssText="display:none;margin:4px 0 8px;padding:6px;background:rgba(15,23,42,.6);border-radius:4px;border:1px solid #1e293b",'<div style="font-size:9px;color:#94a3b8;margin-bottom:6px">기준: 100점 만점 (감점 방식) — 일반적인 창고 운영 가이드라인 기반</div>'),ie=(A=A+'<div style="margin-bottom:6px;padding:4px 6px;background:rgba(30,41,59,.5);border-radius:3px;border:1px solid #1e293b">'+'<div style="font-size:8px;color:#64748b;margin-bottom:3px">▶ 공간 활용률 평가 기준</div>',v<20?0:v<40?1:v<55?2:v<=70?3:v<=80?4:v<=90?5:6),E=([{r:"20% 미만",s:"매우 낮음",d:"-30",c:"#f87171"},{r:"20~40%",s:"낮음",d:"-15",c:"#fbbf24"},{r:"40~55%",s:"다소 낮음",d:"-5",c:"#67e8f9"},{r:"55~70%",s:"★ 최적",d:"±0",c:"#34d399"},{r:"70~80%",s:"다소 높음",d:"-5",c:"#67e8f9"},{r:"80~90%",s:"포화 접근",d:"-10",c:"#fbbf24"},{r:"90% 초과",s:"과밀",d:"-25",c:"#f87171"}].forEach(function(e,t){A+='<div style="display:flex;justify-content:space-between;padding:1px 0;font-size:8px;'+(t===ie?"background:rgba(52,211,153,.1);border-radius:2px;padding:2px 4px;":"")+'"><span style="color:#94a3b8">'+e.r+'</span><span style="color:#94a3b8">'+e.s+'</span><span style="color:'+e.c+';font-weight:700">'+e.d+"</span></div>"}),A=A+('<div style="font-size:8px;color:#475569;margin-top:2px">현재: '+v.toFixed(1)+"%</div></div>")+'<div style="font-size:8px;color:#64748b;margin-bottom:4px">▶ 감점 내역</div>',k.forEach(function(e){var t=0===e.d?"#67e8f9":-10<=e.d?"#fbbf24":"#f87171";A+='<div style="display:flex;justify-content:space-between;padding:2px 0;font-size:9px"><span style="color:#cbd5e1">'+e.r+'</span><span style="color:'+t+';font-weight:700;white-space:nowrap;margin-left:8px">'+(0===e.d?"±0":e.d)+"</span></div>"}),A+='<div style="border-top:1px solid #334155;margin-top:4px;padding-top:4px;display:flex;justify-content:space-between;font-size:10px;font-weight:700"><span style="color:#e2e8f0">최종</span><span style="color:'+(80<=M?"#34d399":60<=M?"#fbbf24":"#f87171")+'">'+M+"점</span></div>",se.innerHTML=A,oe.onclick=function(){var e="none"!==se.style.display;se.style.display=e?"none":"block",oe.textContent="📊 점수 산출 근거 "+(e?"▸":"▾")},z.appendChild(oe),z.appendChild(se),e.forEach(function(e){var t,a="ok"===e.t?"sp-aisle-ok":"warn"===e.t?"sp-aisle-warn":"sp-aisle-bad",n=document.createElement("div");n.className="sp-aisle "+a,n.textContent=e.msg+(e.action?" ▶ 상세":""),e.action&&(t=e.action,n.style.cursor="pointer",n.onclick=function(){spToggleSection(t)}),z.appendChild(n)}),Math.floor(.5*r/1.71)),g=Math.floor(.5*r/.855),le=document.createElement("div"),H=(le.style.cssText="font-size:10px;color:#a78bfa;cursor:pointer;margin:10px 0 4px;font-weight:700;user-select:none;padding:5px 8px;background:rgba(139,92,246,.08);border-radius:5px;border:1px solid rgba(139,92,246,.2)",le.textContent="🤖 AI 공간 최적화 추천 ▸",document.createElement("div")),L=(H.id="sp-ai-body",H.style.cssText="display:none;margin:4px 0;padding:8px;background:rgba(15,23,42,.7);border-radius:6px;border:1px solid rgba(139,92,246,.15);font-size:10px;color:#cbd5e1;line-height:1.6",le.onclick=function(){var e="none"!==H.style.display;H.style.display=e?"none":"block",le.textContent="🤖 AI 공간 최적화 추천 "+(e?"▸":"▾")},{}),de=(y.forEach(function(e){var t=e.s;L[t]||(L[t]={cnt:0,nm:{}}),L[t].cnt++,L[t].nm[e.a]||(L[t].nm[e.a]=0),L[t].nm[e.a]++}),{mx48:"RSC48",mx16:"RSC16",hsm:"HSM",semi:"Semi",spare:"SP",etc:"기타"}),N=[],ce=[],T=(y.forEach(function(e){var t=rpx(e);ce.push({x1:e.x,y1:e.y,x2:e.x+t.w,y2:e.y+t.h})}),zones.forEach(function(e){var t=BX+e.x,a=BY+e.y;0<getIntersectArea(s,i,l,d,t,a,t+e.w,a+e.h)&&ce.push({x1:t,y1:a,x2:t+e.w,y2:a+e.h})}),mm(1e3)),pe=Math.floor((l-s)/T),ue=Math.floor((d-i)/T),xe=BY+mm(12900);for(var he=[],I=0;I<ue;I++){he[I]=[];for(var W=0;W<pe;W++){var ye=s+W*T,me=i+I*T,fe=ye+T,ge=me+T;if(C=(me+ge)/2,(G=(ye+fe)/2)>=BX&&G<BX+WHW&&C>=BY&&C<BY+WHH||G>=BX+WHW&&G<982&&xe<=C&&C<BY+WHH){for(var be=!1,ve=0;ve<ce.length;ve++){var we=ce[ve];if(we.x1<fe&&we.x2>ye&&we.y1<ge&&we.y2>me){be=!0;break}}he[I][W]=be?1:0}else he[I][W]=1}}for(var Ce=[],I=0;I<ue;I++){Ce[I]=[];for(W=0;W<pe;W++)Ce[I][W]=!1}for(I=0;I<ue;I++)for(var Ee,Se,Me,Be,ke,ze,Ae,He,Le,Ne,W=0;W<pe;W++)Ce[I][W]||he[I][W]||2<=(Le=((e,t)=>{for(var a=[],n=[[e,t]];n.length;){var r=n.pop(),o=r[0],s=r[1];o<0||ue<=o||s<0||pe<=s||Ce[o][s]||he[o][s]||(Ce[o][s]=!0,a.push(r),n.push([o-1,s],[o+1,s],[o,s-1],[o,s+1]))}return a})(I,W)).length&&(Se=Ee=1/0,Be=Me=-1/0,Le.forEach(function(e){Ee=Math.min(Ee,e[1]),Se=Math.min(Se,e[0]),Me=Math.max(Me,e[1]),Be=Math.max(Be,e[0])}),ke=s+Ee*T,ze=i+Se*T,Ae=s+(Me+1)*T,He=i+(Be+1)*T,Le=Le.length*(T/S)*(T/S)/1e6,Ne=(Ne="")+(ke<s+.3*(l-s)?"좌측":s+.7*(l-s)<Ae?"우측":"중앙")+(ze<i+.3*(d-i)?" 상단":i+.7*(d-i)<He?" 하단":" 중간"),N.push({loc:Ne,mm:Math.round(Math.max(Ae-ke,He-ze)/S),px1:ke,py1:ze,px2:Ae,py2:He,m2:Le}));N.sort(function(e,t){return t.m2-e.m2});y.filter(function(e){return"custom"!==e.t}).slice().sort(function(e,t){return e.x-t.x});var v=y.filter(function(e){return"custom"!==e.t}).slice().sort(function(e,t){return e.y-t.y}),O="";O=(O=(O=(O=(O=(O=O+'<div style="color:#a78bfa;font-weight:700;margin-bottom:4px">📋 현황 요약</div>'+'<div style="padding:4px 8px;margin-bottom:8px;background:rgba(30,41,59,.5);border-radius:4px">')+("전체 <b>"+t.toFixed(1)+"m²</b> → 랙 <b>"+n.toFixed(1)+"m²</b>("+f.toFixed(1)+"%), "))+("존 <b>"+a.toFixed(1)+"m²</b>("+q.toFixed(1)+"%), "))+("통로 <b>"+o.toFixed(1)+"m²</b>("+j.toFixed(1)+"%), "))+('미활용 <b style="color:#fbbf24">'+r.toFixed(1)+"m²</b>("+b.toFixed(1)+"%)</div>"))+'<div style="color:#a78bfa;font-weight:700;margin-bottom:4px">📦 랙 구성</div>'+'<div style="padding:4px 8px;margin-bottom:8px;background:rgba(30,41,59,.5);border-radius:4px">',Object.keys(L).forEach(function(e){var t=L[e],a=Object.keys(t.nm).map(function(e){return e+"("+t.nm[e]+")"}).join(", ");O+="<div>"+(de[e]||e)+": <b>"+t.cnt+"개</b> — "+a+"</div>"}),O+="</div>",0<N.length&&(O+='<div style="color:#a78bfa;font-weight:700;margin-bottom:4px">📍 여유 공간 위치 <span style="color:#64748b;font-weight:400;font-size:9px">(클릭 → 위치 확인)</span></div><div style="padding:4px 8px;margin-bottom:8px;background:rgba(30,41,59,.5);border-radius:4px">',N.forEach(function(e,t){O=(O+='<div class="sp-ai-click" data-gapidx="'+t+'" style="cursor:pointer;padding:3px 4px;margin:2px 0;border-radius:3px;border:1px solid transparent">')+'🟡 <b style="color:#fbbf24">'+e.loc+"</b>: ~<b>"+e.m2.toFixed(1)+"m²</b></div>"}),O+="</div>"),_simGaps=N,_simYSR=v,_simUnusedM2=r,_simEstL=g,O=O+'<div style="color:#a78bfa;font-weight:700;margin-bottom:4px">💡 최적화 추천</div>'+'<div style="padding:4px 8px;background:rgba(30,41,59,.5);border-radius:4px">',0<(_simEstH=E)&&3<r&&(O=(O=(O+='<div style="margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid #1e293b"><span style="color:#34d399;font-weight:700">▸ 추가 배치 가능</span> <span class="sp-sim-btn" data-action="unused" style="cursor:pointer;font-size:9px;color:#fbbf24;background:rgba(251,191,36,.1);border:1px solid rgba(251,191,36,.3);padding:1px 6px;border-radius:3px;margin-left:4px">🔍 위치 보기</span><br>')+"미활용 <b>"+r.toFixed(1)+"m²</b> 중 통로(1m) 확보 후:<br>• 중량랙(900×900): 약 <b>"+E+"개</b><br>")+"• 경량랙(900×450): 약 <b>"+g+"개</b></div>"),1<v.length&&(k=((v[v.length-1].y-v[0].y)/S/1e3).toFixed(1),O=(O+='<div style="margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid #1e293b"><span style="color:#67e8f9;font-weight:700">▸ 동선 분석</span> <span class="sp-sim-btn" data-action="movement" style="cursor:pointer;font-size:9px;color:#f87171;background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);padding:1px 6px;border-radius:3px;margin-left:4px">🔍 동선 보기</span><br>')+"랙 간 최대 Y축 거리: <b>"+k+"m</b> ("+v[0].a+" ↔ "+v[v.length-1].a+")<br>",20<parseFloat(k)?O+='<span style="color:#fbbf24">권고:</span> 고빈도 출고 품목을 출입구 인근(하단)에, 저빈도 품목을 상단에 배치':15<parseFloat(k)?O+="동선이 다소 긴 편. 출고 빈도에 따른 랙 배치 순서 검토":O+="동선 길이 적정 범위",O+="</div>"),5<r&&(O=(O=(O+='<div style="margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid #1e293b"><span style="color:#67e8f9;font-weight:700">▸ 신모델 런칭 대응</span><br>')+"미활용 <b>"+r.toFixed(1)+'m²</b> 기준 시뮬레이션:<br><div style="display:flex;gap:4px;margin:6px 0">')+'<span class="sp-sim-btn" data-action="simA" style="cursor:pointer;flex:1;text-align:center;font-size:9px;font-weight:700;color:#34d399;background:rgba(52,211,153,.08);border:1px solid rgba(52,211,153,.3);padding:4px 2px;border-radius:4px">A: 경량 '+g+'개<br>미리보기</span><span class="sp-sim-btn" data-action="simB" style="cursor:pointer;flex:1;text-align:center;font-size:9px;font-weight:700;color:#60a5fa;background:rgba(96,165,250,.08);border:1px solid rgba(96,165,250,.3);padding:4px 2px;border-radius:4px">B: 중량 '+E+"개<br>미리보기</span>",Math.floor(.5*E),Math.floor(.5*g),O+='<span class="sp-sim-btn" data-action="simC" style="cursor:pointer;flex:1;text-align:center;font-size:9px;font-weight:700;color:#fbbf24;background:rgba(251,191,36,.08);border:1px solid rgba(251,191,36,.3);padding:4px 2px;border-radius:4px">C: 혼합<br>미리보기</span></div><span style="color:#94a3b8;font-size:9px">※ 편측 통로 1m 확보 기준. 클릭하면 배치도에 반투명 가상 랙 표시</span></div>'),O+='<div style="border-top:1px solid #334155;margin-top:6px;padding-top:6px;color:#e2e8f0">',90<=M?O+='<b style="color:#34d399">종합 의견:</b> 현재 배치가 매우 효율적입니다. 통로·랙·존의 균형이 잘 잡혀 있습니다.':70<=M?(O+='<b style="color:#34d399">종합 의견:</b> 전반적으로 양호한 배치입니다.',10<r&&(O+=" 미활용 공간 활용 여지 있음."),0<h&&(O+=" 위험 통로 "+h+"곳 개선 필요.")):O+=50<=M?'<b style="color:#fbbf24">종합 의견:</b> 개선 필요. 통로 안전 확보와 공간 재배치 검토.':'<b style="color:#f87171">종합 의견:</b> 배치 재설계 권고.',O+="</div></div>",H.innerHTML=O,H.querySelectorAll(".sp-ai-click").forEach(function(t){t.addEventListener("click",function(){var e=parseInt(t.getAttribute("data-gapidx")),e=N[e];e&&spHighlightArea(e.px1,e.py1,e.px2,e.py2,e.loc+" ~"+e.m2.toFixed(1)+"m²","rgba(251,191,36,.12)")})}),H.querySelectorAll(".sp-sim-btn").forEach(function(t){t.addEventListener("click",function(){var e=t.getAttribute("data-action");"unused"===e?spShowUnused():"movement"===e?spShowMovement():"simA"===e?spSimulate("A"):"simB"===e?spSimulate("B"):"simC"===e&&spSimulate("C")})}),z.appendChild(le),z.appendChild(H)}e=new Date,t=document.getElementById("sp-updated");t&&(t.textContent=e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0"));try{renderCorridorOverlay(c)}catch(e){}}var _simGaps=[],_simYSR=[],_simUnusedM2=0,_simEstH=0,_simEstL=0;function spClearSim(){document.querySelectorAll(".sp-sim,.sp-sim-arrow,.sp-sim-ghost").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)}),document.querySelectorAll(".rk,.zone,.txl").forEach(function(e){e.style.opacity="",e.style.filter=""}),CV.style.background=""}function spShowUnused(){var e;spClearSim(),document.querySelectorAll(".rk,.zone,.txl").forEach(function(e){e.style.opacity="0.15",e.style.filter="grayscale(1)"}),_simGaps.length?(_simGaps.forEach(function(e){var t=document.createElement("div"),a=(t.className="sp-sim",(e.m2||(e.px2-e.px1)/S*(e.py2-e.py1)/S/1e6).toFixed(1)),n=(t.style.cssText="position:absolute;z-index:17;pointer-events:none;border-radius:4px;left:"+e.px1+"px;top:"+e.py1+"px;width:"+(e.px2-e.px1)+"px;height:"+(e.py2-e.py1)+"px;background:rgba(251,191,36,.15);border:2px dashed rgba(251,191,36,.5);animation:spPulse 1.5s infinite alternate",document.createElement("div"));n.style.cssText="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:10px;font-weight:700;color:#fbbf24;text-shadow:0 1px 3px rgba(0,0,0,.9);background:rgba(15,23,42,.85);padding:2px 8px;border-radius:4px;white-space:nowrap",n.textContent=e.loc+" ~"+a+"m²",t.appendChild(n),CV.appendChild(t)}),0<_simGaps.length&&(CA.scrollLeft=_simGaps[0].px1*Z-CA.clientWidth/2,CA.scrollTop=_simGaps[0].py1*Z-CA.clientHeight/2),setTimeout(spClearSim,6e3)):((e=document.createElement("div")).className="sp-sim",e.style.cssText="position:fixed;top:60px;left:50%;transform:translateX(-50%);z-index:300;background:rgba(15,23,42,.95);border:1px solid #fbbf24;color:#fbbf24;padding:8px 16px;border-radius:8px;font-size:12px;font-weight:600;pointer-events:auto;cursor:pointer",e.textContent="미활용 공간이 랑/존 사이에 분산되어 있습니다 (클릭: 닫기)",e.onclick=spClearSim,document.body.appendChild(e),setTimeout(spClearSim,4e3))}function spShowMovement(){var e,t,a,n,r,o,s,i,l;spClearSim(),document.querySelectorAll(".rk,.zone,.txl").forEach(function(e){e.style.opacity="0.15",e.style.filter="grayscale(1)"}),_simYSR.length<2||(e=_simYSR[0],t=_simYSR[_simYSR.length-1],a=rpx(e),n=rpx(t),r=e.x+a.w/2,o=e.y+a.h/2,i=t.x+n.w/2,l=t.y+n.h/2,(s=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("class","sp-sim-arrow"),s.style.cssText="position:absolute;left:0;top:0;width:"+CW+"px;height:"+CH+"px;z-index:17;pointer-events:none",s.innerHTML='<defs><marker id="ah" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><polygon points="0 0, 8 3, 0 6" fill="#f87171"/></marker><marker id="ah2" markerWidth="8" markerHeight="6" refX="0" refY="3" orient="auto"><polygon points="8 0, 0 3, 8 6" fill="#f87171"/></marker></defs><line x1="'+r+'" y1="'+o+'" x2="'+i+'" y2="'+l+'" stroke="#f87171" stroke-width="2" stroke-dasharray="8,4" marker-end="url(#ah)" marker-start="url(#ah2)"/>',i=(o+l)/2,l=(Math.abs(l-o)/S/1e3).toFixed(1),s.innerHTML+='<rect x="'+(r-40)+'" y="'+(i-10)+'" width="80" height="20" rx="4" fill="rgba(15,23,42,.9)" stroke="#f87171" stroke-width="1"/><text x="'+r+'" y="'+(4+i)+'" text-anchor="middle" fill="#f87171" font-size="11" font-weight="700" font-family="monospace">'+l+"m</text>",CV.appendChild(s),[{r:e,rp:a,l:"상단"},{r:t,rp:n,l:"하단"}].forEach(function(e){var t=document.createElement("div"),a=(t.className="sp-sim",t.style.cssText="position:absolute;z-index:17;pointer-events:none;left:"+e.r.x+"px;top:"+e.r.y+"px;width:"+e.rp.w+"px;height:"+e.rp.h+"px;border:3px solid #f87171;border-radius:4px;background:rgba(239,68,68,.15)",document.createElement("div"));a.style.cssText="position:absolute;top:-16px;left:0;font-size:9px;color:#f87171;font-weight:700;background:rgba(15,23,42,.85);padding:1px 5px;border-radius:3px",a.textContent=e.l+" "+e.r.a,t.appendChild(a),CV.appendChild(t)}),CA.scrollLeft=r*Z-CA.clientWidth/2,CA.scrollTop=o*Z-100,setTimeout(spClearSim,8e3))}function spSimulate(e){spClearSim(),document.querySelectorAll(".rk,.zone,.txl").forEach(function(e){e.style.opacity="0.08",e.style.filter="grayscale(1)"}),CV.style.background="rgba(15,23,42,.95)";var a=["Packaging Foam","Spare Part Box","Yellow Box","8160 Area","Test Area","Final QC Area","Defect Area"];function t(e){for(var t=0;t<a.length;t++)if(e.n===a[t])return 1;return!!e.excl}function n(e){var t=e.a.toUpperCase();return 0<=t.indexOf("DOOR")||0<=t.indexOf("PILLAR")||0<=e.a.indexOf("기둥")}var r,o,s,i=[],l={racks:0,zones:0,custom:0,fixed:0,skippedRacks:[],skippedZones:[]},d=(R.forEach(function(e){var t;n(e)?(l.fixed++,l.skippedRacks.push(e.a+" (고정)")):(t=rpx(e),i.push({a:e.a,s:e.s,t:e.t,w:t.w,h:t.h,col:e.s}),l.racks++)}),zones.forEach(function(e){t(e)?(l.fixed++,l.skippedZones.push(e.n+" (고정)")):(i.push({a:e.n,s:"zone",t:"zone",w:e.w,h:e.h,col:"zone"}),l.zones++)}),console.log("[SIM] 수집: 랙 "+l.racks+"개, 존 "+l.zones+"개, 고정 "+l.fixed+"개"),console.log("[SIM] 고정 랙:",l.skippedRacks),console.log("[SIM] 고정 존:",l.skippedZones),console.log("[SIM] 이동 항목:",i.map(function(e){return e.a}).join(", ")),0);if("A"===e)d=_simEstL,r=mm(900),o=mm(450),s="mx16";else if("B"===e)d=_simEstH,r=mm(900),o=mm(900),s="mx48";else{for(var c=Math.floor(.5*_simEstH),p=Math.floor(.5*_simEstL),u=0;u<c;u++)i.push({a:"NEW",s:"mx48",t:"heavy",w:mm(900),h:mm(900),col:"mx48",isNew:!0});for(u=0;u<p;u++)i.push({a:"NEW",s:"mx16",t:"light",w:mm(900),h:mm(450),col:"mx16",isNew:!0});d=0}for(u=0;u<d;u++)i.push({a:"NEW",s:s,t:"mx48"===s?"heavy":"light",w:r,h:o,col:s,isNew:!0});var x=[],h=(zones.forEach(function(e){t(e)&&x.push({x:BX+e.x,y:BY+e.y,w:e.w,h:e.h,n:e.n})}),R.forEach(function(e){var t;n(e)&&(t=rpx(e),x.push({x:e.x,y:e.y,w:t.w,h:t.h,n:e.a}))}),zones.forEach(function(e){"Spare Part Box"!==e.n&&"Packaging Foam"!==e.n||x.push({x:BX+e.x+e.w,y:BY+e.y,w:mm(2e3),h:e.h,n:e.n+" 불출"})}),zones.forEach(function(e){e.n.indexOf("8160")<0||x.push({x:BX+e.x,y:BY+e.y+e.h,w:e.w,h:mm(2e3),n:"8160 출입구"})}),R.forEach(function(e){var t,a;e.a.toUpperCase().indexOf("DOOR")<0||(t=rpx(e),a=mm(2e3),x.push({x:e.x,y:Math.max(BY,e.y-a),w:t.w,h:a,n:"DOOR통행"}),x.push({x:e.x,y:e.y+t.h,w:t.w,h:Math.min(a,BY+WHH-e.y-t.h),n:"DOOR통행"}))}),R.forEach(function(e){var t,a;e.a.toUpperCase().indexOf("DOOR")<0||e.y>BY+WHH/2||(t=rpx(e),a=mm(1500),x.push({x:e.x+t.w/2-a/2,y:e.y+t.h+mm(2e3),w:a,h:mm(8e3),n:"입고동선"}))}),zones.forEach(function(e){"Packaging Foam"===e.n&&x.push({x:BX+e.x+e.w,y:BY+e.y-mm(500),w:mm(3e3),h:mm(3e3),n:"폼입고"})}),BY+mm(12900)),y=mm(300),m=mm(1e3),f=mm(1500),g=mm(300),b={},v=(i.forEach(function(e){b[e.s]||(b[e.s]=[]),b[e.s].push(e)}),[]);function w(e,t,a,n){e+=a/2,a=t+n/2;return e>=BX&&e<=BX+WHW&&a>=BY&&a<=BY+WHH||e>BX+WHW&&e<=982&&h<=a&&a<=BY+WHH}function C(e,t,a,n){for(var r=g,o=mm(200),s=0;s<x.length;s++){var i=x[s];if(e<i.x+i.w+r&&e+a+r>i.x&&t<i.y+i.h+o&&t+n+o>i.y)return 1}for(var l=0;l<v.length;l++){var d=v[l];if(e<d.x+d.w+r&&e+a+r>d.x&&t<d.y+d.h+o&&t+n+o>d.y)return 1}}function E(e){return e<h?BX+WHW-y:982-y}var S=BY+y,M=(["mx48","mx16","hsm","semi","spare","etc","zone"].forEach(function(e){var o,s,e=b[e];e&&e.length&&(e.sort(function(e,t){return t.h-e.h||t.w-e.w}),o=BX+y,s=0,e.forEach(function(e){var t=e.w,a=e.h,n=E(S);if(n<o+t&&(S+=s+m,o=BX+y,s=0),E(S)<o+t&&(S+=s+m,o=BX+y,s=0,E(S)),!(S+a>BY+WHH)){for(var r=0;C(o,S,t,a)&&r<100;){if((o+=mm(500))+t>E(S)&&(S+=s+m,o=BX+y,s=0,S+a>BY+WHH))return;r++}w(o,S,t,a)&&!C(o,S,t,a)&&(v.push({x:o,y:S,w:t,h:a,s:e.s,a:e.a,isNew:e.isNew||!1}),e._placed=!0,o+=t+g,s<a)&&(s=a)}}),S+=s+f)}),i.filter(function(e){return!e._placed}).forEach(function(e){for(var t=BY+y;t<BY+WHH-e.h;t+=mm(500)){for(var a=BX+y;a<982-e.w;a+=mm(500))if(w(a,t,e.w,e.h)&&!C(a,t,e.w,e.h)){v.push({x:a,y:t,w:e.w,h:e.h,s:e.s,a:e.a,isNew:e.isNew||!1}),e._placed=!0;break}if(e._placed)break}}),i.filter(function(e){return!e._placed})),B=M.length,M=M.map(function(e){return e.a}).join(", "),k=(console.log("[SIM] 배치됨:",v.length,"미배치:",B,M),x.forEach(function(e){var t=document.createElement("div"),a=(t.className="sp-sim-ghost",e.n&&(0<=e.n.indexOf("DOOR")||0<=e.n.indexOf("통행")||0<=e.n.indexOf("동선")||0<=e.n.indexOf("입고")||0<=e.n.indexOf("폼")||0<=e.n.indexOf("불출")||0<=e.n.indexOf("출입")));t.style.cssText="position:absolute;z-index:16;pointer-events:none;left:"+e.x+"px;top:"+e.y+"px;width:"+e.w+"px;height:"+e.h+"px;background:"+(a?"rgba(239,68,68,.08)":"rgba(100,116,139,.2)")+";border:1.5px "+(a?"dashed rgba(239,68,68,.3)":"solid rgba(100,116,139,.4)")+";border-radius:3px;display:flex;align-items:center;justify-content:center;font-size:8px;color:"+(a?"rgba(239,68,68,.5)":"rgba(148,163,184,.7)")+";font-weight:600",t.textContent=e.n||"",CV.appendChild(t)}),{mx48:"rgba(220,38,38,.4)",mx16:"rgba(37,99,235,.4)",hsm:"rgba(217,119,6,.4)",semi:"rgba(234,179,8,.4)",spare:"rgba(124,58,237,.4)",etc:"rgba(148,163,184,.3)",zone:"rgba(34,197,94,.3)"}),z={mx48:"#ef4444",mx16:"#3b82f6",hsm:"#f59e0b",semi:"#eab308",spare:"#8b5cf6",etc:"#94a3b8",zone:"#22c55e"},A=0,H=0,L=0,N=(v.forEach(function(e){var t=document.createElement("div"),a=(t.className="sp-sim-ghost",e.isNew?"rgba(52,211,153,.5)":"zone"===e.s?"rgba(34,197,94,.3)":k[e.s]||"rgba(148,163,184,.3)"),n=e.isNew?"#34d399":"zone"===e.s?"#22c55e":z[e.s]||"#94a3b8";t.style.cssText="position:absolute;z-index:17;pointer-events:none;left:"+e.x+"px;top:"+e.y+"px;width:"+e.w+"px;height:"+e.h+"px;background:"+a+";border:1.5px "+(e.isNew?"solid":"dashed")+" "+n+";border-radius:2px;display:flex;align-items:center;justify-content:center;font-size:"+(e.isNew?"9":"8")+"px;color:rgba(255,255,255,.9);font-weight:700;text-shadow:0 1px 3px rgba(0,0,0,.8)",t.textContent=e.isNew?"NEW":e.a,CV.appendChild(t),e.isNew?A++:"zone"===e.s?L++:H++}),document.createElement("div"));N.className="sp-sim",N.style.cssText="position:fixed;top:60px;left:50%;transform:translateX(-50%);z-index:300;background:rgba(15,23,42,.95);border:1px solid "+("A"===e?"#60a5fa":"B"===e?"#f87171":"#fbbf24")+";color:#e2e8f0;padding:8px 16px;border-radius:8px;font-size:12px;font-weight:600;pointer-events:auto;cursor:pointer;max-width:400px;text-align:center",N.innerHTML='<div style="font-size:14px;margin-bottom:4px">Option '+e+" 시뮬레이션</div><div>랙 "+H+" + 구역 "+L+' + 신규 <b style="color:'+("A"===e?"#60a5fa":"B"===e?"#f87171":"#fbbf24")+'">'+A+"</b> = 총 "+(H+L+A)+"개"+(0<B?' <span style="color:#f87171">(미배치 '+B+": "+M+")</span>":"")+'</div><div style="font-size:9px;color:#94a3b8;margin-top:4px"><span style="color:#ef4444">■</span>RSC48 <span style="color:#3b82f6">■</span>RSC16 <span style="color:#f59e0b">■</span>HSM <span style="color:#eab308">■</span>Semi <span style="color:#22c55e">■</span>구역 <span style="color:#34d399">■</span>NEW <span style="color:#64748b">■</span>고정 | 클릭하면 닫힘</div>',N.onclick=spClearSim,document.body.appendChild(N),CA.scrollLeft=BX*Z,CA.scrollTop=BY*Z}function renderCorridorOverlay(e){var c,t;document.querySelectorAll(".sp-corridor-ov,.sp-total-ov").forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)}),spPanelOpen&&"area"!==mode&&0!==spOvMode&&(1===spOvMode&&e&&0<e.length&&((c=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("class","sp-corridor-ov"),c.style.cssText="position:absolute;left:0;top:0;width:"+CW+"px;height:"+CH+"px;z-index:16;pointer-events:none",e.forEach(function(e){var a,n,r,t,o,s,i,l,d;!e||e.w<=0||e.h<=0||(a="bad"===e.status?"#f87171":"warn"===e.status?"#fbbf24":"#67e8f9",n="ok"===e.status?"0.4":"0.9","X"===e.dir?(r=e.y+e.h/2,t=e.x+e.w/2,o=r-6,i=Math.min(8,e.h/2),[e.x,e.x+e.w].forEach(function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","line");t.setAttribute("x1",e),t.setAttribute("y1",r-i),t.setAttribute("x2",e),t.setAttribute("y2",r+i),t.setAttribute("stroke",a),t.setAttribute("stroke-width","1.5"),t.setAttribute("opacity",n),c.appendChild(t)}),l=Math.min(.2*e.w,10),[{x1:e.x,x2:e.x+l},{x1:e.x+e.w-l,x2:e.x+e.w}].forEach(function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","line");t.setAttribute("x1",e.x1),t.setAttribute("y1",r),t.setAttribute("x2",e.x2),t.setAttribute("y2",r),t.setAttribute("stroke",a),t.setAttribute("stroke-width","1"),t.setAttribute("stroke-dasharray","3,2"),t.setAttribute("opacity",n),c.appendChild(t)})):(t=(s=e.x+e.w/2)+4,o=e.y+e.h/2,i=Math.min(8,e.w/2),[e.y,e.y+e.h].forEach(function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","line");t.setAttribute("x1",s-i),t.setAttribute("y1",e),t.setAttribute("x2",s+i),t.setAttribute("y2",e),t.setAttribute("stroke",a),t.setAttribute("stroke-width","1.5"),t.setAttribute("opacity",n),c.appendChild(t)}),l=Math.min(.2*e.h,10),[{y1:e.y,y2:e.y+l},{y1:e.y+e.h-l,y2:e.y+e.h}].forEach(function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","line");t.setAttribute("x1",s),t.setAttribute("y1",e.y1),t.setAttribute("x2",s),t.setAttribute("y2",e.y2),t.setAttribute("stroke",a),t.setAttribute("stroke-width","1"),t.setAttribute("stroke-dasharray","3,2"),t.setAttribute("opacity",n),c.appendChild(t)})),e=5*(l=(e.gapMM/1e3).toFixed(2)+"m").length+6,(d=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("x",t-e/2),d.setAttribute("y",o-6),d.setAttribute("width",e),d.setAttribute("height",12),d.setAttribute("rx","2"),d.setAttribute("fill","rgba(15,23,42,.85)"),c.appendChild(d),(e=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",t),e.setAttribute("y",o+3),e.setAttribute("text-anchor","middle"),e.setAttribute("fill",a),e.setAttribute("font-size","8"),e.setAttribute("font-weight","700"),e.setAttribute("font-family","monospace"),e.textContent=l,c.appendChild(e))}),CV.appendChild(c)),2===spOvMode)&&(e=BY+mm(12900),(t=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("class","sp-total-ov"),t.style.cssText="position:absolute;left:0;top:0;width:"+CW+"px;height:"+CH+"px;z-index:3;pointer-events:none",e="M "+BX+" "+BY+" L "+(BX+WHW)+" "+BY+" L "+(BX+WHW)+" "+e+" L 982 "+e+" L 982 "+(BY+WHH)+" L "+BX+" "+(BY+WHH)+" Z",t.innerHTML='<path d="'+e+'" fill="rgba(139,92,246,.1)" stroke="rgba(139,92,246,.3)" stroke-width="2" stroke-linejoin="round"/>',CV.appendChild(t),e=Math.max(0,selM2_global-rackM2_global-zoneM2_global-exclM2_global),(t=document.createElement("div")).className="sp-total-ov",t.style.cssText="position:absolute;z-index:18;pointer-events:none;left:"+(BX+4)+"px;top:"+(BY+WHH+4)+"px;font-size:10px;color:#a78bfa;background:rgba(15,23,42,.9);padding:3px 8px;border-radius:4px;border:1px solid rgba(139,92,246,.3);font-weight:600",t.textContent="생산창고 통로: "+e.toFixed(1)+"m² (117.91평 기준)",CV.appendChild(t))}function upStats(){var e=R.filter(e=>"heavy"===e.t).length,t=R.filter(e=>"light"===e.t).length,a=R.filter(e=>"custom"===e.t).length;document.getElementById("stats").textContent="랙 "+(e+t)+" (중량"+e+"/경량"+t+")"+(a?" · 기타 "+a:"")+" · 선택 "+(sel.size+selZ.size)+" · 측정 "+rulers.length+" · 선 "+lines.length+" · 면적 "+areas.length}function showConfirm(e,a){var n=document.createElement("div"),t=(n.className="edit-modal",document.createElement("div")),r=(t.className="edit-box",document.createElement("h4")),r=(r.textContent="확인",t.appendChild(r),document.createElement("div")),e=(r.textContent=e,r.style.cssText="font-size:12px;color:#e2e8f0;margin:12px 0",t.appendChild(r),document.createElement("div")),r=(e.style.cssText="display:flex;gap:6px;margin-top:14px",document.createElement("button")),o=(r.textContent="예 (Enter)",r.style.cssText="flex:1;padding:7px;border:none;border-radius:5px;font-size:12px;font-weight:600;cursor:pointer;background:#dc2626;color:#fff;font-family:inherit",document.createElement("button"));o.textContent="아니오",o.style.cssText="flex:1;padding:7px;border:none;border-radius:5px;font-size:12px;font-weight:600;cursor:pointer;background:#475569;color:#e2e8f0;font-family:inherit",r.addEventListener("click",function(){n.parentNode.removeChild(n),a()}),o.addEventListener("click",function(){n.parentNode.removeChild(n)}),e.appendChild(r),e.appendChild(o),t.appendChild(e),n.appendChild(t),document.body.appendChild(n),document.addEventListener("keydown",function e(t){"Enter"===t.key&&(n.parentNode.removeChild(n),document.removeEventListener("keydown",e),a()),"Escape"===t.key&&(n.parentNode.removeChild(n),document.removeEventListener("keydown",e))}),r.focus()}function showEditModal(e,t,a){for(var n=document.createElement("div"),r=(n.className="edit-modal",document.createElement("div")),o=(r.className="edit-box",document.createElement("h4")),s=(o.textContent=e,r.appendChild(o),[]),i=0;i<t.length;i++){var l,d=t[i],c=document.createElement("label");if(c.textContent=d.label,r.appendChild(c),"color"===d.type){var c=document.createElement("div"),p=(c.style.cssText="display:flex;gap:6px;align-items:center",(l=document.createElement("input")).type="color",l.style.cssText="width:40px;height:28px;border:none;cursor:pointer;background:none",document.createElement("input"));p.value=d.value||"",p.style.cssText="flex:1;background:#0f172a;border:1px solid #334155;color:#e2e8f0;padding:5px 8px;border-radius:4px;font-size:11px";try{var u,x,h,y,m=d.value||"";0===m.indexOf("rgba")||0===m.indexOf("rgb")?(u=m.match(/[\d.]+/g))&&3<=u.length&&(x=parseInt(u[0]),h=parseInt(u[1]),y=parseInt(u[2]),l.value="#"+((1<<24)+(x<<16)+(h<<8)+y).toString(16).slice(1)):0===m.indexOf("#")?l.value=m:l.value="#3b82f6"}catch(e){l.value="#3b82f6"}l.oninput=(e=>function(){e.value=this.value})(p),p.oninput=(a=>function(){var e=this.value;if(0===e.indexOf("#")&&7===e.length)a.value=e;else if(0===e.indexOf("rgb"))try{var t=e.match(/[\d.]+/g);t&&3<=t.length&&(a.value="#"+((1<<24)+(parseInt(t[0])<<16)+(parseInt(t[1])<<8)+parseInt(t[2])).toString(16).slice(1))}catch(e){}})(l),c.appendChild(l),c.appendChild(p),r.appendChild(c),s.push({key:d.key,el:p})}else(l=document.createElement("input")).value=d.value||"",l.style.cssText="width:100%;background:#0f172a;border:1px solid #334155;color:#e2e8f0;padding:5px 8px;border-radius:4px;font-size:11px;font-family:inherit",r.appendChild(l),s.push({key:d.key,el:l})}var e=document.createElement("div"),f=(e.style.cssText="display:flex;gap:6px;margin-top:14px",document.createElement("button")),o=(f.textContent="확인",f.style.cssText="flex:1;padding:7px;border:none;border-radius:5px;font-size:12px;font-weight:600;cursor:pointer;background:#059669;color:#fff;font-family:inherit",document.createElement("button"));function g(e){"Enter"===e.key&&(e.preventDefault(),f.click())}o.textContent="취소",o.style.cssText="flex:1;padding:7px;border:none;border-radius:5px;font-size:12px;font-weight:600;cursor:pointer;background:#475569;color:#e2e8f0;font-family:inherit",f.addEventListener("click",function(){for(var e={},t=0;t<s.length;t++)e[s[t].key]=s[t].el.value;n.parentNode.removeChild(n),a(e)}),o.addEventListener("click",function(){n.parentNode.removeChild(n)}),e.appendChild(f),e.appendChild(o),r.appendChild(e),n.appendChild(r),document.body.appendChild(n);for(var b=0;b<s.length;b++)s[b].el.addEventListener("keydown",g);0<s.length&&s[0].el.focus()}function trySnap(a){var n=rpx(a),r=13,o=null;R.forEach(function(e){var t;e.id===a.id||sel.has(e.id)||(t=rpx(e),[[a.x+n.w,e.x,a.y,e.y,{x:e.x-n.w-3,y:e.y}],[a.x,e.x+t.w,a.y,e.y,{x:e.x+t.w+3,y:e.y}],[a.x,e.x,a.y+n.h,e.y,{x:e.x,y:e.y-n.h-3}],[a.x,e.x,a.y,e.y+t.h,{x:e.x,y:e.y+t.h+3}]].forEach(function(e){var t;Math.abs(e[0]-e[1])<12&&Math.abs(e[2]-e[3])<10&&(t=Math.abs(e[0]-e[1])+Math.abs(e[2]-e[3]))<r&&(r=t,o=e[4])}))}),o&&(a.x=o.x,a.y=o.y)}function tog(e){O[e]=!O[e],document.getElementById("grid"===e?"bG":"bS").classList.toggle("act",O[e]),"snap"===e&&(document.getElementById("snapSt").textContent=O.snap?"스냅 ON":"스냅 OFF"),"grid"===e&&render()}function toggleP(e){document.getElementById(e).classList.toggle("show")}function addRack(){var e=document.getElementById("aA").value.toUpperCase()||"NEW",t=document.getElementById("aT").value,a=document.getElementById("aS").value,n=document.getElementById("aC")?document.getElementById("aC").value:"",r=(CA.scrollLeft+CA.clientWidth/2)/Z,o=(CA.scrollTop+CA.clientHeight/2)/Z,t="custom"===t?"custom":"heavy"===t?"heavy":"light",a={id:nid++,a:e,t:t,s:a,x:Math.round(r),y:Math.round(o),rot:!1};"custom"==t&&(a.cw=parseInt(document.getElementById("aCW").value)||1800,a.ch=parseInt(document.getElementById("aCH").value)||450),n&&(a.cc=n),R.push(a),render(),autoSave(),toast(e+" 추가")}function addZone(){var e=document.getElementById("aZN").value||"새 구역",t=mm(parseInt(document.getElementById("aZW").value)||2e3),a=mm(parseInt(document.getElementById("aZH").value)||1e3),n=document.getElementById("aZC").value,r=(CA.scrollLeft+CA.clientWidth/2)/Z,o=(CA.scrollTop+CA.clientHeight/2)/Z,s=n.replace(".15)","0.5)").replace(".12)","0.5)").replace(".4)","0.6)");zones.push({id:"z"+Date.now(),n:e,x:Math.round(r-BX),y:Math.round(o-BY),w:t,h:a,c:n,b:s}),render(),autoSave(),toast(e+" 구역 추가")}function addPreset(e){var n={table:{a:"TBL",cw:1200,ch:4500,cc:"rgba(20,20,20,.85)",rot:!0},pillar:{a:"PILLAR",cw:500,ch:500,cc:"#6b7280",rot:!1},equip:{a:"EQUIP",cw:2e3,ch:1e3,cc:"#374151",rot:!1},desk:{a:"DESK",cw:1800,ch:600,cc:"#78716c",rot:!1},conveyor:{a:"CONV",cw:3e3,ch:500,cc:"#525252",rot:!1},wall:{a:"WALL",cw:3e3,ch:100,cc:"#9ca3af",rot:!1},pallet:{a:"PLT",cw:1100,ch:1100,cc:"#a16207",rot:!1},door:{a:"DOOR",cw:1500,ch:200,cc:"#065f46",rot:!1}}[e];n&&showEditModal(n.a+" 추가",[{key:"a",label:"이름",value:n.a},{key:"cw",label:"가로 mm",value:""+n.cw},{key:"ch",label:"세로 mm",value:""+n.ch},{key:"cc",label:"색상",value:n.cc,type:"color"}],function(e){var t=(CA.scrollLeft+CA.clientWidth/2)/Z,a=(CA.scrollTop+CA.clientHeight/2)/Z;R.push({id:nid++,a:e.a||n.a,t:"custom",s:"etc",x:Math.round(t),y:Math.round(a),rot:n.rot,cw:parseInt(e.cw)||n.cw,ch:parseInt(e.ch)||n.ch,cc:e.cc||n.cc}),render(),autoSave(),toast((e.a||n.a)+" 추가")})}function delSel(){var e=sel.size+selZ.size;e?showConfirm(e+"개 항목을 삭제하시겠습니까?",function(){R=R.filter(function(e){return!sel.has(e.id)}),zones=zones.filter(function(e,t){return!selZ.has(e.id||"z"+t)}),sel.clear(),selZ.clear(),render(),autoSave(),toast("삭제 완료")}):toast("선택 없음")}CA.addEventListener("mousedown",function(e){if(!drag){var t,a,n=exy(e),r=e.target;if(1===e.button)e.preventDefault(),drag={type:"pan",sx:e.clientX,sy:e.clientY,sl:CA.scrollLeft,st:CA.scrollTop},CA.classList.add("panning");else if(0===e.button)if(r.dataset.rotid)(i=R.find(function(e){return e.id===+r.dataset.rotid}))&&(i.rot=!i.rot,render(),autoSave());else if(void 0!==r.dataset.dtx)txts.splice(+r.dataset.dtx,1),render(),autoSave();else if(void 0!==r.dataset.drl)rulers.splice(+r.dataset.drl,1),render(),autoSave();else{if(void 0!==r.dataset.dli&&r.dataset.dltype)return i=+r.dataset.dli,s=r.dataset.dltype,(o=lines[i])?("move"===s?drag={type:"ld",dli:i,dltype:"move",ox:n.x-(o.x1+o.x2)/2,oy:n.y-(o.y1+o.y2)/2}:"p1"===s?drag={type:"ld",dli:i,dltype:"p1"}:"p2"===s&&(drag={type:"ld",dli:i,dltype:"p2"}),void r.classList.add("dragging")):void 0;if("move"===mode){var o=r.closest(".rk");if(o){var s=+o.dataset.ri,i=R[s];if(e.shiftKey)return sel.add(i.id),updSel(),void upStats();if(e.ctrlKey||e.metaKey)return sel.has(i.id)?sel.delete(i.id):sel.add(i.id),updSel(),void upStats();sel.has(i.id)||(sel.clear(),sel.add(i.id),updSel(),upStats());var l={};return R.forEach(function(e){sel.has(e.id)&&(l[e.id]={dx:e.x-n.x,dy:e.y-n.y})}),drag={type:"gd",off:l,moved:!1},void document.querySelectorAll(".rk").forEach(function(e){sel.has(+e.dataset.id)&&e.classList.add("dragging")})}return void 0!==r.dataset.rh?(o=+r.dataset.rh,void(drag={type:"zr",zi:o,sx:e.clientX,sy:e.clientY,sw:zones[o].w,sh:zones[o].h})):(s=r.closest(".zone"))?(i=+s.dataset.zi,o=s.dataset.zid,e.shiftKey?(selZ.add(o),updSel(),void upStats()):e.ctrlKey||e.metaKey?(selZ.has(o)?selZ.delete(o):selZ.add(o),updSel(),void upStats()):(selZ.has(o)||(selZ.clear(),selZ.add(o),updSel(),upStats()),1<selZ.size?(d={},zones.forEach(function(e,t){selZ.has(e.id||"z"+t)&&(d[e.id||"z"+t]={dx:BX+e.x-n.x,dy:BY+e.y-n.y,idx:t})}),void(drag={type:"zgd",zoff:d,moved:!1})):void(drag={type:"zd",zi:i,ox:n.x-(BX+zones[i].x),oy:n.y-(BY+zones[i].y)}))):(s=r.closest(".txl"))?(o=+s.dataset.ti,void(drag={type:"td",ti:o,ox:n.x-txts[o].x,oy:n.y-txts[o].y})):(drag={type:"pan",sx:e.clientX,sy:e.clientY,sl:CA.scrollLeft,st:CA.scrollTop},void CA.classList.add("panning"))}if("select"===mode)if(void 0!==r.dataset.rh)i=+r.dataset.rh,drag={type:"zr",zi:i,sx:e.clientX,sy:e.clientY,sw:zones[i].w,sh:zones[i].h};else{var d,s=r.closest(".zone");if(s)return o=+s.dataset.zi,i=s.dataset.zid,e.shiftKey?(selZ.add(i),updSel(),void upStats()):e.ctrlKey||e.metaKey?(selZ.has(i)?selZ.delete(i):selZ.add(i),updSel(),void upStats()):(selZ.has(i)||(selZ.clear(),selZ.add(i),updSel(),upStats()),1<selZ.size?(d={},zones.forEach(function(e,t){selZ.has(e.id||"z"+t)&&(d[e.id||"z"+t]={dx:BX+e.x-n.x,dy:BY+e.y-n.y,idx:t})}),void(drag={type:"zgd",zoff:d,moved:!1})):void(drag={type:"zd",zi:o,ox:n.x-(BX+zones[o].x),oy:n.y-(BY+zones[o].y)}));var c,s=r.closest(".txl");s?(i=+s.dataset.ti,drag={type:"td",ti:i,ox:n.x-txts[i].x,oy:n.y-txts[i].y}):(o=r.closest(".rk"))?(s=+o.dataset.ri,i=R[s],e.shiftKey?(sel.add(i.id),updSel(),upStats()):e.ctrlKey||e.metaKey?(sel.has(i.id)?sel.delete(i.id):sel.add(i.id),updSel(),upStats()):(sel.has(i.id)||(sel.clear(),sel.add(i.id),updSel(),upStats()),c={},R.forEach(function(e){sel.has(e.id)&&(c[e.id]={dx:e.x-n.x,dy:e.y-n.y})}),drag={type:"gd",off:c,moved:!1},document.querySelectorAll(".rk").forEach(function(e){sel.has(+e.dataset.id)&&e.classList.add("dragging")}))):(e.shiftKey||sel.clear(),drag={type:"sb",sx:n.x,sy:n.y,shift:e.shiftKey},SB.style.display="block",updSel(),upStats())}else"ruler"===mode?rulerPt?(rulers.push({x1:rulerPt.x,y1:rulerPt.y,x2:n.x,y2:n.y}),rulerPt=null,(o=document.getElementById("rulerStartMk"))&&(o.style.display="none"),(s=document.getElementById("rulerPreviewSvg"))&&s.remove(),render(),autoSave()):(rulerPt={x:n.x,y:n.y},(i=document.getElementById("rulerStartMk"))||((i=document.createElement("div")).id="rulerStartMk",i.style.cssText="position:absolute;width:12px;height:12px;border-radius:50%;background:#f59e0b;border:2px solid #fff;box-shadow:0 0 8px rgba(245,158,11,.8);pointer-events:none;z-index:9999;transform:translate(-50%,-50%)",CV.appendChild(i)),i.style.left=n.x+"px",i.style.top=n.y+"px",i.style.display="block",document.getElementById("rulerPreviewSvg")||((e=document.createElementNS("http://www.w3.org/2000/svg","svg")).id="rulerPreviewSvg",e.style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:9998",e.innerHTML='<line id="rulerPrevLine" stroke="#f59e0b" stroke-width="2" stroke-dasharray="6,4"/>',CV.appendChild(e)),toast("📏 두번째 점을 클릭하세요")):"area"===mode?areaPt?(areas.push({id:naid++,x1:areaPt.x,y1:areaPt.y,x2:n.x,y2:n.y}),areaPt=null,render(),autoSave(),spPanelOpen&&setTimeout(runSpAnalysis,100)):(areaPt={x:n.x,y:n.y},toast("⬜ 반대 꼭짓점을 클릭하세요")):"line"===mode?(o=document.getElementById("lineColor")?document.getElementById("lineColor").value:"#ffffff",s=document.getElementById("lineWidth")&&parseInt(document.getElementById("lineWidth").value)||2,i=lineArrow,linePt?(lines.push({id:nlid++,x1:linePt.x,y1:linePt.y,x2:n.x,y2:n.y,style:lineStyle,color:o,width:s,arrow:i}),linePt=null,render(),autoSave(),toast("선 추가됨 (클릭으로 삭제)")):(linePt={x:n.x,y:n.y},toast("✏ 두 번째 점을 클릭하세요"))):"text"===mode&&(t=Math.round(n.x),a=Math.round(n.y),showEditModal("텍스트 추가",[{key:"text",label:"텍스트",value:""},{key:"fs",label:"글자(px)",value:"12"}],function(e){e.text&&(txts.push({id:ntid++,text:e.text,x:t,y:a,fs:parseInt(e.fs)||12}),render(),autoSave())}))}}}),document.addEventListener("mousemove",function(e){if(drag){document.getElementById("tip").style.display="none";var r,o,s,i,t,l=exy(e);"pan"===drag.type?(CA.scrollLeft=drag.sl-(e.clientX-drag.sx),CA.scrollTop=drag.st-(e.clientY-drag.sy)):"gd"===drag.type?(drag.moved=!0,R.forEach(function(e){var t,a;sel.has(e.id)&&(a=l.x+drag.off[e.id].dx,t=l.y+drag.off[e.id].dy,O.snap&&(a=Math.round(a/SNAP)*SNAP,t=Math.round(t/SNAP)*SNAP),e.x=Math.round(a),e.y=Math.round(t),a=CV.querySelector('.rk[data-id="'+e.id+'"]'))&&(a.style.left=e.x+"px",a.style.top=e.y+"px")}),(y=R.find(function(e){return sel.has(e.id)}))&&(document.getElementById("coords").textContent=y.a+" X:"+y.x+" Y:"+y.y+" ("+sel.size+"개)")):"sb"===drag.type?(r=Math.min(drag.sx,l.x),o=Math.min(drag.sy,l.y),s=Math.abs(l.x-drag.sx),i=Math.abs(l.y-drag.sy),SB.style.left=r+"px",SB.style.top=o+"px",SB.style.width=s+"px",SB.style.height=i+"px",SB.style.display="block",R.forEach(function(e){var t=rpx(e);e.x+t.w>r&&e.x<r+s&&e.y+t.h>o&&e.y<o+i?sel.add(e.id):drag.shift||sel.delete(e.id)}),zones.forEach(function(e,t){var t=e.id||"z"+t,a=BX+e.x,n=BY+e.y;r<a+e.w&&a<r+s&&n+e.h>o&&n<o+i?selZ.add(t):drag.shift||selZ.delete(t)}),updSel(),upStats()):"zgd"===drag.type?(drag.moved=!0,zones.forEach(function(e,t){var a,n,t=e.id||"z"+t;selZ.has(t)&&(a=drag.zoff[t])&&(n=l.x+a.dx-BX,a=l.y+a.dy-BY,O.snap&&(n=Math.round(n/SNAP)*SNAP,a=Math.round(a/SNAP)*SNAP),e.x=Math.round(n),e.y=Math.round(a),n=CV.querySelector('.zone[data-zid="'+t+'"]'))&&(n.style.left=BX+e.x+"px",n.style.top=BY+e.y+"px")})):"zd"===drag.type?(y=l.x-drag.ox-BX,m=l.y-drag.oy-BY,O.snap&&(y=Math.round(y/SNAP)*SNAP,m=Math.round(m/SNAP)*SNAP),zones[drag.zi].x=Math.round(y),zones[drag.zi].y=Math.round(m),(m=CV.querySelector('.zone[data-zi="'+drag.zi+'"]'))&&(m.style.left=BX+zones[drag.zi].x+"px",m.style.top=BY+zones[drag.zi].y+"px")):"zr"===drag.type?(zones[drag.zi].w=Math.max(30,Math.round(drag.sw+(e.clientX-drag.sx)/Z)),zones[drag.zi].h=Math.max(20,Math.round(drag.sh+(e.clientY-drag.sy)/Z)),(m=CV.querySelector('.zone[data-zi="'+drag.zi+'"]'))&&(m.style.width=zones[drag.zi].w+"px",m.style.height=zones[drag.zi].h+"px",y=m.querySelector(".zd"))&&(y.textContent=zones[drag.zi].w+"×"+zones[drag.zi].h)):"td"===drag.type?(txts[drag.ti].x=Math.round(l.x-drag.ox),txts[drag.ti].y=Math.round(l.y-drag.oy),(m=CV.querySelector('.txl[data-ti="'+drag.ti+'"]'))&&(m.style.left=txts[drag.ti].x+"px",m.style.top=txts[drag.ti].y+"px")):"ld"===drag.type&&(t=lines[drag.dli])&&("move"===drag.dltype?(v=Math.round(l.x-drag.ox),g=Math.round(l.y-drag.oy),y=(t.x2-t.x1)/2,m=(t.y2-t.y1)/2,t.x1=Math.round(v-y),t.y1=Math.round(g-m),t.x2=Math.round(v+y),t.y2=Math.round(g+m)):"p1"===drag.dltype?(t.x1=Math.round(l.x),t.y1=Math.round(l.y)):"p2"===drag.dltype&&(t.x2=Math.round(l.x),t.y2=Math.round(l.y)),(y=CV.querySelectorAll(".dl-svg"))[drag.dli]&&(m=y[drag.dli].querySelector("line"))&&(m.setAttribute("x1",t.x1),m.setAttribute("y1",t.y1),m.setAttribute("x2",t.x2),m.setAttribute("y2",t.y2)),CV.querySelectorAll('.dl-handle[data-dli="'+drag.dli+'"]').forEach(function(e){e.style.left=(t.x1+t.x2)/2+"px",e.style.top=(t.y1+t.y2)/2+"px"}),CV.querySelectorAll('.dl-ep[data-dli="'+drag.dli+'"]').forEach(function(e){"p1"===e.dataset.dltype?(e.style.left=t.x1+"px",e.style.top=t.y1+"px"):(e.style.left=t.x2+"px",e.style.top=t.y2+"px")}),document.getElementById("coords").textContent="선 ("+Math.round((t.x2-t.x1)/S)+"×"+Math.round((t.y2-t.y1)/S)+"mm)")}else{try{var l=exy(e);document.getElementById("coords").textContent="X:"+Math.round(l.x)+" Y:"+Math.round(l.y)}catch(e){}var d,c,p,u,n,x,h,a,y=document.getElementById("tip"),m=e.target.closest&&e.target.closest(".rk"),m=(m?(m=R[+m.dataset.ri])&&(y.innerHTML='<div class="ttn">'+m.a+" #"+m.id+'</div><div class="ttr"><span class="ttl">시리즈</span><span class="ttv">'+SN[m.s]+'</span></div><div class="ttr"><span class="ttl">타입</span><span class="ttv">'+("heavy"===m.t?"중량 1800mm":"경량 900mm")+"</span></div>",y.style.display="block",y.style.left=e.clientX+12+"px",y.style.top=e.clientY-8+"px"):y.style.display="none",document.getElementById("areaPreview"));function f(e,t,a,n,r,o,s,i){e=Math.max(e,r),r=Math.max(t,o),t=Math.min(a,s),o=Math.min(n,i);return t<=e||o<=r?null:{x1:e,y1:r,x2:t,y2:o}}"area"===mode&&areaPt?(y=exy(e),m||((m=document.createElementNS("http://www.w3.org/2000/svg","svg")).id="areaPreview",m.setAttribute("class","dl-preview"),m.style.width=CW+"px",m.style.height=CH+"px",CV.appendChild(m)),a={x1:BX,y1:BY,x2:BX+WHW,y2:BY+WHH},b={x1:BX+WHW,y1:BY+mm(12900),x2:BX+WHW+mm(19900),y2:BY+WHH},d=Math.min(areaPt.x,y.x),c=Math.min(areaPt.y,y.y),p=Math.max(areaPt.x,y.x),u=Math.max(areaPt.y,y.y),y=f(d,c,p,u,a.x1,a.y1,a.x2,a.y2),a=f(d,c,p,u,b.x1,b.y1,b.x2,b.y2),n=0,h="",[y,a].forEach(function(e){var t,a;e&&(t=e.x2-e.x1,a=e.y2-e.y1,n+=t/S*(a/S),h+='<rect x="'+e.x1+'" y="'+e.y1+'" width="'+t+'" height="'+a+'" fill="rgba(34,211,238,.1)" stroke="#22d3ee" stroke-width="1.5"/>')}),h+='<rect x="'+d+'" y="'+c+'" width="'+(p-d)+'" height="'+(u-c)+'" fill="none" stroke="rgba(34,211,238,.2)" stroke-width="0.8"/>',x=0,zones.forEach(function(e){var t,a,n;e.excl&&(t=BX+e.x,a=BY+e.y,n=BX+e.x+e.w,e=BY+e.y+e.h,t=Math.max(d,t),a=Math.max(c,a),n=Math.min(p,n),e=Math.min(u,e),n<=t||e<=a||(x+=(n-t)/S*(e-a)/S,h+='<rect x="'+t+'" y="'+a+'" width="'+(n-t)+'" height="'+(e-a)+'" fill="rgba(239,68,68,.08)" stroke="rgba(239,68,68,.35)" stroke-width="1"/>'))}),b=((n=(n-=x)<0?0:n)/1e6).toFixed(2),h=h+('<rect x="'+((v=(d+p)/2)-(y=0<x?130:90)/2)+'" y="'+((g=(c+u)/2)-13))+'" width="'+y+'" height="24" rx="4" fill="rgba(15,23,42,.88)"/><text x="'+v+'" y="'+(g+4)+'" text-anchor="middle" fill="#22d3ee" font-size="12" font-weight="700" font-family="monospace">'+b+"m²"+(0<x?" (제외 있음)":"")+"</text>",m.innerHTML=h):m&&(m.innerHTML=""),"ruler"===mode&&rulerPt&&(a=exy(e),y=document.getElementById("rulerPrevLine"))&&(y.setAttribute("x1",rulerPt.x),y.setAttribute("y1",rulerPt.y),y.setAttribute("x2",a.x),y.setAttribute("y2",a.y));var g,b,v=document.getElementById("linePreviewSvg");"line"===mode&&linePt?(g=exy(e),v||((v=document.createElementNS("http://www.w3.org/2000/svg","svg")).id="linePreviewSvg",v.setAttribute("class","dl-preview"),v.style.width=CW+"px",v.style.height=CH+"px",CV.appendChild(v)),b=document.getElementById("lineColor")?document.getElementById("lineColor").value:"#ffffff",m=document.getElementById("lineWidth")&&parseInt(document.getElementById("lineWidth").value)||2,y="dashed"===lineStyle?'stroke-dasharray="8,5"':"",v.innerHTML='<line x1="'+linePt.x+'" y1="'+linePt.y+'" x2="'+g.x+'" y2="'+g.y+'" stroke="'+b+'" stroke-width="'+m+'" '+y+' stroke-linecap="round" opacity="0.6"/><circle cx="'+linePt.x+'" cy="'+linePt.y+'" r="5" fill="'+b+'" opacity="0.9"/><circle cx="'+g.x+'" cy="'+g.y+'" r="4" fill="none" stroke="'+b+'" stroke-width="2" opacity="0.7"/>'):v&&(v.innerHTML="")}}),document.addEventListener("mouseup",function(){drag&&("gd"===drag.type?drag.moved&&(R.forEach(function(e){sel.has(e.id)&&trySnap(e)}),render(),autoSave()):"zgd"===drag.type?drag.moved&&(render(),autoSave()):"sb"===drag.type?(SB.style.display="none",render()):"pan"===drag.type?CA.classList.remove("panning"):("ld"===drag.type&&(document.querySelectorAll(".dl-handle.dragging,.dl-ep.dragging").forEach(function(e){e.classList.remove("dragging")}),render()),autoSave()),drag=null)}),CA.addEventListener("dblclick",function(e){var t=e.target.closest?e.target.closest("[data-dai]"):null;if((t=!t&&e.target.dataset&&void 0!==e.target.dataset.dai?e.target:t)&&void 0!==t.dataset.dai)areas.splice(+t.dataset.dai,1),render(),autoSave(),toast("면적 삭제됨");else{var a,n,r,o,s,t=e.target.closest?e.target.closest("[data-dli]"):null;if(!(t=!t&&e.target.dataset&&void 0!==e.target.dataset.dli?e.target:t)||void 0===t.dataset.dli)return(r=e.target.closest(".rk"))?(r=+r.dataset.ri,(a=R[r])?(r="custom"===a.t?a.cw||1800:"heavy"===a.t?1800:900,o="custom"===a.t&&a.ch||450,void showEditModal(a.a+" \\uc218\\uc815",[{key:"a",label:"\\uc774\\ub984",value:a.a},{key:"t",label:"\\ud0c0\\uc785(heavy/light/custom)",value:a.t},{key:"cw",label:"\\uac00\\ub85c mm",value:""+r},{key:"ch",label:"\\uc138\\ub85c mm",value:""+o},{key:"cc",label:"\\ubc30\\uacbd\\uc0c9",value:a.cc||"",type:"color"},{key:"fs",label:"\\uae00\\uc790\\ud06c\\uae30(px)",value:""+(a.fs||10)},{key:"fc",label:"\\uae00\\uc790\\uc0c9\\uc0c1",value:a.fc||"",type:"color"},{key:"rot2",label:"\\ud68c\\uc804(0/90/180/270)",value:""+(!0===a.rot?90:a.rot||0)}],function(e){a.a=e.a.toUpperCase();var t=e.t;"heavy"!==t&&"light"!==t&&"custom"!==t||(a.t=t),a.cw=parseInt(e.cw)||1800,a.ch=parseInt(e.ch)||450,"custom"!==a.t&&1800!==a.cw&&900!==a.cw&&(a.t="custom"),a.cc=e.cc||"",a.fs=parseInt(e.fs)||10,a.fc=e.fc||"",a.rot=parseInt(e.rot2)||0,render(),autoSave()})):void 0):(r=e.target.closest(".zone"))?(o=+r.dataset.zi,(n=zones[o])?void showEditModal(n.n+" \\uc218\\uc815",[{key:"n",label:"\\uc774\\ub984",value:n.n},{key:"w",label:"\\uac00\\ub85c mm",value:""+Math.round(n.w/S)},{key:"h",label:"\\uc138\\ub85c mm",value:""+Math.round(n.h/S)},{key:"c",label:"\\uc0c9\\uc0c1",value:n.c||"",type:"color"},{key:"fs",label:"\\uae00\\uc790\\ud06c\\uae30(px)",value:""+(n.fs||11)},{key:"fc",label:"\\uae00\\uc790\\uc0c9\\uc0c1",value:n.fc||"",type:"color"},{key:"rot",label:"\\ud68c\\uc804(0/90/270)",value:""+(n.rot||0)},{key:"excl",label:"\\uba74\\uc801 \\uacc4\\uc0b0 \\uc81c\\uc678(1=\\uc608, 0=\\uc544\\ub2c8\\uc624)",value:n.excl?"1":"0"}],function(e){n.n=e.n,n.w=mm(parseInt(e.w)||1e3),n.h=mm(parseInt(e.h)||500),e.c&&(n.c=e.c,n.b=e.c),n.fs=parseInt(e.fs)||11,n.fc=e.fc||"",n.rot=parseInt(e.rot)||0,n.excl="1"===e.excl||1===e.excl||!0===e.excl,render(),autoSave()}):void 0):void((r=e.target.closest(".txl"))&&(o=+r.dataset.ti,showEditModal("\\ud14d\\uc2a4\\ud2b8 \\uc218\\uc815",[{key:"text",label:"\\ud14d\\uc2a4\\ud2b8",value:(s=txts[o]).text},{key:"fs",label:"\\uae00\\uc790\\ud06c\\uae30(px)",value:""+(s.fs||10)},{key:"fc",label:"\\uae00\\uc790\\uc0c9\\uc0c1",value:s.fc||"",type:"color"},{key:"rot",label:"\\ud68c\\uc804(0/90/270)",value:""+(s.rot||0)}],function(e){s.text=e.text,s.fs=parseInt(e.fs)||10,s.fc=e.fc||"",s.rot=parseInt(e.rot)||0,render(),autoSave()})));lines.splice(+t.dataset.dli,1),render(),autoSave(),toast("선 삭제됨")}}),document.getElementById("zoomR").addEventListener("input",function(e){Z=e.target.value/100,document.getElementById("zoomV").textContent=e.target.value+"%",CV.style.transform="scale("+Z+")"}),document.addEventListener("keydown",function(e){if("INPUT"!==e.target.tagName&&"SELECT"!==e.target.tagName)if(!e.ctrlKey&&!e.metaKey||e.shiftKey||"z"!==e.key){if((e.ctrlKey||e.metaKey)&&"c"===e.key)if(0<sel.size+selZ.size)return window._clipR=[],R.forEach(function(e){sel.has(e.id)&&window._clipR.push(JSON.parse(JSON.stringify(e)))}),window._clipZ=[],zones.forEach(function(e,t){selZ.has(e.id||"z"+t)&&window._clipZ.push(JSON.parse(JSON.stringify(e)))}),toast("복사: "+(window._clipR.length+window._clipZ.length)+"개"),void e.preventDefault();if((e.ctrlKey||e.metaKey)&&"v"===e.key){var t=0;if(window._clipR&&0<window._clipR.length&&(window._clipR.forEach(function(e){R.push({id:nid++,a:e.a,t:e.t,s:e.s,x:e.x+20,y:e.y+20,rot:e.rot||!1,cw:e.cw,ch:e.ch,cc:e.cc})}),t+=window._clipR.length),window._clipZ&&0<window._clipZ.length&&(window._clipZ.forEach(function(e){zones.push({id:"z"+Date.now()+Math.random(),n:e.n,x:e.x+20,y:e.y+20,w:e.w,h:e.h,c:e.c,b:e.b,fs:e.fs,fc:e.fc,rot:e.rot})}),t+=window._clipZ.length),0<t)return render(),autoSave(),toast("붙여넣기: "+t+"개"),void e.preventDefault()}var a,t=e.key.toLowerCase();"v"===t?setMode("move"):"s"!==t||e.ctrlKey?"m"!==t||e.ctrlKey?"t"!==t||e.ctrlKey?"l"!==t||e.ctrlKey?"a"!==t||e.ctrlKey||e.metaKey?"r"!==t||e.ctrlKey?"delete"===t||"backspace"===t?((sel.size||selZ.size)&&delSel(),e.preventDefault()):"escape"===t?(sel.clear(),selZ.clear(),rulerPt=null,linePt=null,areaPt=null,(a=document.getElementById("linePreviewSvg"))&&(a.innerHTML=""),(a=document.getElementById("areaPreview"))&&(a.innerHTML=""),setMode("move"),render()):"a"===t&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),R.forEach(function(e){sel.add(e.id)}),zones.forEach(function(e,t){selZ.add(e.id||"z"+t)}),render()):(R.forEach(function(e){sel.has(e.id)&&(e.rot=!e.rot)}),sel.size&&(render(),autoSave())):setMode("area"):setMode("line"):setMode("text"):setMode("ruler"):setMode("select")}else undo(),e.preventDefault()}),CA.addEventListener("wheel",function(e){(e.ctrlKey||e.metaKey)&&(e.preventDefault(),e=Math.max(30,Math.min(200,Math.round(100*Z)+(0<e.deltaY?-5:5))),Z=e/100,document.getElementById("zoomR").value=e,document.getElementById("zoomV").textContent=e+"%",CV.style.transform="scale("+Z+")")},{passive:!1}),CA.addEventListener("contextmenu",function(e){e.preventDefault()});try{initR(),load(),render(),pushHistory()}catch(e){console.error("Layout init error:",e),initR(),render(),pushHistory()}window.addEventListener("message",function(e){if(e.data&&"layoutLoad"===e.data.type)try{loadFromData(JSON.parse(e.data.data)),pushHistory()}catch(e){}}),setTimeout(function(){window.parent!==window&&window.parent.postMessage({type:"layoutReady"},"*")},500);
<\/script>
</body>
</html>
`;// 랙 배치도 데이터 저장/로드 (postMessage 통신)
const layoutIframeRef=React.useRef(null);const[layoutData,setLayoutData]=useState(null);const view3dCanvasRef=React.useRef(null);const view3dSceneRef=React.useRef(null);const view3dCtrlRef=React.useRef(null);const view3dWalkRef=React.useRef(null);const[walkHudVisible,setWalkHudVisible]=useState(false);// 카메라/기능 제어용
useEffect(()=>{// 초기 로드: 저장된 데이터가 있으면 파싱
try{const saved=safeStorage.getItem('pbk_layout_data');if(saved)setLayoutData(JSON.parse(saved));}catch(ex){}},[]);useEffect(()=>{const handleLayoutMessage=e=>{if(!e.data||!e.data.type)return;if(e.data.type==='layoutClear'){try{safeStorage.removeItem('pbk_layout_data');}catch(ex){}setLayoutData(null);}if(e.data.type==='layoutSave'){try{safeStorage.setItem('pbk_layout_data',e.data.data);setLayoutData(JSON.parse(e.data.data));}catch(ex){}}if(e.data.type==='layoutReady'){try{const saved=safeStorage.getItem('pbk_layout_data');if(saved&&layoutIframeRef.current){const parsed=JSON.parse(saved);if(parsed.R&&parsed.R.length>0){layoutIframeRef.current.contentWindow.postMessage({type:'layoutLoad',data:saved},'*');}}}catch(ex){}}};window.addEventListener('message',handleLayoutMessage);return()=>window.removeEventListener('message',handleLayoutMessage);},[]);// 3D 뷰 렌더링
const view3dKeyRef=React.useRef(null);useEffect(()=>{if(activeTab!=='view3d'||!layoutData||!view3dCanvasRef.current)return;if(view3dSceneRef.current){view3dSceneRef.current.renderer.dispose();view3dSceneRef.current=null;}if(view3dKeyRef.current){if(view3dKeyRef.current.down){window.removeEventListener('keydown',view3dKeyRef.current.down);window.removeEventListener('keyup',view3dKeyRef.current.up);}else{window.removeEventListener('keydown',view3dKeyRef.current);}view3dKeyRef.current=null;}const loadAndInit=()=>{const THREE=window.THREE;if(!THREE)return;const cv=view3dCanvasRef.current;if(!cv)return;const W=cv.clientWidth||800,H=cv.clientHeight||600;const S3D=0.06,BX3D=50,BY3D=50;const toM=px=>px/S3D/1000;// 시리즈 색상 — etc를 밝은 청록색으로
const SERIES_COLORS={mx48:0xdc2626,mx16:0x2563eb,hsm:0xd97706,semi:0xeab308,spare:0x7c3aed,etc:0x06b6d4};const rpx3d=r=>{var w,h;if(r.t==='custom'){w=(r.cw||1000)*S3D;h=(r.ch||500)*S3D;}else{w=(r.t==='heavy'?1800:900)*S3D;h=450*S3D;}if(r.rot===true||r.rot===90||r.rot===270){var tmp=w;w=h;h=tmp;}return{w:w,h:h};};const scene=new THREE.Scene();scene.background=new THREE.Color(0x0f172a);const camera=new THREE.PerspectiveCamera(50,W/H,0.1,200);const renderer=new THREE.WebGLRenderer({canvas:cv,antialias:true,preserveDrawingBuffer:true});renderer.setSize(W,H);renderer.shadowMap.enabled=true;view3dSceneRef.current={scene,camera,renderer};scene.add(new THREE.AmbientLight(0xffffff,0.5));const dl=new THREE.DirectionalLight(0xffffff,0.6);dl.position.set(20,30,10);dl.castShadow=true;scene.add(dl);// Floor (L-shape)
const whw=toM(564),whh=toM(1890),jy=toM(774),rx=toM(982-BX3D);const floorShape=new THREE.Shape();floorShape.moveTo(0,0);floorShape.lineTo(whw,0);floorShape.lineTo(whw,jy);floorShape.lineTo(rx,jy);floorShape.lineTo(rx,whh);floorShape.lineTo(0,whh);const floor=new THREE.Mesh(new THREE.ShapeGeometry(floorShape),new THREE.MeshStandardMaterial({color:0x1a2332,side:THREE.DoubleSide}));floor.rotation.x=-Math.PI/2;floor.receiveShadow=true;scene.add(floor);// Walls
const wallH=3.5;const pts=[[0,0],[whw,0],[whw,jy],[rx,jy],[rx,whh],[0,whh]];for(let i=0;i<pts.length;i++){const p0=pts[i],p1=pts[(i+1)%pts.length];const dx=p1[0]-p0[0],dz=p1[1]-p0[1],len=Math.sqrt(dx*dx+dz*dz);const wall=new THREE.Mesh(new THREE.PlaneGeometry(len,wallH),new THREE.MeshStandardMaterial({color:0x475569,transparent:true,opacity:0.15,side:THREE.DoubleSide}));wall.position.set((p0[0]+p1[0])/2,wallH/2,(p0[1]+p1[1])/2);wall.rotation.y=-Math.atan2(dz,dx);scene.add(wall);}// 라벨: Sprite 방식 (항상 카메라를 향해 읽기 쉬움)
function makeLabel(text,x,topY,z,scale,color){const cW=512,cH=64;const c=document.createElement('canvas');c.width=cW;c.height=cH;const ctx=c.getContext('2d');ctx.clearRect(0,0,cW,cH);var fontSize=32;ctx.font='bold '+fontSize+'px sans-serif';while(ctx.measureText(text).width>cW-10&&fontSize>8){fontSize-=2;ctx.font='bold '+fontSize+'px sans-serif';}ctx.fillStyle='rgba(0,0,0,0.6)';var tw=Math.min(ctx.measureText(text).width+16,cW);ctx.fillRect((cW-tw)/2,4,tw,cH-8);ctx.fillStyle=color||'#ffffff';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillText(text,cW/2,cH/2);const tex=new THREE.CanvasTexture(c);tex.minFilter=THREE.LinearFilter;const sp=new THREE.Sprite(new THREE.SpriteMaterial({map:tex,depthWrite:false,depthTest:false}));sp.position.set(x,topY+0.15,z);var s=scale||1.2;sp.scale.set(s,s*cH/cW,1);scene.add(sp);}// 랙 렌더링
if(layoutData.R)layoutData.R.forEach(r=>{const rp=rpx3d(r),wM=toM(rp.w),dM=toM(rp.h);const xM=toM(r.x-BX3D),zM=toM(r.y-BY3D);const nm=(r.a||'').toUpperCase();const isPillar=nm.indexOf('PILLAR')>=0||(r.a||'').indexOf('\uae30\ub465')>=0||r.cc==='#6b7280'||r.t==='custom'&&(r.cw||0)<=600&&(r.ch||0)<=600&&nm.indexOf('DOOR')<0&&nm.indexOf('PLT')<0;const isDoor=nm.indexOf('DOOR')>=0;const isPLT=nm.indexOf('PLT')>=0;// 높이
var hM=1.8;// 기본 1.8m
if(isDoor)hM=2.0;else if(isPLT)hM=0.3;else if(isPillar)hM=1.8;// 기둥
// 색상
var col=isDoor?0x10b981:isPillar?0x6b7280:isPLT?0xa16207:SERIES_COLORS[r.s]||0x06b6d4;var op=isDoor?0.5:isPillar?0.95:isPLT?0.7:0.9;// DOOR: 얇은 프레임 (높이 2m, 깊이 0.05m)
var geoW=wM,geoH=hM,geoD=dM;if(isDoor){geoD=Math.max(dM,0.05);geoW=Math.max(wM,0.05);}const mesh=new THREE.Mesh(new THREE.BoxGeometry(geoW,geoH,geoD),new THREE.MeshStandardMaterial({color:col,transparent:true,opacity:op}));mesh.position.set(xM+wM/2,geoH/2,zM+dM/2);mesh.castShadow=true;scene.add(mesh);// 엣지 (DOOR은 두껍게)
const edgeLine=new THREE.LineSegments(new THREE.EdgesGeometry(new THREE.BoxGeometry(geoW,geoH,geoD)),new THREE.LineBasicMaterial({color:isDoor?0x34d399:isPillar?0x94a3b8:col,transparent:true,opacity:isDoor?0.8:0.4}));edgeLine.position.copy(mesh.position);scene.add(edgeLine);// 라벨
var lblScale=Math.max(wM*1.5,1);makeLabel(r.a,xM+wM/2,geoH,zM+dM/2,lblScale,isPillar?'#94a3b8':isDoor?'#34d399':isPLT?'#fbbf24':'#ffffff');});// 존 — 이름별 높이/색상
const ZONE_CFG={'Packaging Foam':{h:1.8,c:0x22c55e,op:0.6},'Spare Part Box':{h:1.8,c:0x22c55e,op:0.6},'Injection':{h:0.3,c:0x3b82f6,op:0.3},'Stand':{h:1.8,c:0xf59e0b,op:0.9},'Tablet':{h:1.8,c:0xf59e0b,op:0.9},'Base Plate':{h:0.5,c:0x8b5cf6,op:0.6},'Yellow Box':{h:0.8,c:0xeab308,op:0.6},'8160 Area':{h:3.5,c:0x94a3b8,op:0.5},'Barcode/ E6150 Area':{h:0.3,c:0x8b5cf6,op:0.5},'Defect Area':{h:0.01,c:0xef4444,op:0.2},'Test Area':{h:0.01,c:0x3b82f6,op:0.15},'Final QC Area':{h:0.01,c:0x3b82f6,op:0.15}};if(layoutData.zones)layoutData.zones.forEach(z=>{const wM=toM(z.w),dM=toM(z.h),xM=toM(z.x),zM=toM(z.y);var cfg=ZONE_CFG[z.n];if(!cfg){// 이름에 '기둥' 포함 시 1.8m 기둥으로 처리
if(z.n.indexOf('\uae30\ub465')>=0)cfg={h:1.8,c:0x6b7280,op:0.95};else cfg={h:0.3,c:0x22c55e,op:0.4};}const mesh=new THREE.Mesh(new THREE.BoxGeometry(wM,cfg.h,dM),new THREE.MeshStandardMaterial({color:cfg.c,transparent:true,opacity:cfg.op}));mesh.position.set(xM+wM/2,cfg.h/2,zM+dM/2);scene.add(mesh);if(cfg.h>=0.1){var lblScale=Math.max(wM,1.5);makeLabel(z.n,xM+wM/2,cfg.h,zM+dM/2,lblScale,'#ffffff');}});// Camera orbit + 화살표 키 이동
let isDrag=false,prevX=0,prevY=0,theta=0.8,phi=0.5,dist=35;const target=new THREE.Vector3(whw/2,0,whh/3);const updateCam=()=>{camera.position.set(target.x+dist*Math.sin(theta)*Math.cos(phi),dist*Math.sin(phi),target.z+dist*Math.cos(theta)*Math.cos(phi));camera.lookAt(target);};updateCam();cv.addEventListener('mousedown',e=>{isDrag=true;prevX=e.clientX;prevY=e.clientY;});cv.addEventListener('mousemove',e=>{if(!isDrag)return;if(walkState.active){// 워크스루: 자키 방향 직접 회전
walkState.angle-=(e.clientX-prevX)*0.005;walkState.camPhi=Math.max(0.1,Math.min(1.2,walkState.camPhi+(e.clientY-prevY)*0.005));prevX=e.clientX;prevY=e.clientY;}else{theta+=(e.clientX-prevX)*0.005;phi=Math.max(0.1,Math.min(1.5,phi+(e.clientY-prevY)*0.005));prevX=e.clientX;prevY=e.clientY;updateCam();}});window.addEventListener('mouseup',()=>{isDrag=false;});cv.addEventListener('wheel',e=>{if(walkState.active){walkState.camDist=Math.max(2,Math.min(12,walkState.camDist+e.deltaY*0.01));}else{dist=Math.max(5,Math.min(80,dist+e.deltaY*0.03));updateCam();}e.preventDefault();},{passive:false});const onKey=e=>{var kl=e.key.toLowerCase();// 워크스루 모드 키 처리
if(walkState.active){if('wasdqe'.indexOf(kl)>=0){walkState.keys[kl]=true;e.preventDefault();return;}if(e.key==='Escape'){if(view3dCtrlRef.current)view3dCtrlRef.current.toggleWalk();var btn=document.getElementById('btn3dWalk');if(btn)btn.classList.remove('bg-yellow-700');e.preventDefault();return;}return;}// 오빗 모드: WASD + 화살표 모두 지원
const sp=0.5;var fwdX=Math.sin(theta),fwdZ=Math.cos(theta);var rightX=Math.cos(theta),rightZ=-Math.sin(theta);if(kl==='a'||e.key==='ArrowLeft'){target.x-=rightX*sp;target.z-=rightZ*sp;updateCam();e.preventDefault();}else if(kl==='d'||e.key==='ArrowRight'){target.x+=rightX*sp;target.z+=rightZ*sp;updateCam();e.preventDefault();}else if(kl==='w'||e.key==='ArrowUp'){target.x-=fwdX*sp;target.z-=fwdZ*sp;updateCam();e.preventDefault();}else if(kl==='s'||e.key==='ArrowDown'){target.x+=fwdX*sp;target.z+=fwdZ*sp;updateCam();e.preventDefault();}};const onKeyUp=e=>{if(walkState.active){var kl=e.key.toLowerCase();if('wasdqe'.indexOf(kl)>=0){walkState.keys[kl]=false;e.preventDefault();}}};window.addEventListener('keydown',onKey);window.addEventListener('keyup',onKeyUp);view3dKeyRef.current={down:onKey,up:onKeyUp};// ── 외부 제어 함수 노출 ──
view3dCtrlRef.current={setCamPreset:function(preset){if(view3dWalkRef.current&&view3dWalkRef.current.active)return;// 워크스루 중 프리셋 비활성
if(preset==='top'){theta=0;phi=1.5;dist=30;target.set(whw/2,0,whh/2);}else if(preset==='front'){theta=0;phi=0.3;dist=35;target.set(whw/2,0,whh);}else if(preset==='entrance'){theta=0.3;phi=0.4;dist=25;target.set(whw/2,0,2);}else if(preset==='side'){theta=Math.PI/2;phi=0.4;dist=35;target.set(0,0,whh/2);}else if(preset==='iso'){theta=0.8;phi=0.5;dist=35;target.set(whw/2,0,whh/3);}updateCam();}};// ══════════════════════════════════════════════════
// ██ 워크스루 시뮬레이션 (자키 + 파렛트 동선 검증) ██
// ══════════════════════════════════════════════════
// --- 충돌 박스 수집 (모든 랙, 존, 벽) ---
var colliders=[];if(layoutData.R)layoutData.R.forEach(function(r){var nm=(r.a||'').toUpperCase();var rp=rpx3d(r),wM=toM(rp.w),dM=toM(rp.h);var xM=toM(r.x-BX3D),zM=toM(r.y-BY3D);// DOOR만 통과 가능(passable), PLT는 충돌 대상
var pass=nm.indexOf('DOOR')>=0;colliders.push({minX:xM,maxX:xM+wM,minZ:zM,maxZ:zM+dM,name:r.a||'rack',passable:pass});});if(layoutData.zones)layoutData.zones.forEach(function(z){var wM=toM(z.w),dM=toM(z.h),xM=toM(z.x),zM=toM(z.y);// 모든 배치된 존을 충돌 대상으로 등록
colliders.push({minX:xM,maxX:xM+wM,minZ:zM,maxZ:zM+dM,name:z.n});});// 벽 충돌 (L자 건물 외곽 — 벗어나지 못하도록)
var wallThick=0.05;// 하단벽(z=0), 우측벽(x=whw, z<jy), 상단벽z=jy(x>rx), 내벽x=rx(z>jy), 상단벽z=whh(x<rx), 좌측벽x=0
colliders.push({minX:-wallThick,maxX:whw+wallThick,minZ:-wallThick-0.5,maxZ:-wallThick,name:'wall-bottom'});colliders.push({minX:whw,maxX:whw+wallThick,minZ:-wallThick,maxZ:jy+wallThick,name:'wall-right'});colliders.push({minX:rx,maxX:whw+wallThick,minZ:jy,maxZ:jy+wallThick,name:'wall-step-h'});colliders.push({minX:rx,maxX:rx+wallThick,minZ:jy,maxZ:whh+wallThick,name:'wall-step-v'});colliders.push({minX:-wallThick,maxX:rx+wallThick,minZ:whh,maxZ:whh+wallThick,name:'wall-top'});colliders.push({minX:-wallThick-0.5,maxX:-wallThick,minZ:-wallThick,maxZ:whh+wallThick,name:'wall-left'});// --- 자키 + 파렛트 3D 모델 생성 ---
var jackGroup=new THREE.Group();jackGroup.visible=false;// 파렛트: 1100×1100mm, 높이 150mm
var palletW=1.1,palletD=1.1,palletH=0.15;var palletMesh=new THREE.Mesh(new THREE.BoxGeometry(palletW,palletH,palletD),new THREE.MeshStandardMaterial({color:0xc4a035,roughness:0.8}));palletMesh.position.y=palletH/2;palletMesh.castShadow=true;jackGroup.add(palletMesh);// 파렛트 엣지
var palletEdge=new THREE.LineSegments(new THREE.EdgesGeometry(new THREE.BoxGeometry(palletW,palletH,palletD)),new THREE.LineBasicMaterial({color:0x8b6914}));palletEdge.position.copy(palletMesh.position);jackGroup.add(palletEdge);// 핸드잭 포크 2개: 파렛트 아래에 들어감 (폭150mm×길이1000mm×높이50mm)
var forkW=0.15,forkD=1.0,forkH=0.05;var forkMat=new THREE.MeshStandardMaterial({color:0x4a90d9,roughness:0.4,metalness:0.6});var forkL=new THREE.Mesh(new THREE.BoxGeometry(forkW,forkH,forkD),forkMat);forkL.position.set(-0.17,forkH/2,0.05);// 파렛트 아래 좌측
jackGroup.add(forkL);var forkR=new THREE.Mesh(new THREE.BoxGeometry(forkW,forkH,forkD),forkMat);forkR.position.set(0.17,forkH/2,0.05);// 파렛트 아래 우측
jackGroup.add(forkR);// 펌프 본체: 파렛트 뒤에 (폭450mm×길이300mm×높이200mm)
var pumpW=0.45,pumpD=0.3,pumpH=0.2;var pumpMesh=new THREE.Mesh(new THREE.BoxGeometry(pumpW,pumpH,pumpD),new THREE.MeshStandardMaterial({color:0x3b78c4,roughness:0.3,metalness:0.7}));pumpMesh.position.set(0,pumpH/2,-palletD/2-pumpD/2);pumpMesh.castShadow=true;jackGroup.add(pumpMesh);// 핸들 (수직 봉 + 가로 손잡이)
var handleMesh=new THREE.Mesh(new THREE.CylinderGeometry(0.02,0.02,0.8,8),new THREE.MeshStandardMaterial({color:0x666666,metalness:0.8}));handleMesh.position.set(0,0.5,-palletD/2-pumpD);jackGroup.add(handleMesh);// 핸들 가로 손잡이
var handleGrip=new THREE.Mesh(new THREE.CylinderGeometry(0.015,0.015,0.35,8),new THREE.MeshStandardMaterial({color:0x444444,metalness:0.6}));handleGrip.rotation.z=Math.PI/2;handleGrip.position.set(0,0.9,-palletD/2-pumpD);jackGroup.add(handleGrip);// 충돌 바운딩 표시 (파렛트 + 뒤쪽 펌프만)
var totalD=palletD+pumpD;// 1.1+0.3=1.4m
var jackBoundVis=new THREE.Mesh(new THREE.BoxGeometry(palletW+0.05,0.02,totalD+0.05),new THREE.MeshBasicMaterial({color:0x00ff00,transparent:true,opacity:0.2,side:THREE.DoubleSide}));jackBoundVis.position.set(0,0.01,-pumpD/2);jackGroup.add(jackBoundVis);scene.add(jackGroup);// --- 클리어런스 측정 라인 (좌/우) ---
var clearLineL=new THREE.Line(new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(0,0.3,0),new THREE.Vector3(-1,0.3,0)]),new THREE.LineBasicMaterial({color:0x00ff00,linewidth:2}));clearLineL.visible=false;scene.add(clearLineL);var clearLineR=new THREE.Line(new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(0,0.3,0),new THREE.Vector3(1,0.3,0)]),new THREE.LineBasicMaterial({color:0x00ff00,linewidth:2}));clearLineR.visible=false;scene.add(clearLineR);// 전방 클리어런스 라인
var clearLineF=new THREE.Line(new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(0,0.3,0),new THREE.Vector3(0,0.3,1)]),new THREE.LineBasicMaterial({color:0x00ff00,linewidth:2}));clearLineF.visible=false;scene.add(clearLineF);// 3D 거리 라벨 함수
function makeDynLabel(){var cW=256,cH=64;var c=document.createElement('canvas');c.width=cW;c.height=cH;var tex=new THREE.CanvasTexture(c);tex.minFilter=THREE.LinearFilter;var sp=new THREE.Sprite(new THREE.SpriteMaterial({map:tex,depthWrite:false,depthTest:false,transparent:true}));sp.scale.set(1.2,0.3,1);sp.visible=false;scene.add(sp);return{sprite:sp,canvas:c,texture:tex};}var labelL=makeDynLabel(),labelR=makeDynLabel(),labelF=makeDynLabel();// --- 랙 근접 정보 표시 ---
var SERIES_NAMES={mx48:'Maxwell48',mx16:'Maxwell16',hsm:'HSM',semi:'Semi Goods',spare:'Spare',etc:'E3/D2'};var SERIES_HEX={mx48:'#ef4444',mx16:'#3b82f6',hsm:'#d97706',semi:'#eab308',spare:'#7c3aed',etc:'#06b6d4'};// 랙 위치 데이터 (3D 좌표 + 메타)
var rackInfos=[];if(layoutData.R)layoutData.R.forEach(function(r){var nm=(r.a||'').toUpperCase();if(nm.indexOf('DOOR')>=0||nm.indexOf('PILLAR')>=0||nm.indexOf('PLT')>=0||r.t==='custom')return;var rp=rpx3d(r),wM=toM(rp.w),dM=toM(rp.h);var xM=toM(r.x-BX3D)+wM/2,zM=toM(r.y-BY3D)+dM/2;rackInfos.push({x:xM,z:zM,name:r.a||'',series:r.s||'etc',bins:r.b||0});});// 근접 랙 라벨 (최대 3개)
var rackLabels=[];for(var ri=0;ri<3;ri++){var rlc=document.createElement('canvas');rlc.width=512;rlc.height=64;var rlTex=new THREE.CanvasTexture(rlc);rlTex.minFilter=THREE.LinearFilter;var rlSp=new THREE.Sprite(new THREE.SpriteMaterial({map:rlTex,depthWrite:false,depthTest:false,transparent:true}));rlSp.scale.set(2.4,0.5,1);rlSp.visible=false;scene.add(rlSp);rackLabels.push({sprite:rlSp,canvas:rlc,texture:rlTex});}function updateDynLabel(lb,text,color,x,y,z){var ctx=lb.canvas.getContext('2d');var cW=lb.canvas.width,cH=lb.canvas.height;ctx.clearRect(0,0,cW,cH);ctx.fillStyle='rgba(0,0,0,0.75)';ctx.fillRect(8,6,cW-16,cH-12);// 자동 폰트 크기 (텍스트 길이에 맞춤)
var fs=28;ctx.font='bold '+fs+'px monospace';while(ctx.measureText(text).width>cW-24&&fs>12){fs-=2;ctx.font='bold '+fs+'px monospace';}ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillStyle=color;ctx.fillText(text,cW/2,cH/2);lb.texture.needsUpdate=true;lb.sprite.position.set(x,y,z);lb.sprite.visible=true;}// --- 워크스루 상태 ---
var walkState={active:false,posX:0,posZ:0,angle:Math.PI/2,speed:0.06,turnSpeed:0.04,keys:{w:false,a:false,s:false,d:false,q:false,e:false},colliding:false,nearestL:999,nearestR:999,nearestF:999,collideName:'',camTheta:0,camPhi:0.35,camDist:4,nearRack:'',// 미니맵용 창고 치수 (미터)
whw:whw,whh:whh,jy:jy,rx:rx,colliders:colliders};view3dWalkRef.current=walkState;// 자키의 AABB 구하기 (월드좌표)
function getJackAABB(px,pz,ang){// 자키+파렛트 합산: 폭 1.1m, 길이 1.4m (파렛트1.1 + 펌프0.3)
var hw=palletW/2+0.05,hd=(palletD+pumpD)/2+0.05;// 반폭, 반길이
// 회전된 4개 코너의 AABB
var cos=Math.cos(ang),sin=Math.sin(ang);var corners=[[-hw,-hd],[hw,-hd],[hw,hd],[-hw,hd]];var mnX=1e9,mxX=-1e9,mnZ=1e9,mxZ=-1e9;corners.forEach(function(c){var rx=c[0]*cos-c[1]*sin+px;var rz=c[0]*sin+c[1]*cos+pz;if(rx<mnX)mnX=rx;if(rx>mxX)mxX=rx;if(rz<mnZ)mnZ=rz;if(rz>mxZ)mxZ=rz;});return{minX:mnX,maxX:mxX,minZ:mnZ,maxZ:mxZ};}// 충돌 검사
function checkCollision(px,pz,ang){var bb=getJackAABB(px,pz,ang);for(var i=0;i<colliders.length;i++){var c=colliders[i];if(c.passable)continue;// DOOR/PLT는 통과 가능
if(bb.maxX>c.minX&&bb.minX<c.maxX&&bb.maxZ>c.minZ&&bb.minZ<c.maxZ){return{hit:true,name:c.name};}}return{hit:false,name:''};}// 좌우/전방 클리어런스 계산 (레이캐스트)
function calcClearance(px,pz,ang){var cos=Math.cos(ang),sin=Math.sin(ang);var leftDir=[-cos,-sin];var rightDir=[cos,sin];var fwdDir=[Math.sin(ang),Math.cos(ang)];var hw=palletW/2+0.05;var lEdgeX=px+leftDir[0]*hw,lEdgeZ=pz+leftDir[1]*hw;var rEdgeX=px+rightDir[0]*hw,rEdgeZ=pz+rightDir[1]*hw;var fEdgeX=px+fwdDir[0]*(palletD/2+0.1),fEdgeZ=pz+fwdDir[1]*(palletD/2+0.1);var nearL=raycastAll(lEdgeX,lEdgeZ,leftDir);var nearR=raycastAll(rEdgeX,rEdgeZ,rightDir);var nearF=raycastAll(fEdgeX,fEdgeZ,fwdDir);return{l:nearL,r:nearR,f:nearF};}// 모든 collider + 건물 경계에 대한 레이캐스트
function raycastAll(ox,oz,dir){var minD=999;// 1) 건물 경계선에 대한 레이캐스트 (L자 형태 6개 변)
var segs=[[0,0,whw,0],[whw,0,whw,jy],[whw,jy,rx,jy],[rx,jy,rx,whh],[rx,whh,0,whh],[0,whh,0,0]];segs.forEach(function(s){var d=raySegment(ox,oz,dir[0],dir[1],s[0],s[1],s[2],s[3]);if(d>0&&d<minD)minD=d;});// 2) 장애물 박스에 대한 AABB 레이캐스트
colliders.forEach(function(c){if(c.name&&c.name.indexOf('wall')===0)return;// 벽 collider는 이미 경계선으로 처리
var d=rayAABB(ox,oz,dir,c);if(d>0&&d<minD)minD=d;});return minD;}// 레이 vs 선분 교차 (2D)
function raySegment(ox,oz,dx,dz,ax,az,bx,bz){var sx=bx-ax,sz=bz-az;var denom=dx*sz-dz*sx;if(Math.abs(denom)<1e-8)return 999;// 평행
var t=((ax-ox)*sz-(az-oz)*sx)/denom;var u=((ax-ox)*dz-(az-oz)*dx)/denom;if(t>0.001&&u>=0&&u<=1)return t;return 999;}// 레이 vs AABB 교차 (2D)
function rayAABB(ox,oz,dir,box){var tmin=-1e9,tmax=1e9;// X slab
if(Math.abs(dir[0])>1e-8){var t1=(box.minX-ox)/dir[0],t2=(box.maxX-ox)/dir[0];if(t1>t2){var tmp=t1;t1=t2;t2=tmp;}tmin=Math.max(tmin,t1);tmax=Math.min(tmax,t2);}else{if(ox<box.minX||ox>box.maxX)return 999;}// Z slab
if(Math.abs(dir[1])>1e-8){var t3=(box.minZ-oz)/dir[1],t4=(box.maxZ-oz)/dir[1];if(t3>t4){var tmp2=t3;t3=t4;t4=tmp2;}tmin=Math.max(tmin,t3);tmax=Math.min(tmax,t4);}else{if(oz<box.minZ||oz>box.maxZ)return 999;}if(tmax<0||tmin>tmax)return 999;return tmin>0?tmin:tmax>0?tmax:999;}// 워크스루 업데이트 (매 프레임)
function updateWalkthrough(){if(!walkState.active)return;var k=walkState.keys;var newX=walkState.posX,newZ=walkState.posZ,newAng=walkState.angle;// 회전
if(k.q)newAng+=walkState.turnSpeed;if(k.e)newAng-=walkState.turnSpeed;// 전진/후진
var fwdX=Math.sin(newAng),fwdZ=Math.cos(newAng);if(k.w){newX+=fwdX*walkState.speed;newZ+=fwdZ*walkState.speed;}if(k.s){newX-=fwdX*walkState.speed;newZ-=fwdZ*walkState.speed;}// 좌우 이동 (스트레이프)
var sideX=Math.cos(newAng),sideZ=-Math.sin(newAng);if(k.a){newX+=sideX*walkState.speed;newZ+=sideZ*walkState.speed;}if(k.d){newX-=sideX*walkState.speed;newZ-=sideZ*walkState.speed;}// 충돌 검사 (슬라이딩 + 끼임 탈출)
var col=checkCollision(newX,newZ,newAng);if(!col.hit){// 이동 성공
walkState.colliding=false;walkState.collideName='';walkState.posX=newX;walkState.posZ=newZ;walkState.angle=newAng;jackBoundVis.material.color.setHex(0x00ff00);jackBoundVis.material.opacity=0.2;}else{// X축만 이동 시도 (벽을 따라 미끄러짐)
var colX=checkCollision(newX,walkState.posZ,newAng);var colZ=checkCollision(walkState.posX,newZ,newAng);if(!colX.hit){walkState.posX=newX;walkState.angle=newAng;walkState.colliding=false;walkState.collideName='';jackBoundVis.material.color.setHex(0xffaa00);jackBoundVis.material.opacity=0.3;}else if(!colZ.hit){walkState.posZ=newZ;walkState.angle=newAng;walkState.colliding=false;walkState.collideName='';jackBoundVis.material.color.setHex(0xffaa00);jackBoundVis.material.opacity=0.3;}else{// 끼임 상태: 가장 가까운 장애물 반대 방향으로 밀어내기 시도
walkState.angle=newAng;// 회전은 항상 허용
var bb=getJackAABB(walkState.posX,walkState.posZ,newAng);var pushX=0,pushZ=0,pushCount=0;for(var ci=0;ci<colliders.length;ci++){var c=colliders[ci];if(c.passable)continue;if(bb.maxX>c.minX&&bb.minX<c.maxX&&bb.maxZ>c.minZ&&bb.minZ<c.maxZ){// 겹치는 충돌체에서 밀어내기 방향 계산
var cx=(c.minX+c.maxX)/2,cz=(c.minZ+c.maxZ)/2;var dx=walkState.posX-cx,dz=walkState.posZ-cz;var dl=Math.sqrt(dx*dx+dz*dz)||1;pushX+=dx/dl;pushZ+=dz/dl;pushCount++;}}if(pushCount>0){pushX/=pushCount;pushZ/=pushCount;var pushSpd=walkState.speed*0.8;var tryX=walkState.posX+pushX*pushSpd;var tryZ=walkState.posZ+pushZ*pushSpd;if(!checkCollision(tryX,tryZ,newAng).hit){walkState.posX=tryX;walkState.posZ=tryZ;walkState.colliding=false;walkState.collideName='';jackBoundVis.material.color.setHex(0xff8800);jackBoundVis.material.opacity=0.3;}else{walkState.colliding=true;walkState.collideName=col.name;jackBoundVis.material.color.setHex(0xff0000);jackBoundVis.material.opacity=0.4;}}else{walkState.colliding=true;walkState.collideName=col.name;jackBoundVis.material.color.setHex(0xff0000);jackBoundVis.material.opacity=0.4;}}}// 모델 위치 업데이트
jackGroup.position.set(walkState.posX,0,walkState.posZ);jackGroup.rotation.y=walkState.angle;// 클리어런스 계산
var cl=calcClearance(walkState.posX,walkState.posZ,walkState.angle);walkState.nearestL=cl.l;walkState.nearestR=cl.r;walkState.nearestF=cl.f;// 클리어런스 라인 업데이트
var cos=Math.cos(walkState.angle),sin=Math.sin(walkState.angle);var leftDir=[-cos,-sin],rightDir=[cos,sin];var hw=palletW/2+0.05;var lx=walkState.posX+leftDir[0]*hw,lz=walkState.posZ+leftDir[1]*hw;var rx2=walkState.posX+rightDir[0]*hw,rz2=walkState.posZ+rightDir[1]*hw;var dL=Math.min(cl.l,3),dR=Math.min(cl.r,3);clearLineL.geometry.dispose();clearLineL.geometry=new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(lx,0.3,lz),new THREE.Vector3(lx+leftDir[0]*dL,0.3,lz+leftDir[1]*dL)]);clearLineL.material.color.setHex(cl.l<0.3?0xff0000:cl.l<0.5?0xffaa00:0x00ff00);clearLineR.geometry.dispose();clearLineR.geometry=new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(rx2,0.3,rz2),new THREE.Vector3(rx2+rightDir[0]*dR,0.3,rz2+rightDir[1]*dR)]);clearLineR.material.color.setHex(cl.r<0.3?0xff0000:cl.r<0.5?0xffaa00:0x00ff00);// 전방 클리어런스 라인
var fwdDirV=[Math.sin(walkState.angle),Math.cos(walkState.angle)];var fEdge=palletD/2+0.1;var fx=walkState.posX+fwdDirV[0]*fEdge,fz=walkState.posZ+fwdDirV[1]*fEdge;var dF=Math.min(cl.f,3);clearLineF.geometry.dispose();clearLineF.geometry=new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(fx,0.3,fz),new THREE.Vector3(fx+fwdDirV[0]*dF,0.3,fz+fwdDirV[1]*dF)]);clearLineF.material.color.setHex(cl.f<0.3?0xff0000:cl.f<0.5?0xffaa00:0x00ff00);// 3D 거리 라벨 업데이트
var fmtD=function(d){return d>=100?'∞':Math.round(d*1000)+'mm';};var clrHex=function(d){return d<0.3?'#f87171':d<0.5?'#fbbf24':'#4ade80';};updateDynLabel(labelL,'◀ '+fmtD(cl.l),clrHex(cl.l),lx+leftDir[0]*Math.min(dL,1.5),0.6,lz+leftDir[1]*Math.min(dL,1.5));updateDynLabel(labelR,fmtD(cl.r)+' ▶',clrHex(cl.r),rx2+rightDir[0]*Math.min(dR,1.5),0.6,rz2+rightDir[1]*Math.min(dR,1.5));updateDynLabel(labelF,'▲ '+fmtD(cl.f),clrHex(cl.f),fx+fwdDirV[0]*Math.min(dF,1.5),0.6,fz+fwdDirV[1]*Math.min(dF,1.5));// 근접 랙 정보 표시 (2m 이내)
var nearRacks=[];rackInfos.forEach(function(ri){var dx=ri.x-walkState.posX,dz=ri.z-walkState.posZ;var dist2=Math.sqrt(dx*dx+dz*dz);if(dist2<2.5)nearRacks.push({info:ri,dist:dist2});});nearRacks.sort(function(a,b){return a.dist-b.dist;});for(var rli=0;rli<3;rli++){if(rli<nearRacks.length){var nr=nearRacks[rli];var sName=SERIES_NAMES[nr.info.series]||nr.info.series;var sCol=SERIES_HEX[nr.info.series]||'#ffffff';var txt=SERIES_NAMES[nr.info.series]||nr.info.series;updateDynLabel(rackLabels[rli],txt,sCol,nr.info.x,2.2,nr.info.z);}else{rackLabels[rli].sprite.visible=false;}}walkState.nearRack=nearRacks.length>0?SERIES_NAMES[nearRacks[0].info.series]||nearRacks[0].info.series:'';// 카메라: 3인칭 팔로우 (마우스로 시점 변경 가능)
var camH=walkState.camDist*Math.sin(walkState.camPhi);var camHoriz=walkState.camDist*Math.cos(walkState.camPhi);var totalAng=walkState.angle;var behindX=walkState.posX-Math.sin(totalAng)*camHoriz;var behindZ=walkState.posZ-Math.cos(totalAng)*camHoriz;camera.position.set(behindX,camH,behindZ);camera.lookAt(walkState.posX,0.5,walkState.posZ);}// 워크스루 시작 위치: 첫 번째 DOOR 아래 통로 중앙
var startDoor=null;if(layoutData.R){var allDoors2=layoutData.R.filter(function(r){return(r.a||'').toUpperCase().indexOf('DOOR')>=0;});startDoor=allDoors2.length>0?allDoors2.reduce(function(a,b){return a.y<b.y?a:b;}):null;}// DOOR 위치에서 창고 안쪽으로 5m, Packaging Foam과 Injection 사이 통로 중앙
var walkStartX=startDoor?toM(startDoor.x-BX3D)+toM(rpx3d(startDoor).w)/2:3;var walkStartZ=startDoor?toM(startDoor.y-BY3D)+5:5;// 충돌 없는 스폰 지점 찾기 (나선형 탐색)
function findSafeSpawn(cx,cz){var ang=Math.PI/2;if(!checkCollision(cx,cz,ang).hit)return{x:cx,z:cz};for(var r=0.5;r<=5;r+=0.5){for(var a=0;a<Math.PI*2;a+=Math.PI/6){var tx=cx+Math.cos(a)*r,tz=cz+Math.sin(a)*r;if(!checkCollision(tx,tz,ang).hit)return{x:tx,z:tz};}}return{x:cx+3,z:cz+3};// fallback
}var safeSpawn=findSafeSpawn(walkStartX,walkStartZ);walkStartX=safeSpawn.x;walkStartZ=safeSpawn.z;// 토글 함수 노출
view3dCtrlRef.current.toggleWalk=function(){walkState.active=!walkState.active;jackGroup.visible=walkState.active;clearLineL.visible=walkState.active;clearLineR.visible=walkState.active;clearLineF.visible=walkState.active;labelL.sprite.visible=walkState.active;labelR.sprite.visible=walkState.active;labelF.sprite.visible=walkState.active;rackLabels.forEach(function(rl){rl.sprite.visible=false;});if(walkState.active){var sp=findSafeSpawn(walkStartX,walkStartZ);walkState.posX=sp.x;walkState.posZ=sp.z;walkState.angle=0;// 오른쪽(+Z 방향, 창고 안쪽)
walkState.keys={w:false,a:false,s:false,d:false,q:false,e:false};walkState.colliding=false;walkState.collideName='';walkState.camTheta=0;walkState.camPhi=0.35;walkState.camDist=4;jackGroup.position.set(walkState.posX,0,walkState.posZ);jackGroup.rotation.y=walkState.angle;}else{// 오빗 모드로 복원
theta=0.8;phi=0.5;dist=35;target.set(whw/2,0,whh/3);updateCam();}return walkState.active;};view3dCtrlRef.current.getWalkState=function(){return walkState;};view3dCtrlRef.current.resetWalkCam=function(){walkState.camTheta=0;walkState.camPhi=0.35;walkState.camDist=4;};view3dCtrlRef.current.resetWalkPos=function(){var sp=findSafeSpawn(walkStartX,walkStartZ);walkState.posX=sp.x;walkState.posZ=sp.z;walkState.angle=0;walkState.colliding=false;walkState.collideName='';jackGroup.position.set(walkState.posX,0,walkState.posZ);jackGroup.rotation.y=walkState.angle;};// 스크린샷 캡처
view3dCtrlRef.current.captureScreenshot=function(){renderer.render(scene,camera);try{cv.toBlob(function(blob){if(!blob)return;var url=URL.createObjectURL(blob);var a=document.createElement('a');a.href=url;var now=new Date();var pad=function(n){return n<10?'0'+n:''+n;};a.download='warehouse_3d_'+now.getFullYear()+pad(now.getMonth()+1)+pad(now.getDate())+'_'+pad(now.getHours())+pad(now.getMinutes())+'.png';document.body.appendChild(a);a.click();document.body.removeChild(a);setTimeout(function(){URL.revokeObjectURL(url);},1000);},'image/png');}catch(e){// fallback: 새 탭에 이미지 열기
var dataUrl=cv.toDataURL('image/png');window.open(dataUrl,'_blank');}};const animate=()=>{if(!view3dSceneRef.current)return;requestAnimationFrame(animate);updateWalkthrough();renderer.render(scene,camera);};animate();};if(!window.THREE){const sc=document.createElement('script');sc.src='https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js';sc.onload=loadAndInit;document.head.appendChild(sc);}else{loadAndInit();}return()=>{if(view3dKeyRef.current){window.removeEventListener('keydown',view3dKeyRef.current.down);window.removeEventListener('keyup',view3dKeyRef.current.up);view3dKeyRef.current=null;}if(view3dWalkRef.current){view3dWalkRef.current.active=false;view3dWalkRef.current=null;}if(view3dSceneRef.current){view3dSceneRef.current.renderer.dispose();view3dSceneRef.current=null;}};},[activeTab,layoutData]);const[rackDetailModal,setRackDetailModal]=useState(null);// 'items', 'stock', 'weight', 'bins'
// 백업 모달
const[showBackupModal,setShowBackupModal]=useState(false);const[backupData,setBackupData]=useState('');// 모델별/Sub-component 생산 가능 대수 상세 모달
const[showModelDetailModal,setShowModelDetailModal]=useState(null);// 'excess', 'normal', 'caution', 'urgent'
const[showSubcomDetailModal,setShowSubcomDetailModal]=useState(null);const[showShortageDetailModal,setShowShortageDetailModal]=useState(null);// 'critical', 'high', 'withPO', 'noPO' // 'excess', 'normal', 'caution', 'urgent'
// Cycle Time 그래프 설정
const[showGraphModal,setShowGraphModal]=useState(false);const[graphDateRange,setGraphDateRange]=useState({start:'',end:''});const[graphViewType,setGraphViewType]=useState('monthly');// 'monthly', 'daily', 'custom'
const[selectedMonth,setSelectedMonth]=useState(new Date().toISOString().slice(0,7));// YYYY-MM
// TO DO 뷰 모드
const[todoViewMode,setTodoViewMode]=useState('list');// 'list' or 'calendar'
// URL 파라미터 지원
const urlParams=useMemo(()=>{try{return new URLSearchParams(window.location.search);}catch(e){return new URLSearchParams();}},[]);const[locateSearch,setLocateSearch]=useState(urlParams.get('q')||'');const[locateQuery,setLocateQuery]=useState(urlParams.get('q')||'');const[calendarMonth,setCalendarMonth]=useState(new Date());const[selectedCalendarTodo,setSelectedCalendarTodo]=useState(null);const[selectedCategory,setSelectedCategory]=useState(null);// 온습도 Excel 내보내기 모달
const[showTempHumidityExportModal,setShowTempHumidityExportModal]=useState(false);// 온습도 관리 상태
const[tempHumidityData,setTempHumidityData]=useState(()=>{const saved=safeStorage.getItem('pbk_temp_humidity_data');const savedData=saved?JSON.parse(saved):{};// 과거 데이터와 사용자 입력 데이터 병합 (사용자 입력이 우선)
return{...HISTORICAL_TEMP_HUMIDITY_DATA,...savedData};});const[tempHumidityMonth,setTempHumidityMonth]=useState(()=>{const now=new Date();return`${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}`;});const[tempHumidityRecorder,setTempHumidityRecorder]=useState(()=>{return safeStorage.getItem('pbk_temp_humidity_recorder')||'JM. Jung';});// 삭제 확인 모달
const[deleteConfirm,setDeleteConfirm]=useState({show:false,type:'',id:null,text:'',count:0});// ========== v15 신규 기능 ==========
// 다크 모드
const[darkMode,setDarkMode]=useState(()=>{const saved=safeStorage.getItem('pbk_dark_mode');return saved?JSON.parse(saved):false;});// 알림 센터
const[showNotificationCenter,setShowNotificationCenter]=useState(false);const[notifications,setNotifications]=useState(()=>{const saved=safeStorage.getItem('pbk_notifications');return saved?JSON.parse(saved):[];});// 토스트 메시지 (자동 저장 표시)
const[toasts,setToasts]=useState([]);// 로딩 상태 (loadingText만 추가, isLoading은 기존 것 사용)
const[loadingText,setLoadingText]=useState('');// 데이터 업로드 히스토리
const[dataHistory,setDataHistory]=useState(()=>{const saved=safeStorage.getItem('pbk_data_history');return saved?JSON.parse(saved):[];});const[showHistoryModal,setShowHistoryModal]=useState(false);// 단축키 도움말 모달
const[showShortcutHelp,setShowShortcutHelp]=useState(false);// 공간 최적화 리포트 모달
const[showSpaceOptimizationModal,setShowSpaceOptimizationModal]=useState(false);const[showSeriesCards,setShowSeriesCards]=useState(false);// 기본 접힘
const[showDetailSection,setShowDetailSection]=useState(false);// 상세 정보 접힘
// ========== KPI 관리 ==========
// GR Cancel 기본 데이터 (Movement Type 102 기준)
// GR Cancel 기본값 (SUM 시트 기준 확정 데이터)
const DEFAULT_GR_CANCEL_DATA={'2024-01':1,'2024-02':0,'2024-03':0,'2024-04':0,'2024-05':0,'2024-06':0,'2024-07':0,'2024-08':0,'2024-09':0,'2024-10':1,'2024-11':0,'2024-12':0,'2025-01':0,'2025-02':0,'2025-03':0,'2025-04':0,'2025-05':0,'2025-06':0,'2025-07':0,'2025-08':0,'2025-09':1,'2025-10':0,'2025-11':0,'2025-12':0,'2026-01':0};// GR Qty 기본값 (SUM 시트 기준 확정 데이터) - 엑셀 업로드 시 덮어씌워짐
const DEFAULT_GR_CANCEL_QTY={'2024-01':91,'2024-02':201,'2024-03':123,'2024-04':68,'2024-05':65,'2024-06':110,'2024-07':114,'2024-08':85,'2024-09':107,'2024-10':108,'2024-11':167,'2024-12':138,'2025-01':83,'2025-02':0,'2025-03':0,'2025-04':0,'2025-05':0,'2025-06':0,'2025-07':0,'2025-08':0,'2025-09':0,'2025-10':0,'2025-11':0,'2025-12':0,'2026-01':83};const[kpiData,setKpiData]=useState(()=>{const saved=safeStorage.getItem('pbk_kpi_data');if(saved){const parsed=JSON.parse(saved);return{grCancel:{...DEFAULT_GR_CANCEL_DATA,...parsed.grCancel},grCancelQty:{...DEFAULT_GR_CANCEL_QTY,...parsed.grCancelQty},inventoryAdjust:parsed.inventoryAdjust||{}};}return{grCancel:DEFAULT_GR_CANCEL_DATA,grCancelQty:DEFAULT_GR_CANCEL_QTY,inventoryAdjust:{}};});// v17: GR Cancel 엑셀 업로드 상태
const[grCancelUploadStatus,setGrCancelUploadStatus]=useState(null);// null | 'loading' | 'success' | 'error'
const[grCancelUploadMsg,setGrCancelUploadMsg]=useState('');const[inventoryLossUploadStatus,setInventoryLossUploadStatus]=useState(null);const[inventoryLossUploadMsg,setInventoryLossUploadMsg]=useState('');const[showKpiInputModal,setShowKpiInputModal]=useState(false);const[kpiInputMonth,setKpiInputMonth]=useState(new Date().toISOString().slice(0,7));const[kpiInputType,setKpiInputType]=useState('grCancel');// 'grCancel' or 'inventoryAdjust'
const[kpiSelectedYear,setKpiSelectedYear]=useState(new Date().getFullYear());// KPI 연도 선택
// KPI 점수 계산 함수
const KPI_SCORE_TABLE={grCancel:[{score:100,max:0},{score:90,max:1},{score:80,max:2},{score:70,max:3},{score:60,max:4},{score:50,max:5},{score:40,max:6},{score:30,max:7},{score:20,max:8},{score:10,max:9}],inventoryAdjust:[{score:100,max:0.02},{score:90,max:0.04},{score:80,max:0.064},{score:70,max:0.08},{score:60,max:0.10},{score:50,max:0.12},{score:40,max:0.14},{score:30,max:0.16},{score:20,max:0.18},{score:10,max:0.20}],kittingLeadTime:[{score:100,max:2},{score:90,max:2.5},{score:80,max:3},{score:70,max:4},{score:60,max:4.5},{score:50,max:5},{score:40,max:5.5},{score:30,max:6},{score:20,max:6.5},{score:10,max:7}]};const calculateKpiScore=(type,value)=>{if(value===null||value===undefined)return null;const table=KPI_SCORE_TABLE[type];if(!table)return null;for(const row of table){if(value<=row.max)return row.score;}return 10;// 최저 점수
};// ========== 상태별 색상 정의 (일관성) ==========
const STATUS_COLORS={danger:{bg:'bg-red-100',text:'text-red-700',border:'border-red-500',badge:'bg-red-500'},warning:{bg:'bg-amber-100',text:'text-amber-700',border:'border-amber-500',badge:'bg-amber-500'},success:{bg:'bg-emerald-100',text:'text-emerald-700',border:'border-emerald-500',badge:'bg-emerald-500'},info:{bg:'bg-blue-100',text:'text-blue-700',border:'border-blue-500',badge:'bg-blue-500'},neutral:{bg:'bg-gray-100',text:'text-gray-700',border:'border-gray-500',badge:'bg-gray-500'}};// safeStorage에 저장
useEffect(()=>{safeStorage.setItem('pbk_pick_cycles',JSON.stringify(pickCycles));},[pickCycles]);// 마운트 시 완료된 pickCycles의 cycleMin을 영업시간 기준으로 재계산
useEffect(()=>{setPickCycles(prev=>{let changed=false;const updated=prev.map(p=>{if(p.status==='completed'&&p.startTime&&p.completed){const oldMin=p.cycleMin||0;// 간단한 영업시간 계산 (calculateWorkingMinutes가 아직 안 됨 → 인라인)
const start=new Date(p.startTime);const end=new Date(p.completed);if(!isNaN(start.getTime())&&!isNaN(end.getTime())&&end>start){let totalMin=0;const cur=new Date(start);while(cur<end){const krTime=new Date(cur.toLocaleString('en-US',{timeZone:'Asia/Seoul'}));const day=krTime.getDay();const h=krTime.getHours();const m=krTime.getMinutes();const t=h+m/60;const dateStr=krTime.getFullYear()+'-'+String(krTime.getMonth()+1).padStart(2,'0')+'-'+String(krTime.getDate()).padStart(2,'0');const isWorkday=day>=1&&day<=5&&!KR_HOLIDAYS.has(dateStr);const isWorkHour=h>=7&&h<16;const isLunch=t>=12.5&&t<13.5;if(isWorkday&&isWorkHour&&!isLunch)totalMin++;cur.setTime(cur.getTime()+60000);}if(Math.abs(totalMin-oldMin)>5){changed=true;return{...p,cycleMin:totalMin};}}}return p;});return changed?updated:prev;});},[]);// eslint-disable-line react-hooks/exhaustive-deps
useEffect(()=>{safeStorage.setItem('pbk_receive_cycles',JSON.stringify(receiveCycles));},[receiveCycles]);useEffect(()=>{safeStorage.setItem('pbk_kitting_data',JSON.stringify(kittingData));},[kittingData]);// LT 재계산은 useState 초기화에서 처리됨
useEffect(()=>{safeStorage.setItem('pbk_todo_list',JSON.stringify(todoList));},[todoList]);// v15: 다크모드 저장
useEffect(()=>{safeStorage.setItem('pbk_dark_mode',JSON.stringify(darkMode));},[darkMode]);// v15: 알림 저장
useEffect(()=>{safeStorage.setItem('pbk_notifications',JSON.stringify(notifications));},[notifications]);// v15: 데이터 히스토리 저장
useEffect(()=>{safeStorage.setItem('pbk_data_history',JSON.stringify(dataHistory));},[dataHistory]);// v15: KPI 데이터 저장
useEffect(()=>{safeStorage.setItem('pbk_kpi_data',JSON.stringify(kpiData));},[kpiData]);// 온습도 데이터 저장
useEffect(()=>{safeStorage.setItem('pbk_temp_humidity_data',JSON.stringify(tempHumidityData));},[tempHumidityData]);useEffect(()=>{safeStorage.setItem('pbk_temp_humidity_recorder',tempHumidityRecorder);},[tempHumidityRecorder]);// 마감 임박/당일 할일 체크 및 알림
useEffect(()=>{const checkDueSoonTodos=()=>{const today=new Date().toISOString().split('T')[0];const tomorrow=new Date(Date.now()+24*60*60*1000).toISOString().split('T')[0];const dueSoon=todoList.filter(todo=>!todo.completed&&todo.dueDate&&(todo.dueDate===today||todo.dueDate===tomorrow||todo.dueDate<today));setDueSoonTodos(dueSoon);if(dueSoon.length>0){setShowDueSoonAlert(true);document.title=`(${dueSoon.length}) ⚠️ Warehouse Management`;}else{document.title='Warehouse Management';}};checkDueSoonTodos();if('Notification'in window){setNotificationPermission(Notification.permission);}},[todoList]);// Bin 100% 알림 확인
useEffect(()=>{const checkFullBins=()=>{const full=[];rackSummary.forEach(rack=>{// 각 랙의 모든 Bin 확인
const rackBins={};inventoryData.filter(item=>item.rack===rack.id).forEach(item=>{const bin=item.bin;if(!rackBins[bin]){rackBins[bin]={count:0,maxCount:10};// 임시로 Bin당 최대 10개 품목
}rackBins[bin].count++;});// 100% 찬 Bin 찾기 (임시 기준: 품목 수가 10개 이상이면 100%)
Object.entries(rackBins).forEach(([bin,data])=>{if(data.count>=10){full.push({rack:rack.id,bin,count:data.count});}});});setFullBins(full);};if(inventoryData.length>0){checkFullBins();}},[inventoryData,rackSummary]);// 탭이 보일 때 깜빡임 효과 (마감 임박 항목 있을 때)
useEffect(()=>{let interval;const today=new Date().toISOString().split('T')[0];const urgentCount=todoList.filter(todo=>!todo.completed&&todo.dueDate&&(todo.dueDate===today||todo.dueDate<today)).length;if(urgentCount>0){let isAlert=true;interval=setInterval(()=>{if(isAlert){document.title=`🚨 (${urgentCount}) 마감 임박!`;}else{document.title=`⏰ Warehouse Management`;}isAlert=!isAlert;},1500);}return()=>{if(interval)clearInterval(interval);};},[todoList]);// 온습도 미입력 알림 상태
const[showTempAlert,setShowTempAlert]=useState(false);const[showUploadAlert,setShowUploadAlert]=useState(false);const[showOpenPOAlert,setShowOpenPOAlert]=useState(false);// 온습도 미입력 체크 (평일 오후 2시 이후 ~ 퇴근 전)
useEffect(()=>{const checkAlerts=()=>{const now=new Date();const dayOfWeek=now.getDay();const currentHour=now.getHours();// 주말이면 체크 안함
if(dayOfWeek===0||dayOfWeek===6)return;// 공휴일이면 체크 안함
const todayStr=now.toISOString().split('T')[0];if(KR_HOLIDAYS.has(todayStr))return;// 오후 2시(14시) 이후면 온습도 체크
if(currentHour>=14){const today=now.toISOString().split('T')[0];const todayData=tempHumidityData[today];const hasInput=todayData&&(todayData.temp||todayData.humidity);setShowTempAlert(!hasInput);}// 오전 9시 이후면 재고/Open PO 업로드 체크 (오늘 업로드 여부)
if(currentHour>=9){const krNow=new Date(now.toLocaleString('en-US',{timeZone:'Asia/Seoul'}));const todayISO=krNow.getFullYear()+'-'+String(krNow.getMonth()+1).padStart(2,'0')+'-'+String(krNow.getDate()).padStart(2,'0');// dataHistory에서 오늘 stock 업로드 기록 확인
const toKRDateStr=ts=>{try{const d=new Date(ts);const kr=new Date(d.getTime()+9*60*60*1000);return kr.toISOString().slice(0,10);}catch(e){return'';}};const stockUploadedToday=dataHistory.some(h=>h.type==='stock'&&h.timestamp&&toKRDateStr(h.timestamp)===todayISO);// dataHistory에서 오늘 openPO 업로드 기록 확인
const poUploadedToday=dataHistory.some(h=>h.type==='openPO'&&h.timestamp&&toKRDateStr(h.timestamp)===todayISO);setShowUploadAlert(!stockUploadedToday);setShowOpenPOAlert(!poUploadedToday);}else{setShowUploadAlert(false);setShowOpenPOAlert(false);}};checkAlerts();const interval=setInterval(checkAlerts,60000);return()=>clearInterval(interval);},[tempHumidityData,inventoryData,openPOData,dataHistory]);// TO DO 수정 함수
const updateTodo=(id,field,value)=>{setTodoList(prev=>prev.map(todo=>todo.id===id?{...todo,[field]:value}:todo));};// TO DO 삭제 확인
const confirmDeleteTodo=()=>{setTodoList(prev=>prev.filter(t=>t.id!==deleteConfirm.id));setDeleteConfirm({show:false,type:'',id:null,text:'',count:0});};useEffect(()=>{safeStorage.setItem('pbk_rack_config',JSON.stringify(rackConfig));},[rackConfig]);useEffect(()=>{safeStorage.setItem('pbk_weight_data',JSON.stringify(weightData));},[weightData]);// 필터 상태 safeStorage에 저장 (C2 개선)
useEffect(()=>{safeStorage.setItem('pbk_filter_inventorySortBy',inventorySortBy);safeStorage.setItem('pbk_filter_inventorySortOrder',inventorySortOrder);},[inventorySortBy,inventorySortOrder]);useEffect(()=>{safeStorage.setItem('pbk_filter_weightSortBy',weightSortBy);safeStorage.setItem('pbk_filter_weightSortOrder',weightSortOrder);},[weightSortBy,weightSortOrder]);useEffect(()=>{safeStorage.setItem('pbk_filter_pickSortBy',pickSortBy);safeStorage.setItem('pbk_filter_pickSortOrder',pickSortOrder);safeStorage.setItem('pbk_filter_pickFilterModel',pickFilterModel);safeStorage.setItem('pbk_filter_pickFilterStatus',pickFilterStatus);safeStorage.setItem('pbk_filter_pickFilterWorker',pickFilterWorker);safeStorage.setItem('pbk_filter_pickFilterUrgent',pickFilterUrgent);},[pickSortBy,pickSortOrder,pickFilterModel,pickFilterStatus,pickFilterWorker,pickFilterUrgent]);useEffect(()=>{safeStorage.setItem('pbk_filter_receiveSortBy',receiveSortBy);safeStorage.setItem('pbk_filter_receiveSortOrder',receiveSortOrder);safeStorage.setItem('pbk_filter_receiveFilterStatus',receiveFilterStatus);},[receiveSortBy,receiveSortOrder,receiveFilterStatus]);// 키보드 단축키 (Ctrl+N: 새 입고, Ctrl+K: 새 Kitting, Ctrl+D: 대시보드)
useEffect(()=>{const handleKeyDown=e=>{// input, textarea에서는 단축키 무시
if(e.target.tagName==='INPUT'||e.target.tagName==='TEXTAREA')return;if(e.ctrlKey||e.metaKey){switch(e.key.toLowerCase()){case'm':e.preventDefault();setActiveTab('receive');setShowReceiveModal(true);break;case'k':e.preventDefault();setActiveTab('kitting');setShowKittingModal(true);break;case'd':e.preventDefault();setActiveTab('dashboard');break;case'b':e.preventDefault();setShowBackupModal(true);break;case'/':case'?':e.preventDefault();setShowShortcutHelp(true);break;case'n':e.preventDefault();setShowNotificationCenter(true);break;}}// ESC로 모달 닫기
if(e.key==='Escape'){setShowShortcutHelp(false);setShowNotificationCenter(false);setShowSpaceOptimizationModal(false);setShowHistoryModal(false);}};window.addEventListener('keydown',handleKeyDown);return()=>window.removeEventListener('keydown',handleKeyDown);},[]);// 불출 Cycle 담당자 변경 시 Kitting 담당자 자동 동기화 + Lead Time 재계산
useEffect(()=>{if(pickCycles.length===0||kittingData.length===0)return;// Production Order별 불출 정보 맵 생성
const pickInfoMap={};pickCycles.forEach(p=>{const po=p.productionOrder||p.orderId;if(po){pickInfoMap[po]={worker:p.worker,startTime:p.startTime,completed:p.completed,cycleMin:p.cycleMin,status:p.status};}});// Kitting 담당자 동기화 + Lead Time 재계산 (완료된 것만)
let hasChanges=false;const updatedKitting=kittingData.map(k=>{const pickInfo=pickInfoMap[k.productionOrder];if(!pickInfo)return k;let updated={...k};// 담당자 동기화
if(pickInfo.worker&&k.worker!==pickInfo.worker){updated.worker=pickInfo.worker;hasChanges=true;}// 완료된 Kitting의 Lead Time 재계산 (영업일 기준)
if(k.status==='completed'&&pickInfo.status==='completed'&&pickInfo.startTime){const startTime=new Date(pickInfo.startTime);const endTime=pickInfo.completed?new Date(pickInfo.completed):new Date();if(!isNaN(startTime.getTime())&&!isNaN(endTime.getTime())&&endTime>startTime){const newLeadTime=getBusinessDays(startTime,endTime);if(newLeadTime>=0&&Math.abs(newLeadTime-(k.leadTimeDays||0))>0.05){updated.leadTimeDays=newLeadTime;if(pickInfo.startTime){updated.startedAt=pickInfo.startTime;}hasChanges=true;}}}return updated;});if(hasChanges){setKittingData(updatedKitting);}},[pickCycles]);// 이전에 입력한 협력업체 목록 (자동완성용)
const previousVendors=React.useMemo(()=>{const vendors=new Set();receiveCycles.forEach(r=>{if(r.vendor)vendors.add(r.vendor);});return Array.from(vendors).sort();},[receiveCycles]);// 협력업체 자동완성 필터링
const filteredVendorSuggestions=React.useMemo(()=>{if(!newReceive.vendor)return previousVendors.slice(0,5);const term=newReceive.vendor.toLowerCase();return previousVendors.filter(v=>v.toLowerCase().includes(term)).slice(0,5);},[newReceive.vendor,previousVendors]);// 정렬/필터된 Pick 데이터 (A5 개선 - 긴급 Order 상단 고정)
const filteredSortedPicks=React.useMemo(()=>{let result=[...pickCycles];// 월별 필터 (Basic Start Date 기준)
if(pickFilterMonth){const ym=pickFilterMonth;const ymShort=ym.slice(2);result=result.filter(p=>p.startedAt?.startsWith(ym)||p.startedAt?.startsWith(ymShort)||p.basicStartDate?.startsWith(ym)||p.basicStartDate?.startsWith(ymShort));}// 검색 필터
if(pickSearchTerm){const term=pickSearchTerm.toLowerCase();result=result.filter(p=>(p.productionOrder||p.orderId||'').toLowerCase().includes(term)||(p.materialDesc||'').toLowerCase().includes(term));}// Model 필터
if(pickFilterModel!=='all'){result=result.filter(p=>p.model===pickFilterModel);}// 상태 필터
if(pickFilterStatus!=='all'){result=result.filter(p=>p.status===pickFilterStatus);}// 담당자 필터
if(pickFilterWorker!=='all'){result=result.filter(p=>p.worker===pickFilterWorker);}// 긴급 필터
if(pickFilterUrgent!=='all'){result=result.filter(p=>pickFilterUrgent==='urgent'?p.isUrgent:!p.isUrgent);}// 정렬 (A5 개선: 긴급 + 미완료는 항상 최상단)
result.sort((a,b)=>{// 1순위: 긴급 + 미완료는 최상단 (완료되지 않은 긴급 건)
const aIsUrgentPending=a.isUrgent&&a.status!=='completed';const bIsUrgentPending=b.isUrgent&&b.status!=='completed';if(aIsUrgentPending&&!bIsUrgentPending)return-1;if(!aIsUrgentPending&&bIsUrgentPending)return 1;// 2순위: 일반 정렬
let aVal,bVal;if(pickSortBy==='productionOrder'){aVal=a.productionOrder||a.orderId||'';bVal=b.productionOrder||b.orderId||'';}else if(pickSortBy==='basicStartDate'){aVal=a.basicStartDate||a.received||'';bVal=b.basicStartDate||b.received||'';}else if(pickSortBy==='model'){aVal=a.model||'';bVal=b.model||'';}else if(pickSortBy==='status'){const statusOrder={'waiting':0,'in-progress':1,'paused':2,'completed':3};aVal=statusOrder[a.status]||0;bVal=statusOrder[b.status]||0;}if(pickSortOrder==='asc'){return aVal>bVal?1:aVal<bVal?-1:0;}else{return aVal<bVal?1:aVal>bVal?-1:0;}});return result;},[pickCycles,pickFilterMonth,pickSearchTerm,pickFilterModel,pickFilterStatus,pickFilterWorker,pickFilterUrgent,pickSortBy,pickSortOrder]);// 정렬/필터된 Receive 데이터
const filteredSortedReceives=React.useMemo(()=>{let result=[...receiveCycles];// 검색 필터
if(receiveSearchTerm){const term=receiveSearchTerm.toLowerCase();result=result.filter(r=>(r.poNo||'').toLowerCase().includes(term)||(r.vendor||'').toLowerCase().includes(term));}// 상태 필터
if(receiveFilterStatus!=='all'){result=result.filter(r=>r.status===receiveFilterStatus);}// 정렬
result.sort((a,b)=>{let aVal,bVal;if(receiveSortBy==='poNo'){aVal=a.poNo||'';bVal=b.poNo||'';}else if(receiveSortBy==='delivery'){aVal=a.delivery||'';bVal=b.delivery||'';}else if(receiveSortBy==='vendor'){aVal=a.vendor||'';bVal=b.vendor||'';}if(receiveSortOrder==='asc'){return aVal>bVal?1:aVal<bVal?-1:0;}else{return aVal<bVal?1:aVal>bVal?-1:0;}});return result;},[receiveCycles,receiveSearchTerm,receiveFilterStatus,receiveSortBy,receiveSortOrder]);// 무게 데이터 수정
const updateWeight=(material,field,value)=>{setWeightData(prev=>({...prev,[material]:{...prev[material],[field]:field==='w'?parseFloat(value)||0:value}}));};// 무게 데이터 엑셀 대량 업로드
const handleWeightExcelUpload=async e=>{const file=e.target.files[0];if(!file)return;try{const XLSX=await new Promise(res=>{if(window.XLSX){res(window.XLSX);return;}var s=document.createElement('script');s.src='https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js';s.onload=()=>res(window.XLSX);document.head.appendChild(s);});const data=await file.arrayBuffer();const workbook=XLSX.read(data);const sheetName=workbook.SheetNames[0];const worksheet=workbook.Sheets[sheetName];const jsonData=XLSX.utils.sheet_to_json(worksheet);if(jsonData.length===0){alert('❌ 엑셀 파일에 데이터가 없습니다.');return;}// 컬럼명 자동 감지 (Material, Description, Weight, Bin 등)
const firstRow=jsonData[0];const keys=Object.keys(firstRow);// Material 컬럼 찾기
const materialCol=keys.find(k=>k.toLowerCase().includes('material')||k.toLowerCase()==='mat'||k.toLowerCase()==='품번'||k.toLowerCase()==='part')||keys[0];// Description 컬럼 찾기
const descCol=keys.find(k=>k.toLowerCase().includes('desc')||k.toLowerCase().includes('품명')||k.toLowerCase().includes('name'));// Weight 컬럼 찾기 (g 또는 kg)
const weightColG=keys.find(k=>k.toLowerCase().includes('weight')&&k.toLowerCase().includes('g')&&!k.toLowerCase().includes('kg'));const weightColKg=keys.find(k=>k.toLowerCase().includes('weight')&&k.toLowerCase().includes('kg'));const weightCol=keys.find(k=>k.toLowerCase().includes('weight')||k.toLowerCase().includes('무게')||k.toLowerCase()==='net weight');// Bin 컬럼 찾기
const binCol=keys.find(k=>k.toLowerCase().includes('bin')||k.toLowerCase().includes('storage')||k.toLowerCase().includes('위치'));let addedCount=0;let updatedCount=0;const newWeightData={...weightData};jsonData.forEach(row=>{const material=String(row[materialCol]||'').trim();if(!material)return;// 무게 처리 (g → kg 변환)
let weightKg=0;if(weightColG&&row[weightColG]){weightKg=parseFloat(row[weightColG])/1000;// g → kg
}else if(weightColKg&&row[weightColKg]){weightKg=parseFloat(row[weightColKg]);// 이미 kg
}else if(weightCol&&row[weightCol]){const w=parseFloat(row[weightCol]);// 1000 이상이면 g로 간주, 아니면 kg로 간주
weightKg=w>100?w/1000:w;}const desc=descCol?String(row[descCol]||''):'';const bin=binCol?String(row[binCol]||''):'';if(newWeightData[material]){updatedCount++;}else{addedCount++;}newWeightData[material]={d:desc||newWeightData[material]?.d||'',w:weightKg||newWeightData[material]?.w||0,b:bin||newWeightData[material]?.b||''};});setWeightData(newWeightData);alert(`✅ 업로드 완료!\n- 신규 추가: ${addedCount}개\n- 업데이트: ${updatedCount}개\n- 총: ${Object.keys(newWeightData).length}개`);}catch(error){console.error('Excel upload error:',error);alert('❌ 엑셀 파일 처리 중 오류가 발생했습니다.\n'+error.message);}e.target.value='';// 같은 파일 재업로드 가능하게
};// 신규 Material 추가
const addNewMaterial=()=>{if(!newMaterial.material.trim())return;setWeightData(prev=>({...prev,[newMaterial.material]:{d:newMaterial.desc,w:parseFloat(newMaterial.weight)||0,b:newMaterial.bin}}));setNewMaterial({material:'',desc:'',weight:'',bin:''});setShowWeightModal(false);};// Material 삭제
const deleteMaterial=material=>{if(!confirm(`${material}을(를) 삭제하시겠습니까?`))return;setWeightData(prev=>{const newData={...prev};delete newData[material];return newData;});};// 엑셀 내보내기 공통 함수
const[exportModalData,setExportModalData]=useState(null);const exportToExcel=async(data,filename,sheetName='Sheet1')=>{if(!data||data.length===0)return;const headers=Object.keys(data[0]);const rows=[headers.join('\t')];data.forEach(row=>{rows.push(headers.map(h=>String(row[h]??'')).join('\t'));});setExportModalData({text:rows.join('\n'),filename,count:data.length});};// 재고 목록 엑셀 내보내기
const exportInventory=()=>{const data=inventoryData.map(item=>({'품번':item.material,'품명':item.description,'Storage Bin':item.bin,'랙':getRackId(item.bin),'가용재고':item.stock,'단위':item.unit}));exportToExcel(data,'PBK_재고목록','재고목록');};// 무게 정보 엑셀 내보내기
const exportWeightData=()=>{const data=Object.entries(weightData).map(([material,info])=>{const invItem=inventoryData.find(i=>i.material===material);return{'Material':material,'Description':info.d||'','Storage Bin':info.b||'','무게(g)':((info.w||0)*1000).toFixed(1),'무게(kg)':(info.w||0).toFixed(4),'현재재고':invItem?.stock||0,'총무게(kg)':((invItem?.stock||0)*(info.w||0)).toFixed(2)};});exportToExcel(data,'PBK_무게정보','무게정보');};// 랙별 현황 엑셀 내보내기
const exportRackSummary=()=>{const SPECIAL_AREAS=['D2','E','F1','LABEL'];const data=rackSummary.map(rack=>{// 공간 사용률 계산
let curBoxes=0,maxBoxes=0;if(!SPECIAL_AREAS.includes(rack.id)){const areaItems=inventoryData.filter(item=>{const bin=item.bin||'';return bin.startsWith(rack.id+'-')||bin===rack.id;});const binGroups={};areaItems.forEach(item=>{const bin=item.bin||rack.id;if(!binGroups[bin])binGroups[bin]=[];binGroups[bin].push(item);});Object.entries(binGroups).forEach(([bin,items])=>{items.forEach(item=>{const qtyPerBox=MATERIAL_QTY_PER_BOX[item.material]||1;curBoxes+=(item.stock||0)/qtyPerBox;});const binInfo=BIN_RACK_INFO[bin]||{rackType:'경량랙',rackCount:1};const binBoxTypes=items.map(i=>MATERIAL_BOX_MAP[i.material]||'PLASTIC-S');const tc={};binBoxTypes.forEach(t=>{tc[t]=(tc[t]||0)+1;});const mainBT=Object.entries(tc).sort((a,b)=>b[1]-a[1])[0]?.[0]||'PLASTIC-S';if(binInfo.maxBoxes){maxBoxes+=binInfo.maxBoxes;}else if(binInfo.mixed){binInfo.mixed.forEach(m=>{const s=BOXES_PER_SHELF[m.type]||BOXES_PER_SHELF['경량랙'];maxBoxes+=(s[mainBT]||s['PLASTIC-S']||2)*m.count;});}else{const s=BOXES_PER_SHELF[binInfo.rackType]||BOXES_PER_SHELF['경량랙'];maxBoxes+=(s[mainBT]||s['PLASTIC-S']||2)*binInfo.rackCount*(binInfo.shelves||1);}});}const spaceUtil=maxBoxes>0?(curBoxes/maxBoxes*100).toFixed(1):'N/A';return{'랙ID':rack.id,'모델시리즈':RACK_MODEL_SERIES[rack.id]||'기타','품목수':rack.items,'총재고':rack.stock,'현재박스수':curBoxes.toFixed(1),'최대박스수':maxBoxes||'N/A','공간사용률(%)':spaceUtil,'총무게(kg)':rack.weight.toFixed(2),'최대무게(kg)':rack.maxWeight>=99999?'무제한':rack.maxWeight};});exportToExcel(data,'PBK_랙별현황','랙별현황');};// 불출 Cycle Time 엑셀 내보내기
const exportPickCycles=()=>{const data=pickCycles.map(cycle=>({'Production Order':cycle.productionOrder,'Material':cycle.material,'Description':cycle.description,'수량':cycle.quantity,'요청시간':cycle.requestTime,'완료시간':cycle.completeTime||'','상태':cycle.status==='completed'?'완료':cycle.status==='in-progress'?'진행중':'대기','Cycle Time(분)':cycle.cycleTime||''}));exportToExcel(data,'PBK_불출CycleTime','불출Cycle');};// 입고 Cycle Time 엑셀 내보내기
const exportReceiveCycles=()=>{const data=receiveCycles.map(cycle=>({'Material':cycle.material,'Description':cycle.description,'수량':cycle.quantity,'PO Number':cycle.poNumber||'','도착시간':cycle.arrivalTime,'MIGO완료시간':cycle.migoTime||'','적치완료시간':cycle.putawayTime||'','상태':cycle.status==='completed'?'완료':cycle.status==='migo-done'?'MIGO완료':'도착','총CycleTime(분)':cycle.totalCycleTime||''}));exportToExcel(data,'PBK_입고CycleTime','입고Cycle');};// Kitting 현황 엑셀 내보내기
const exportKittingData=()=>{const data=kittingData.map(order=>({'주문번호':order.orderId,'모델':order.model,'수량':order.quantity,'시작일':order.startDate,'목표완료일':order.targetDate,'진행률(%)':order.progress,'상태':order.status==='completed'?'완료':order.status==='in-progress'?'진행중':order.status==='paused'?'일시정지':'대기','완료품목':order.completedItems,'총품목':order.totalItems}));exportToExcel(data,'PBK_Kitting현황','Kitting');};// TO DO 리스트 엑셀 내보내기
const exportTodoList=()=>{const categoryNames={general:'일반',data:'데이터',process:'프로세스',kpi:'KPI',other:'기타'};const priorityNames={high:'높음',medium:'중간',low:'낮음'};const data=todoList.map(todo=>({'할일':todo.text,'카테고리':categoryNames[todo.category]||todo.category,'우선순위':priorityNames[todo.priority]||todo.priority,'완료여부':todo.completed?'완료':'미완료','생성일':todo.createdAt,'마감일':todo.dueDate||''}));exportToExcel(data,'PBK_TODO리스트','TODO');};// 저장된 재고 데이터 로드
useEffect(()=>{const savedInventory=safeStorage.getItem('pbk_inventory');const savedLastUpdated=safeStorage.getItem('pbk_last_updated');if(savedInventory){const data=JSON.parse(savedInventory);setInventoryData(data);processRackSummary(data);}if(savedLastUpdated){setLastUpdated(savedLastUpdated);}},[]);// 랙 ID 추출
const getRackId=bin=>{if(!bin)return'UNKNOWN';const binStr=String(bin).trim();if(binStr.match(/^\d/))return null;// Production Order Bin 제외
if(binStr.includes('-'))return binStr.split('-')[0];return binStr;};// 랙별 요약 계산
const processRackSummary=useCallback(data=>{const rackMap={};data.forEach(item=>{const rackId=getRackId(item.bin);if(!rackId)return;// Production Order Bin 제외
if(!rackMap[rackId]){rackMap[rackId]={id:rackId,zone:rackId.charAt(0),items:new Set(),stock:0,weight:0,bins:new Set()};}rackMap[rackId].items.add(item.material);rackMap[rackId].stock+=item.stock||0;// weightData에서 무게 가져오기 (kg 단위)
const itemWeight=weightData[item.material]?.w||0;rackMap[rackId].weight+=(item.stock||0)*itemWeight;rackMap[rackId].bins.add(item.bin);});const summary=Object.values(rackMap).map(rack=>({id:rack.id,zone:rack.zone,items:rack.items.size,stock:rack.stock,weight:rack.weight,bins:rack.bins.size,maxBins:rackConfig[rack.id]?.maxBins||10,maxWeight:rackConfig[rack.id]?.maxWeight||200})).sort((a,b)=>b.stock-a.stock);setRackSummary(summary);},[rackConfig,weightData]);// 엑셀 파일 파싱 (SheetJS 사용)
const parseExcelFile=async file=>{setIsLoading(true);setUploadError(null);try{// SheetJS 라이브러리 로드
if(!window.XLSX){await new Promise((resolve,reject)=>{const script=document.createElement('script');script.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';script.onload=resolve;script.onerror=reject;document.head.appendChild(script);});}const data=await file.arrayBuffer();const workbook=window.XLSX.read(data);const sheet=workbook.Sheets[workbook.SheetNames[0]];const jsonData=window.XLSX.utils.sheet_to_json(sheet);// SAP 데이터 파싱 
// Description 없는 행 (노란색) = Material별 총 재고 → 여기서 재고 추출
// Description 있는 행 = Bin 정보 + 품명 → 매핑용
// 1. Description 있는 행에서 Material별 정보 매핑 (Bin, Description)
const materialInfoMap={};jsonData.forEach(row=>{const material=row['Material'];const desc=row['Material Description'];const bin=row['Storage Bin'];if(material&&desc&&desc.toString().trim()&&bin){const matKey=String(material);// Production Order Bin (숫자로 시작) 제외
if(String(bin).match(/^\d{10}/))return;if(!materialInfoMap[matKey]){materialInfoMap[matKey]={description:String(desc),bins:[]};}materialInfoMap[matKey].bins.push(String(bin));}});// 2. 노란색 행 (Description 없는 행)에서 총 재고 추출
const inventory=jsonData.filter(row=>{const material=row['Material'];const desc=row['Material Description'];// Material은 있고, Description은 비어있는 행 (노란색)
return material&&(!desc||!desc.toString().trim());}).map(row=>{const material=String(row['Material']||'');const info=materialInfoMap[material]||{description:'',bins:[]};// 첫 번째 Bin을 대표 Bin으로 사용
const primaryBin=info.bins.length>0?info.bins[0]:'';return{material:material,description:info.description,bin:primaryBin,allBins:info.bins,// 모든 Bin 저장
stock:parseFloat(row['Available stock'])||0,unit:String(row['Base Unit of Measure']||'EA')};}).filter(item=>item.bin);// Bin 정보가 있는 것만 (Production Order 제외됨)
if(inventory.length===0){throw new Error('유효한 재고 데이터가 없습니다. SAP 엑셀 형식을 확인해주세요.');}// 저장
setInventoryData(inventory);processRackSummary(inventory);const now=new Date().toLocaleString('ko-KR');setLastUpdated(now);safeStorage.setItem('pbk_inventory',JSON.stringify(inventory));safeStorage.setItem('pbk_last_updated',now);setShowUploadModal(false);// v15: 토스트, 알림, 히스토리 추가
showToast(`✅ SAP 재고 업로드 완료! ${inventory.length}개 품목`,'success');addNotification('재고 데이터 업로드',`${inventory.length}개 품목이 업로드되었습니다.`,'success');addDataHistory('stock',`SAP 재고 데이터 업로드 (${inventory.length}개 품목)`,inventory.length);}catch(error){console.error('Excel parsing error:',error);setUploadError(error.message||'엑셀 파일 파싱 중 오류가 발생했습니다.');showToast('❌ 파일 업로드 실패','error');}finally{setIsLoading(false);}};// 파일 드롭 핸들러
const handleDrop=useCallback(e=>{e.preventDefault();const file=e.dataTransfer.files[0];if(file&&(file.name.endsWith('.xlsx')||file.name.endsWith('.xls'))){parseExcelFile(file);}else{setUploadError('엑셀 파일(.xlsx, .xls)만 업로드 가능합니다.');}},[]);const handleFileSelect=e=>{const file=e.target.files[0];if(file){parseExcelFile(file);}};// Open PO 엑셀 파싱
const parseOpenPOFile=async file=>{setIsLoading(true);setOpenPOError(null);try{if(!window.XLSX){await new Promise((resolve,reject)=>{const script=document.createElement('script');script.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';script.onload=resolve;script.onerror=reject;document.head.appendChild(script);});}const data=await file.arrayBuffer();const workbook=window.XLSX.read(data);const sheet=workbook.Sheets[workbook.SheetNames[0]];const jsonData=window.XLSX.utils.sheet_to_json(sheet);// Z열: "Still to be delivered (qty)" > 0 필터링
const filtered=jsonData.filter(row=>{const qty=parseFloat(row['Still to be delivered (qty)']);return qty>0;});// Material별로 그룹화 (같은 Material의 수량 합산)
const poByMaterial={};filtered.forEach(row=>{const material=String(row['Material']||'').trim();const description=String(row['Short Text']||'').trim();const qty=parseFloat(row['Still to be delivered (qty)'])||0;const unit=String(row['Order Unit']||'EA').trim();const poNo=row['Purchasing Document'];if(material){if(!poByMaterial[material]){poByMaterial[material]={material,description,totalQty:0,unit,poNumbers:[]};}poByMaterial[material].totalQty+=qty;if(poNo&&!poByMaterial[material].poNumbers.includes(poNo)){poByMaterial[material].poNumbers.push(poNo);}}});const openPOList=Object.values(poByMaterial);if(openPOList.length===0){throw new Error('납품 예정인 자재가 없습니다. (Still to be delivered > 0)');}// 저장
setOpenPOData(openPOList);const now=new Date().toLocaleString('ko-KR');setOpenPOLastUpdated(now);safeStorage.setItem('pbk_open_po',JSON.stringify(openPOList));safeStorage.setItem('pbk_open_po_updated',now);setShowOpenPOModal(false);// v15: 토스트, 알림, 히스토리 추가
showToast(`✅ Open PO 업로드 완료! ${openPOList.length}개 자재`,'success');addNotification('Open PO 업로드',`${openPOList.length}개 자재 납품 예정이 업로드되었습니다.`,'success');addDataHistory('openPO',`Open PO 데이터 업로드 (${openPOList.length}개 자재)`,openPOList.length);}catch(error){console.error('Open PO parsing error:',error);setOpenPOError(error.message||'Open PO 파일 파싱 중 오류가 발생했습니다.');showToast('❌ Open PO 업로드 실패','error');}finally{setIsLoading(false);}};// Open PO 파일 핸들러
const handleOpenPODrop=useCallback(e=>{e.preventDefault();const file=e.dataTransfer.files[0];if(file&&(file.name.endsWith('.xlsx')||file.name.endsWith('.xls'))){parseOpenPOFile(file);}else{setOpenPOError('엑셀 파일(.xlsx, .xls)만 업로드 가능합니다.');}},[]);const handleOpenPOFileSelect=e=>{const file=e.target.files[0];if(file){parseOpenPOFile(file);}};// Open PO에서 자재 찾기 헬퍼 함수
const getOpenPOForMaterial=material=>{return openPOData.find(po=>po.material===material);};// BOM 파일 파싱 함수 (새 형식 + Sub-component 지원)
const parseBOMFile=async file=>{setIsLoading(true);try{// XLSX 라이브러리 로드
if(!window.XLSX){await new Promise((resolve,reject)=>{const script=document.createElement('script');script.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';script.onload=resolve;script.onerror=reject;document.head.appendChild(script);});}const data=await file.arrayBuffer();const workbook=window.XLSX.read(data,{type:'array'});// 모델별 BOM 데이터 + Sub-component 데이터
const modelBomData={};const subComponentBomData={};workbook.SheetNames.forEach(sheetName=>{// storage bin 시트 제외
if(sheetName.toLowerCase().includes('storage'))return;const worksheet=workbook.Sheets[sheetName];const jsonData=window.XLSX.utils.sheet_to_json(worksheet);if(jsonData.length===0)return;const bomItems={};let validCount=0;let excludedCount=0;jsonData.forEach(row=>{// Part No. = Component number 컬럼
const partNo=row['Component number'];// Qty = Comp. Qty (CUn) 컬럼
const qty=parseFloat(row['Comp. Qty (CUn)'])||1;// Phantom item 체크 - X면 제외
const phantom=row['Phantom item']||'';// Item category 체크 - L만 포함 (D, T 등은 제외)
const itemCategory=row['Item category']||'';// 제외 조건 1: Phantom item = X
if(phantom.toString().toUpperCase()==='X'){excludedCount++;return;}// 제외 조건 2: Item category가 L이 아닌 경우 (D, T 등)
if(itemCategory.toString().toUpperCase()!=='L'){excludedCount++;return;}if(partNo){validCount++;bomItems[String(partNo).trim()]=qty;}});// 시트 탭 이름으로 완제품/Sub-component 구분
if(sheetName.startsWith('KB')){// Sub-component
subComponentBomData[sheetName]=bomItems;}else if(sheetName.startsWith('AS')||sheetName.includes('A2715')||sheetName.includes('HSM')){// 완제품 - 모델명 매핑
let modelName=sheetName;if(sheetName==='AS4500')modelName='RSC16';else if(sheetName==='AS6000')modelName='CSC16';else if(sheetName==='AS4600')modelName='FSC16';else if(sheetName==='AS8500')modelName='RSC48';else if(sheetName==='AS8000')modelName='CSC48';else if(sheetName.includes('A2715')||sheetName.includes('HSM'))modelName='HSM3';modelBomData[modelName]=bomItems;}});if(Object.keys(modelBomData).length===0){alert('❌ BOM 데이터를 찾을 수 없습니다.\n\n시트 탭 이름이 AS4500, AS8500, KB0xxx 형식이어야 합니다.');setIsLoading(false);return;}// 저장
const now=new Date().toLocaleString('ko-KR');setCustomBomData(modelBomData);setSubComponentBomData(subComponentBomData);setBomLastUpdated(now);safeStorage.setItem('pbk_custom_bom',JSON.stringify(modelBomData));safeStorage.setItem('pbk_subcom_bom',JSON.stringify(subComponentBomData));safeStorage.setItem('pbk_bom_updated',now);const modelCount=Object.keys(modelBomData).length;const subComCount=Object.keys(subComponentBomData).length;const totalModelParts=Object.values(modelBomData).reduce((sum,m)=>sum+Object.keys(m).length,0);const totalSubComParts=Object.values(subComponentBomData).reduce((sum,m)=>sum+Object.keys(m).length,0);// v15: 토스트, 알림, 히스토리 추가
showToast(`✅ BOM 업로드 완료! ${modelCount}개 모델`,'success');addNotification('BOM 데이터 업로드',`완제품 ${modelCount}개 모델, Sub-com ${subComCount}개가 업로드되었습니다.`,'success');addDataHistory('bom',`BOM 데이터 업로드 (완제품 ${totalModelParts}개, Sub-com ${totalSubComParts}개 자재)`,totalModelParts+totalSubComParts);}catch(error){console.error('BOM parsing error:',error);alert('❌ BOM 파일 파싱 중 오류가 발생했습니다.\n\n'+error.message);showToast('❌ BOM 업로드 실패','error');}finally{setIsLoading(false);}};const handleBOMFileSelect=e=>{const file=e.target.files[0];if(file){parseBOMFile(file);}e.target.value='';};// BOM 초기화 (기본 BOM으로 복원)
const resetBOMData=()=>{if(confirm('BOM 데이터를 기본값으로 초기화하시겠습니까?\n(완제품 + Sub-component 모두 초기화)')){setCustomBomData(null);setSubComponentBomData(null);setBomLastUpdated(null);safeStorage.removeItem('pbk_custom_bom');safeStorage.removeItem('pbk_subcom_bom');safeStorage.removeItem('pbk_bom_updated');alert('✅ BOM 데이터가 기본값으로 초기화되었습니다.');}};// 현재 사용 중인 BOM 데이터 (사용자 업로드 또는 기본값)
const activeBomData=customBomData||MODEL_BOM_DATA;// 통계
const totals={items:new Set(inventoryData.map(i=>i.material)).size,stock:inventoryData.reduce((s,i)=>s+(i.stock||0),0),weight:rackSummary.reduce((s,r)=>s+r.weight,0),bins:new Set(inventoryData.map(i=>i.bin)).size};// Sub-component 생산 가능 대수 계산
const calculateSubComponentUnits=useCallback(()=>{if(!subComponentBomData||inventoryData.length===0)return{};// 재고를 Material 기준으로 합계
const stockByMaterial={};const descByMaterial={};inventoryData.forEach(item=>{const mat=item.material;if(!stockByMaterial[mat])stockByMaterial[mat]=0;stockByMaterial[mat]+=item.stock||0;if(!descByMaterial[mat])descByMaterial[mat]=item.description||'';});const results={};Object.entries(subComponentBomData).forEach(([subComName,bom])=>{let minUnits=Infinity;let bottleneck=null;let missingCount=0;let totalBomItems=Object.keys(bom).length;let matchedItems=0;Object.entries(bom).forEach(([material,requiredQty])=>{const currentStock=stockByMaterial[material]||0;const description=descByMaterial[material]||'';if(currentStock>0){matchedItems++;const possibleUnits=Math.floor(currentStock/requiredQty);if(possibleUnits<minUnits){minUnits=possibleUnits;bottleneck={material,description,currentStock,requiredQty,possibleUnits};}}else{missingCount++;if(minUnits>0){minUnits=0;bottleneck={material,description,currentStock:0,requiredQty,possibleUnits:0};}}});results[subComName]={units:minUnits===Infinity?0:minUnits,bottleneck,missingCount,totalBomItems,matchedItems,coverage:totalBomItems>0?(matchedItems/totalBomItems*100).toFixed(1):'0'};});return results;},[inventoryData,subComponentBomData]);const subComponentUnits=calculateSubComponentUnits();// 생산 가능 대수 계산 (사용자 BOM 또는 기본 BOM 사용)
const calculateProducibleUnits=useCallback(()=>{if(inventoryData.length===0)return{};// 재고를 Material 기준으로 합계 및 description 저장
const stockByMaterial={};const descByMaterial={};inventoryData.forEach(item=>{const mat=item.material;if(!stockByMaterial[mat])stockByMaterial[mat]=0;stockByMaterial[mat]+=item.stock||0;if(!descByMaterial[mat])descByMaterial[mat]=item.description||'';});const results={};const bomToUse=customBomData||MODEL_BOM_DATA;Object.keys(bomToUse).forEach(model=>{const bom=bomToUse[model];let minUnits=Infinity;let bottleneck=null;let missingCount=0;let totalBomItems=Object.keys(bom).length;let matchedItems=0;Object.entries(bom).forEach(([material,requiredQty])=>{const currentStock=stockByMaterial[material]||0;const description=descByMaterial[material]||'';if(currentStock>0){matchedItems++;const possibleUnits=Math.floor(currentStock/requiredQty);if(possibleUnits<minUnits){minUnits=possibleUnits;bottleneck={material,description,currentStock,requiredQty,possibleUnits};}}else{missingCount++;if(minUnits>0){minUnits=0;bottleneck={material,description,currentStock:0,requiredQty,possibleUnits:0};}}});results[model]={units:minUnits===Infinity?0:minUnits,bottleneck,missingCount,totalBomItems,matchedItems,coverage:(matchedItems/totalBomItems*100).toFixed(1)};});return results;},[inventoryData,customBomData]);const producibleUnits=calculateProducibleUnits();const avgPickTime=pickCycles.filter(p=>p.cycleMin).reduce((s,p,_,a)=>s+p.cycleMin/a.length,0)||0;const avgReceiveTime=receiveCycles.filter(r=>r.cycleMin).reduce((s,r,_,a)=>s+r.cycleMin/a.length,0)||0;const avgLeadTime=(()=>{const cm=new Date().toISOString().slice(0,7);const arr=kittingData.filter(k=>k.status==='completed'&&k.leadTimeDays!=null&&k.leadTimeDays>=0&&(k.startedAt?.startsWith(cm)||k.basicStartDate?.startsWith(cm)));return arr.length>0?arr.reduce((s,k)=>s+k.leadTimeDays,0)/arr.length:0;})();// C1 개선: 현재 통계를 매일 자정에 이전 통계로 저장
useEffect(()=>{const today=new Date().toISOString().split('T')[0];const lastSavedDate=safeStorage.getItem('pbk_stats_saved_date');// 날짜가 바뀌면 현재 값을 이전 값으로 저장
if(lastSavedDate!==today&&avgPickTime>0){const currentStats={avgPickTime,avgReceiveTime,avgLeadTime,savedAt:today};safeStorage.setItem('pbk_previous_stats',JSON.stringify(currentStats));safeStorage.setItem('pbk_stats_saved_date',today);setPreviousStats(currentStats);}},[avgPickTime,avgReceiveTime,avgLeadTime]);// 필터링
const filteredRacks=rackSummary.filter(r=>{if(selectedZone!=='all'&&r.zone!==selectedZone)return false;if(searchTerm&&!r.id.toLowerCase().includes(searchTerm.toLowerCase()))return false;return true;}).sort((a,b)=>{// 시리즈별 우선순위: Maxwell 48 → Maxwell 16 → HSM 3.0 → 기타
const seriesOrder={'Maxwell 48':0,'Maxwell 16':1,'HSM 3.0':2,'Others':3};const aSeries=RACK_MODEL_SERIES[a.id]||'Others';const bSeries=RACK_MODEL_SERIES[b.id]||'Others';const aOrder=seriesOrder[aSeries]??3;const bOrder=seriesOrder[bSeries]??3;if(aOrder!==bOrder)return aOrder-bOrder;// 같은 시리즈 내에서 알파벳 순
return a.id.localeCompare(b.id);});// 여유 공간 있는 랙
const availableRacks=rackSummary.filter(r=>r.bins<r.maxBins&&!['D2','LABEL','E','E3'].includes(r.id)).sort((a,b)=>b.maxBins-b.bins-(a.maxBins-a.bins));// Cycle Time 완료 처리
const completePick=id=>{const now=new Date();const koreaTime=now.toLocaleString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',hour12:false}).replace(/\. /g,'-').replace('.','');// 한국 시간 날짜 (YYYY-MM-DD)
const koreaDate=now.toLocaleDateString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit'}).replace(/\. /g,'-').replace('.','');// 먼저 productionOrder 찾기 (productionOrder 또는 orderId)
const targetPick=pickCycles.find(p=>p.id===id);const productionOrder=targetPick?.productionOrder||targetPick?.orderId;setPickCycles(prev=>prev.map(p=>{if(p.id===id&&p.startTime){// 근무시간만 계산 (평일 07:00~16:00, 점심 12:30~13:30 제외)
const cycleMin=calculateWorkingMinutes(p.startTime,now.toISOString());return{...p,completed:koreaTime,cycleMin,status:'completed'};}return p;}));// Kitting도 같이 완료 처리
if(productionOrder){setKittingData(prev=>prev.map(k=>{if(k.productionOrder===productionOrder&&k.status!=='completed'){// 시작 시간이 있으면 실제 작업 시간 계산, 없으면 0
let leadTimeDays=0;if(k.startedAt){const startTime=new Date(k.startedAt);leadTimeDays=getBusinessDays(startTime,now);// 영업일 기준 (주말+공휴일 제외)
}return{...k,status:'completed',completedAt:koreaDate,leadTimeDays};}return k;}));}};const completeReceive=id=>{const now=new Date();// 한국 시간으로 포맷팅
const koreaTime=now.toLocaleString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',hour12:false}).replace(/\. /g,'-').replace('.','').replace(' ',' ');setReceiveCycles(prev=>prev.map(r=>{if(r.id===id&&r.startTime){// 근무시간만 계산 (평일 07:00~16:00)
const cycleMin=calculateWorkingMinutes(r.startTime,now.toISOString());return{...r,migo:koreaTime,cycleMin,status:'completed'};}return r;}));};// 시작 기능
const startPick=id=>{const now=new Date().toISOString();// 먼저 productionOrder 찾기 (productionOrder 또는 orderId)
const targetPick=pickCycles.find(p=>p.id===id);const productionOrder=targetPick?.productionOrder||targetPick?.orderId;setPickCycles(prev=>prev.map(p=>p.id===id?{...p,startTime:now,status:'in-progress'}:p));// Kitting도 같이 시작 처리
if(productionOrder){setKittingData(prev=>prev.map(k=>k.productionOrder===productionOrder&&k.status==='waiting'?{...k,status:'in-progress',startedAt:now}:k));}};const startReceive=id=>{const now=new Date().toISOString();setReceiveCycles(prev=>prev.map(r=>r.id===id?{...r,startTime:now,status:'in-progress'}:r));};// 일시정지 기능
const pausePick=id=>{const now=new Date().toISOString();// 먼저 productionOrder 찾기
const targetPick=pickCycles.find(p=>p.id===id);const productionOrder=targetPick?.productionOrder||targetPick?.orderId;setPickCycles(prev=>prev.map(p=>p.id===id?{...p,pausedAt:now,status:'paused'}:p));// Kitting도 같이 일시정지 처리
if(productionOrder){setKittingData(prev=>prev.map(k=>k.productionOrder===productionOrder&&k.status==='in-progress'?{...k,status:'paused',pausedAt:now}:k));}};const pauseReceive=id=>{const now=new Date().toISOString();setReceiveCycles(prev=>prev.map(r=>r.id===id?{...r,pausedAt:now,status:'paused'}:r));};// 재개 기능
const resumePick=id=>{const now=new Date().toISOString();// 먼저 productionOrder 찾기
const targetPick=pickCycles.find(p=>p.id===id);const productionOrder=targetPick?.productionOrder||targetPick?.orderId;setPickCycles(prev=>prev.map(p=>{if(p.id===id&&p.pausedAt){const pausedMs=new Date()-new Date(p.pausedAt);return{...p,totalPausedMs:(p.totalPausedMs||0)+pausedMs,pausedAt:null,status:'in-progress'};}return p;}));// Kitting도 같이 재개 처리
if(productionOrder){setKittingData(prev=>prev.map(k=>{if(k.productionOrder===productionOrder&&k.status==='paused'){const pausedMs=k.pausedAt?new Date()-new Date(k.pausedAt):0;return{...k,status:'in-progress',totalPausedMs:(k.totalPausedMs||0)+pausedMs,pausedAt:null};}return k;}));}};const resumeReceive=id=>{setReceiveCycles(prev=>prev.map(r=>{if(r.id===id&&r.pausedAt){const pausedMs=new Date()-new Date(r.pausedAt);return{...r,totalPausedMs:(r.totalPausedMs||0)+pausedMs,pausedAt:null,status:'in-progress'};}return r;}));};// 엑셀 다운로드 기능
const downloadCycleExcel=async type=>{if(!window.XLSX){await new Promise((resolve,reject)=>{const script=document.createElement('script');script.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';script.onload=resolve;script.onerror=reject;document.head.appendChild(script);});}let data,filename;if(type==='pick'){data=pickCycles.map(p=>({'Production Order':p.productionOrder||p.orderId,'Model':p.model,'담당자':p.worker||'-','긴급':p.isUrgent?'긴급':'-','Material Description':p.materialDesc||'-','시작예정일':p.basicStartDate||'-','시작 시간':p.startTime?new Date(p.startTime).toLocaleString('ko-KR'):'-','완료 시간':p.completed||'-','Cycle Time (분)':p.cycleMin||'-','일시정지 시간 (분)':p.totalPausedMs?Math.round(p.totalPausedMs/60000):0,'상태':p.status==='completed'?'완료':p.status==='paused'?'일시정지':p.status==='in-progress'?'진행중':'대기'}));filename=`불출_Cycle_Time_${new Date().toISOString().slice(0,10)}.xlsx`;}else{data=receiveCycles.map(r=>({'No.':r.poNo,'협력업체':r.vendor,'납품 시각':r.delivery?r.delivery.replace(/^(\d{4}-\d{2}-\d{2})[\-T](\d{2}:\d{2}).*/,'$1 $2'):'-','시작 시간':r.startTime?new Date(r.startTime).toLocaleString('ko-KR',{timeZone:'Asia/Seoul'}):'-','MIGO 완료':r.migo?convertToKoreaTime(r.migo):'-','Cycle Time (분)':r.cycleMin||'-','일시정지 시간 (분)':r.totalPausedMs?Math.round(r.totalPausedMs/60000):0,'상태':r.status==='completed'?'완료':r.status==='paused'?'일시정지':r.status==='in-progress'?'진행중':'대기','Comments':r.comments||''}));filename=`입고_Cycle_Time_${new Date().toISOString().slice(0,10)}.xlsx`;}const ws=window.XLSX.utils.json_to_sheet(data);const wb=window.XLSX.utils.book_new();window.XLSX.utils.book_append_sheet(wb,ws,'Cycle Time');window.XLSX.writeFile(wb,filename);};// 주간 리포트 다운로드 함수
const downloadWeeklyReport=async()=>{if(!window.XLSX){await new Promise((resolve,reject)=>{const script=document.createElement('script');script.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';script.onload=resolve;script.onerror=reject;document.head.appendChild(script);});}const now=new Date();const lastWeekStart=new Date(now);lastWeekStart.setDate(now.getDate()-now.getDay()-6);// 지난주 월요일
lastWeekStart.setHours(0,0,0,0);const lastWeekEnd=new Date(lastWeekStart);lastWeekEnd.setDate(lastWeekStart.getDate()+6);// 지난주 일요일
lastWeekEnd.setHours(23,59,59,999);const formatDate=d=>`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;// 지난주 데이터 필터링
const lastWeekPicks=pickCycles.filter(p=>{if(!p.completed)return false;const completedDate=new Date(p.completed);return completedDate>=lastWeekStart&&completedDate<=lastWeekEnd;});const lastWeekReceives=receiveCycles.filter(r=>{if(!r.migo)return false;const migoDate=new Date(r.migo);return migoDate>=lastWeekStart&&migoDate<=lastWeekEnd;});const lastWeekKittings=kittingData.filter(k=>{if(!k.completedAt)return false;const completedDate=new Date(k.completedAt);return completedDate>=lastWeekStart&&completedDate<=lastWeekEnd;});// KPI 계산
const avgPickTime=lastWeekPicks.length>0?(lastWeekPicks.reduce((s,p)=>s+(p.cycleMin||0),0)/lastWeekPicks.length).toFixed(1):'-';const avgReceiveTime=lastWeekReceives.length>0?(lastWeekReceives.reduce((s,r)=>s+(r.cycleMin||0),0)/lastWeekReceives.length).toFixed(1):'-';const avgLeadTime=lastWeekKittings.filter(k=>k.leadTimeDays).length>0?(lastWeekKittings.filter(k=>k.leadTimeDays).reduce((s,k)=>s+k.leadTimeDays,0)/lastWeekKittings.filter(k=>k.leadTimeDays).length).toFixed(2):'-';// 협력업체별 입고 통계
const vendorStats={};lastWeekReceives.forEach(r=>{if(!vendorStats[r.vendor])vendorStats[r.vendor]={count:0,totalTime:0};vendorStats[r.vendor].count++;vendorStats[r.vendor].totalTime+=r.cycleMin||0;});// KPI 요약 시트
const summaryData=[{'항목':'📅 리포트 기간','값':`${formatDate(lastWeekStart)} ~ ${formatDate(lastWeekEnd)}`},{'항목':'📊 Kitting 완료 건수','값':`${lastWeekPicks.length}건`},{'항목':'⏱️ 평균 Kitting 시간','값':`${avgPickTime}분`},{'항목':'📦 입고 완료 건수','값':`${lastWeekReceives.length}건`},{'항목':'⏱️ 평균 입고 시간','값':`${avgReceiveTime}분`},{'항목':'📈 Kitting 완료 건수','값':`${lastWeekKittings.length}건`},{'항목':'📅 평균 리드타임','값':`${avgLeadTime}일`}];// 협력업체별 시트
const vendorData=Object.entries(vendorStats).map(([vendor,stats])=>({'협력업체':vendor,'입고 건수':stats.count,'평균 입고시간(분)':stats.count>0?(stats.totalTime/stats.count).toFixed(1):'-'})).sort((a,b)=>b['입고 건수']-a['입고 건수']);// 엑셀 생성
const wb=window.XLSX.utils.book_new();const ws1=window.XLSX.utils.json_to_sheet(summaryData);window.XLSX.utils.book_append_sheet(wb,ws1,'KPI 요약');const ws2=window.XLSX.utils.json_to_sheet(vendorData);window.XLSX.utils.book_append_sheet(wb,ws2,'협력업체별 통계');if(lastWeekPicks.length>0){const pickData=lastWeekPicks.map(p=>({'Production Order':p.productionOrder||p.orderId,'Model':p.model,'담당자':p.worker||'-','완료 시간':p.completed,'Cycle Time (분)':p.cycleMin||'-'}));const ws3=window.XLSX.utils.json_to_sheet(pickData);window.XLSX.utils.book_append_sheet(wb,ws3,'Kitting 상세');}if(lastWeekReceives.length>0){const receiveData=lastWeekReceives.map(r=>({'No.':r.poNo,'협력업체':r.vendor,'MIGO 완료':r.migo,'Cycle Time (분)':r.cycleMin||'-'}));const ws4=window.XLSX.utils.json_to_sheet(receiveData);window.XLSX.utils.book_append_sheet(wb,ws4,'입고 상세');}const filename=`주간리포트_${formatDate(lastWeekStart)}_${formatDate(lastWeekEnd)}.xlsx`;window.XLSX.writeFile(wb,filename);};// 온습도 PDF 생성 함수
const generateTempHumidityPDF=()=>{const[year,month]=tempHumidityMonth.split('-').map(Number);const daysInMonth=new Date(year,month,0).getDate();// 테이블 행 생성
let tableRows='';for(let day=1;day<=31;day++){const dateKey=tempHumidityMonth+'-'+String(day).padStart(2,'0');const data=tempHumidityData[dateKey]||{temp:'',humidity:''};const tempNum=parseFloat(data.temp);const humidNum=parseFloat(data.humidity);const tempStyle=!isNaN(tempNum)&&(tempNum<5||tempNum>40)?'color:red;font-weight:bold;':'';const humidStyle=!isNaN(humidNum)&&(humidNum<0||humidNum>75)?'color:red;font-weight:bold;':'';if(day>daysInMonth){tableRows+='<tr><td>'+day+'</td><td>-</td><td>-</td><td>-</td></tr>';}else{const tempVal=data.temp||'';const humidVal=data.humidity||'';const recorder=data.temp||data.humidity?tempHumidityRecorder:'';tableRows+='<tr><td>'+day+'</td><td style="'+tempStyle+'">'+tempVal+'</td><td style="'+humidStyle+'">'+humidVal+'</td><td>'+recorder+'</td></tr>';}}// Word 호환 HTML 생성 (mso 스타일 포함)
const htmlContent=`
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta charset="UTF-8">
<title>ESD Check Sheet - ${year}년 ${month}월</title>
<!--[if gte mso 9]>
<xml>
<w:WordDocument>
<w:View>Print</w:View>
<w:Zoom>100</w:Zoom>
</w:WordDocument>
</xml>
<![endif]-->
<style>
@page { size: A4; margin: 2cm; }
body { font-family: 'Malgun Gothic', Arial, sans-serif; font-size: 10pt; }
h1 { text-align: center; font-size: 14pt; margin-bottom: 5px; }
h2 { text-align: center; font-size: 11pt; color: #666; margin-top: 0; margin-bottom: 15px; }
table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
td, th { border: 1px solid #000; padding: 5px 8px; text-align: center; }
th { background-color: #e8e8e8; font-weight: bold; }
.header-table td { padding: 8px; }
.title-cell { font-weight: bold; background-color: #f5f5f5; width: 40%; font-size: 9pt; }
.signature-cell { width: 20%; }
</style>
</head>
<body>
<h1>Temp. & Humidity Check Log (Daily)</h1>
<h2>ESD Protected Work Area Check log - ${year}년 ${String(month).padStart(2,'0')}월</h2>

<table class="header-table">
<tr>
<td class="title-cell" rowspan="2">Temp. & Humidity Check Log(Daily)<br/>ESD Protected Work Area Check log</td>
<td class="signature-cell">Writer</td>
<td class="signature-cell">Reviewer</td>
<td class="signature-cell">Approver</td>
</tr>
<tr>
<td class="signature-cell">${tempHumidityRecorder}</td>
<td class="signature-cell"></td>
<td class="signature-cell"></td>
</tr>
</table>

<table>
<thead>
<tr>
<th style="width:12%">Day</th>
<th style="width:28%">Temp (℃)</th>
<th style="width:28%">Humidity (%)</th>
<th style="width:32%">Recorded by</th>
</tr>
</thead>
<tbody>
${tableRows}
</tbody>
</table>

<p style="font-size:8pt;color:#666;margin-top:20px;">
* Spec: Temp +5~40℃ / Humidity 0~75% (Equipment: NS-205B)<br/>
* Generated: ${new Date().toLocaleString('ko-KR')}
</p>
</body>
</html>`;// Blob으로 doc 파일 다운로드 (Word에서 열 수 있는 HTML)
const blob=new Blob(['\ufeff'+htmlContent],{type:'application/msword'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=year+'_'+String(month).padStart(2,'0')+'_ESD_Check_Sheet.doc';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);alert('파일이 다운로드되었습니다!\\n\\n'+year+'_'+String(month).padStart(2,'0')+'_ESD_Check_Sheet.doc\\n\\nWord에서 열어 PDF로 저장하거나 바로 인쇄하세요.');};// CSV 내보내기 함수 (원본 docx 템플릿용)
const exportTempHumidityCSV=()=>{const[year,month]=tempHumidityMonth.split('-').map(Number);const daysInMonth=new Date(year,month,0).getDate();// CSV 헤더
let csvContent='Day,Temp,Humidity,Recorded_by\n';// 각 일별 데이터
for(let day=1;day<=daysInMonth;day++){const dateKey=tempHumidityMonth+'-'+String(day).padStart(2,'0');const data=tempHumidityData[dateKey]||{temp:'',humidity:''};const temp=data.temp||'';const humidity=data.humidity||'';const recorder=temp||humidity?tempHumidityRecorder:'';csvContent+=day+','+temp+','+humidity+','+recorder+'\n';}// CSV 파일 다운로드
const blob=new Blob(['\ufeff'+csvContent],{type:'text/csv;charset=utf-8'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=year+'_'+String(month).padStart(2,'0')+'_temp_humidity_data.csv';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);};const addPick=()=>{if(!newPick.productionOrder||!newPick.model||!newPick.received)return;// 불출 Cycle 추가
setPickCycles(prev=>[...prev,{id:Date.now(),...newPick,startTime:null,completed:null,cycleMin:null,totalPausedMs:0,pausedAt:null,status:'waiting'}]);// Kitting에 같은 Production Order가 있으면 담당자 업데이트
if(newPick.productionOrder&&newPick.worker){setKittingData(prev=>prev.map(k=>k.productionOrder===newPick.productionOrder?{...k,worker:newPick.worker}:k));}setNewPick({productionOrder:'',model:'RSC48',received:'',worker:'Z01',isUrgent:false});setShowPickModal(false);};// Order CSV 업로드 처리 (불출 Cycle + Kitting 현황 동시 업데이트)
const handleOrderCsvUpload=e=>{const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=event=>{try{const text=event.target.result;const lines=text.split('\n').filter(line=>line.trim());if(lines.length<2){alert('❌ CSV 파일에 데이터가 없습니다.');return;}// 헤더 파싱
const headers=lines[0].split(',').map(h=>h.trim().replace(/"/g,''));const orderIdx=headers.findIndex(h=>/^Order$/i.test(h));const descIdx=headers.findIndex(h=>/Material description/i.test(h));const materialNumIdx=headers.findIndex(h=>/Material Number/i.test(h));const startDateIdx=headers.findIndex(h=>/Basic start date/i.test(h));// 담당자 (Prodn Supervisor) 컬럼 추가
const supervisorIdx=headers.findIndex(h=>/Prodn Supervisor/i.test(h)||/Production Supervisor/i.test(h)||/Supervisor/i.test(h));if(orderIdx===-1){alert('❌ Order 컬럼을 찾을 수 없습니다.');return;}// Model 매핑 함수 (Material Number 기준)
// RSC16(AS4500), RSC48(AS8500), CSC48(AS8000), FSC16(AS4600), CSC16(AS6000), HSM3.0(A2715)
const getModelFromMaterial=materialNum=>{if(!materialNum)return'Spare Parts';const m=materialNum.toUpperCase();if(m==='AS4500')return'RSC16';if(m==='AS8500')return'RSC48';if(m==='AS8000')return'CSC48';if(m==='AS4600')return'FSC16';if(m==='AS6000')return'CSC16';if(m==='A2715')return'HSM3.0';if(SUBCOM_INFO[materialNum])return'Sub-com.';if(SUBCOM_INFO[materialNum])return'Sub-com.';return'Spare Parts';};// 날짜 형식 통일 (YY-MM-DD → YYYY-MM-DD)
const normalizeDate=d=>{if(!d)return'';d=d.trim().split(' ')[0];// YY-MM-DD (예: 26-03-04)
if(/^\d{2}-\d{2}-\d{2}$/.test(d))return'20'+d;// DD.MM.YYYY (예: 04.03.2026)
if(/^\d{2}\.\d{2}\.\d{4}$/.test(d)){var p=d.split('.');return p[2]+'-'+p[1]+'-'+p[0];}// MM/DD/YYYY (예: 03/04/2026)
if(/^\d{2}\/\d{2}\/\d{4}$/.test(d)){var p=d.split('/');return p[2]+'-'+p[0]+'-'+p[1];}return d;};// 데이터 파싱
const newPickOrders=[];const newKittingOrders=[];const existingPickOrders=new Set(pickCycles.map(p=>p.productionOrder));const existingKittingOrders=new Set(kittingData.map(k=>k.productionOrder));const now=new Date().toISOString().slice(0,16).replace('T',' ');for(let i=1;i<lines.length;i++){// CSV 파싱 (쉼표 처리)
const row=lines[i].match(/(".*?"|[^,]+)(?=\s*,|\s*$)/g);if(!row)continue;const values=row.map(v=>v.trim().replace(/^"|"$/g,'').replace(/\r/g,''));const order=values[orderIdx];if(!order)continue;const desc=descIdx>=0?values[descIdx]:'';const materialNum=materialNumIdx>=0?values[materialNumIdx]:'';const startDate=startDateIdx>=0?values[startDateIdx]:'';const model=getModelFromMaterial(materialNum);// 담당자 추출 (없으면 기본값 Z01)
const worker=supervisorIdx>=0&&values[supervisorIdx]?values[supervisorIdx].trim():'Z01';// 불출 Cycle에 추가 (중복 아닌 경우)
if(!existingPickOrders.has(order)){newPickOrders.push({id:Date.now()+i,productionOrder:order,model:model,materialNum:materialNum,// Part No.
materialDesc:desc,received:now,basicStartDate:normalizeDate(startDate),worker:worker,// 담당자 자동 매핑
startTime:null,completed:null,cycleMin:null,totalPausedMs:0,pausedAt:null,status:'waiting'});existingPickOrders.add(order);}// Kitting 현황에 추가 (중복 아닌 경우)
if(!existingKittingOrders.has(order)){newKittingOrders.push({id:Date.now()+i+100000,productionOrder:order,model:model,materialNum:materialNum,// Part No.
materialDesc:desc,basicStartDate:normalizeDate(startDate)||new Date().toISOString().split('T')[0],worker:worker,// 담당자 자동 매핑
isUrgent:false,status:'waiting',createdAt:new Date().toISOString(),completedAt:null,leadTimeDays:null});existingKittingOrders.add(order);}}if(newPickOrders.length===0&&newKittingOrders.length===0){alert('⚠️ 추가할 새로운 Order가 없습니다.\n(이미 등록된 Order이거나 유효하지 않은 데이터)');return;}// 불출 Cycle 업데이트
if(newPickOrders.length>0){setPickCycles(prev=>[...prev,...newPickOrders]);}// Kitting 현황 업데이트
if(newKittingOrders.length>0){setKittingData(prev=>[...prev,...newKittingOrders]);}alert(`✅ Order 업로드 완료!\n\n📦 불출 Cycle: ${newPickOrders.length}개 추가\n📋 Kitting 현황: ${newKittingOrders.length}개 추가`);}catch(error){console.error('CSV parsing error:',error);alert('❌ CSV 파일 파싱 중 오류가 발생했습니다.');}};reader.readAsText(file);e.target.value='';};// UTC 시간을 한국 시간으로 변환하는 함수
// 새로 입력한 데이터(한국 시간)는 그대로, 기존 UTC 데이터만 +9시간
const convertToKoreaTime=timeStr=>{if(!timeStr||timeStr==='-')return timeStr;// "2026-02-23-13:54" 형식 (날짜-시간 사이 하이픈) → 공백으로 정규화
const m=timeStr.match(/^(\d{4}-\d{2}-\d{2})[\-T\s](\d{2}:\d{2}.*)$/);if(m)timeStr=m[1]+' '+m[2];// "2026-02-03 12:00" 형식 확인
if(timeStr.includes('-')&&timeStr.includes(' ')&&timeStr.length>=16){const[datePart,timePart]=timeStr.split(' ');if(datePart&&timePart){const hour=parseInt(timePart.split(':')[0]);// 07:00 ~ 23:59 범위면 이미 한국 시간으로 간주 (정상 근무/생활 시간)
// 00:00 ~ 06:59 범위면 UTC일 가능성 높음 (한국시간 09:00~15:59)
if(hour>=7&&hour<=23){return timeStr;// 이미 한국 시간, 그대로 반환
}}}try{// ISO 형식이나 다른 형식의 날짜 파싱
let date;if(timeStr.includes('T')){date=new Date(timeStr);}else{// "2026-02-03 04:35" 형식 → UTC로 해석하여 +9시간
const[datePart,timePart]=timeStr.split(' ');if(datePart&&timePart){const[year,month,day]=datePart.split('-');const[hour,minute]=timePart.split(':');date=new Date(Date.UTC(year,month-1,day,hour,minute));}else{return timeStr;}}if(isNaN(date.getTime()))return timeStr;// 한국 시간으로 변환
const koreaTime=date.toLocaleString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',hour12:false});// "2026. 02. 03. 13:35" → "2026-02-03 13:35" 형식으로 변환
return koreaTime.replace(/\. /g,'-').replace('.','');}catch(e){return timeStr;}};// 근무시간만 계산하는 함수 (평일 07:00~16:00, 한국 시간 기준)
const calculateWorkingMinutes=(startTime,endTime)=>{const start=new Date(startTime);const end=new Date(endTime);const WORK_START_HOUR=7;// 오전 7시
const WORK_END_HOUR=16;// 오후 4시
const LUNCH_START=12.5;// 점심 시작 12:30
const LUNCH_END=13.5;// 점심 종료 13:30
let totalMinutes=0;let current=new Date(start);// 한국 시간대 오프셋 (UTC+9)
const getKoreaHour=date=>{const koreaTime=new Date(date.toLocaleString('en-US',{timeZone:'Asia/Seoul'}));return koreaTime.getHours();};const getKoreaMinute=date=>{const koreaTime=new Date(date.toLocaleString('en-US',{timeZone:'Asia/Seoul'}));return koreaTime.getMinutes();};const getKoreaDay=date=>{const koreaTime=new Date(date.toLocaleString('en-US',{timeZone:'Asia/Seoul'}));return koreaTime.getDay();};while(current<end){const dayOfWeek=getKoreaDay(current);// 0=일, 1=월, ..., 6=토
const isWeekday=dayOfWeek>=1&&dayOfWeek<=5;// 월~금
// 한국시간 기준 날짜 문자열로 공휴일 체크
const krDate=new Date(current.toLocaleString('en-US',{timeZone:'Asia/Seoul'}));const dateStr=krDate.getFullYear()+'-'+String(krDate.getMonth()+1).padStart(2,'0')+'-'+String(krDate.getDate()).padStart(2,'0');const isHoliday=KR_HOLIDAYS.has(dateStr);if(isWeekday&&!isHoliday){const currentHour=getKoreaHour(current);const currentMinute=getKoreaMinute(current);const currentTime=currentHour+currentMinute/60;// 시간을 소수점으로 변환
// 근무시간 내인지 확인 (07:00 ~ 16:00)
// 점심시간 제외 (12:30 ~ 13:30)
const isWorkingHour=currentHour>=WORK_START_HOUR&&currentHour<WORK_END_HOUR;const isLunchTime=currentTime>=LUNCH_START&&currentTime<LUNCH_END;if(isWorkingHour&&!isLunchTime){totalMinutes+=1;}}// 1분씩 증가
current=new Date(current.getTime()+60000);}return totalMinutes;};const addReceive=()=>{if(!newReceive.vendor)return;// 자동 번호 계산: 현재 최대값 + 1
const maxNo=receiveCycles.reduce((max,r)=>{const num=parseInt(r.poNo)||0;return num>max?num:max;},0);const newPoNo=String(maxNo+1);// 현재 시간을 납품 시각으로 사용
const now=new Date();const deliveryStr=now.getFullYear()+'-'+String(now.getMonth()+1).padStart(2,'0')+'-'+String(now.getDate()).padStart(2,'0')+' '+String(now.getHours()).padStart(2,'0')+':'+String(now.getMinutes()).padStart(2,'0');setReceiveCycles(prev=>[...prev,{id:Date.now(),poNo:newPoNo,vendor:newReceive.vendor,delivery:deliveryStr,startTime:now.toISOString(),// 현재 시각 기준으로 Cycle Time 계산
migo:null,cycleMin:null,totalPausedMs:0,pausedAt:null,status:'in-progress'// 바로 진행중 상태
}]);setNewReceive({poNo:'',vendor:'',delivery:''});setShowReceiveModal(false);};// ===== 다중 선택 관련 함수들 =====
// Pick 전체 선택/해제
const toggleAllPicks=()=>{if(selectedPicks.size===pickCycles.length){setSelectedPicks(new Set());}else{setSelectedPicks(new Set(pickCycles.map(p=>p.id)));}};// Pick 개별 선택/해제
const togglePickSelection=id=>{const newSet=new Set(selectedPicks);if(newSet.has(id)){newSet.delete(id);}else{newSet.add(id);}setSelectedPicks(newSet);};// Receive 전체 선택/해제
const toggleAllReceives=()=>{if(selectedReceives.size===receiveCycles.length){setSelectedReceives(new Set());}else{setSelectedReceives(new Set(receiveCycles.map(r=>r.id)));}};// Receive 개별 선택/해제
const toggleReceiveSelection=id=>{const newSet=new Set(selectedReceives);if(newSet.has(id)){newSet.delete(id);}else{newSet.add(id);}setSelectedReceives(newSet);};// 선택된 Pick 일괄 시작
const startSelectedPicks=()=>{if(selectedPicks.size===0)return;const now=new Date().toISOString();const idsToStart=Array.from(selectedPicks);// 먼저 Production Order 목록 수집
const productionOrders=pickCycles.filter(p=>idsToStart.includes(p.id)&&p.status==='waiting').map(p=>p.productionOrder);setPickCycles(prev=>prev.map(p=>idsToStart.includes(p.id)&&p.status==='waiting'?{...p,startTime:now,status:'in-progress'}:p));// Kitting도 같이 시작
if(productionOrders.length>0){setKittingData(prev=>prev.map(k=>productionOrders.includes(k.productionOrder)&&k.status==='waiting'?{...k,status:'in-progress',startedAt:now}:k));}setSelectedPicks(new Set());};// 선택된 Pick 일괄 완료
const completeSelectedPicks=()=>{if(selectedPicks.size===0)return;const now=new Date();const idsToComplete=Array.from(selectedPicks);// 먼저 Production Order 목록 수집
const productionOrders=pickCycles.filter(p=>idsToComplete.includes(p.id)&&(p.status==='in-progress'||p.status==='paused')&&p.startTime).map(p=>p.productionOrder);setPickCycles(prev=>prev.map(p=>{if(idsToComplete.includes(p.id)&&(p.status==='in-progress'||p.status==='paused')&&p.startTime){const totalPaused=p.totalPausedMs||0;const cycleMin=Math.round((now-new Date(p.startTime)-totalPaused)/60000);return{...p,completed:now.toISOString().slice(0,16).replace('T',' '),cycleMin,status:'completed'};}return p;}));// Kitting도 같이 완료
if(productionOrders.length>0){setKittingData(prev=>prev.map(k=>{if(productionOrders.includes(k.productionOrder)&&k.status!=='completed'){// 시작 시간이 있으면 실제 작업 시간 계산, 없으면 0
let leadTimeDays=0;if(k.startedAt){const startTime=new Date(k.startedAt);leadTimeDays=getBusinessDays(startTime,now);// 영업일 기준 (주말+공휴일 제외)
}return{...k,status:'completed',completedAt:now.toLocaleDateString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit'}).replace(/\. /g,'-').replace('.',''),leadTimeDays};}return k;}));}setSelectedPicks(new Set());};// 선택된 Pick 일괄 삭제 (모달 호출)
const deleteSelectedPicks=()=>{if(selectedPicks.size===0)return;setDeleteConfirm({show:true,type:'pick',id:null,text:'',count:selectedPicks.size});};// 실제 Pick 삭제 실행
const confirmDeletePicks=()=>{const idsToDelete=[...selectedPicks];setPickCycles(prev=>prev.filter(p=>!idsToDelete.includes(p.id)));setSelectedPicks(new Set());setDeleteConfirm({show:false,type:'',id:null,text:'',count:0});};// 선택된 Receive 일괄 시작
const startSelectedReceives=()=>{if(selectedReceives.size===0)return;const now=new Date().toISOString();const idsToStart=Array.from(selectedReceives);setReceiveCycles(prev=>prev.map(r=>idsToStart.includes(r.id)&&r.status==='waiting'?{...r,startTime:now,status:'in-progress'}:r));setSelectedReceives(new Set());};// 선택된 Receive 일괄 완료
const completeSelectedReceives=()=>{if(selectedReceives.size===0)return;const now=new Date();const idsToComplete=Array.from(selectedReceives);setReceiveCycles(prev=>prev.map(r=>{if(idsToComplete.includes(r.id)&&(r.status==='in-progress'||r.status==='paused')&&r.startTime){const totalPaused=r.totalPausedMs||0;const cycleMin=Math.round((now-new Date(r.startTime)-totalPaused)/60000);return{...r,migo:now.toISOString().slice(0,16).replace('T',' '),cycleMin,status:'completed'};}return r;}));setSelectedReceives(new Set());};// 선택된 Receive 일괄 삭제 (모달 호출)
const deleteSelectedReceives=()=>{if(selectedReceives.size===0)return;setDeleteConfirm({show:true,type:'receive',id:null,text:'',count:selectedReceives.size});};// 실제 Receive 삭제 실행
const confirmDeleteReceives=()=>{const idsToDelete=[...selectedReceives];setReceiveCycles(prev=>prev.filter(r=>!idsToDelete.includes(r.id)));setSelectedReceives(new Set());setDeleteConfirm({show:false,type:'',id:null,text:'',count:0});};// Kitting 추가
const addKitting=()=>{if(!newKitting.productionOrder)return;const newItem={id:Date.now(),...newKitting,materialDesc:'',status:'waiting',// waiting, in-progress, completed
createdAt:new Date().toISOString(),completedAt:null,leadTimeDays:null};setKittingData(prev=>[...prev,newItem]);setNewKitting({productionOrder:'',model:'RSC48',basicStartDate:'',worker:'Z01',isUrgent:false});setShowKittingModal(false);};// Kitting 완료 처리
const completeKitting=id=>{const now=new Date();// 먼저 productionOrder 찾기
const targetKitting=kittingData.find(k=>k.id===id);const productionOrder=targetKitting?.productionOrder;setKittingData(prev=>prev.map(k=>{if(k.id===id){// 시작 시간이 있으면 실제 작업 시간 계산, 없으면 0
let leadTimeDays=0;if(k.startedAt){const startTime=new Date(k.startedAt);leadTimeDays=getBusinessDays(startTime,now);// 영업일 기준 (주말+공휴일 제외)
}return{...k,status:'completed',completedAt:now.toLocaleDateString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit'}).replace(/\. /g,'-').replace('.',''),leadTimeDays};}return k;}));// 불출 Cycle도 같이 완료 처리
if(productionOrder){const nowStr=now.toISOString().slice(0,16).replace('T',' ');setPickCycles(prev=>prev.map(p=>{if((p.productionOrder===productionOrder||p.orderId===productionOrder)&&p.status!=='completed'){const cycleMin=p.startTime?calculateWorkingMinutes(p.startTime,now.toISOString()):0;return{...p,completed:nowStr,cycleMin,status:'completed'};}return p;}));}};// Kitting 시작 처리
const startKitting=id=>{const now=new Date().toISOString();// 먼저 productionOrder 찾기
const targetKitting=kittingData.find(k=>k.id===id);const productionOrder=targetKitting?.productionOrder;setKittingData(prev=>prev.map(k=>k.id===id?{...k,status:'in-progress',startedAt:now}:k));// 불출 Cycle도 같이 시작 처리
if(productionOrder){setPickCycles(prev=>prev.map(p=>(p.productionOrder===productionOrder||p.orderId===productionOrder)&&p.status==='waiting'?{...p,startTime:now,status:'in-progress'}:p));}};// Kitting 일시정지 처리
const pauseKitting=id=>{const now=new Date().toISOString();// 먼저 productionOrder 찾기
const targetKitting=kittingData.find(k=>k.id===id);const productionOrder=targetKitting?.productionOrder;setKittingData(prev=>prev.map(k=>k.id===id?{...k,status:'paused',pausedAt:now}:k));// 불출 Cycle도 같이 일시정지 처리
if(productionOrder){setPickCycles(prev=>prev.map(p=>(p.productionOrder===productionOrder||p.orderId===productionOrder)&&p.status==='in-progress'?{...p,pausedAt:now,status:'paused'}:p));}};// Kitting 재개 처리
const resumeKitting=id=>{const now=new Date();// 먼저 productionOrder 찾기
const targetKitting=kittingData.find(k=>k.id===id);const productionOrder=targetKitting?.productionOrder;setKittingData(prev=>prev.map(k=>{if(k.id===id&&k.status==='paused'){const pausedMs=k.pausedAt?now-new Date(k.pausedAt):0;return{...k,status:'in-progress',totalPausedMs:(k.totalPausedMs||0)+pausedMs,pausedAt:null};}return k;}));// 불출 Cycle도 같이 재개 처리
if(productionOrder){setPickCycles(prev=>prev.map(p=>{if((p.productionOrder===productionOrder||p.orderId===productionOrder)&&p.status==='paused'){const pausedMs=p.pausedAt?now-new Date(p.pausedAt):0;return{...p,totalPausedMs:(p.totalPausedMs||0)+pausedMs,pausedAt:null,status:'in-progress'};}return p;}));}};// Kitting 선택 토글
const toggleKittingSelection=id=>{setSelectedKittings(prev=>{const newSet=new Set(prev);if(newSet.has(id))newSet.delete(id);else newSet.add(id);return newSet;});};// Kitting 일괄 완료
const completeSelectedKittings=()=>{if(selectedKittings.size===0)return;const now=new Date();const idsToComplete=Array.from(selectedKittings);// 먼저 Production Order 목록 수집
const productionOrders=kittingData.filter(k=>idsToComplete.includes(k.id)&&k.status!=='completed').map(k=>k.productionOrder);setKittingData(prev=>prev.map(k=>{if(idsToComplete.includes(k.id)&&k.status!=='completed'){// 시작 시간이 있으면 실제 작업 시간 계산, 없으면 0
let leadTimeDays=0;if(k.startedAt){const startTime=new Date(k.startedAt);leadTimeDays=getBusinessDays(startTime,now);// 영업일 기준 (주말+공휴일 제외)
}return{...k,status:'completed',completedAt:now.toLocaleDateString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit'}).replace(/\. /g,'-').replace('.',''),leadTimeDays};}return k;}));// 불출 Cycle도 같이 완료
if(productionOrders.length>0){const nowStr=now.toISOString().slice(0,16).replace('T',' ');setPickCycles(prev=>prev.map(p=>{if(productionOrders.includes(p.productionOrder)&&p.status!=='completed'){const cycleMin=p.startTime?calculateWorkingMinutes(p.startTime,now.toISOString()):0;return{...p,completed:nowStr,cycleMin,status:'completed'};}return p;}));}setSelectedKittings(new Set());};// Kitting 일괄 삭제
const deleteSelectedKittings=()=>{if(selectedKittings.size===0)return;setDeleteConfirm({show:true,type:'kitting',id:null,text:'',count:selectedKittings.size});};const confirmDeleteKittings=()=>{const idsToDelete=[...selectedKittings];setKittingData(prev=>prev.filter(k=>!idsToDelete.includes(k.id)));setSelectedKittings(new Set());setDeleteConfirm({show:false,type:'',id:null,text:'',count:0});};// Kitting CSV 업로드
const handleKittingCsvUpload=e=>{const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=event=>{try{const text=event.target.result;const lines=text.split('\n').filter(line=>line.trim());if(lines.length<2){alert('유효한 데이터가 없습니다.');return;}// 헤더 파싱
const headers=lines[0].split(',').map(h=>h.trim().replace(/"/g,''));const orderIdx=headers.findIndex(h=>/^Order$/i.test(h));const descIdx=headers.findIndex(h=>/Material description/i.test(h));const materialNumIdx=headers.findIndex(h=>/Material Number/i.test(h));const startDateIdx=headers.findIndex(h=>/Basic start date/i.test(h));if(orderIdx===-1){alert('❌ Order 컬럼을 찾을 수 없습니다.');return;}// Model 매핑 함수 (Material Number 기준) - 불출과 동일
// RSC16(AS4500), RSC48(AS8500), CSC48(AS8000), FSC16(AS4600), CSC16(AS6000), HSM3.0(A2715)
const getModelFromMaterial=materialNum=>{if(!materialNum)return'Spare Parts';const m=materialNum.toUpperCase();if(m==='AS4500')return'RSC16';if(m==='AS8500')return'RSC48';if(m==='AS8000')return'CSC48';if(m==='AS4600')return'FSC16';if(m==='AS6000')return'CSC16';if(m==='A2715')return'HSM3.0';return'Spare Parts';};// 날짜 형식 통일
const normalizeDate2=d=>{if(!d)return'';d=d.trim().split(' ')[0];if(/^\d{2}-\d{2}-\d{2}$/.test(d))return'20'+d;if(/^\d{2}\.\d{2}\.\d{4}$/.test(d)){var p=d.split('.');return p[2]+'-'+p[1]+'-'+p[0];}if(/^\d{2}\/\d{2}\/\d{4}$/.test(d)){var p=d.split('/');return p[2]+'-'+p[0]+'-'+p[1];}return d;};const newItems=[];for(let i=1;i<lines.length;i++){// CSV 파싱 (쉼표 처리)
const row=lines[i].match(/(".*?"|[^,]+)(?=\s*,|\s*$)/g);if(!row)continue;const values=row.map(v=>v.trim().replace(/^"|"$/g,'').replace(/\r/g,''));const productionOrder=values[orderIdx];if(!productionOrder)continue;// 중복 체크
const exists=kittingData.some(k=>k.productionOrder===productionOrder);if(exists)continue;const materialDesc=descIdx>=0?values[descIdx]:'';const materialNum=materialNumIdx>=0?values[materialNumIdx]:'';const startDate=startDateIdx>=0?values[startDateIdx]:'';const model=getModelFromMaterial(materialNum);newItems.push({id:Date.now()+i,productionOrder,model,materialNum,materialDesc,basicStartDate:normalizeDate2(startDate)||new Date().toISOString().split('T')[0],worker:'Z01',isUrgent:false,status:'waiting',createdAt:new Date().toISOString(),completedAt:null,leadTimeDays:null});}if(newItems.length>0){setKittingData(prev=>[...prev,...newItems]);alert(`✅ ${newItems.length}개의 Kitting 항목이 추가되었습니다.`);}else{alert('추가할 새로운 항목이 없습니다. (중복 제외)');}}catch(error){alert('❌ CSV 파일 파싱 중 오류가 발생했습니다.');console.error(error);}};reader.readAsText(file);e.target.value='';};// Kitting 엑셀 다운로드
const downloadKittingExcel=async()=>{try{const XLSX=await new Promise(res=>{if(window.XLSX){res(window.XLSX);return;}var s=document.createElement('script');s.src='https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js';s.onload=()=>res(window.XLSX);document.head.appendChild(s);});const data=kittingData.map(k=>({'Production Order':k.productionOrder,'Model':k.model,'Material Description':k.materialDesc||'','시작예정일':k.basicStartDate||'','담당자':k.worker||'','긴급':k.isUrgent?'긴급':'일반','상태':k.status==='completed'?'완료':k.status==='in-progress'?'진행중':k.status==='paused'?'일시정지':'대기','완료일':k.completedAt||'','Lead Time(일)':k.leadTimeDays||''}));const worksheet=XLSX.utils.json_to_sheet(data);const workbook=XLSX.utils.book_new();XLSX.utils.book_append_sheet(workbook,worksheet,'Kitting현황');XLSX.writeFile(workbook,`PBK_Kitting현황_${new Date().toISOString().slice(0,10)}.xlsx`);}catch(error){// 폴백: CSV로 다운로드
const headers=['Production Order','Model','Material Description','시작예정일','담당자','긴급','상태','완료일','Lead Time(일)'];const rows=kittingData.map(k=>[k.productionOrder,k.model,k.materialDesc||'',k.basicStartDate||'',k.worker||'',k.isUrgent?'긴급':'일반',k.status==='completed'?'완료':k.status==='in-progress'?'진행중':'대기',k.completedAt||'',k.leadTimeDays||'']);const csvContent=[headers,...rows].map(row=>row.map(cell=>`"${cell}"`).join(',')).join('\n');const blob=new Blob(['\ufeff'+csvContent],{type:'text/csv;charset=utf-8;'});const link=document.createElement('a');link.href=URL.createObjectURL(blob);link.download=`Kitting_현황_${new Date().toISOString().split('T')[0]}.csv`;link.click();}};// Kitting 수정 저장
const saveEditKitting=()=>{if(!editingKitting)return;setKittingData(prev=>prev.map(k=>k.id===editingKitting.id?editingKitting:k));setEditingKitting(null);};// Kitting 필터링 및 정렬
const filteredSortedKittings=React.useMemo(()=>{let result=[...kittingData];// 월별 필터
if(kittingFilterMonth){const ym=kittingFilterMonth;const ymShort=ym.slice(2);result=result.filter(k=>{const dt=k.startedAt||k.completedAt;return dt?dt.startsWith(ym)||dt.startsWith(ymShort):k.basicStartDate?.startsWith(ym)||k.basicStartDate?.startsWith(ymShort);});}// 검색어 필터
if(kittingSearchTerm){const term=kittingSearchTerm.toLowerCase();result=result.filter(k=>k.productionOrder?.toLowerCase().includes(term)||k.materialDesc?.toLowerCase().includes(term));}// 모델 필터
if(kittingFilterModel!=='all'){if(kittingFilterModel==='Maxwell 48'){result=result.filter(k=>['RSC48','CSC48'].includes(k.model));}else if(kittingFilterModel==='Maxwell 16'){result=result.filter(k=>['RSC16','CSC16','FSC16'].includes(k.model));}else{result=result.filter(k=>k.model===kittingFilterModel);}}// 상태 필터
if(kittingFilterStatus!=='all'){result=result.filter(k=>k.status===kittingFilterStatus);}// 정렬
result.sort((a,b)=>{let aVal=a[kittingSortBy]||'';let bVal=b[kittingSortBy]||'';if(kittingSortOrder==='asc')return aVal.localeCompare(bVal);return bVal.localeCompare(aVal);});return result;},[kittingData,kittingFilterMonth,kittingSearchTerm,kittingFilterModel,kittingFilterStatus,kittingSortBy,kittingSortOrder]);// Pick 수정 저장
const saveEditPick=()=>{if(!editingPick)return;// 불출 Cycle 저장
setPickCycles(prev=>prev.map(p=>p.id===editingPick.id?editingPick:p));// Kitting 담당자도 같이 변경
const productionOrder=editingPick.productionOrder||editingPick.orderId;if(productionOrder&&editingPick.worker){setKittingData(prev=>prev.map(k=>k.productionOrder===productionOrder?{...k,worker:editingPick.worker}:k));}setEditingPick(null);};// Receive 수정 저장
const saveEditReceive=()=>{if(!editingReceive)return;// delivery 형식 정규화 (하이픈 구분 → 공백 구분)
const cleaned={...editingReceive};if(cleaned.delivery){const dm=cleaned.delivery.match(/^(\d{4}-\d{2}-\d{2})[\-T\s](\d{2}:\d{2})/);if(dm)cleaned.delivery=dm[1]+' '+dm[2];}setReceiveCycles(prev=>prev.map(r=>r.id===cleaned.id?cleaned:r));setEditingReceive(null);};// ========== v15 헬퍼 함수들 ==========
// 토스트 메시지 표시
const showToast=(message,type='success')=>{const id=Date.now();setToasts(prev=>[...prev,{id,message,type}]);setTimeout(()=>{setToasts(prev=>prev.filter(t=>t.id!==id));},3000);};// v17: XLSX 라이브러리 동적 로드 헬퍼
const ensureXLSX=()=>new Promise((resolve,reject)=>{if(window.XLSX)return resolve();const script=document.createElement('script');script.src='https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';script.onload=resolve;script.onerror=()=>reject(new Error('XLSX 라이브러리 로드 실패'));document.head.appendChild(script);});// v17: GR Cancel SUM 시트 파싱 함수 (showToast 이후 정의)
const parseGRCancelExcel=async file=>{setGrCancelUploadStatus('loading');setGrCancelUploadMsg('파일 읽는 중...');try{await ensureXLSX();}catch(err){setGrCancelUploadStatus('error');setGrCancelUploadMsg('❌ XLSX 라이브러리 로드 실패');return;}const reader=new FileReader();reader.onload=e=>{try{const data=new Uint8Array(e.target.result);const workbook=window.XLSX.read(data,{type:'array'});const MONTH_NAMES=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];const newQty={};const newCancel={};// ── STEP 1: SUM 시트 파싱 ──
const sumSheetName=workbook.SheetNames.find(n=>n.toUpperCase()==='SUM');if(sumSheetName){const ws=workbook.Sheets[sumSheetName];const rows=window.XLSX.utils.sheet_to_json(ws,{header:1,defval:null});if(rows.length>=5){const headerRow=rows[0];const qtyRow=rows[1];const cancelRow=rows[3];let currentYear=null;for(let col=1;col<headerRow.length;col++){const cell=headerRow[col];if(cell===null||cell===undefined)continue;if(typeof cell==='number'&&cell>=2020&&cell<=2030){currentYear=Math.round(cell);continue;}if(typeof cell==='string'&&MONTH_NAMES.includes(cell)){if(!currentYear)continue;const mNum=MONTH_NAMES.indexOf(cell)+1;const key=`${currentYear}-${String(mNum).padStart(2,'0')}`;const qty=qtyRow[col];const cancel=cancelRow[col];if(typeof qty==='number'&&qty>0)newQty[key]=Math.round(qty);if(typeof cancel==='number'&&cancel>=0)newCancel[key]=Math.round(cancel);}}}}const qtyCount=Object.keys(newQty).length;const cancelCount=Object.keys(newCancel).length;if(qtyCount===0)throw new Error('SUM 시트에서 데이터를 파싱할 수 없습니다. SUM 시트를 확인하세요.');setKpiData(prev=>({...prev,grCancel:{...prev.grCancel,...newCancel},grCancelQty:{...prev.grCancelQty,...newQty}}));setGrCancelUploadStatus('success');setGrCancelUploadMsg(`✅ 파싱 완료: ${qtyCount}개월 (SUM + 개별 시트 보완)`);showToast(`GR Cancel 데이터 ${qtyCount}개월 로드 완료!`,'success');}catch(err){setGrCancelUploadStatus('error');setGrCancelUploadMsg(`❌ 오류: ${err.message}`);showToast('파일 파싱 실패: '+err.message,'error');}};reader.readAsArrayBuffer(file);};// v17: 재고 손실율 엑셀 업로드 파싱 함수
const parseInventoryLossExcel=async file=>{setInventoryLossUploadStatus('loading');setInventoryLossUploadMsg('파일 읽는 중...');try{await ensureXLSX();}catch(err){setInventoryLossUploadStatus('error');setInventoryLossUploadMsg('❌ XLSX 라이브러리 로드 실패');return;}const reader=new FileReader();reader.onload=e=>{try{const data=new Uint8Array(e.target.result);const workbook=window.XLSX.read(data,{type:'array'});const sheetName=workbook.SheetNames.find(n=>n==='Ratio')||workbook.SheetNames[0];const ws=workbook.Sheets[sheetName];const rows=window.XLSX.utils.sheet_to_json(ws,{header:1,defval:null});const newInvAdj={};const headerRow=rows[0]||[];const adjustRow=rows[3]||[];for(let col=1;col<headerRow.length;col++){const h=headerRow[col];if(!h)continue;const qMatch=typeof h==='string'&&h.match(/(\d{4})\s*\/\s*Q(\d)/);if(qMatch){const year=parseInt(qMatch[1]);const quarter=parseInt(qMatch[2]);const month=quarter*3;const key=`${year}-${String(month).padStart(2,'0')}`;const val=adjustRow[col];if(typeof val==='number')newInvAdj[key]=parseFloat((val*100).toFixed(4));}}if(Object.keys(newInvAdj).length>0){setKpiData(prev=>({...prev,inventoryAdjust:{...prev.inventoryAdjust,...newInvAdj}}));setInventoryLossUploadStatus('success');setInventoryLossUploadMsg(`✅ ${Object.keys(newInvAdj).length}개 기간 데이터 로드 (분기별). 월별 형식 확정 후 업데이트 예정.`);showToast('재고 손실율 데이터 업로드 완료','success');}else{setInventoryLossUploadStatus('error');setInventoryLossUploadMsg('❌ 파싱된 데이터 없음. 형식을 확인하세요.');}}catch(err){setInventoryLossUploadStatus('error');setInventoryLossUploadMsg(`❌ 오류: ${err.message}`);showToast('파일 파싱 실패: '+err.message,'error');}};reader.readAsArrayBuffer(file);};// 알림 추가
const addNotification=(title,message,type='info')=>{const notification={id:Date.now(),title,message,type,timestamp:new Date().toISOString(),read:false};setNotifications(prev=>[notification,...prev].slice(0,50));// 최대 50개 유지
};// 알림 읽음 처리
const markNotificationAsRead=id=>{setNotifications(prev=>prev.map(n=>n.id===id?{...n,read:true}:n));};// 모든 알림 읽음 처리
const markAllNotificationsAsRead=()=>{setNotifications(prev=>prev.map(n=>({...n,read:true})));};// 알림 삭제
const deleteNotification=id=>{setNotifications(prev=>prev.filter(n=>n.id!==id));};// 모든 알림 삭제
const clearAllNotifications=()=>{setNotifications([]);};// 데이터 히스토리 추가
const addDataHistory=(type,description,itemCount)=>{const history={id:Date.now(),type,description,itemCount,timestamp:new Date().toISOString()};setDataHistory(prev=>[history,...prev].slice(0,100));// 최대 100개 유지
};// 경과 시간 계산 (상세)
const getElapsedTimeDetail=dateString=>{if(!dateString)return'정보 없음';try{// 한국어 날짜 형식 파싱: "2026. 2. 9. 오후 3:30:00" 또는 "2026. 2. 9. 오전 10:30:00"
let past;if(dateString.includes('오전')||dateString.includes('오후')){// 한국어 형식
const isAM=dateString.includes('오전');const cleaned=dateString.replace('오전','').replace('오후','').trim();const parts=cleaned.split(/[.\s:]+/).filter(p=>p);if(parts.length>=5){let hours=parseInt(parts[3]);if(!isAM&&hours!==12)hours+=12;if(isAM&&hours===12)hours=0;past=new Date(parseInt(parts[0]),// year
parseInt(parts[1])-1,// month (0-indexed)
parseInt(parts[2]),// day
hours,parseInt(parts[4]),parseInt(parts[5])||0);}}// ISO 형식 또는 기타 형식 시도
if(!past||isNaN(past.getTime())){past=new Date(dateString);}if(isNaN(past.getTime())){// 파싱 실패 시 원본 문자열에서 시간 부분 제거하고 반환
return dateString.replace(/:\d{2}$/,'');}const now=new Date();const diffMs=now-past;const minutes=Math.floor(diffMs/(1000*60));const hours=Math.floor(diffMs/(1000*60*60));const days=Math.floor(diffMs/(1000*60*60*24));if(days>0){return`${days}일 전`;}else if(hours>0){return`${hours}시간 전`;}else if(minutes>0){return`${minutes}분 전`;}else{return'방금 전';}}catch(e){// 에러 시 원본 반환
return dateString.replace(/:\d{2}$/,'');}};// 공간 최적화 분석 (개선된 버전)
const analyzeSpaceOptimization=()=>{const suggestions=[];if(inventoryData.length===0)return suggestions;const SPECIAL_AREAS=['D2','E','F1','LABEL'];// 1. 영역별 공간 사용률 계산 (핵심!)
const areaUtils=[];rackSummary.forEach(rack=>{if(SPECIAL_AREAS.includes(rack.id))return;const areaItems=inventoryData.filter(item=>{const bin=item.bin||'';return bin.startsWith(rack.id+'-')||bin===rack.id;});const binGroups={};areaItems.forEach(item=>{const bin=item.bin||rack.id;if(!binGroups[bin])binGroups[bin]=[];binGroups[bin].push(item);});let totalCur=0,totalMax=0;Object.entries(binGroups).forEach(([bin,items])=>{let binCur=0;items.forEach(item=>{const qtyPerBox=MATERIAL_QTY_PER_BOX[item.material]||1;binCur+=(item.stock||0)/qtyPerBox;});totalCur+=binCur;const binInfo=BIN_RACK_INFO[bin]||{rackType:'경량랙',rackCount:1};if(binInfo.maxBoxes){totalMax+=binInfo.maxBoxes;}else if(binInfo.mixed){const binBoxTypes=items.map(i=>MATERIAL_BOX_MAP[i.material]||'PLASTIC-S');const tc={};binBoxTypes.forEach(t=>{tc[t]=(tc[t]||0)+1;});const mainBT=Object.entries(tc).sort((a,b)=>b[1]-a[1])[0]?.[0]||'PLASTIC-S';binInfo.mixed.forEach(m=>{const s=BOXES_PER_SHELF[m.type]||BOXES_PER_SHELF['경량랙'];totalMax+=(s[mainBT]||s['PLASTIC-S']||2)*m.count;});}else{const binBoxTypes=items.map(i=>MATERIAL_BOX_MAP[i.material]||'PLASTIC-S');const tc={};binBoxTypes.forEach(t=>{tc[t]=(tc[t]||0)+1;});const mainBT=Object.entries(tc).sort((a,b)=>b[1]-a[1])[0]?.[0]||'PLASTIC-S';const s=BOXES_PER_SHELF[binInfo.rackType]||BOXES_PER_SHELF['경량랙'];const perShelf=s[mainBT]||s['PLASTIC-S']||2;totalMax+=perShelf*binInfo.rackCount*(binInfo.shelves||1);}});const util=totalMax>0?totalCur/totalMax*100:0;areaUtils.push({id:rack.id,util:Math.round(util),curBoxes:totalCur,maxBoxes:totalMax,items:rack.items});});// 전체 공간 사용률
const totalCur=areaUtils.reduce((s,a)=>s+a.curBoxes,0);const totalMax=areaUtils.reduce((s,a)=>s+a.maxBoxes,0);const overallUtil=totalMax>0?Math.round(totalCur/totalMax*100):0;suggestions.push({type:'utilization_score',priority:overallUtil>85?'danger':overallUtil>70?'warning':overallUtil>50?'info':'success',title:'전체 공간 사용률',description:`현재 ${totalCur.toFixed(0)}박스 / 최대 ${totalMax.toFixed(0)}박스`,score:overallUtil,recommendation:overallUtil>85?'공간이 거의 포화 상태입니다. 추가 랙 확보를 검토하세요.':overallUtil>70?'적정 수준입니다. 효율적인 배치를 유지하세요.':'여유 공간이 충분합니다.'});// 2. 위험 영역 (80% 이상)
const dangerAreas=areaUtils.filter(a=>a.util>=80).sort((a,b)=>b.util-a.util);if(dangerAreas.length>0){suggestions.push({type:'overloaded_bins',priority:'danger',title:`공간 부족 영역 ${dangerAreas.length}개`,description:'80% 이상 적재된 영역입니다. 재배치 또는 랙 추가가 필요합니다.',details:dangerAreas.slice(0,8).map(a=>({rack:a.id,bin:'',count:a.util,totalStock:a.items})),action:dangerAreas.map(a=>`${a.id}(${a.util}%)`).join(', ')});}// 3. 여유 영역 (30% 미만)
const lowAreas=areaUtils.filter(a=>a.util<30&&a.items>0).sort((a,b)=>a.util-b.util);if(lowAreas.length>0){suggestions.push({type:'empty_bins',priority:'success',title:`여유 공간 영역 ${lowAreas.length}개`,description:'30% 미만 사용 중입니다. 과밀 영역 품목 이동에 활용 가능합니다.',details:lowAreas.slice(0,8).map(a=>({rack:a.id,bin:`${a.util}%`,count:0,totalStock:a.items})),action:lowAreas.map(a=>`${a.id}(${a.util}%)`).join(', ')});}// 4. 재배치 추천 (과밀 → 여유)
if(dangerAreas.length>0&&lowAreas.length>0){const recs=[];dangerAreas.slice(0,3).forEach(da=>{const sameSeries=lowAreas.find(la=>{return RACK_MODEL_SERIES[la.id]===RACK_MODEL_SERIES[da.id];});if(sameSeries){recs.push({from:`${da.id}(${da.util}%)`,to:`${sameSeries.id}(${sameSeries.util}%)`,reason:'같은 시리즈 내 재배치'});}});if(recs.length>0){suggestions.push({type:'relocation_recommendation',priority:'info',title:'재배치 추천',description:'같은 시리즈 내에서 과밀 → 여유 영역으로 품목 이동을 권장합니다.',details:recs,action:'공간 균형이 개선됩니다.'});}}return suggestions;};// 데이터 유효성 검사
const validateUploadData=(data,type)=>{const errors=[];const warnings=[];if(type==='stock'){// 필수 필드 체크
data.forEach((row,idx)=>{if(!row.material){errors.push(`행 ${idx+1}: Material 코드가 없습니다.`);}if(!row.bin){warnings.push(`행 ${idx+1}: Bin 정보가 없습니다 (Material: ${row.material})`);}if(row.stock<0){errors.push(`행 ${idx+1}: 재고 수량이 음수입니다 (${row.stock})`);}});// 중복 체크
const duplicates={};data.forEach(row=>{const key=`${row.material}-${row.bin}`;duplicates[key]=(duplicates[key]||0)+1;});Object.entries(duplicates).forEach(([key,count])=>{if(count>1){warnings.push(`중복 데이터: ${key} (${count}건)`);}});}if(type==='openPO'){data.forEach((row,idx)=>{if(!row.material){errors.push(`행 ${idx+1}: Material 코드가 없습니다.`);}if(!row.poNo){warnings.push(`행 ${idx+1}: PO 번호가 없습니다.`);}if(row.qty<=0){warnings.push(`행 ${idx+1}: 수량이 0 이하입니다.`);}});}if(type==='bom'){Object.entries(data).forEach(([model,items])=>{if(Object.keys(items).length===0){warnings.push(`${model}: BOM 항목이 없습니다.`);}Object.entries(items).forEach(([material,qty])=>{if(qty<=0){warnings.push(`${model} - ${material}: 수량이 0 이하입니다.`);}});});}return{isValid:errors.length===0,errors,warnings,summary:`${errors.length}개 오류, ${warnings.length}개 경고`};};// 데이터 초기화
const clearData=()=>{if(confirm('모든 재고 데이터를 초기화하시겠습니까?')){setInventoryData([]);setRackSummary([]);setLastUpdated(null);safeStorage.removeItem('pbk_inventory');safeStorage.removeItem('pbk_last_updated');showToast('재고 데이터가 초기화되었습니다.','info');addNotification('데이터 초기화','모든 재고 데이터가 초기화되었습니다.','warning');}};// 데이터 내보내기 (JSON 파일로 다운로드)
const exportAllData=()=>{const exportData={version:'1.2',exportDate:new Date().toISOString(),inventory:inventoryData,weightData:weightData,pickCycles:pickCycles,receiveCycles:receiveCycles,kittingData:kittingData,todoList:todoList,rackConfig:rackConfig,lastUpdated:lastUpdated,tempHumidityData:tempHumidityData,tempHumidityRecorder:tempHumidityRecorder,openPOData:openPOData,openPOLastUpdated:openPOLastUpdated,customBomData:customBomData,bomLastUpdated:bomLastUpdated};const jsonStr=JSON.stringify(exportData,null,2);setBackupData(jsonStr);};const selectAllBackupText=()=>{const textarea=document.getElementById('backup-textarea');if(textarea){textarea.select();textarea.setSelectionRange(0,textarea.value.length);alert('✅ 텍스트가 선택되었습니다!\nCtrl+C로 복사 후 메모장에 붙여넣기하세요.');}};// 데이터 가져오기 (JSON 파일에서 복원)
const importAllData=e=>{const file=e.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=event=>{try{const importData=JSON.parse(event.target.result);if(!importData.version){alert('❌ 유효하지 않은 백업 파일입니다.');return;}if(confirm(`${importData.exportDate?.slice(0,10)||'알 수 없음'} 백업을 복원하시겠습니까?\n현재 데이터가 덮어씌워집니다.`)){if(importData.inventory){setInventoryData(importData.inventory);processRackSummary(importData.inventory);safeStorage.setItem('pbk_inventory',JSON.stringify(importData.inventory));}if(importData.weightData){setWeightData(importData.weightData);safeStorage.setItem('pbk_weight_data',JSON.stringify(importData.weightData));}if(importData.pickCycles){setPickCycles(importData.pickCycles);safeStorage.setItem('pbk_pick_cycles',JSON.stringify(importData.pickCycles));}if(importData.receiveCycles){setReceiveCycles(importData.receiveCycles);safeStorage.setItem('pbk_receive_cycles',JSON.stringify(importData.receiveCycles));}if(importData.rackConfig){setRackConfig(importData.rackConfig);safeStorage.setItem('pbk_rack_config',JSON.stringify(importData.rackConfig));}if(importData.kittingData){setKittingData(importData.kittingData);safeStorage.setItem('pbk_kitting_data',JSON.stringify(importData.kittingData));}if(importData.todoList){setTodoList(importData.todoList);safeStorage.setItem('pbk_todo_list',JSON.stringify(importData.todoList));}if(importData.lastUpdated){setLastUpdated(importData.lastUpdated);safeStorage.setItem('pbk_last_updated',importData.lastUpdated);}// 온습도 데이터 복원
if(importData.tempHumidityData){setTempHumidityData(importData.tempHumidityData);safeStorage.setItem('pbk_temp_humidity_data',JSON.stringify(importData.tempHumidityData));}if(importData.tempHumidityRecorder){setTempHumidityRecorder(importData.tempHumidityRecorder);safeStorage.setItem('pbk_temp_humidity_recorder',importData.tempHumidityRecorder);}// Open PO 데이터 복원
if(importData.openPOData){setOpenPOData(importData.openPOData);safeStorage.setItem('pbk_open_po_data',JSON.stringify(importData.openPOData));}if(importData.openPOLastUpdated){setOpenPOLastUpdated(importData.openPOLastUpdated);safeStorage.setItem('pbk_open_po_last_updated',importData.openPOLastUpdated);}// BOM 데이터 복원
if(importData.customBomData){setCustomBomData(importData.customBomData);safeStorage.setItem('pbk_custom_bom_data',JSON.stringify(importData.customBomData));}if(importData.bomLastUpdated){setBomLastUpdated(importData.bomLastUpdated);safeStorage.setItem('pbk_bom_last_updated',importData.bomLastUpdated);}alert('✅ 데이터가 복원되었습니다!');}}catch(error){alert('❌ 파일을 읽는 중 오류가 발생했습니다.');console.error(error);}};reader.readAsText(file);e.target.value='';// 같은 파일 다시 선택 가능하게
};return/*#__PURE__*/React.createElement("div",{className:`min-h-screen ${darkMode?'bg-gray-900':'bg-slate-50'}`},/*#__PURE__*/React.createElement("div",{className:"fixed top-4 right-4 z-[100] space-y-2"},toasts.map(toast=>/*#__PURE__*/React.createElement("div",{key:toast.id,className:`px-4 py-3 rounded-lg shadow-lg text-white text-sm animate-pulse ${toast.type==='success'?'bg-emerald-500':toast.type==='error'?'bg-red-500':toast.type==='warning'?'bg-amber-500':'bg-blue-500'}`},toast.message))),isLoading&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[90]"},/*#__PURE__*/React.createElement("div",{className:`${darkMode?'bg-gray-800':'bg-white'} rounded-xl p-8 flex flex-col items-center gap-4 shadow-xl`},/*#__PURE__*/React.createElement("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),/*#__PURE__*/React.createElement("p",{className:`${darkMode?'text-gray-200':'text-gray-600'}`},loadingText||'처리 중...'))),/*#__PURE__*/React.createElement("header",{className:`${darkMode?'bg-gradient-to-r from-gray-800 to-gray-900':'bg-gradient-to-r from-indigo-700 to-indigo-900'} text-white shadow-lg`},/*#__PURE__*/React.createElement("div",{className:"max-w-7xl mx-auto px-4 py-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("div",{className:"bg-amber-400 text-gray-900 px-3 py-2 rounded-lg font-bold text-sm"},/*#__PURE__*/React.createElement("span",{className:"text-lg"},"\u2B21")," ",/*#__PURE__*/React.createElement("span",{className:"hidden sm:inline"},"Promega")),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h1",{className:"text-lg sm:text-xl font-bold"},"Warehouse Management ",/*#__PURE__*/React.createElement("span",{className:"text-indigo-300 text-sm font-normal"},APP_VERSION)),/*#__PURE__*/React.createElement("p",{className:"text-xs sm:text-sm text-indigo-200 hidden sm:block"},totals.items>0?`${totals.items.toLocaleString()}개 품목 | ${rackSummary.length}개 랙 | ${totals.bins}개 Bin`:'SAP 엑셀을 업로드해주세요'))),/*#__PURE__*/React.createElement("div",{className:"hidden md:flex items-center gap-2"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowShortcutHelp(true),className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition",title:"\uB2E8\uCD95\uD0A4 \uB3C4\uC6C0\uB9D0 (Ctrl+?)"},/*#__PURE__*/React.createElement(Keyboard,{className:"w-4 h-4"})),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowNotificationCenter(true),className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition relative",title:"\uC54C\uB9BC \uC13C\uD130 (Ctrl+N)"},/*#__PURE__*/React.createElement(Bell,{className:"w-4 h-4"}),(()=>{const now=new Date();const overdueReceiveCount=receiveCycles.filter(r=>{if(r.status==='completed')return false;if(!r.startTime)return false;return(now-new Date(r.startTime))/(1000*60*60)>=4;}).length;const unreadCount=notifications.filter(n=>!n.read).length;const totalAlerts=unreadCount+overdueReceiveCount+(showTempAlert?1:0)+(showUploadAlert?1:0)+(showOpenPOAlert?1:0);return totalAlerts>0?/*#__PURE__*/React.createElement("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center"},totalAlerts):null;})()),/*#__PURE__*/React.createElement("button",{onClick:()=>setDarkMode(!darkMode),className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition",title:darkMode?'라이트 모드':'다크 모드'},darkMode?/*#__PURE__*/React.createElement(Sun,{className:"w-4 h-4"}):/*#__PURE__*/React.createElement(Moon,{className:"w-4 h-4"})),/*#__PURE__*/React.createElement("a",{href:"http://172.30.49.122:8503/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition text-sm",title:"Operations Dashboard \uC5F4\uAE30"},/*#__PURE__*/React.createElement(ExternalLink,{className:"w-4 h-4"}),"Ops Dashboard"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowBackupModal(true),className:"flex items-center gap-2 px-3 py-2 bg-orange-500 hover:bg-orange-600 rounded-lg transition text-sm",title:"\uB370\uC774\uD130 \uBC31\uC5C5 \uBC0F \uBCF5\uC6D0"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"}),"\uBC31\uC5C5/\uBCF5\uC6D0"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowDataUploadModal(true),className:"flex items-center gap-2 px-3 py-2 bg-indigo-500 hover:bg-indigo-600 rounded-lg transition text-sm"},/*#__PURE__*/React.createElement(Database,{className:"w-4 h-4"}),"\uB370\uC774\uD130 \uAD00\uB9AC"),(lastUpdated||openPOLastUpdated||bomLastUpdated)&&/*#__PURE__*/React.createElement("div",{className:"text-left text-xs"},/*#__PURE__*/React.createElement("p",{className:"text-indigo-200 mb-1"},"\uB9C8\uC9C0\uB9C9 \uC5C5\uB370\uC774\uD2B8"),lastUpdated&&/*#__PURE__*/React.createElement("p",{title:getElapsedTimeDetail(lastUpdated)},/*#__PURE__*/React.createElement("span",{className:"text-emerald-300 font-bold"},"Stock:")," ",lastUpdated.replace(/:\d{2}$/,'').replace(/^20/,'')),openPOLastUpdated&&/*#__PURE__*/React.createElement("p",{title:getElapsedTimeDetail(openPOLastUpdated)},/*#__PURE__*/React.createElement("span",{className:"text-amber-300 font-bold"},"Open PO:")," ",openPOLastUpdated.replace(/:\d{2}$/,'').replace(/^20/,'')),bomLastUpdated&&/*#__PURE__*/React.createElement("p",{title:getElapsedTimeDetail(bomLastUpdated)},/*#__PURE__*/React.createElement("span",{className:"text-purple-300 font-bold"},"BOM:")," ",bomLastUpdated.replace(/:\d{2}$/,'').replace(/^20/,'')))),/*#__PURE__*/React.createElement("div",{className:"flex md:hidden items-center gap-2"},/*#__PURE__*/React.createElement("button",{onClick:()=>setDarkMode(!darkMode),className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition"},darkMode?/*#__PURE__*/React.createElement(Sun,{className:"w-5 h-5"}):/*#__PURE__*/React.createElement(Moon,{className:"w-5 h-5"})),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowNotificationCenter(true),className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition relative"},/*#__PURE__*/React.createElement(Bell,{className:"w-5 h-5"}),notifications.filter(n=>!n.read).length>0&&/*#__PURE__*/React.createElement("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-xs rounded-full flex items-center justify-center"},notifications.filter(n=>!n.read).length)),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowDataUploadModal(true),className:"p-2 bg-white/20 hover:bg-white/30 rounded-lg transition"},/*#__PURE__*/React.createElement(Database,{className:"w-5 h-5"})))))),/*#__PURE__*/React.createElement("nav",{className:`hidden md:block ${darkMode?'bg-gray-800 border-gray-700':'bg-white border-b'} shadow-sm sticky top-0 z-10`},/*#__PURE__*/React.createElement("div",{className:"max-w-7xl mx-auto px-4"},/*#__PURE__*/React.createElement("div",{className:"flex gap-1 overflow-x-auto"},[{id:'dashboard',label:'Overview',icon:BarChart3},{id:'receive',label:'입고 Cycle',icon:Database},{id:'kitting',label:'Kitting L/T',icon:Package},{id:'pick',label:'Kitting Cycle',icon:Clock},{id:'kpi',label:'KPI',icon:TrendingUp},{id:'analysis',label:'Area Analysis',icon:BarChart3},{id:'locate',label:'자재 위치',icon:Search},{id:'layout',label:'랙 배치도',icon:Warehouse},{id:'view3d',label:'3D 뷰',icon:Box},{id:'temphumidity',label:'온습도 관리',icon:Thermometer},{id:'todo',label:'TO DO',icon:Check}].map(tab=>/*#__PURE__*/React.createElement("button",{key:tab.id,onClick:()=>setActiveTab(tab.id),className:`flex items-center gap-1.5 px-2.5 py-2.5 text-xs font-medium border-b-2 transition whitespace-nowrap ${activeTab===tab.id?'border-indigo-600 text-indigo-600 bg-indigo-50':darkMode?'border-transparent text-gray-300 hover:text-white':'border-transparent text-gray-600 hover:text-gray-900'}`},/*#__PURE__*/React.createElement(tab.icon,{className:"w-3.5 h-3.5"}),tab.label,tab.id==='todo'&&dueSoonTodos.length>0&&/*#__PURE__*/React.createElement("span",{className:"ml-1 px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full"},dueSoonTodos.length),tab.id==='receive'&&(()=>{const now=new Date();const overdueCount=receiveCycles.filter(r=>{if(r.status==='completed')return false;if(!r.startTime)return false;return(now-new Date(r.startTime))/(1000*60*60)>=4;}).length;return overdueCount>0?/*#__PURE__*/React.createElement("span",{className:"ml-1 px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full"},overdueCount):null;})(),tab.id==='rack'&&fullBins.length>0&&/*#__PURE__*/React.createElement("span",{className:"ml-1 px-1.5 py-0.5 bg-pink-500 text-white text-xs rounded-full"},fullBins.length)))))),/*#__PURE__*/React.createElement("nav",{className:`md:hidden fixed bottom-0 left-0 right-0 ${darkMode?'bg-gray-800 border-gray-700':'bg-white border-t'} shadow-lg z-50`},/*#__PURE__*/React.createElement("div",{className:"flex justify-around items-center py-2"},[{id:'dashboard',label:'Overview',icon:BarChart3},{id:'receive',label:'입고',icon:Database},{id:'kitting',label:'Kitting',icon:Package},{id:'pick',label:'Cycle',icon:Clock},{id:'more',label:'더보기',icon:List}].map(tab=>/*#__PURE__*/React.createElement("button",{key:tab.id,onClick:()=>{if(tab.id==='more'){setShowMobileMenu(true);}else{setActiveTab(tab.id);}},className:`flex flex-col items-center gap-1 px-3 py-1 rounded-lg transition ${activeTab===tab.id?'text-indigo-600':'text-gray-500'}`},/*#__PURE__*/React.createElement(tab.icon,{className:"w-5 h-5"}),/*#__PURE__*/React.createElement("span",{className:"text-xs"},tab.label),tab.id==='receive'&&receiveCycles.filter(r=>r.status==='in-progress').length>0&&/*#__PURE__*/React.createElement("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full"}))))),showMobileMenu&&/*#__PURE__*/React.createElement("div",{className:"md:hidden fixed inset-0 bg-black/50 z-50 flex items-end",onClick:()=>setShowMobileMenu(false)},/*#__PURE__*/React.createElement("div",{className:"bg-white w-full rounded-t-2xl p-4 pb-8",onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"w-12 h-1 bg-gray-300 rounded-full mx-auto mb-4"}),/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg mb-4"},"\uBA54\uB274"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-4 gap-4"},[{id:'dashboard',label:'Overview',icon:BarChart3},{id:'receive',label:'입고',icon:Database},{id:'kitting',label:'Kitting',icon:Package},{id:'pick',label:'Cycle',icon:Clock},{id:'kpi',label:'KPI',icon:TrendingUp},{id:'analysis',label:'Analysis',icon:BarChart3},{id:'todo',label:'TO DO',icon:Check}].map(tab=>/*#__PURE__*/React.createElement("button",{key:tab.id,onClick:()=>{setActiveTab(tab.id);setShowMobileMenu(false);},className:`flex flex-col items-center gap-2 p-3 rounded-xl transition ${activeTab===tab.id?'bg-indigo-100 text-indigo-600':'bg-gray-50 text-gray-600'}`},/*#__PURE__*/React.createElement(tab.icon,{className:"w-6 h-6"}),/*#__PURE__*/React.createElement("span",{className:"text-xs"},tab.label)))),/*#__PURE__*/React.createElement("div",{className:"mt-6 pt-4 border-t grid grid-cols-2 gap-3"},/*#__PURE__*/React.createElement("button",{onClick:()=>{setShowBackupModal(true);setShowMobileMenu(false);},className:"flex items-center justify-center gap-2 p-3 bg-orange-100 text-orange-600 rounded-xl"},/*#__PURE__*/React.createElement(Download,{className:"w-5 h-5"})," \uBC31\uC5C5/\uBCF5\uC6D0"),/*#__PURE__*/React.createElement("button",{onClick:()=>{setShowDataUploadModal(true);setShowMobileMenu(false);},className:"flex items-center justify-center gap-2 p-3 bg-indigo-100 text-indigo-600 rounded-xl"},/*#__PURE__*/React.createElement(Database,{className:"w-5 h-5"})," \uB370\uC774\uD130 \uAD00\uB9AC")))),/*#__PURE__*/React.createElement("main",{className:"max-w-7xl mx-auto px-4 py-6 pb-24 md:pb-6"},inventoryData.length===0&&activeTab!=='pick'&&activeTab!=='receive'&&activeTab!=='todo'&&activeTab!=='kitting'&&/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center"},/*#__PURE__*/React.createElement(FileSpreadsheet,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),/*#__PURE__*/React.createElement("h3",{className:"text-xl font-semibold text-gray-700 mb-2"},"\uC7AC\uACE0 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),/*#__PURE__*/React.createElement("p",{className:"text-gray-500 mb-6"},"SAP\uC5D0\uC11C \uCD94\uCD9C\uD55C \uC7AC\uACE0 \uB9AC\uC2A4\uD2B8 \uC5D1\uC140\uC744 \uC5C5\uB85C\uB4DC\uD574\uC8FC\uC138\uC694."),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowUploadModal(true),className:"inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},/*#__PURE__*/React.createElement(Upload,{className:"w-5 h-5"}),"\uC5D1\uC140 \uC5C5\uB85C\uB4DC")),activeTab==='dashboard'&&inventoryData.length===0&&/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",{className:"bg-amber-50 border border-amber-300 rounded-xl p-5 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-2xl"},"\uD83D\uDCCA"),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-amber-800"},"\uC624\uB298 \uC7AC\uACE0 \uB370\uC774\uD130 \uBBF8\uC5C5\uB85C\uB4DC!"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-amber-600"},"ZBIN(Stock) \uB370\uC774\uD130\uB97C \uC5C5\uB85C\uB4DC\uD574\uC8FC\uC138\uC694."))),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowDataUploadModal(true),className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 text-sm font-medium"},"\uC5C5\uB85C\uB4DC\uD558\uAE30")),showOpenPOAlert&&/*#__PURE__*/React.createElement("div",{className:"bg-orange-50 border border-orange-300 rounded-xl p-5 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-2xl"},"\uD83D\uDCCB"),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-orange-800"},"Open PO \uB370\uC774\uD130 \uBBF8\uC5C5\uB85C\uB4DC!"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-orange-600"},"ME2N(Open PO) \uB370\uC774\uD130\uB97C \uC5C5\uB85C\uB4DC\uD574\uC8FC\uC138\uC694."))),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowOpenPOModal(true),className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm font-medium"},"\uC5C5\uB85C\uB4DC\uD558\uAE30")),showTempAlert&&/*#__PURE__*/React.createElement("div",{className:"bg-red-50 border border-red-300 rounded-xl p-5 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-2xl"},"\uD83C\uDF21\uFE0F"),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-red-800"},"\uC628\uC2B5\uB3C4 \uBBF8\uC785\uB825!"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-red-600"},"\uC624\uB298\uC758 \uC628\uB3C4/\uC2B5\uB3C4\uAC00 \uC544\uC9C1 \uC785\uB825\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."))),/*#__PURE__*/React.createElement("button",{onClick:()=>setActiveTab('temphumidity'),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium"},"\uC785\uB825\uD558\uB7EC \uAC00\uAE30"))),activeTab==='dashboard'&&inventoryData.length>0&&/*#__PURE__*/React.createElement("div",{className:"space-y-6"},showTempAlert&&/*#__PURE__*/React.createElement("div",{className:"bg-red-50 border border-red-300 rounded-xl p-4 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-2xl"},"\uD83C\uDF21\uFE0F"),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-red-800"},"\uC628\uC2B5\uB3C4 \uBBF8\uC785\uB825!"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-red-600"},"\uC624\uB298\uC758 \uC628\uB3C4/\uC2B5\uB3C4\uAC00 \uC544\uC9C1 \uC785\uB825\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4. \uC628\uC2B5\uB3C4 \uAD00\uB9AC \uD0ED\uC5D0\uC11C \uC785\uB825\uD574\uC8FC\uC138\uC694."))),/*#__PURE__*/React.createElement("button",{onClick:()=>setActiveTab('temphumidity'),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium"},"\uC785\uB825\uD558\uB7EC \uAC00\uAE30")),showUploadAlert&&/*#__PURE__*/React.createElement("div",{className:"bg-amber-50 border border-amber-300 rounded-xl p-4 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-2xl"},"\uD83D\uDCCA"),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-amber-800"},"\uC624\uB298 \uC7AC\uACE0 \uB370\uC774\uD130 \uBBF8\uC5C5\uB85C\uB4DC!"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-amber-600"},"ZBIN(Stock) \uB370\uC774\uD130\uB97C \uC5C5\uB85C\uB4DC\uD574\uC8FC\uC138\uC694."))),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowDataUploadModal(true),className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 text-sm font-medium"},"\uC5C5\uB85C\uB4DC\uD558\uAE30")),showOpenPOAlert&&/*#__PURE__*/React.createElement("div",{className:"bg-orange-50 border border-orange-300 rounded-xl p-4 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-2xl"},"\uD83D\uDCCB"),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-orange-800"},"Open PO \uB370\uC774\uD130 \uBBF8\uC5C5\uB85C\uB4DC!"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-orange-600"},"ME2N(Open PO) \uB370\uC774\uD130\uB97C \uC5C5\uB85C\uB4DC\uD574\uC8FC\uC138\uC694."))),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowOpenPOModal(true),className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 text-sm font-medium"},"\uC5C5\uB85C\uB4DC\uD558\uAE30")),(()=>{if(!lastUpdated)return null;const lastUpdateDate=new Date(lastUpdated.replace(/\. /g,'-').replace('.',''));const hoursSinceUpdate=(new Date()-lastUpdateDate)/(1000*60*60);const needsUpdate=hoursSinceUpdate>24;if(needsUpdate){return/*#__PURE__*/React.createElement("div",{className:"bg-amber-50 border border-amber-300 rounded-xl p-4 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement(AlertTriangle,{className:"w-5 h-5 text-amber-600"}),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-medium text-amber-800"},"\uC7AC\uACE0 \uB370\uC774\uD130 \uAC31\uC2E0 \uD544\uC694"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-amber-600"},"\uB9C8\uC9C0\uB9C9 \uC5C5\uB370\uC774\uD2B8: ",lastUpdated," (",Math.floor(hoursSinceUpdate),"\uC2DC\uAC04 \uC804)"))),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowUploadModal(true),className:"px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 flex items-center gap-2"},/*#__PURE__*/React.createElement(Upload,{className:"w-4 h-4"})," SAP Stock \uC5C5\uB85C\uB4DC"));}return null;})(),(()=>{const now=new Date();const overdueReceives=receiveCycles.filter(r=>{if(r.status==='completed')return false;if(!r.startTime)return false;const startTime=new Date(r.startTime);const hoursPassed=(now-startTime)/(1000*60*60);return hoursPassed>=4;// 4시간 이상 경과
});if(overdueReceives.length>0){return/*#__PURE__*/React.createElement("div",{className:"bg-red-50 border border-red-300 rounded-xl p-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement(AlertTriangle,{className:"w-5 h-5 text-red-600"}),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-medium text-red-800"},"\u26A0\uFE0F \uC785\uACE0 \uBBF8\uCC98\uB9AC ",overdueReceives.length,"\uAC74"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-red-600"},"4\uC2DC\uAC04 \uC774\uC0C1 MIGO \uBBF8\uC644\uB8CC: ",overdueReceives.map(r=>`${r.vendor}(No.${r.poNo})`).join(', ')))),/*#__PURE__*/React.createElement("button",{onClick:()=>setActiveTab('receive'),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 flex items-center gap-2"},"\uC785\uACE0 Cycle \uC774\uB3D9")));}return null;})(),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4"},(()=>{// 이번 달과 지난 달 데이터 분리
const now=new Date();const thisMonth=`${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}`;const lastMonthDate=new Date(now.getFullYear(),now.getMonth()-1,1);const lastMonth=`${lastMonthDate.getFullYear()}-${String(lastMonthDate.getMonth()+1).padStart(2,'0')}`;// 불출시간 - 이번 달 vs 지난 달
const thisMonthPicks=pickCycles.filter(p=>p.status==='completed'&&p.cycleMin&&p.completed?.startsWith(thisMonth));const lastMonthPicks=pickCycles.filter(p=>p.status==='completed'&&p.cycleMin&&p.completed?.startsWith(lastMonth));const thisMonthPickAvg=thisMonthPicks.length>0?thisMonthPicks.reduce((s,p)=>s+p.cycleMin,0)/thisMonthPicks.length:0;const lastMonthPickAvg=lastMonthPicks.length>0?lastMonthPicks.reduce((s,p)=>s+p.cycleMin,0)/lastMonthPicks.length:0;const pickDiff=lastMonthPickAvg>0?thisMonthPickAvg-lastMonthPickAvg:0;// 입고시간 - 이번 달 vs 지난 달
const thisMonthReceives=receiveCycles.filter(r=>r.status==='completed'&&r.cycleMin&&r.migo?.startsWith(thisMonth));const lastMonthReceives=receiveCycles.filter(r=>r.status==='completed'&&r.cycleMin&&r.migo?.startsWith(lastMonth));const thisMonthReceiveAvg=thisMonthReceives.length>0?thisMonthReceives.reduce((s,r)=>s+r.cycleMin,0)/thisMonthReceives.length:0;const lastMonthReceiveAvg=lastMonthReceives.length>0?lastMonthReceives.reduce((s,r)=>s+r.cycleMin,0)/lastMonthReceives.length:0;const receiveDiff=lastMonthReceiveAvg>0?thisMonthReceiveAvg-lastMonthReceiveAvg:0;// 리드타임 - 이번 달 vs 지난 달
const thisMonthKittings=kittingData.filter(k=>k.status==='completed'&&k.leadTimeDays&&k.completedAt?.startsWith(thisMonth));const lastMonthKittings=kittingData.filter(k=>k.status==='completed'&&k.leadTimeDays&&k.completedAt?.startsWith(lastMonth));const thisMonthLeadAvg=thisMonthKittings.length>0?thisMonthKittings.reduce((s,k)=>s+k.leadTimeDays,0)/thisMonthKittings.length:0;const lastMonthLeadAvg=lastMonthKittings.length>0?lastMonthKittings.reduce((s,k)=>s+k.leadTimeDays,0)/lastMonthKittings.length:0;const leadDiff=lastMonthLeadAvg>0?thisMonthLeadAvg-lastMonthLeadAvg:0;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-rose-500 cursor-pointer hover:bg-rose-50 transition",onClick:()=>setShowReceiveDetailModal(true)},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},"\uD3C9\uADE0 \uC785\uACE0\uC2DC\uAC04 ",/*#__PURE__*/React.createElement("span",{className:"text-xs text-rose-500"},"\u25B6 \uD074\uB9AD")),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2"},/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold"},avgReceiveTime.toFixed(0),"\uBD84"),/*#__PURE__*/React.createElement("span",{className:`text-sm font-medium ${receiveDiff>0?'text-red-500':receiveDiff<0?'text-green-500':'text-gray-400'}`},receiveDiff!==0?(receiveDiff>0?'↑':'↓')+Math.abs(receiveDiff).toFixed(0)+'분':'-'," ",/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400"},"\uC804\uC6D4\uB300\uBE44"))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mt-1"},"\uC644\uB8CC ",receiveCycles.filter(r=>r.status==='completed').length,"\uAC74 \uAE30\uC900")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-cyan-500 cursor-pointer hover:bg-cyan-50 transition",onClick:()=>setShowLeadTimeDetailModal(true)},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},"\uD3C9\uADE0 Kitting \uB9AC\uB4DC\uD0C0\uC784 ",/*#__PURE__*/React.createElement("span",{className:"text-xs text-cyan-500"},"\u25B6 \uD074\uB9AD")),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2"},/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold"},avgLeadTime.toFixed(1),"\uC77C"),/*#__PURE__*/React.createElement("span",{className:`text-sm font-medium ${leadDiff>0?'text-red-500':leadDiff<0?'text-green-500':'text-gray-400'}`},leadDiff!==0?(leadDiff>0?'↑':'↓')+Math.abs(leadDiff).toFixed(1)+'일':'-'," ",/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400"},"\uC804\uC6D4\uB300\uBE44"))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mt-1"},"Kitting \uC644\uB8CC ",kittingData.filter(k=>k.status==='completed').length,"\uAC74 \uAE30\uC900")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-purple-500 cursor-pointer hover:bg-purple-50 transition",onClick:()=>setShowPickDetailModal(true)},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},"\uD3C9\uADE0 Kitting \uC2DC\uAC04 ",/*#__PURE__*/React.createElement("span",{className:"text-xs text-purple-500"},"\u25B6 \uD074\uB9AD")),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2"},/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold"},avgPickTime.toFixed(0),"\uBD84"),/*#__PURE__*/React.createElement("span",{className:`text-sm font-medium ${pickDiff>0?'text-red-500':pickDiff<0?'text-green-500':'text-gray-400'}`},pickDiff!==0?(pickDiff>0?'↑':'↓')+Math.abs(pickDiff).toFixed(0)+'분':'-'," ",/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400"},"\uC804\uC6D4\uB300\uBE44"))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mt-1"},"\uC644\uB8CC ",pickCycles.filter(p=>p.status==='completed').length,"\uAC74 \uAE30\uC900")));})()),/*#__PURE__*/React.createElement("div",{className:"flex justify-end"},/*#__PURE__*/React.createElement("button",{onClick:downloadWeeklyReport,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 shadow-sm transition"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"}),"\uD83D\uDCCA \uC8FC\uAC04 \uB9AC\uD3EC\uD2B8 \uB2E4\uC6B4\uB85C\uB4DC")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold flex items-center gap-2"},/*#__PURE__*/React.createElement(Package,{className:"w-5 h-5 text-indigo-600"}),"\uD83C\uDFED \uBAA8\uB378\uBCC4 \uC0DD\uC0B0 \uAC00\uB2A5 \uB300\uC218"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 mt-1 sm:mt-0"},lastUpdated&&/*#__PURE__*/React.createElement("span",{className:`text-xs px-2 py-1 rounded ${(()=>{const lastUpdateDate=new Date(lastUpdated.replace(/\. /g,'-').replace('.',''));const hoursSinceUpdate=(new Date()-lastUpdateDate)/(1000*60*60);return hoursSinceUpdate>24?'bg-amber-100 text-amber-700':'bg-green-100 text-green-700';})()}`},"\uD83D\uDCC5 ",lastUpdated))),(()=>{const TARGET_STOCK={'RSC16':{min:10,max:30},'CSC16':{min:5,max:10},'FSC16':{min:2,max:2},'RSC48':{min:10,max:20},'CSC48':{min:3,max:10},'HSM3':{min:1,max:5}};const modelStatus=Object.entries(TARGET_STOCK).map(([model,range])=>{const info=MODEL_WEIGHTS[model];const currentStock=inventoryData.filter(i=>i.material===info?.code).reduce((sum,i)=>sum+(i.stock||0),0);let status='ok';if(currentStock>range.max)status='over';else if(currentStock>=range.min)status='ok';else if(currentStock>=range.min*0.5)status='warning';else status='shortage';return{model,currentStock,status};});const overStock=modelStatus.filter(m=>m.status==='over');const okStock=modelStatus.filter(m=>m.status==='ok');const warningStock=modelStatus.filter(m=>m.status==='warning');const shortageStock=modelStatus.filter(m=>m.status==='shortage');return/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-4 gap-3 mb-4"},/*#__PURE__*/React.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 cursor-pointer hover:bg-purple-100 transition",onClick:()=>setShowModelDetailModal('excess')},/*#__PURE__*/React.createElement("p",{className:"text-xs text-purple-600 font-medium"},"\uD83D\uDCE6 \uACFC\uB2E4 \uC7AC\uACE0"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-purple-700"},overStock.length,/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal ml-1"},"\uBAA8\uB378"))),/*#__PURE__*/React.createElement("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3 cursor-pointer hover:bg-emerald-100 transition",onClick:()=>setShowModelDetailModal('normal')},/*#__PURE__*/React.createElement("p",{className:"text-xs text-emerald-600 font-medium"},"\u2705 \uC801\uC815 \uC7AC\uACE0"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-emerald-700"},okStock.length,/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal ml-1"},"\uBAA8\uB378"))),/*#__PURE__*/React.createElement("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 cursor-pointer hover:bg-amber-100 transition",onClick:()=>setShowModelDetailModal('caution')},/*#__PURE__*/React.createElement("p",{className:"text-xs text-amber-600 font-medium"},"\u26A0\uFE0F \uBD80\uC871 \uC8FC\uC758"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-amber-700"},warningStock.length,/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal ml-1"},"\uBAA8\uB378"))),/*#__PURE__*/React.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 cursor-pointer hover:bg-red-100 transition",onClick:()=>setShowModelDetailModal('urgent')},/*#__PURE__*/React.createElement("p",{className:"text-xs text-red-600 font-medium"},"\uD83D\uDEA8 \uBD80\uC871 \uAE34\uAE09"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-red-700"},shortageStock.length,/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal ml-1"},"\uBAA8\uB378"))));})(),/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap gap-4 mb-4 text-xs"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded-full bg-purple-400"})," \uACFC\uB2E4 (\uCD5C\uB300 \uCD08\uACFC)"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded-full bg-emerald-400"})," \uC801\uC815 (\uCD5C\uC18C~\uCD5C\uB300)"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded-full bg-amber-400"})," \uC8FC\uC758 (\uCD5C\uC18C\uC758 50% \uC774\uC0C1)"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded-full bg-red-400"})," \uAE34\uAE09 (\uCD5C\uC18C\uC758 50% \uBBF8\uB9CC)")),/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h4",{className:"text-sm font-semibold text-purple-700 mb-3 flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 bg-purple-100 rounded text-xs"},"16")," Maxwell 16 \uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4"},Object.entries(MODEL_WEIGHTS).filter(([_,info])=>info.series==='16').map(([model,info])=>{const prodInfo=producibleUnits[model]||{units:0,coverage:'0'};const TARGET={RSC16:{min:10,max:30},CSC16:{min:5,max:10},FSC16:{min:2,max:2}};const range=TARGET[model]||{min:10,max:30};const currentStock=inventoryData.filter(i=>i.material===info.code).reduce((sum,i)=>sum+(i.stock||0),0);const status=currentStock>range.max?'over':currentStock>=range.min?'ok':currentStock>=range.min*0.5?'warning':'shortage';const bgColor=status==='over'?'bg-purple-50 border-purple-300':status==='ok'?'bg-emerald-50 border-emerald-300':status==='warning'?'bg-amber-50 border-amber-300':'bg-red-50 border-red-300';const textColor=status==='over'?'text-purple-700':status==='ok'?'text-emerald-700':status==='warning'?'text-amber-700':'text-red-700';const statusLabel=status==='over'?'과다':status==='ok'?'적정':status==='warning'?'주의':'긴급';const statusIcon=status==='over'?'📦':status==='ok'?'✅':status==='warning'?'⚠️':'🚨';return/*#__PURE__*/React.createElement("div",{key:model,className:`rounded-xl p-4 border-2 ${bgColor}`},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-start mb-2"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-gray-800"},model),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},info.code)),/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${status==='over'?'bg-purple-200 text-purple-800':status==='ok'?'bg-emerald-200 text-emerald-800':status==='warning'?'bg-amber-200 text-amber-800':'bg-red-200 text-red-800'}`},statusIcon," ",statusLabel)),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2"},/*#__PURE__*/React.createElement("p",{className:`text-3xl font-bold ${textColor}`},prodInfo.units,/*#__PURE__*/React.createElement("span",{className:"text-lg"},"\uB300"))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Safety Stock: ",range.min,"~",range.max,"\uB300"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-blue-600 mt-0.5"},"\uD604\uC7AC \uC7AC\uACE0: ",currentStock.toLocaleString()," EA"),/*#__PURE__*/React.createElement("div",{className:"mt-2"},/*#__PURE__*/React.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2 relative"},/*#__PURE__*/React.createElement("div",{className:"absolute h-full w-0.5 bg-gray-400",style:{left:`${range.min/range.max*100}%`}}),/*#__PURE__*/React.createElement("div",{className:`h-2 rounded-full ${status==='over'?'bg-purple-500':status==='ok'?'bg-emerald-500':status==='warning'?'bg-amber-500':'bg-red-500'}`,style:{width:`${Math.min(currentStock/range.max*100,100)}%`}}))),prodInfo.bottleneck&&/*#__PURE__*/React.createElement("div",{className:"mt-2 text-xs"},/*#__PURE__*/React.createElement("p",{className:"text-gray-600 truncate"},"\uBCD1\uBAA9: ",prodInfo.bottleneck.material," | ",prodInfo.bottleneck.description?.slice(0,15)||'-'," | \uC7AC\uACE0: ",prodInfo.bottleneck.currentStock," EA",(()=>{const openPO=getOpenPOForMaterial(prodInfo.bottleneck.material);return openPO?/*#__PURE__*/React.createElement("span",{className:"text-green-600 font-medium ml-1"},"| \uD83D\uDCE6 ",openPO.totalQty.toLocaleString()," ",openPO.unit):/*#__PURE__*/React.createElement("span",{className:"text-red-500 ml-1"},"| \u26A0\uFE0F Open PO \uC5C6\uC74C");})())));}))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h4",{className:"text-sm font-semibold text-blue-700 mb-3 flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 bg-blue-100 rounded text-xs"},"48")," Maxwell 48 \uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4"},Object.entries(MODEL_WEIGHTS).filter(([_,info])=>info.series==='48').map(([model,info])=>{const prodInfo=producibleUnits[model]||{units:0,coverage:'0'};const TARGET={RSC48:{min:10,max:20},CSC48:{min:3,max:10}};const range=TARGET[model]||{min:10,max:20};const currentStock=inventoryData.filter(i=>i.material===info.code).reduce((sum,i)=>sum+(i.stock||0),0);const status=currentStock>range.max?'over':currentStock>=range.min?'ok':currentStock>=range.min*0.5?'warning':'shortage';const bgColor=status==='over'?'bg-purple-50 border-purple-300':status==='ok'?'bg-emerald-50 border-emerald-300':status==='warning'?'bg-amber-50 border-amber-300':'bg-red-50 border-red-300';const textColor=status==='over'?'text-purple-700':status==='ok'?'text-emerald-700':status==='warning'?'text-amber-700':'text-red-700';const statusLabel=status==='over'?'과다':status==='ok'?'적정':status==='warning'?'주의':'긴급';const statusIcon=status==='over'?'📦':status==='ok'?'✅':status==='warning'?'⚠️':'🚨';return/*#__PURE__*/React.createElement("div",{key:model,className:`rounded-xl p-4 border-2 ${bgColor}`},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-start mb-2"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-gray-800"},model),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},info.code)),/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${status==='over'?'bg-purple-200 text-purple-800':status==='ok'?'bg-emerald-200 text-emerald-800':status==='warning'?'bg-amber-200 text-amber-800':'bg-red-200 text-red-800'}`},statusIcon," ",statusLabel)),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2"},/*#__PURE__*/React.createElement("p",{className:`text-3xl font-bold ${textColor}`},prodInfo.units,/*#__PURE__*/React.createElement("span",{className:"text-lg"},"\uB300"))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Safety Stock: ",range.min,"~",range.max,"\uB300"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-blue-600 mt-0.5"},"\uD604\uC7AC \uC7AC\uACE0: ",currentStock.toLocaleString()," EA"),/*#__PURE__*/React.createElement("div",{className:"mt-2"},/*#__PURE__*/React.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2 relative"},/*#__PURE__*/React.createElement("div",{className:"absolute h-full w-0.5 bg-gray-400",style:{left:`${range.min/range.max*100}%`}}),/*#__PURE__*/React.createElement("div",{className:`h-2 rounded-full ${status==='over'?'bg-purple-500':status==='ok'?'bg-emerald-500':status==='warning'?'bg-amber-500':'bg-red-500'}`,style:{width:`${Math.min(currentStock/range.max*100,100)}%`}}))),prodInfo.bottleneck&&/*#__PURE__*/React.createElement("div",{className:"mt-2 text-xs"},/*#__PURE__*/React.createElement("p",{className:"text-gray-600 truncate"},"\uBCD1\uBAA9: ",prodInfo.bottleneck.material," | ",prodInfo.bottleneck.description?.slice(0,15)||'-'," | \uC7AC\uACE0: ",prodInfo.bottleneck.currentStock," EA",(()=>{const openPO=getOpenPOForMaterial(prodInfo.bottleneck.material);return openPO?/*#__PURE__*/React.createElement("span",{className:"text-green-600 font-medium ml-1"},"| \uD83D\uDCE6 ",openPO.totalQty.toLocaleString()," ",openPO.unit):/*#__PURE__*/React.createElement("span",{className:"text-red-500 ml-1"},"| \u26A0\uFE0F Open PO \uC5C6\uC74C");})())));}),/*#__PURE__*/React.createElement("div",{className:"rounded-xl p-4 border-2 border-dashed border-gray-200 bg-gray-50 flex items-center justify-center"},/*#__PURE__*/React.createElement("span",{className:"text-gray-400 text-sm"},"-")))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h4",{className:"text-sm font-semibold text-orange-600 mb-3 flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 bg-orange-100 rounded text-xs"},"HSM")," HSM \uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4"},Object.entries(MODEL_WEIGHTS).filter(([_,info])=>info.series==='HSM').map(([model,info])=>{const prodInfo=producibleUnits[model]||{units:0,coverage:'0'};const range={min:1,max:5};const currentStock=inventoryData.filter(i=>i.material===info.code).reduce((sum,i)=>sum+(i.stock||0),0);const status=currentStock>range.max?'over':currentStock>=range.min?'ok':currentStock>=range.min*0.5?'warning':'shortage';const bgColor=status==='over'?'bg-purple-50 border-purple-300':status==='ok'?'bg-emerald-50 border-emerald-300':status==='warning'?'bg-amber-50 border-amber-300':'bg-red-50 border-red-300';const textColor=status==='over'?'text-purple-700':status==='ok'?'text-emerald-700':status==='warning'?'text-amber-700':'text-red-700';const statusLabel=status==='over'?'과다':status==='ok'?'적정':status==='warning'?'주의':'긴급';const statusIcon=status==='over'?'📦':status==='ok'?'✅':status==='warning'?'⚠️':'🚨';return/*#__PURE__*/React.createElement("div",{key:model,className:`rounded-xl p-4 border-2 ${bgColor}`},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-start mb-2"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-gray-800"},model),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},info.code)),/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${status==='over'?'bg-purple-200 text-purple-800':status==='ok'?'bg-emerald-200 text-emerald-800':status==='warning'?'bg-amber-200 text-amber-800':'bg-red-200 text-red-800'}`},statusIcon," ",statusLabel)),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2"},/*#__PURE__*/React.createElement("p",{className:`text-3xl font-bold ${textColor}`},prodInfo.units,/*#__PURE__*/React.createElement("span",{className:"text-lg"},"\uB300"))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Safety Stock: ",range.min,"~",range.max,"\uB300"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-blue-600 mt-0.5"},"\uD604\uC7AC \uC7AC\uACE0: ",currentStock.toLocaleString()," EA"),/*#__PURE__*/React.createElement("div",{className:"mt-2"},/*#__PURE__*/React.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2 relative"},/*#__PURE__*/React.createElement("div",{className:"absolute h-full w-0.5 bg-gray-400",style:{left:`${range.min/range.max*100}%`}}),/*#__PURE__*/React.createElement("div",{className:`h-2 rounded-full ${status==='over'?'bg-purple-500':status==='ok'?'bg-emerald-500':status==='warning'?'bg-amber-500':'bg-red-500'}`,style:{width:`${Math.min(currentStock/range.max*100,100)}%`}}))),prodInfo.bottleneck&&/*#__PURE__*/React.createElement("div",{className:"mt-2 text-xs"},/*#__PURE__*/React.createElement("p",{className:"text-gray-600 truncate"},"\uBCD1\uBAA9: ",prodInfo.bottleneck.material," | ",prodInfo.bottleneck.description?.slice(0,15)||'-'," | \uC7AC\uACE0: ",prodInfo.bottleneck.currentStock," EA",(()=>{const openPO=getOpenPOForMaterial(prodInfo.bottleneck.material);return openPO?/*#__PURE__*/React.createElement("span",{className:"text-green-600 font-medium ml-1"},"| \uD83D\uDCE6 ",openPO.totalQty.toLocaleString()," ",openPO.unit):/*#__PURE__*/React.createElement("span",{className:"text-red-500 ml-1"},"| \u26A0\uFE0F Open PO \uC5C6\uC74C");})())));}),/*#__PURE__*/React.createElement("div",{className:"rounded-xl p-4 border-2 border-dashed border-gray-200 bg-gray-50 flex items-center justify-center"},/*#__PURE__*/React.createElement("span",{className:"text-gray-400 text-sm"},"-")),/*#__PURE__*/React.createElement("div",{className:"rounded-xl p-4 border-2 border-dashed border-gray-200 bg-gray-50 flex items-center justify-center"},/*#__PURE__*/React.createElement("span",{className:"text-gray-400 text-sm"},"-"))))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mt-4"},"\uD83D\uDCA1 \uBCD1\uBAA9 \uC790\uC7AC = \uAC00\uC7A5 \uBA3C\uC800 \uC18C\uC9C4\uB418\uB294 \uC790\uC7AC. \uD574\uB2F9 \uC790\uC7AC \uC7AC\uACE0 \uBD80\uC871 \uC2DC \uC0DD\uC0B0 \uBD88\uAC00.")),subComponentBomData&&Object.keys(subComponentBomData).length>0&&/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold flex items-center gap-2"},/*#__PURE__*/React.createElement(Package,{className:"w-5 h-5 text-teal-600"}),"\uD83D\uDD27 Sub-component \uC0DD\uC0B0 \uAC00\uB2A5 \uB300\uC218"),/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-500 mt-1 sm:mt-0"},Object.keys(subComponentBomData).length,"\uAC1C Sub-com")),(()=>{const SUBCOM_SAFETY={min:10,max:50};// Sub-component Safety Stock 기준
const SUBCOM_SAFETY_KB0770={min:20,max:100};// KB0770은 1대당 2EA 사용
const subComStatus=Object.entries(subComponentUnits).map(([name,info])=>{const currentStock=inventoryData.filter(i=>i.material===name).reduce((sum,i)=>sum+(i.stock||0),0);const range=name==='KB0770'?SUBCOM_SAFETY_KB0770:SUBCOM_SAFETY;let status='ok';if(currentStock>range.max)status='over';else if(currentStock>=range.min)status='ok';else if(currentStock>=range.min*0.5)status='warning';else status='shortage';return{name,currentStock,status};});const overStock=subComStatus.filter(m=>m.status==='over');const okStock=subComStatus.filter(m=>m.status==='ok');const warningStock=subComStatus.filter(m=>m.status==='warning');const shortageStock=subComStatus.filter(m=>m.status==='shortage');return/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-4 gap-3 mb-4"},/*#__PURE__*/React.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 cursor-pointer hover:bg-purple-100 transition",onClick:()=>setShowSubcomDetailModal('excess')},/*#__PURE__*/React.createElement("p",{className:"text-xs text-purple-600 font-medium"},"\uD83D\uDCE6 \uACFC\uB2E4 \uC7AC\uACE0"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-purple-700"},overStock.length,/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal ml-1"},"Sub"))),/*#__PURE__*/React.createElement("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3 cursor-pointer hover:bg-emerald-100 transition",onClick:()=>setShowSubcomDetailModal('normal')},/*#__PURE__*/React.createElement("p",{className:"text-xs text-emerald-600 font-medium"},"\u2705 \uC801\uC815 \uC7AC\uACE0"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-emerald-700"},okStock.length,/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal ml-1"},"Sub"))),/*#__PURE__*/React.createElement("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 cursor-pointer hover:bg-amber-100 transition",onClick:()=>setShowSubcomDetailModal('caution')},/*#__PURE__*/React.createElement("p",{className:"text-xs text-amber-600 font-medium"},"\u26A0\uFE0F \uBD80\uC871 \uC8FC\uC758"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-amber-700"},warningStock.length,/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal ml-1"},"Sub"))),/*#__PURE__*/React.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 cursor-pointer hover:bg-red-100 transition",onClick:()=>setShowSubcomDetailModal('urgent')},/*#__PURE__*/React.createElement("p",{className:"text-xs text-red-600 font-medium"},"\uD83D\uDEA8 \uBD80\uC871 \uAE34\uAE09"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-red-700"},shortageStock.length,/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal ml-1"},"Sub"))));})(),/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap gap-4 mb-4 text-xs"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded-full bg-purple-400"})," \uACFC\uB2E4 (50\uB300 \uCD08\uACFC, KB0770: 100\uB300 \uCD08\uACFC)"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded-full bg-emerald-400"})," \uC801\uC815 (10~50\uB300, KB0770: 20~100\uB300)"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded-full bg-amber-400"})," \uC8FC\uC758 (5~9\uB300)"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded-full bg-red-400"})," \uAE34\uAE09 (5\uB300 \uBBF8\uB9CC)")),(()=>{const subCom48=['KB0770','KB0778','KB0840','KB0768','KB0776','KB0780','KB0835','KB0775','KB0771'];const SUBCOM_SAFETY={min:10,max:50};const filtered16=Object.entries(subComponentUnits).filter(([name])=>!subCom48.includes(name)).sort((a,b)=>a[1].units-b[1].units);if(filtered16.length===0)return null;return/*#__PURE__*/React.createElement("div",{className:"mb-6"},/*#__PURE__*/React.createElement("h4",{className:"text-sm font-semibold text-purple-700 mb-3 flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 bg-purple-100 rounded text-xs"},"16")," Maxwell 16 \uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4"},filtered16.map(([subComName,info])=>{const currentStock=inventoryData.filter(i=>i.material===subComName).reduce((sum,i)=>sum+(i.stock||0),0);const range=SUBCOM_SAFETY;const status=currentStock>range.max?'over':currentStock>=range.min?'ok':currentStock>=range.min*0.5?'warning':'shortage';const bgColor=status==='over'?'bg-purple-50 border-purple-300':status==='ok'?'bg-emerald-50 border-emerald-300':status==='warning'?'bg-amber-50 border-amber-300':'bg-red-50 border-red-300';const textColor=status==='over'?'text-purple-700':status==='ok'?'text-emerald-700':status==='warning'?'text-amber-700':'text-red-700';const statusLabel=status==='over'?'과다':status==='ok'?'적정':status==='warning'?'주의':'긴급';const statusIcon=status==='over'?'📦':status==='ok'?'✅':status==='warning'?'⚠️':'🚨';return/*#__PURE__*/React.createElement("div",{key:subComName,className:`rounded-xl p-4 border-2 ${bgColor}`},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-start mb-2"},/*#__PURE__*/React.createElement("p",{className:"font-bold text-gray-800"},subComName),/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${status==='over'?'bg-purple-200 text-purple-800':status==='ok'?'bg-emerald-200 text-emerald-800':status==='warning'?'bg-amber-200 text-amber-800':'bg-red-200 text-red-800'}`},statusIcon," ",statusLabel)),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2"},/*#__PURE__*/React.createElement("p",{className:`text-3xl font-bold ${textColor}`},info.units,/*#__PURE__*/React.createElement("span",{className:"text-lg"},"\uB300"))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Safety Stock: ",range.min,"~",range.max,"\uB300"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-blue-600 mt-0.5"},"\uD604\uC7AC \uC7AC\uACE0: ",currentStock.toLocaleString()," EA"),/*#__PURE__*/React.createElement("div",{className:"mt-2"},/*#__PURE__*/React.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2 relative"},/*#__PURE__*/React.createElement("div",{className:"absolute h-full w-0.5 bg-gray-400",style:{left:`${range.min/range.max*100}%`}}),/*#__PURE__*/React.createElement("div",{className:`h-2 rounded-full ${status==='over'?'bg-purple-500':status==='ok'?'bg-emerald-500':status==='warning'?'bg-amber-500':'bg-red-500'}`,style:{width:`${Math.min(currentStock/range.max*100,100)}%`}}))),info.bottleneck&&info.units<20&&/*#__PURE__*/React.createElement("p",{className:"mt-2 text-xs text-gray-600 truncate"},"\uBCD1\uBAA9: ",info.bottleneck.material," | \uC7AC\uACE0: ",info.bottleneck.currentStock," EA",(()=>{const openPO=getOpenPOForMaterial(info.bottleneck.material);return openPO?/*#__PURE__*/React.createElement("span",{className:"text-green-600 font-medium ml-1"},"| \uD83D\uDCE6 ",openPO.totalQty.toLocaleString()," ",openPO.unit):/*#__PURE__*/React.createElement("span",{className:"text-red-500 ml-1"},"| \u26A0\uFE0F Open PO \uC5C6\uC74C");})()));})));})(),/*#__PURE__*/React.createElement("div",{className:"my-6 border-t border-gray-200"}),(()=>{const subCom48=['KB0770','KB0778','KB0840','KB0768','KB0776','KB0780','KB0835','KB0775','KB0771'];const SUBCOM_SAFETY={min:10,max:50};const SUBCOM_SAFETY_KB0770={min:20,max:100};// KB0770은 1대당 2EA 사용
const filtered48=Object.entries(subComponentUnits).filter(([name])=>subCom48.includes(name)).sort((a,b)=>a[1].units-b[1].units);if(filtered48.length===0)return null;return/*#__PURE__*/React.createElement("div",{className:"mb-2"},/*#__PURE__*/React.createElement("h4",{className:"text-sm font-semibold text-blue-700 mb-3 flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 bg-blue-100 rounded text-xs"},"48")," Maxwell 48 \uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4"},filtered48.map(([subComName,info])=>{const currentStock=inventoryData.filter(i=>i.material===subComName).reduce((sum,i)=>sum+(i.stock||0),0);const range=subComName==='KB0770'?SUBCOM_SAFETY_KB0770:SUBCOM_SAFETY;const status=currentStock>range.max?'over':currentStock>=range.min?'ok':currentStock>=range.min*0.5?'warning':'shortage';const bgColor=status==='over'?'bg-purple-50 border-purple-300':status==='ok'?'bg-emerald-50 border-emerald-300':status==='warning'?'bg-amber-50 border-amber-300':'bg-red-50 border-red-300';const textColor=status==='over'?'text-purple-700':status==='ok'?'text-emerald-700':status==='warning'?'text-amber-700':'text-red-700';const statusLabel=status==='over'?'과다':status==='ok'?'적정':status==='warning'?'주의':'긴급';const statusIcon=status==='over'?'📦':status==='ok'?'✅':status==='warning'?'⚠️':'🚨';return/*#__PURE__*/React.createElement("div",{key:subComName,className:`rounded-xl p-4 border-2 ${bgColor}`},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-start mb-2"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-bold text-gray-800"},subComName),subComName==='KB0770'&&/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"1\uB300\uB2F9 2EA")),/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${status==='over'?'bg-purple-200 text-purple-800':status==='ok'?'bg-emerald-200 text-emerald-800':status==='warning'?'bg-amber-200 text-amber-800':'bg-red-200 text-red-800'}`},statusIcon," ",statusLabel)),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2"},/*#__PURE__*/React.createElement("p",{className:`text-3xl font-bold ${textColor}`},info.units,/*#__PURE__*/React.createElement("span",{className:"text-lg"},"\uB300"))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Safety Stock: ",range.min,"~",range.max,"\uB300"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-blue-600 mt-0.5"},"\uD604\uC7AC \uC7AC\uACE0: ",currentStock.toLocaleString()," EA"),/*#__PURE__*/React.createElement("div",{className:"mt-2"},/*#__PURE__*/React.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2 relative"},/*#__PURE__*/React.createElement("div",{className:"absolute h-full w-0.5 bg-gray-400",style:{left:`${range.min/range.max*100}%`}}),/*#__PURE__*/React.createElement("div",{className:`h-2 rounded-full ${status==='over'?'bg-purple-500':status==='ok'?'bg-emerald-500':status==='warning'?'bg-amber-500':'bg-red-500'}`,style:{width:`${Math.min(currentStock/range.max*100,100)}%`}}))),info.bottleneck&&info.units<20&&/*#__PURE__*/React.createElement("p",{className:"mt-2 text-xs text-gray-600 truncate"},"\uBCD1\uBAA9: ",info.bottleneck.material," | \uC7AC\uACE0: ",info.bottleneck.currentStock," EA",(()=>{const openPO=getOpenPOForMaterial(info.bottleneck.material);return openPO?/*#__PURE__*/React.createElement("span",{className:"text-green-600 font-medium ml-1"},"| \uD83D\uDCE6 ",openPO.totalQty.toLocaleString()," ",openPO.unit):/*#__PURE__*/React.createElement("span",{className:"text-red-500 ml-1"},"| \u26A0\uFE0F Open PO \uC5C6\uC74C");})()));})));})(),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mt-4"},"\uD83D\uDCA1 Sub-component = \uC644\uC81C\uD488 \uC870\uB9BD\uC5D0 \uD544\uC694\uD55C \uBC18\uC81C\uD488/\uC870\uB9BD\uD488. BOM \uD30C\uC77C\uC758 KB \uC2DC\uD2B8 \uAE30\uC900.")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold mb-4 flex items-center gap-2"},/*#__PURE__*/React.createElement(Package,{className:"w-5 h-5 text-indigo-500"}),"\uD83D\uDCA1 \uBC1C\uC8FC \uC81C\uC548 (BOM \uBCD1\uBAA9 \uC790\uC7AC \uAE30\uC900)"),(()=>{const TARGET_STOCK={'RSC16':{min:10,max:30},'CSC16':{min:10,max:30},'FSC16':{min:5,max:20},'RSC48':{min:10,max:30},'CSC48':{min:10,max:30},'HSM3':{min:3,max:30}};// 부족 모델의 병목 자재 수집
const shortageItems=[];const overItems=[];Object.entries(TARGET_STOCK).forEach(([model,range])=>{const current=producibleUnits[model]?.units||0;const bottleneck=producibleUnits[model]?.bottleneck;if(current<range.min&&bottleneck){// 부족: 발주 필요
const needQty=(range.min-current)*(bottleneck.requiredQty||1);shortageItems.push({model,material:bottleneck.material,description:bottleneck.description,currentStock:bottleneck.currentStock,needQty,shortage:range.min-current,min:range.min,type:'shortage'});}else if(current>range.max&&bottleneck){// 과다: 발주 연기
overItems.push({model,material:bottleneck.material,description:bottleneck.description,currentStock:bottleneck.currentStock,excess:current-range.max,max:range.max,type:'over'});}});return/*#__PURE__*/React.createElement("div",{className:"space-y-4"},shortageItems.length>0&&/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h4",{className:"text-sm font-medium text-red-700 mb-2"},"\uD83D\uDEA8 \uBC1C\uC8FC \uD544\uC694 (\uBD80\uC871 \uC790\uC7AC)"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-red-50"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uBAA8\uB378"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uBCD1\uBAA9 \uC790\uC7AC"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Description"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-right"},"\uD604\uC7AC \uC7AC\uACE0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-right"},"\uBD80\uC871 \uB300\uC218"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uC81C\uC548"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Open PO"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},shortageItems.map((item,idx)=>{const openPO=getOpenPOForMaterial(item.material);return/*#__PURE__*/React.createElement("tr",{key:idx,className:"hover:bg-red-50/50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-medium"},item.model),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},item.material),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-gray-600 truncate max-w-xs"},item.description?.slice(0,25)||'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-right"},item.currentStock?.toLocaleString()," EA"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-right font-bold text-red-600"},"-",item.shortage,"\uB300"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},openPO?/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded"},"\uD83D\uDCE6 \uBC1C\uC8FC \uC9C4\uD589 \uC911"):/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded"},"\uD83D\uDED2 \uBC1C\uC8FC \uD544\uC694")),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},openPO?/*#__PURE__*/React.createElement("span",{className:"text-amber-600 font-medium"},"\uD83D\uDCE6 ",openPO.totalQty.toLocaleString()," ",openPO.unit):/*#__PURE__*/React.createElement("span",{className:"text-gray-400"},"-")));}))))),overItems.length>0&&/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h4",{className:"text-sm font-medium text-purple-700 mb-2"},"\uD83D\uDCE6 \uBC1C\uC8FC \uC5F0\uAE30 \uAC80\uD1A0 (\uACFC\uB2E4 \uC7AC\uACE0)"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-purple-50"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uBAA8\uB378"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uBCD1\uBAA9 \uC790\uC7AC"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Description"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-right"},"\uD604\uC7AC \uC7AC\uACE0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-right"},"\uCD08\uACFC \uB300\uC218"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uC81C\uC548"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},overItems.map((item,idx)=>/*#__PURE__*/React.createElement("tr",{key:idx,className:"hover:bg-purple-50/50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-medium"},item.model),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},item.material),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-gray-600 truncate max-w-xs"},item.description?.slice(0,25)||'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-right"},item.currentStock?.toLocaleString()," EA"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-right font-bold text-purple-600"},"+",item.excess,"\uB300"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded"},"\uD83D\uDCC5 \uBC1C\uC8FC \uC5F0\uAE30")))))))),shortageItems.length===0&&overItems.length===0&&/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-500 py-4"},"\u2705 \uBAA8\uB4E0 \uBAA8\uB378\uC774 \uC801\uC815 \uC7AC\uACE0 \uBC94\uC704 \uB0B4\uC785\uB2C8\uB2E4."));})()),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold mb-4 flex items-center gap-2"},/*#__PURE__*/React.createElement(AlertTriangle,{className:"w-5 h-5 text-red-500"}),"\uD83D\uDEA8 \uBD80\uC871/\uC800\uC7AC\uACE0 \uC790\uC7AC \uD604\uD669 (Open PO \uB9E4\uCE6D)",customBomData&&/*#__PURE__*/React.createElement("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full ml-2"},"\uC0AC\uC6A9\uC790 BOM")),(()=>{// 모든 모델의 BOM을 검사하여 부족 자재 수집
const allShortages=[];const stockByMaterial={};const descByMaterial={};inventoryData.forEach(item=>{stockByMaterial[item.material]=(stockByMaterial[item.material]||0)+item.stock;descByMaterial[item.material]=item.description||'';});// 모델별 BOM 검사 (사용자 BOM 또는 기본 BOM)
const bomToUse=customBomData||MODEL_BOM_DATA;Object.entries(bomToUse).forEach(([model,bom])=>{Object.entries(bom).forEach(([material,requiredQty])=>{const currentStock=stockByMaterial[material]||0;const possibleUnits=Math.floor(currentStock/requiredQty);// 모델별 부족 기준: HSM3=3대, 나머지=10대
const threshold=model==='HSM3'||model==='HSM3.0'?3:10;if(possibleUnits<threshold&&requiredQty>0){const openPO=openPOData.find(po=>po.material===material);const existingIdx=allShortages.findIndex(s=>s.material===material);if(existingIdx===-1){allShortages.push({material,description:descByMaterial[material]||openPO?.description||'-',currentStock,requiredQty,possibleUnits,models:[model],openPO:openPO?{qty:openPO.totalQty,unit:openPO.unit,poNumbers:openPO.poNumbers}:null,urgency:possibleUnits===0?'critical':possibleUnits<Math.ceil(threshold/2)?'high':'medium'});}else{if(!allShortages[existingIdx].models.includes(model)){allShortages[existingIdx].models.push(model);}}}});});// 긴급도 순으로 정렬
allShortages.sort((a,b)=>{const urgencyOrder={critical:0,high:1,medium:2};return urgencyOrder[a.urgency]-urgencyOrder[b.urgency]||a.possibleUnits-b.possibleUnits;});const criticalCount=allShortages.filter(s=>s.urgency==='critical').length;const highCount=allShortages.filter(s=>s.urgency==='high').length;const withPOCount=allShortages.filter(s=>s.openPO).length;const noPOCount=allShortages.filter(s=>!s.openPO).length;return/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-4 gap-3"},/*#__PURE__*/React.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-center cursor-pointer hover:shadow-md transition",onClick:()=>setShowShortageDetailModal('critical')},/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-red-600"},criticalCount),/*#__PURE__*/React.createElement("p",{className:"text-xs text-red-600"},"\uC0DD\uC0B0\uBD88\uAC00 (0\uB300)")),/*#__PURE__*/React.createElement("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 text-center cursor-pointer hover:shadow-md transition",onClick:()=>setShowShortageDetailModal('high')},/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-amber-600"},highCount),/*#__PURE__*/React.createElement("p",{className:"text-xs text-amber-600"},"\uAE34\uAE09 (1~4\uB300)")),/*#__PURE__*/React.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-center cursor-pointer hover:shadow-md transition",onClick:()=>setShowShortageDetailModal('withPO')},/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-green-600"},withPOCount),/*#__PURE__*/React.createElement("p",{className:"text-xs text-green-600"},"\uBC1C\uC8FC \uC9C4\uD589\uC911")),/*#__PURE__*/React.createElement("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 text-center cursor-pointer hover:shadow-md transition",onClick:()=>setShowShortageDetailModal('noPO')},/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-gray-600"},noPOCount),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-600"},"\uBC1C\uC8FC \uD544\uC694"))),allShortages.length>0?/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto max-h-80"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-gray-50 sticky top-0"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uAE34\uAE09\uB3C4"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Material"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Description"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-right"},"\uD604\uC7AC\uC7AC\uACE0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uC0DD\uC0B0\uAC00\uB2A5"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uD574\uB2F9\uBAA8\uB378"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"Open PO"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},allShortages.slice(0,20).map((item,idx)=>/*#__PURE__*/React.createElement("tr",{key:idx,className:`hover:bg-gray-50 ${item.urgency==='critical'?'bg-red-50/50':item.urgency==='high'?'bg-amber-50/50':''}`},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-xs font-medium ${item.urgency==='critical'?'bg-red-100 text-red-700':item.urgency==='high'?'bg-amber-100 text-amber-700':'bg-yellow-100 text-yellow-700'}`},item.urgency==='critical'?'🔴 긴급':item.urgency==='high'?'🟠 주의':'🟡 관찰')),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-mono text-xs"},item.material),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-gray-600 truncate max-w-xs",title:item.description},item.description?.slice(0,30)||'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-right font-medium"},item.currentStock.toLocaleString()),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},/*#__PURE__*/React.createElement("span",{className:`font-bold ${item.possibleUnits===0?'text-red-600':item.possibleUnits<5?'text-amber-600':'text-yellow-600'}`},item.possibleUnits,"\uB300")),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap gap-1"},item.models.slice(0,3).map((m,i)=>/*#__PURE__*/React.createElement("span",{key:i,className:"px-1.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs rounded"},m)),item.models.length>3&&/*#__PURE__*/React.createElement("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded"},"+",item.models.length-3))),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},item.openPO?/*#__PURE__*/React.createElement("div",{className:"flex flex-col items-center"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded font-medium"},"\u2705 ",item.openPO.qty.toLocaleString()," ",item.openPO.unit),item.openPO.poNumbers?.length>0&&/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400 mt-0.5"},"PO: ",item.openPO.poNumbers[0])):/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-red-100 text-red-600 text-xs rounded font-medium"},"\u274C \uBC1C\uC8FC \uD544\uC694")))))),allShortages.length>20&&/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-400 text-sm py-2"},"... \uC678 ",allShortages.length-20,"\uAC1C \uC790\uC7AC")):/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-500 py-4"},"\u2705 \uBAA8\uB4E0 \uC790\uC7AC\uAC00 \uCDA9\uBD84\uD569\uB2C8\uB2E4. (\uAE30\uC900: 10\uB300, HSM3: 3\uB300 \uC774\uC0C1)"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"\uD83D\uDCA1 \uAE30\uC900: 10\uB300 \uBBF8\uB9CC \uC0DD\uC0B0 \uAC00\uB2A5\uD55C \uC790\uC7AC\uB97C \uBD80\uC871 \uC790\uC7AC\uB85C \uBD84\uB958\uD569\uB2C8\uB2E4 (HSM3: 3\uB300 \uBBF8\uB9CC). Open PO \uB370\uC774\uD130\uB294 \uB9C8\uC9C0\uB9C9 \uC5C5\uB85C\uB4DC \uAE30\uC900\uC785\uB2C8\uB2E4."));})()),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold mb-4"},"\uD83D\uDCCD Area\uBCC4 \uD604\uD669"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 md:grid-cols-7 gap-3"},['A','B','C','D','E','F','S'].map(zone=>{const zoneRacks=rackSummary.filter(r=>r.zone===zone);const zoneStock=zoneRacks.reduce((s,r)=>s+r.stock,0);const zoneItems=zoneRacks.reduce((s,r)=>s+r.items,0);if(zoneRacks.length===0)return null;return/*#__PURE__*/React.createElement("div",{key:zone,className:"bg-slate-50 rounded-lg p-3 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-xl font-bold text-indigo-600"},zone," Area"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},zoneRacks.length,"\uAC1C \uB799"),/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium"},zoneItems,"\uAC1C \uD488\uBAA9"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},zoneStock.toLocaleString()," EA"));})))),activeTab==='locate'&&/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-700 rounded-xl p-6 text-white"},/*#__PURE__*/React.createElement("h2",{className:"text-xl font-bold mb-1"},"\uD83D\uDCCD \uC790\uC7AC \uC704\uCE58 \uAC80\uC0C9"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-indigo-200 mb-4"},"Material \uBC88\uD638\uB97C \uC785\uB825\uD558\uBA74 \uCC3D\uACE0 \uB0B4 \uBCF4\uAD00 \uC704\uCE58\uB97C \uC548\uB0B4\uD569\uB2C8\uB2E4."),/*#__PURE__*/React.createElement("div",{className:"flex gap-2 relative"},/*#__PURE__*/React.createElement("div",{className:"flex-1 relative"},/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"Material \uBC88\uD638 \uC785\uB825 (\uC608: 710335, KB0781)",className:"w-full px-4 py-3 rounded-lg text-gray-900 text-lg font-medium",value:locateSearch||'',onChange:e=>{setLocateSearch(e.target.value);if(locateQuery)setLocateQuery('');},onKeyDown:e=>{if(e.key==='Enter'){setLocateQuery(locateSearch);}}}),locateSearch&&locateSearch.length>=2&&!locateQuery&&inventoryData.length>0&&(()=>{const q=locateSearch.trim().toUpperCase();const suggestions=inventoryData.filter(item=>(item.material||'').toUpperCase().includes(q)||(item.description||'').toUpperCase().includes(q)).reduce((acc,item)=>{if(!acc.find(a=>a.material===item.material))acc.push(item);return acc;},[]).slice(0,8);if(suggestions.length===0)return null;return/*#__PURE__*/React.createElement("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-lg shadow-xl border border-gray-200 max-h-64 overflow-y-auto z-50"},suggestions.map((s,i)=>/*#__PURE__*/React.createElement("button",{key:i,className:"w-full px-4 py-2.5 text-left hover:bg-indigo-50 flex items-center gap-3 border-b border-gray-100 last:border-0",onClick:()=>{setLocateSearch(s.material);setLocateQuery(s.material);}},/*#__PURE__*/React.createElement("span",{className:"font-mono font-bold text-gray-900 shrink-0"},s.material),/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500 truncate"},s.description),/*#__PURE__*/React.createElement("span",{className:"text-xs text-indigo-500 shrink-0 ml-auto"},s.bin))));})()),/*#__PURE__*/React.createElement("button",{onClick:()=>setLocateQuery(locateSearch),className:"px-6 py-3 bg-amber-500 hover:bg-amber-600 rounded-lg font-bold text-lg transition shrink-0"},"\uD83D\uDD0D \uAC80\uC0C9"))),locateQuery&&(()=>{const q=locateQuery.trim().toUpperCase();// inventoryData에서 Part No. 매칭
const matches=inventoryData.filter(item=>(item.material||'').toUpperCase().includes(q)||(item.description||'').toUpperCase().includes(q));if(matches.length===0){return/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-8 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-4xl mb-3"},"\uD83D\uDD0D"),/*#__PURE__*/React.createElement("p",{className:"text-lg font-medium text-gray-700"},"\"",locateQuery,"\" \uAC80\uC0C9 \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500 mt-2"},"SAP \uC7AC\uACE0 \uB370\uC774\uD130\uC5D0 \uB4F1\uB85D\uB41C Material \uBC88\uD638\uC778\uC9C0 \uD655\uC778\uD574\uC8FC\uC138\uC694."));}// Bin별 그룹핑
const binGroups={};matches.forEach(item=>{const bin=item.bin||'Unknown';if(!binGroups[bin])binGroups[bin]=[];binGroups[bin].push(item);});// 각 Bin의 위치 정보 매핑
const locationResults=Object.entries(binGroups).map(([bin,items])=>{const area=bin.split('-')[0]||bin;const series=RACK_MODEL_SERIES[area]||'기타';const binInfo=BIN_RACK_INFO[bin]||{rackType:'경량랙',rackCount:1};// BIN_LEVEL_MAP에서 실제 단수/위치 조회
const blm=BIN_LEVEL_MAP[bin]||{l:binInfo.shelves||3,p:1};const levels=blm.l;const rackLevel=blm.p;const totalStock=items.reduce((s,i)=>s+(i.stock||0),0);const totalWeight=items.reduce((s,i)=>s+(weightData[i.material]?.w||0)*(i.stock||0),0);return{bin,area,series,binInfo,levels,rackLevel,items,totalStock,totalWeight};});const seriesColor={'Maxwell 48':{bg:'bg-red-50',border:'border-red-400',text:'text-red-700',badge:'bg-red-500'},'Maxwell 16':{bg:'bg-blue-50',border:'border-blue-400',text:'text-blue-700',badge:'bg-blue-500'},'HSM 3.0':{bg:'bg-orange-50',border:'border-orange-400',text:'text-orange-700',badge:'bg-orange-500'},'기타':{bg:'bg-gray-50',border:'border-gray-400',text:'text-gray-700',badge:'bg-gray-500'}};return/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-4 flex-wrap"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},"\uAC80\uC0C9: ",/*#__PURE__*/React.createElement("strong",{className:"text-gray-800"},locateQuery)),/*#__PURE__*/React.createElement("span",{className:"text-sm px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full font-medium"},matches.length,"\uAC1C \uD488\uBAA9"),/*#__PURE__*/React.createElement("span",{className:"text-sm px-3 py-1 bg-purple-100 text-purple-700 rounded-full font-medium"},Object.keys(binGroups).length,"\uAC1C Bin"),/*#__PURE__*/React.createElement("span",{className:"text-sm px-3 py-1 bg-amber-100 text-amber-700 rounded-full font-medium"},"\uCD1D ",matches.reduce((s,i)=>s+(i.stock||0),0).toLocaleString()," EA"))),locationResults.sort((a,b)=>a.bin.localeCompare(b.bin)).map((loc,idx)=>{const sc=seriesColor[loc.series]||seriesColor['기타'];return/*#__PURE__*/React.createElement("div",{key:idx,className:`${sc.bg} rounded-lg shadow-sm border ${sc.border} overflow-hidden`},/*#__PURE__*/React.createElement("div",{className:"px-4 py-2.5 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:`px-2.5 py-1 ${sc.badge} text-white text-xs font-bold rounded`},loc.series),/*#__PURE__*/React.createElement("h3",{className:"text-base font-bold text-gray-900"},"\uD83D\uDCCD ",loc.bin),/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},loc.binInfo.rackType," \xB7 ",loc.levels,"\uB2E8")),/*#__PURE__*/React.createElement("div",{className:"text-right text-sm"},/*#__PURE__*/React.createElement("span",{className:"font-bold text-gray-700"},loc.items.length,"\uAC1C \uD488\uBAA9 \xB7 "),/*#__PURE__*/React.createElement("span",{className:"font-medium text-indigo-600"},loc.totalStock.toLocaleString()," EA"))),/*#__PURE__*/React.createElement("div",{className:"px-4 py-3 bg-white/60"},/*#__PURE__*/React.createElement("div",{className:"flex gap-3 items-start"},(()=>{const lvls=loc.levels;const shelfH=48,pad=8,pillarW=8;const svgW=160,svgH=lvls*shelfH+pad*2+10;return/*#__PURE__*/React.createElement("svg",{width:svgW,height:svgH,className:"shrink-0"},/*#__PURE__*/React.createElement("rect",{x:0,y:0,width:svgW,height:svgH,rx:5,fill:"#f8fafc",stroke:"#e2e8f0",strokeWidth:1}),/*#__PURE__*/React.createElement("rect",{x:4,y:svgH-7,width:svgW-8,height:6,rx:2,fill:"#64748b"}),/*#__PURE__*/React.createElement("rect",{x:4,y:pad-2,width:pillarW,height:svgH-pad-5,rx:2,fill:"#64748b"}),/*#__PURE__*/React.createElement("rect",{x:svgW-pillarW-4,y:pad-2,width:pillarW,height:svgH-pad-5,rx:2,fill:"#64748b"}),/*#__PURE__*/React.createElement("rect",{x:6,y:pad-2,width:2.5,height:svgH-pad-5,fill:"#94a3b8",opacity:0.4}),/*#__PURE__*/React.createElement("rect",{x:svgW-pillarW-2,y:pad-2,width:2.5,height:svgH-pad-5,fill:"#94a3b8",opacity:0.4}),Array.from({length:lvls},(_,i)=>{const levelNum=i+1;const isHere=levelNum===loc.rackLevel;const y=pad+i*shelfH;const shelfY=y+shelfH-6;const cx=pillarW+7,cw=svgW-pillarW*2-14;return/*#__PURE__*/React.createElement("g",{key:i},isHere&&/*#__PURE__*/React.createElement("rect",{x:cx-1,y:y+2,width:cw+2,height:shelfH-5,rx:3,fill:"#fef3c7",stroke:"#f59e0b",strokeWidth:1.5}),/*#__PURE__*/React.createElement("text",{x:cx+3,y:y+shelfH/2+1,fill:isHere?'#92400e':'#94a3b8',fontSize:isHere?13:11,fontWeight:isHere?'bold':'normal',dominantBaseline:"middle"},levelNum,"\uB2E8"),isHere?loc.items.slice(0,3).map((_,bi)=>{const bw=26,bh=shelfH-16,bx=cx+cw-(3-bi)*(bw+3),by=y+6;return/*#__PURE__*/React.createElement("g",{key:bi},/*#__PURE__*/React.createElement("rect",{x:bx,y:by,width:bw,height:bh,rx:2.5,fill:"#fbbf24",stroke:"#d97706",strokeWidth:0.8}),/*#__PURE__*/React.createElement("path",{d:`M${bx+2},${by} Q${bx+bw/2},${by+5} ${bx+bw-2},${by}`,fill:"#f59e0b",stroke:"#d97706",strokeWidth:0.4}),/*#__PURE__*/React.createElement("rect",{x:bx+bw/2-2.5,y:by+4,width:5,height:bh-7,rx:0.5,fill:"#3b82f6",opacity:0.4}));}):/*#__PURE__*/React.createElement("line",{x1:cx+28,y1:y+shelfH/2,x2:cx+cw-4,y2:y+shelfH/2,stroke:"#e2e8f0",strokeWidth:1,strokeDasharray:"4,3"}),/*#__PURE__*/React.createElement("rect",{x:4,y:shelfY,width:svgW-8,height:6,rx:1,fill:isHere?'#b45309':'#94a3b8'}),/*#__PURE__*/React.createElement("rect",{x:5,y:shelfY,width:svgW-10,height:2,rx:0.5,fill:isHere?'#fbbf24':'#b0bec5',opacity:0.5}));}));})(),/*#__PURE__*/React.createElement("div",{className:"min-w-0",style:{flex:'0 1 auto'}},Array.from({length:loc.levels},(_,i)=>{const levelNum=i+1;const isHere=levelNum===loc.rackLevel;return/*#__PURE__*/React.createElement("div",{key:i,className:"flex items-center",style:{height:48}},isHere?/*#__PURE__*/React.createElement("div",{className:"space-y-0.5"},loc.items.slice(0,3).map((item,j)=>/*#__PURE__*/React.createElement("div",{key:j,className:"flex items-center px-2.5 py-1 bg-amber-50 rounded border border-amber-200 gap-2 whitespace-nowrap"},/*#__PURE__*/React.createElement("span",{className:"font-mono font-bold text-gray-900 text-sm shrink-0"},item.material),/*#__PURE__*/React.createElement("span",{className:"text-gray-600 text-sm"},item.description),/*#__PURE__*/React.createElement("span",{className:"font-bold text-indigo-600 text-sm shrink-0"},(item.stock||0).toLocaleString()," EA"))),loc.items.length>3&&/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400 px-1"},"\uC678 ",loc.items.length-3,"\uAC1C")):null);})),/*#__PURE__*/React.createElement("div",{className:"shrink-0 flex flex-col items-center gap-1.5 ml-auto"},/*#__PURE__*/React.createElement(LocateMiniMap,{layoutData:layoutData,targetArea:loc.area}),/*#__PURE__*/React.createElement("button",{onClick:()=>{setActiveTab('layout');},className:"text-xs px-3 py-1 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition"},"\uD83D\uDDFA\uFE0F \uBC30\uCE58\uB3C4\uC5D0\uC11C \uBCF4\uAE30 \xB7 ",loc.area)))));}),matches.length>3&&/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"px-4 py-2 bg-gray-100 border-b"},/*#__PURE__*/React.createElement("h4",{className:"text-sm font-bold text-gray-700"},"\uD83D\uDCCB \uC804\uCCB4 \uAC80\uC0C9 \uACB0\uACFC (",matches.length,"\uAC74)")),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto",style:{maxHeight:'400px',overflowY:'auto'}},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-gray-50 sticky top-0"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Material"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Description"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"Bin"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uC601\uC5ED"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-right"},"\uC7AC\uACE0"))),/*#__PURE__*/React.createElement("tbody",null,matches.map((item,i)=>{const area=(item.bin||'').split('-')[0];const series=RACK_MODEL_SERIES[area]||'기타';return/*#__PURE__*/React.createElement("tr",{key:i,className:"border-b hover:bg-indigo-50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-mono font-bold"},item.material),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-gray-600 truncate max-w-xs"},item.description),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center font-medium"},item.bin),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},area),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs text-white ${series==='Maxwell 48'?'bg-red-500':series==='Maxwell 16'?'bg-blue-500':series==='HSM 3.0'?'bg-orange-500':'bg-gray-500'}`},series)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-right font-medium"},(item.stock||0).toLocaleString()));}))))));})(),!locateQuery&&/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-8 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-5xl mb-4"},"\uD83D\uDCE6"),/*#__PURE__*/React.createElement("p",{className:"text-lg font-medium text-gray-700"},"Material \uBC88\uD638\uB97C \uC785\uB825\uD558\uC5EC \uC790\uC7AC \uC704\uCE58\uB97C \uAC80\uC0C9\uD558\uC138\uC694"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500 mt-2"},"Material \uBC88\uD638 \uB610\uB294 Description\uC73C\uB85C \uAC80\uC0C9\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."),/*#__PURE__*/React.createElement("div",{className:"mt-6 flex flex-wrap justify-center gap-2"},['710335','712626','KB0781','Motor','Heater'].map(ex=>/*#__PURE__*/React.createElement("button",{key:ex,onClick:()=>{setLocateSearch(ex);setLocateQuery(ex);},className:"px-3 py-1.5 bg-gray-100 hover:bg-indigo-100 text-sm text-gray-600 rounded-lg transition"},ex))))),activeTab==='layout'&&/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"px-4 py-2 bg-gradient-to-r from-slate-700 to-slate-800 text-white flex justify-between items-center"},/*#__PURE__*/React.createElement("h3",{className:"text-lg font-bold flex items-center gap-2"},"\uD83C\uDFED \uCC3D\uACE0 \uB799 \uBC30\uCE58\uB3C4 \uC5D0\uB514\uD130"),/*#__PURE__*/React.createElement("span",{className:"text-xs bg-white/20 px-2 py-1 rounded"},"\uADF8\uB9AC\uB4DC 1\uCE78 = 0.5m (50cm) | \uC0DD\uC0B0\uCC3D\uACE0 117.91\uD3C9 \xB7 \uC0DD\uC0B0\uB77C\uC778+\uCC3D\uACE0 195.01\uD3C9")),/*#__PURE__*/React.createElement("div",{className:"px-3 py-1 bg-gray-50 border-b text-xs text-gray-500"},/*#__PURE__*/React.createElement("span",null,"\uD83D\uDCA1 ",/*#__PURE__*/React.createElement("b",null,"\uC774\uB3D9(V)"),": \uD654\uBA74 \uC2A4\uD06C\uB864 \xB7 ",/*#__PURE__*/React.createElement("b",null,"\uC120\uD0DD(S)"),": \uB799 \uC120\uD0DD/\uC774\uB3D9 \xB7 ",/*#__PURE__*/React.createElement("b",null,"\uCE21\uC815(M)"),": \uAC70\uB9AC \uCE21\uC815 \xB7 ",/*#__PURE__*/React.createElement("b",null,"\uD14D\uC2A4\uD2B8(T)"),": \uB77C\uBCA8 \uCD94\uAC00")),/*#__PURE__*/React.createElement("iframe",{ref:layoutIframeRef,srcDoc:LAYOUT_EDITOR_HTML,style:{width:'100%',height:'calc(100vh - 120px)',border:'none',minHeight:'1200px'},title:"PBK \uCC3D\uACE0 \uB799 \uBC30\uCE58\uB3C4",sandbox:"allow-scripts allow-same-origin allow-modals allow-popups allow-forms"}))),activeTab==='view3d'&&/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",{className:"bg-slate-900 rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"px-4 py-2 bg-gradient-to-r from-indigo-700 to-purple-800 text-white flex justify-between items-center"},/*#__PURE__*/React.createElement("h3",{className:"text-lg font-bold flex items-center gap-2"},"\uD83C\uDFD7\uFE0F 3D \uCC3D\uACE0 \uBDF0"),/*#__PURE__*/React.createElement("div",{className:"flex gap-1"},[{id:'iso',label:'기본'},{id:'top',label:'위에서'},{id:'front',label:'정면'},{id:'entrance',label:'입구'},{id:'side',label:'측면'}].map(p=>/*#__PURE__*/React.createElement("button",{key:p.id,onClick:()=>view3dCtrlRef.current&&view3dCtrlRef.current.setCamPreset(p.id),className:"px-2 py-1 text-xs bg-white/10 hover:bg-white/25 rounded transition"},p.label)))),/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap items-center gap-2 px-3 py-2 bg-slate-800 text-xs text-gray-300"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded",style:{background:'#dc2626'}}),"RSC48"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded",style:{background:'#2563eb'}}),"RSC16"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded",style:{background:'#d97706'}}),"HSM"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded",style:{background:'#eab308'}}),"Semi"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded",style:{background:'#06b6d4'}}),"E3/D2"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded",style:{background:'#22c55e'}}),"\uAD6C\uC5ED"),/*#__PURE__*/React.createElement("span",{className:"border-l border-slate-600 pl-2 ml-1"}),/*#__PURE__*/React.createElement("button",{onClick:()=>{if(view3dCtrlRef.current){var v=view3dCtrlRef.current.toggleWalk();document.getElementById('btn3dWalk').classList.toggle('bg-yellow-700',v);setWalkHudVisible(v);}},id:"btn3dWalk",className:"px-2 py-1 bg-slate-700 hover:bg-yellow-700 rounded transition font-bold"},"\uD83D\uDE9C \uC6CC\uD06C\uC2A4\uB8E8"),/*#__PURE__*/React.createElement("button",{onClick:()=>{if(view3dCtrlRef.current)view3dCtrlRef.current.captureScreenshot();},className:"px-2 py-1 bg-slate-700 hover:bg-sky-700 rounded transition"},"\uD83D\uDCF7 \uCEA1\uCC98"),/*#__PURE__*/React.createElement("span",{className:"ml-auto text-gray-500"},walkHudVisible?'WASD 이동 · Q/E 회전 · 마우스 시점 · ESC 종료':'WASD/↑↓←→ 이동 · 드래그 회전 · 스크롤 줌')),!layoutData?/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-center h-96 text-gray-400"},/*#__PURE__*/React.createElement("p",null,"\uBC30\uCE58\uB3C4 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. \uBA3C\uC800 \uB799 \uBC30\uCE58\uB3C4 \uD0ED\uC5D0\uC11C \uBC30\uCE58\uB3C4\uB97C \uC800\uC7A5\uD574\uC8FC\uC138\uC694.")):/*#__PURE__*/React.createElement("div",{className:"relative"},/*#__PURE__*/React.createElement("canvas",{ref:view3dCanvasRef,style:{width:'100%',height:'calc(100vh - 160px)',minHeight:'600px',display:'block'}}),walkHudVisible&&/*#__PURE__*/React.createElement(WalkHud,{walkRef:view3dWalkRef,ctrlRef:view3dCtrlRef,onClose:()=>{if(view3dCtrlRef.current&&view3dWalkRef.current&&view3dWalkRef.current.active){view3dCtrlRef.current.toggleWalk();var btn=document.getElementById('btn3dWalk');if(btn)btn.classList.remove('bg-yellow-700');}setWalkHudVisible(false);}})))),activeTab==='analysis'&&inventoryData.length>0&&/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-indigo-500"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},"\uCD1D \uD488\uBAA9"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold"},totals.items.toLocaleString(),"\uAC1C")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-emerald-500"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},"\uCD1D \uC7AC\uACE0"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold"},totals.stock.toLocaleString()," EA")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-amber-500"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},"\uCD1D \uBB34\uAC8C"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold"},totals.weight.toLocaleString(undefined,{maximumFractionDigits:1})," kg"))),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4 flex flex-wrap gap-4 items-center"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement(Filter,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("select",{value:selectedZone,onChange:e=>setSelectedZone(e.target.value),className:"border rounded-lg px-3 py-2 text-sm"},/*#__PURE__*/React.createElement("option",{value:"all"},"\uC804\uCCB4 \uBAA8\uB378"),/*#__PURE__*/React.createElement("option",{value:"Maxwell 16"},"Maxwell 16 (RSC16/CSC16/FSC16)"),/*#__PURE__*/React.createElement("option",{value:"Maxwell 48"},"Maxwell 48 (RSC48/CSC48)"),/*#__PURE__*/React.createElement("option",{value:"HSM 3.0"},"HSM 3.0"),/*#__PURE__*/React.createElement("option",{value:"Others"},"\uAE30\uD0C0"))),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 flex-1"},/*#__PURE__*/React.createElement(Search,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"\uB799 \uAC80\uC0C9...",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:"border rounded-lg px-3 py-2 text-sm w-full max-w-xs"})),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-4 text-xs"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded bg-blue-500"})," Maxwell 16"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded bg-emerald-500"})," Maxwell 48"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded bg-orange-500"})," HSM 3.0"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded bg-gray-400"})," \uAE30\uD0C0")),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowSpaceOptimizationModal(true),className:"flex items-center gap-1 px-3 py-1.5 bg-amber-500 text-white rounded-lg hover:bg-amber-600 text-sm"},/*#__PURE__*/React.createElement(Lightbulb,{className:"w-4 h-4"})," \uCD5C\uC801\uD654 \uB9AC\uD3EC\uD2B8"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowHistoryModal(true),className:"flex items-center gap-1 px-3 py-1.5 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 text-sm"},/*#__PURE__*/React.createElement(History,{className:"w-4 h-4"})," \uD788\uC2A4\uD1A0\uB9AC"),/*#__PURE__*/React.createElement("button",{onClick:exportRackSummary,className:"flex items-center gap-1 px-3 py-1.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"})," \uC5D1\uC140")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"px-5 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white flex justify-between items-center"},/*#__PURE__*/React.createElement("h3",{className:"text-lg font-bold"},"\uD83D\uDCE6 \uB799 \uC0C1\uC138 \uD604\uD669"),/*#__PURE__*/React.createElement("span",{className:"text-xs bg-white/20 px-2 py-1 rounded"},"\uD83D\uDCA1 \uB799\uC744 \uD074\uB9AD\uD558\uBA74 Bin\uBCC4 \uC0C1\uC138 \uD604\uD669\uC744 \uBCFC \uC218 \uC788\uC5B4\uC694")),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-50"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-left"},"\uB799 ID"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uBAA8\uB378 \uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uD488\uBAA9 \uC218"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uC7AC\uACE0 \uC218\uB7C9"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uACF5\uAC04 \uC0AC\uC6A9\uB960 (\uBC15\uC2A4/Bin)"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uBB34\uAC8C (\uD604\uC7AC/\uCD5C\uB300)"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uBB34\uAC8C \uD65C\uC6A9\uB960"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},(()=>{const seriesOrder={'Maxwell 48':0,'Maxwell 16':1,'HSM 3.0':2,'Others':3};const seriesNames={'Maxwell 48':'Maxwell 48 (A1, A2, B1, B3, C3)','Maxwell 16':'Maxwell 16 (A5, A6, A7, B2, C1)','HSM 3.0':'HSM 3.0 (A3, B4, C2)','Others':'기타 (D2, E, E3, S1, F1)'};const seriesColors={'Maxwell 48':'emerald','Maxwell 16':'blue','HSM 3.0':'orange','Others':'gray'};const sorted=rackSummary.filter(r=>{if(selectedZone==='all')return true;const series=RACK_MODEL_SERIES[r.id];if(selectedZone==='Others')return!series;return series===selectedZone;}).filter(r=>!searchTerm||r.id.toLowerCase().includes(searchTerm.toLowerCase())).sort((a,b)=>{const aS=RACK_MODEL_SERIES[a.id]||'Others';const bS=RACK_MODEL_SERIES[b.id]||'Others';const aO=seriesOrder[aS]??3;const bO=seriesOrder[bS]??3;if(aO!==bO)return aO-bO;return a.id.localeCompare(b.id);});let lastSeries=null;const rows=[];sorted.forEach(r=>{const series=RACK_MODEL_SERIES[r.id]||'Others';// 시리즈 구분 헤더
if(series!==lastSeries){const sc=seriesColors[series]||'gray';// 첫 번째가 아니면 빈 행으로 간격 추가
if(lastSeries!==null){rows.push(/*#__PURE__*/React.createElement("tr",{key:`spacer-${series}`},/*#__PURE__*/React.createElement("td",{colSpan:"7",className:"py-3"})));}rows.push(/*#__PURE__*/React.createElement("tr",{key:`header-${series}`,className:`bg-${sc}-50`},/*#__PURE__*/React.createElement("td",{colSpan:"7",className:`px-4 py-3 font-bold text-${sc}-700 text-lg border-b-2 border-${sc}-200`},series==='Maxwell 48'?'🟢':series==='Maxwell 16'?'🔵':series==='HSM 3.0'?'🟠':'⚪'," ",seriesNames[series]||series)));lastSeries=series;}const seriesColor=series==='Maxwell 16'?'blue':series==='Maxwell 48'?'emerald':series==='HSM 3.0'?'orange':'gray';// v16.1: 공간 사용률 계산 (BIN_RACK_INFO + BOXES_PER_SHELF 기반)
// 특수 영역 (D2, E, F1, LABEL): 랙 스펙 없으므로 사용률 N/A
const SPECIAL_AREAS=['D2','E','F1','LABEL'];const isSpecialArea=SPECIAL_AREAS.includes(r.id);// 해당 영역의 모든 Material 가져오기
const areaItems=inventoryData.filter(item=>{const bin=item.bin||'';return bin.startsWith(r.id+'-')||bin===r.id;});let totalCurrentBoxes=0;let totalMaxBoxes=0;let stockUtil=0;if(!isSpecialArea){// Bin별로 그룹화
const binGroups={};areaItems.forEach(item=>{const bin=item.bin||r.id;if(!binGroups[bin])binGroups[bin]=[];binGroups[bin].push(item);});// 각 Bin별 현재 박스 수 & 최대 수용량 계산
Object.entries(binGroups).forEach(([bin,items])=>{// 이 Bin의 현재 박스 수
let binCurrentBoxes=0;items.forEach(item=>{const qtyPerBox=MATERIAL_QTY_PER_BOX[item.material]||1;binCurrentBoxes+=(item.stock||0)/qtyPerBox;});totalCurrentBoxes+=binCurrentBoxes;// 이 Bin의 최대 수용량 (BIN_RACK_INFO 사용)
// Bin = 1개 선반(1단), rackCount = 공유 랙 수
// 최대 박스 = 1랙 1선반 박스 수 × rackCount
const binInfo=BIN_RACK_INFO[bin]||{rackType:'경량랙',rackCount:1};// 해당 Bin의 Material들이 사용하는 박스 타입 중 가장 많은 것 사용
const binBoxTypes=items.map(item=>MATERIAL_BOX_MAP[item.material]||'PLASTIC-S');const typeCount={};binBoxTypes.forEach(t=>{typeCount[t]=(typeCount[t]||0)+1;});const mainBoxType=Object.entries(typeCount).sort((a,b)=>b[1]-a[1])[0]?.[0]||'PLASTIC-S';let binMaxBoxes=0;if(binInfo.maxBoxes){// 직접 지정된 최대 박스 수 (B3 등 1단 랙)
binMaxBoxes=binInfo.maxBoxes;}else if(binInfo.mixed){// 혼합 랙 (예: A3 = 중량랙1 + 경량랙2)
binInfo.mixed.forEach(m=>{const shelfByType=BOXES_PER_SHELF[m.type]||BOXES_PER_SHELF['경량랙'];const perShelf=shelfByType[mainBoxType]||shelfByType['PLASTIC-S']||12;binMaxBoxes+=perShelf*m.count;});}else{// 단일 랙 타입
const shelfByType=BOXES_PER_SHELF[binInfo.rackType]||BOXES_PER_SHELF['경량랙'];const perShelf=shelfByType[mainBoxType]||shelfByType['PLASTIC-S']||12;const shelvesPerRack=binInfo.shelves||1;binMaxBoxes=perShelf*binInfo.rackCount*shelvesPerRack;}totalMaxBoxes+=binMaxBoxes;});stockUtil=totalMaxBoxes>0?totalCurrentBoxes/totalMaxBoxes*100:0;}else{// 특수 영역: 박스 수만 계산 (최대 용량 N/A)
areaItems.forEach(item=>{const qtyPerBox=MATERIAL_QTY_PER_BOX[item.material]||1;totalCurrentBoxes+=(item.stock||0)/qtyPerBox;});}// 무게 활용률 계산
const weightUtil=r.weight/r.maxWeight*100;const isUnlimitedWeight=r.maxWeight>=99999;const row=/*#__PURE__*/React.createElement("tr",{key:r.id,className:`hover:bg-slate-50 border-l-4 border-${seriesColor}-500 cursor-pointer`,onClick:()=>setSelectedRackDetail(r)},/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 font-bold text-lg"},r.id),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-xs bg-${seriesColor}-100 text-${seriesColor}-700`},series==='Others'?'기타':series)),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center"},r.items),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center font-medium"},r.stock.toLocaleString()," EA"),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3"},isSpecialArea?/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400"},totalCurrentBoxes.toFixed(1)," \uBC15\uC2A4 (\uB799 \uBBF8\uC9C0\uC815)")):/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("div",{className:"flex-1 bg-gray-200 rounded-full h-2 w-16"},/*#__PURE__*/React.createElement("div",{className:`h-2 rounded-full ${stockUtil>100?'bg-red-500':stockUtil>=80?'bg-amber-500':stockUtil>=50?'bg-emerald-500':'bg-blue-500'}`,style:{width:`${Math.min(stockUtil,100)}%`}})),/*#__PURE__*/React.createElement("span",{className:`text-xs w-24 ${stockUtil>100?'text-red-600 font-bold':stockUtil>=80?'text-amber-600':stockUtil>=50?'text-emerald-600':'text-blue-600'}`},totalCurrentBoxes.toFixed(1),"/",totalMaxBoxes," (",stockUtil.toFixed(0),"%)"))),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center text-sm"},isUnlimitedWeight?/*#__PURE__*/React.createElement("span",null,r.weight.toFixed(1)," kg"):/*#__PURE__*/React.createElement("span",null,r.weight.toFixed(1)," / ",r.maxWeight," kg")),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3"},isUnlimitedWeight?/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400"},"\uBB34\uC81C\uD55C"):/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("div",{className:"flex-1 bg-gray-200 rounded-full h-2 w-16"},/*#__PURE__*/React.createElement("div",{className:`h-2 rounded-full ${weightUtil>=90?'bg-red-500':weightUtil>=70?'bg-amber-500':'bg-emerald-500'}`,style:{width:`${Math.min(weightUtil,100)}%`}})),/*#__PURE__*/React.createElement("span",{className:`text-xs w-12 ${weightUtil>=90?'text-red-600':weightUtil>=70?'text-amber-600':'text-emerald-600'}`},weightUtil.toFixed(0),"%"))));rows.push(row);});return rows;})())))),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-r from-slate-700 to-slate-800 rounded-xl shadow-lg p-6 text-white"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-4"},/*#__PURE__*/React.createElement("h3",{className:"text-lg font-bold flex items-center gap-2"},"\uD83D\uDCD0 v16.0 \uB799 \uC2A4\uD399 \uBD84\uC11D",/*#__PURE__*/React.createElement("span",{className:"text-xs bg-amber-500 px-2 py-0.5 rounded"},"NEW")),/*#__PURE__*/React.createElement("div",{className:"text-xs text-slate-300"},"\uBB3C\uB9AC\uC801 \uB799 ",Object.values(RACK_SPEC).flat().length,"\uAC1C | \uBC15\uC2A4 \uD0C0\uC785 ",Object.keys(BOX_TYPES).length,"\uC885")),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},(()=>{const allRacks=Object.values(RACK_SPEC).flat();const heavyRacks=allRacks.filter(r=>r.type==='중량랙');const lightRacks=allRacks.filter(r=>r.type==='경량랙');const totalCapacity=allRacks.reduce((sum,r)=>sum+r.maxWeight*r.levels,0);const totalVolume=allRacks.reduce((sum,r)=>sum+r.width*r.depth*r.height/1000000,0);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"bg-white/10 rounded-lg p-3"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-slate-300"},"\uC911\uB7C9\uB799"),/*#__PURE__*/React.createElement("p",{className:"text-xl font-bold"},heavyRacks.length,"\uAC1C"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-slate-400"},"\uCD5C\uB300 ",heavyRacks.reduce((s,r)=>s+r.maxWeight*r.levels,0).toLocaleString(),"kg")),/*#__PURE__*/React.createElement("div",{className:"bg-white/10 rounded-lg p-3"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-slate-300"},"\uACBD\uB7C9\uB799"),/*#__PURE__*/React.createElement("p",{className:"text-xl font-bold"},lightRacks.length,"\uAC1C"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-slate-400"},"\uCD5C\uB300 ",lightRacks.reduce((s,r)=>s+r.maxWeight*r.levels,0).toLocaleString(),"kg")),/*#__PURE__*/React.createElement("div",{className:"bg-white/10 rounded-lg p-3"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-slate-300"},"\uCD1D \uC801\uC7AC\uC6A9\uB7C9"),/*#__PURE__*/React.createElement("p",{className:"text-xl font-bold"},totalCapacity.toLocaleString(),"kg"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-slate-400"},"\uD604\uC7AC ",totals.weight.toFixed(0),"kg (",(totals.weight/totalCapacity*100).toFixed(1),"%)")),/*#__PURE__*/React.createElement("div",{className:"bg-white/10 rounded-lg p-3"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-slate-300"},"\uCD1D \uBD80\uD53C"),/*#__PURE__*/React.createElement("p",{className:"text-xl font-bold"},totalVolume.toFixed(1),"m\xB3"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-slate-400"},allRacks.length,"\uAC1C \uB799 \uD569\uACC4")));})()),/*#__PURE__*/React.createElement("div",{className:"bg-white/5 rounded-lg p-4"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium mb-3"},"\uD83D\uDCE6 \uBC15\uC2A4 \uD0C0\uC785\uBCC4 \uC0AC\uC6A9 \uD604\uD669 ",/*#__PURE__*/React.createElement("span",{className:"text-xs text-slate-400"},"(\uC7AC\uACE0 \xF7 Qty/Box = \uBC15\uC2A4 \uC218)")),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-2"},['PLASTIC-XL','PLASTIC-M','PLASTIC-S','PCB BOX-L','PCB BOX-M','PAPER-L'].map(code=>{const box=BOX_TYPES[code]||{name:code,width:0,depth:0};// 해당 박스 타입을 사용하는 Material의 실제 박스 개수 합계
const boxCount=inventoryData.reduce((sum,item)=>{const matBox=MATERIAL_BOX_MAP[item.material];if(matBox===code){const qtyPerBox=MATERIAL_QTY_PER_BOX[item.material]||1;const stock=item.stock||0;return sum+Math.ceil(stock/qtyPerBox);}return sum;},0);return/*#__PURE__*/React.createElement("div",{key:code,className:"bg-white/10 rounded p-2 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-xs truncate"},box.name||code),/*#__PURE__*/React.createElement("p",{className:"text-lg font-bold"},boxCount),/*#__PURE__*/React.createElement("p",{className:"text-xs text-slate-400"},box.width>0?`${box.width}×${box.depth}`:'가변'));})))),fullBins.length>0&&/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-xl shadow-lg p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-3xl"},"\uD83D\uDCE6"),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h3",{className:"font-bold text-lg"},"Bin \uC6A9\uB7C9 \uACBD\uACE0!"),/*#__PURE__*/React.createElement("p",{className:"text-sm opacity-90"},fullBins.length,"\uAC1C Bin\uC774 100% \uAC00\uB4DD \uCC3C\uC2B5\uB2C8\uB2E4. \uC7AC\uBC30\uCE58\uAC00 \uD544\uC694\uD569\uB2C8\uB2E4.")))),/*#__PURE__*/React.createElement("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-2"},fullBins.slice(0,8).map((item,idx)=>/*#__PURE__*/React.createElement("div",{key:idx,className:"bg-white/20 rounded px-3 py-2 text-sm flex items-center justify-between"},/*#__PURE__*/React.createElement("span",{className:"font-medium"},item.rack," - ",item.bin),/*#__PURE__*/React.createElement("span",{className:"bg-white/30 px-2 py-0.5 rounded text-xs"},item.count,"\uAC1C \uD488\uBAA9")))),fullBins.length>8&&/*#__PURE__*/React.createElement("p",{className:"mt-2 text-sm opacity-75"},"+",fullBins.length-8,"\uAC1C \uB354 \uC788\uC74C")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowSeriesCards(!showSeriesCards),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold flex items-center gap-2"},"\uD83D\uDCCA \uBAA8\uB378 \uC2DC\uB9AC\uC988\uBCC4 \uC694\uC57D"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},showSeriesCards?'접기':'펼치기'),showSeriesCards?/*#__PURE__*/React.createElement(ChevronUp,{className:"w-5 h-5 text-gray-400"}):/*#__PURE__*/React.createElement(ChevronDown,{className:"w-5 h-5 text-gray-400"}))),showSeriesCards&&/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4"},[{name:'Maxwell 48',desc:'RSC48 / CSC48',color:'emerald',racks:['A1','A2','B1','B3','C3']},{name:'Maxwell 16',desc:'RSC16 / CSC16 / FSC16',color:'blue',racks:['A5','A6','A7','B2','C1']},{name:'HSM 3.0',desc:'HSM 3.0',color:'orange',racks:['A3','B4','C2']},{name:'기타 구역',desc:'D2, E, E3, S1, F1',color:'gray',racks:['D2','E','E3','S1','F1']}].map(series=>{const seriesRacks=rackSummary.filter(r=>series.racks.includes(r.id));const totalItems=seriesRacks.reduce((s,r)=>s+r.items,0);const totalStock=seriesRacks.reduce((s,r)=>s+r.stock,0);const totalWeight=seriesRacks.reduce((s,r)=>s+r.weight,0);// 공간 사용률 계산
const SPECIAL_AREAS=['D2','E','F1','LABEL'];let seriesCurBoxes=0,seriesMaxBoxes=0;seriesRacks.forEach(rack=>{if(SPECIAL_AREAS.includes(rack.id))return;const areaItems=inventoryData.filter(item=>{const bin=item.bin||'';return bin.startsWith(rack.id+'-')||bin===rack.id;});const binGroups={};areaItems.forEach(item=>{const bin=item.bin||rack.id;if(!binGroups[bin])binGroups[bin]=[];binGroups[bin].push(item);});Object.entries(binGroups).forEach(([bin,items])=>{items.forEach(item=>{const qtyPerBox=MATERIAL_QTY_PER_BOX[item.material]||1;seriesCurBoxes+=(item.stock||0)/qtyPerBox;});const binInfo=BIN_RACK_INFO[bin]||{rackType:'경량랙',rackCount:1};const binBoxTypes=items.map(i=>MATERIAL_BOX_MAP[i.material]||'PLASTIC-S');const tc={};binBoxTypes.forEach(t=>{tc[t]=(tc[t]||0)+1;});const mainBT=Object.entries(tc).sort((a,b)=>b[1]-a[1])[0]?.[0]||'PLASTIC-S';if(binInfo.maxBoxes){seriesMaxBoxes+=binInfo.maxBoxes;}else if(binInfo.mixed){binInfo.mixed.forEach(m=>{const s=BOXES_PER_SHELF[m.type]||BOXES_PER_SHELF['경량랙'];seriesMaxBoxes+=(s[mainBT]||s['PLASTIC-S']||2)*m.count;});}else{const s=BOXES_PER_SHELF[binInfo.rackType]||BOXES_PER_SHELF['경량랙'];seriesMaxBoxes+=(s[mainBT]||s['PLASTIC-S']||2)*binInfo.rackCount*(binInfo.shelves||1);}});});const seriesSpaceUtil=seriesMaxBoxes>0?Math.round(seriesCurBoxes/seriesMaxBoxes*100):0;return/*#__PURE__*/React.createElement("div",{key:series.name,className:`bg-white rounded-xl shadow-sm p-5 border-l-4 border-${series.color}-500`},/*#__PURE__*/React.createElement("h3",{className:`text-lg font-bold text-${series.color}-600 mb-3`},series.name),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 gap-y-2 text-sm"},/*#__PURE__*/React.createElement("div",{className:"text-gray-500"},"\uB799:"),/*#__PURE__*/React.createElement("div",{className:"text-right font-medium"},series.racks.join(', ')),/*#__PURE__*/React.createElement("div",{className:"text-gray-500"},"\uD488\uBAA9:"),/*#__PURE__*/React.createElement("div",{className:"text-right font-medium"},totalItems,"\uAC1C"),/*#__PURE__*/React.createElement("div",{className:"text-gray-500"},"\uC7AC\uACE0:"),/*#__PURE__*/React.createElement("div",{className:"text-right font-medium"},totalStock.toLocaleString()," EA"),/*#__PURE__*/React.createElement("div",{className:"text-gray-500"},"\uBB34\uAC8C:"),/*#__PURE__*/React.createElement("div",{className:"text-right font-medium"},totalWeight.toFixed(1)," kg"),/*#__PURE__*/React.createElement("div",{className:"text-gray-500"},"\uACF5\uAC04 \uC0AC\uC6A9\uB960:"),/*#__PURE__*/React.createElement("div",{className:"text-right"},/*#__PURE__*/React.createElement("span",{className:`font-bold ${seriesSpaceUtil>80?'text-red-600':seriesSpaceUtil>50?'text-amber-600':'text-emerald-600'}`},seriesSpaceUtil,"%"),/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400 ml-1"},"(",seriesCurBoxes.toFixed(0),"/",seriesMaxBoxes,"\uBC15\uC2A4)"))),/*#__PURE__*/React.createElement("div",{className:"mt-2 bg-gray-200 rounded-full h-2"},/*#__PURE__*/React.createElement("div",{className:`h-2 rounded-full ${seriesSpaceUtil>80?'bg-red-500':seriesSpaceUtil>50?'bg-amber-500':'bg-emerald-500'}`,style:{width:`${Math.min(seriesSpaceUtil,100)}%`}})));}))),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowDetailSection(!showDetailSection),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold flex items-center gap-2"},"\uD83C\uDFD7\uFE0F \uC601\uC5ED\uBCC4 \uBB3C\uB9AC\uC801 \uB799 \uD604\uD669"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},showDetailSection?'접기':'펼치기'),showDetailSection?/*#__PURE__*/React.createElement(ChevronUp,{className:"w-5 h-5 text-gray-400"}):/*#__PURE__*/React.createElement(ChevronDown,{className:"w-5 h-5 text-gray-400"}))),showDetailSection&&/*#__PURE__*/React.createElement("div",{className:"p-4 space-y-6"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"px-4 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white flex justify-between items-center"},/*#__PURE__*/React.createElement("h3",{className:"font-bold flex items-center gap-2"},"\uD83C\uDFD7\uFE0F \uC601\uC5ED\uBCC4 \uBB3C\uB9AC\uC801 \uB799 \uD604\uD669"),/*#__PURE__*/React.createElement("span",{className:"text-xs bg-white/20 px-2 py-1 rounded"},"\uD074\uB9AD\uD558\uC5EC \uC0C1\uC138 \uBCF4\uAE30")),/*#__PURE__*/React.createElement("div",{className:"p-4"},/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3"},Object.entries(RACK_SPEC).map(([area,racks])=>{const areaItems=inventoryData.filter(item=>{const bin=item.bin||'';return bin.startsWith(area+'-')||bin===area;});// 무게 계산: weightData에서 Material별 무게(kg) 가져와서 재고 곱하기
const areaWeight=areaItems.reduce((sum,item)=>{const materialWeight=weightData[item.material]?.w||0;// kg 단위
return sum+materialWeight*(item.stock||0);},0);const maxWeight=racks.reduce((sum,r)=>sum+r.maxWeight*r.levels,0);const weightUtil=maxWeight>0?areaWeight/maxWeight*100:0;const heavyCount=racks.filter(r=>r.type==='중량랙').length;const lightCount=racks.filter(r=>r.type==='경량랙').length;return/*#__PURE__*/React.createElement("div",{key:area,className:`border rounded-lg p-3 cursor-pointer hover:shadow-md transition ${weightUtil>=90?'border-red-300 bg-red-50':weightUtil>=70?'border-amber-300 bg-amber-50':'border-gray-200 hover:border-indigo-300'}`,onClick:()=>{const rackData=rackSummary.find(r=>r.id===area);if(rackData)setSelectedRackDetail(rackData);}},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-start mb-2"},/*#__PURE__*/React.createElement("span",{className:"font-bold text-lg"},area),/*#__PURE__*/React.createElement("span",{className:`text-xs px-1.5 py-0.5 rounded ${weightUtil>=90?'bg-red-100 text-red-700':weightUtil>=70?'bg-amber-100 text-amber-700':'bg-emerald-100 text-emerald-700'}`},weightUtil.toFixed(0),"%")),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500 space-y-1"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between"},/*#__PURE__*/React.createElement("span",null,"\uB799:"),/*#__PURE__*/React.createElement("span",null,racks.length,"\uAC1C ",heavyCount>0&&`(중${heavyCount})`," ",lightCount>0&&`(경${lightCount})`)),/*#__PURE__*/React.createElement("div",{className:"flex justify-between"},/*#__PURE__*/React.createElement("span",null,"\uD488\uBAA9:"),/*#__PURE__*/React.createElement("span",null,areaItems.length,"\uAC1C")),/*#__PURE__*/React.createElement("div",{className:"flex justify-between"},/*#__PURE__*/React.createElement("span",null,"\uBB34\uAC8C:"),/*#__PURE__*/React.createElement("span",null,areaWeight.toFixed(1)," / ",maxWeight,"kg"))),/*#__PURE__*/React.createElement("div",{className:"mt-2 bg-gray-200 rounded-full h-1.5"},/*#__PURE__*/React.createElement("div",{className:`h-1.5 rounded-full ${weightUtil>=90?'bg-red-500':weightUtil>=70?'bg-amber-500':'bg-emerald-500'}`,style:{width:`${Math.min(weightUtil,100)}%`}})));})))))),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("button",{onClick:()=>setBinOverloadExpanded(!binOverloadExpanded),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold flex items-center gap-2"},/*#__PURE__*/React.createElement(AlertTriangle,{className:"w-5 h-5 text-orange-500"}),"Bin\uBCC4 \uACFC\uC801 \uD604\uD669 (D2, Label, E3 \uC81C\uC678)",(()=>{const BIN_CAPACITY=500;const EXCLUDED_BINS=['D2','Label','E3','d2','label','LABEL','e3'];const count=inventoryData.reduce((acc,item)=>{if(EXCLUDED_BINS.some(ex=>ex.toLowerCase()===(item.bin||'').toLowerCase()))return acc;if(!acc[item.bin])acc[item.bin]=0;acc[item.bin]+=item.stock||0;return acc;},{});const overCount=Object.values(count).filter(v=>v>BIN_CAPACITY).length;return overCount>0?/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 text-xs rounded ml-2"},overCount,"\uAC1C \uACFC\uC801"):null;})()),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},binOverloadExpanded?'접기':'펼치기'),binOverloadExpanded?/*#__PURE__*/React.createElement(ChevronUp,{className:"w-5 h-5 text-gray-400"}):/*#__PURE__*/React.createElement(ChevronDown,{className:"w-5 h-5 text-gray-400"}))),binOverloadExpanded&&/*#__PURE__*/React.createElement("div",{className:"px-6 pb-6 border-t"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mt-4 mb-4"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},"Bin\uB2F9 \uC801\uC815 \uC218\uB7C9 500 EA \uAE30\uC900 (\uC784\uC2DC) | \uD074\uB9AD\uD558\uBA74 \uD488\uBAA9 \uC0C1\uC138 \uD655\uC778"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},"\uC815\uB82C:"),/*#__PURE__*/React.createElement("select",{className:"border rounded px-2 py-1 text-sm",value:spaceAnalysisSortBy,onChange:e=>setSpaceAnalysisSortBy(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"urgency"},"\uAE34\uAE09\uB3C4\uC21C (\uCD08\uACFC\uB7C9)"),/*#__PURE__*/React.createElement("option",{value:"alphabet"},"\uC54C\uD30C\uBCB3\uC21C (Bin)")))),(()=>{const BIN_CAPACITY=500;// 대소문자 구분 없이 제외
const EXCLUDED_BINS=['D2','Label','E3','d2','label','LABEL','e3'];const binStockMap={};inventoryData.forEach(item=>{// 제외 Bin 필터링 (대소문자 무시)
if(EXCLUDED_BINS.some(ex=>ex.toLowerCase()===(item.bin||'').toLowerCase()))return;// 랙 추출 (C1-04 → C1)
const rack=item.bin?.split('-')[0]||item.bin||'';if(!binStockMap[item.bin]){binStockMap[item.bin]={stock:0,items:[],rack:rack,area:rack};}binStockMap[item.bin].stock+=item.stock||0;binStockMap[item.bin].items.push(item);});let overloadedBins=Object.entries(binStockMap).filter(([_,data])=>data.stock>BIN_CAPACITY);// 정렬
if(spaceAnalysisSortBy==='alphabet'){overloadedBins=overloadedBins.sort((a,b)=>a[0].localeCompare(b[0]));}else{overloadedBins=overloadedBins.sort((a,b)=>b[1].stock-a[1].stock);}// 같은 랙 내 여유 Bin 찾기 (C1→C1, C2→C2)
const spareBinsByRack={};Object.entries(binStockMap).forEach(([bin,data])=>{if(data.stock<BIN_CAPACITY*0.5){const rack=data.rack;if(!spareBinsByRack[rack])spareBinsByRack[rack]=[];spareBinsByRack[rack].push({bin,...data,spare:BIN_CAPACITY-data.stock});}});if(overloadedBins.length===0){return/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-500 py-8"},"\u2705 \uACFC\uC801\uB41C Bin\uC774 \uC5C6\uC2B5\uB2C8\uB2E4!");}return/*#__PURE__*/React.createElement("div",{className:"space-y-3 max-h-[400px] overflow-y-auto"},overloadedBins.slice(0,10).map(([bin,data])=>{const overAmount=data.stock-BIN_CAPACITY;const rack=data.rack;const urgencyPercent=(data.stock/BIN_CAPACITY*100).toFixed(0);// 같은 랙 내에서만 여유 Bin 추천
const sameRackSpare=(spareBinsByRack[rack]||[]).filter(s=>s.bin!==bin).sort((a,b)=>b.spare-a.spare).slice(0,3);return/*#__PURE__*/React.createElement("div",{key:bin,className:"border border-orange-200 rounded-lg p-3 bg-orange-50 cursor-pointer hover:bg-orange-100 transition",onClick:()=>setBinDetailModal({bin,data,BIN_CAPACITY})},/*#__PURE__*/React.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3"},/*#__PURE__*/React.createElement("div",{className:"flex-1"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 mb-1"},/*#__PURE__*/React.createElement("span",{className:"font-bold text-orange-700"},bin),/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 text-xs rounded ${urgencyPercent>200?'bg-red-500 text-white':urgencyPercent>150?'bg-orange-400 text-white':'bg-orange-200 text-orange-800'}`},urgencyPercent,"%")),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-700"},data.stock.toLocaleString()," EA ",/*#__PURE__*/React.createElement("span",{className:"text-orange-500"},"(+",overAmount.toLocaleString()," \uCD08\uACFC)"))),/*#__PURE__*/React.createElement("div",{className:"flex-1"},/*#__PURE__*/React.createElement("p",{className:"text-xs font-medium text-gray-600 mb-1"},"\uD83D\uDCCD ",rack," Area \uC774\uB3D9 \uCD94\uCC9C"),sameRackSpare.length>0?/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap gap-1"},sameRackSpare.map((s,idx)=>/*#__PURE__*/React.createElement("span",{key:s.bin,className:`px-2 py-0.5 rounded text-xs ${idx===0?'bg-emerald-100 text-emerald-700':'bg-gray-100 text-gray-600'}`},s.bin))):/*#__PURE__*/React.createElement("p",{className:"text-xs text-amber-600"},"\uC5EC\uC720 Bin \uC5C6\uC74C"))));}),overloadedBins.length>10&&/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-500 text-sm"},"\uC678 ",overloadedBins.length-10,"\uAC1C Bin"));})()))),activeTab==='inventory'&&inventoryData.length>0&&/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4"},/*#__PURE__*/React.createElement("div",{className:"flex flex-col sm:flex-row gap-3"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 flex-1"},/*#__PURE__*/React.createElement(Search,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"\uD488\uBC88/\uD488\uBA85 \uAC80\uC0C9...",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:"border rounded-lg px-3 py-2 text-sm w-full"})),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("select",{value:inventorySortBy,onChange:e=>setInventorySortBy(e.target.value),className:"border rounded-lg px-3 py-2 text-sm flex-1"},/*#__PURE__*/React.createElement("option",{value:"bin"},"Bin\uC21C"),/*#__PURE__*/React.createElement("option",{value:"material"},"\uD488\uBC88\uC21C"),/*#__PURE__*/React.createElement("option",{value:"stock"},"\uC7AC\uACE0\uC21C")),/*#__PURE__*/React.createElement("button",{onClick:()=>setInventorySortOrder(prev=>prev==='asc'?'desc':'asc'),className:"border rounded-lg px-3 py-2 text-sm"},inventorySortOrder==='asc'?'↑':'↓'),/*#__PURE__*/React.createElement("button",{onClick:exportInventory,className:"p-2 bg-emerald-600 text-white rounded-lg"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"})))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mt-2"},"\uCD1D ",inventoryData.length,"\uAC1C")),/*#__PURE__*/React.createElement("div",{className:"hidden md:block bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto max-h-[600px]"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-50 sticky top-0"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-left cursor-pointer hover:bg-slate-100",onClick:()=>{setInventorySortBy('material');setInventorySortOrder(prev=>inventorySortBy==='material'?prev==='asc'?'desc':'asc':'asc');}},"\uD488\uBC88 ",inventorySortBy==='material'&&(inventorySortOrder==='asc'?'↑':'↓')),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-left"},"\uD488\uBA85"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center cursor-pointer hover:bg-slate-100",onClick:()=>{setInventorySortBy('bin');setInventorySortOrder(prev=>inventorySortBy==='bin'?prev==='asc'?'desc':'asc':'asc');}},"Bin ",inventorySortBy==='bin'&&(inventorySortOrder==='asc'?'↑':'↓')),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uB799"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center cursor-pointer hover:bg-slate-100",onClick:()=>{setInventorySortBy('stock');setInventorySortOrder(prev=>inventorySortBy==='stock'?prev==='asc'?'desc':'asc':'asc');}},"\uC7AC\uACE0 ",inventorySortBy==='stock'&&(inventorySortOrder==='asc'?'↑':'↓')))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},inventoryData.filter(i=>!searchTerm||i.material.toLowerCase().includes(searchTerm.toLowerCase())||i.description.toLowerCase().includes(searchTerm.toLowerCase())).sort((a,b)=>{let aVal,bVal;switch(inventorySortBy){case'bin':aVal=a.bin||'';bVal=b.bin||'';break;case'material':aVal=a.material||'';bVal=b.material||'';break;case'stock':aVal=a.stock||0;bVal=b.stock||0;break;default:aVal=a.bin||'';bVal=b.bin||'';}if(typeof aVal==='number'){return inventorySortOrder==='asc'?aVal-bVal:bVal-aVal;}return inventorySortOrder==='asc'?aVal.localeCompare(bVal):bVal.localeCompare(aVal);}).slice(0,500).map((item,idx)=>/*#__PURE__*/React.createElement("tr",{key:idx,className:"hover:bg-slate-50"},/*#__PURE__*/React.createElement("td",{className:"px-4 py-2 font-mono text-xs"},item.material),/*#__PURE__*/React.createElement("td",{className:"px-4 py-2 text-sm"},item.description?.slice(0,40)),/*#__PURE__*/React.createElement("td",{className:"px-4 py-2 text-center"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-indigo-50 text-indigo-700 rounded text-xs"},item.bin)),/*#__PURE__*/React.createElement("td",{className:"px-4 py-2 text-center text-xs"},getRackId(item.bin)),/*#__PURE__*/React.createElement("td",{className:"px-4 py-2 text-center font-medium"},item.stock?.toLocaleString()))))))),/*#__PURE__*/React.createElement("div",{className:"md:hidden space-y-3"},inventoryData.filter(i=>!searchTerm||i.material.toLowerCase().includes(searchTerm.toLowerCase())||i.description.toLowerCase().includes(searchTerm.toLowerCase())).sort((a,b)=>{let aVal,bVal;switch(inventorySortBy){case'bin':aVal=a.bin||'';bVal=b.bin||'';break;case'material':aVal=a.material||'';bVal=b.material||'';break;case'stock':aVal=a.stock||0;bVal=b.stock||0;break;default:aVal=a.bin||'';bVal=b.bin||'';}if(typeof aVal==='number'){return inventorySortOrder==='asc'?aVal-bVal:bVal-aVal;}return inventorySortOrder==='asc'?aVal.localeCompare(bVal):bVal.localeCompare(aVal);}).slice(0,100).map((item,idx)=>/*#__PURE__*/React.createElement("div",{key:idx,className:"bg-white rounded-xl shadow-sm p-4"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-start mb-2"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-mono text-sm font-medium"},item.material),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},item.description?.slice(0,30))),/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-700 rounded text-xs font-medium"},item.bin)),/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center pt-2 border-t"},/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-500"},"\uB799 ",getRackId(item.bin)),/*#__PURE__*/React.createElement("span",{className:"text-lg font-bold text-indigo-600"},item.stock?.toLocaleString()," ",item.unit)))),inventoryData.length>100&&/*#__PURE__*/React.createElement("p",{className:"text-center text-sm text-gray-500 py-4"},"100\uAC1C\uAE4C\uC9C0 \uD45C\uC2DC (\uC804\uCCB4 ",inventoryData.length,"\uAC1C)"))),activeTab==='pick'&&/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("h2",{className:"text-lg font-semibold"},"\uC790\uC7AC \uBD88\uCD9C Cycle Time"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1"},/*#__PURE__*/React.createElement("button",{onClick:()=>{const d=new Date(pickFilterMonth+'-01');d.setMonth(d.getMonth()-1);setPickFilterMonth(d.toISOString().slice(0,7));},className:"p-1 hover:bg-white rounded"},/*#__PURE__*/React.createElement(ChevronLeft,{className:"w-4 h-4"})),/*#__PURE__*/React.createElement("span",{className:"px-2 font-medium text-indigo-600"},pickFilterMonth.split('-')[0],"\uB144 ",parseInt(pickFilterMonth.split('-')[1]),"\uC6D4"),/*#__PURE__*/React.createElement("button",{onClick:()=>{const d=new Date(pickFilterMonth+'-01');d.setMonth(d.getMonth()+1);setPickFilterMonth(d.toISOString().slice(0,7));},className:"p-1 hover:bg-white rounded"},/*#__PURE__*/React.createElement(ChevronRight,{className:"w-4 h-4"}))),pickFilterMonth!==new Date().toISOString().slice(0,7)&&/*#__PURE__*/React.createElement("button",{onClick:()=>setPickFilterMonth(new Date().toISOString().slice(0,7)),className:"text-xs text-indigo-600 hover:underline"},"\uC774\uBC88 \uB2EC\uB85C")),/*#__PURE__*/React.createElement("div",{className:"flex gap-2"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowGraphModal(true),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},/*#__PURE__*/React.createElement(BarChart3,{className:"w-4 h-4"})," \uD83D\uDCCA \uADF8\uB798\uD504"),/*#__PURE__*/React.createElement("label",{className:"flex items-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 cursor-pointer"},/*#__PURE__*/React.createElement(Upload,{className:"w-4 h-4"})," Order CSV \uC5C5\uB85C\uB4DC",/*#__PURE__*/React.createElement("input",{type:"file",accept:".csv",onChange:handleOrderCsvUpload,className:"hidden"})),/*#__PURE__*/React.createElement("button",{onClick:()=>downloadCycleExcel('pick'),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"})," \uC5D1\uC140 \uB2E4\uC6B4\uB85C\uB4DC"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowPickModal(true),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},/*#__PURE__*/React.createElement(Plus,{className:"w-4 h-4"})," \uC0C8 \uAE30\uB85D"))),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-5 gap-4"},(()=>{const monthPicks=pickCycles.filter(p=>p.completed?.startsWith(pickFilterMonth)||p.basicStartDate?.startsWith(pickFilterMonth));const completedPicks=monthPicks.filter(p=>p.status==='completed');const pendingPicks=monthPicks.filter(p=>p.status!=='completed');// Maxwell 48
const mx48Picks=monthPicks.filter(p=>['RSC48','CSC48'].includes(p.model)&&p.cycleMin&&p.status==='completed');const mx48Avg=mx48Picks.length?Math.round(mx48Picks.reduce((s,p)=>s+p.cycleMin,0)/mx48Picks.length):0;// Maxwell 16
const mx16Picks=monthPicks.filter(p=>['RSC16','CSC16','FSC16'].includes(p.model)&&p.cycleMin&&p.status==='completed');const mx16Avg=mx16Picks.length?Math.round(mx16Picks.reduce((s,p)=>s+p.cycleMin,0)/mx16Picks.length):0;// HSM 3.0
const hsmPicks=monthPicks.filter(p=>p.model==='HSM3.0'&&p.cycleMin&&p.status==='completed');const hsmAvg=hsmPicks.length?Math.round(hsmPicks.reduce((s,p)=>s+p.cycleMin,0)/hsmPicks.length):0;// Spare Parts
const sparePicks=monthPicks.filter(p=>p.model==='Spare Parts'&&p.cycleMin&&p.status==='completed');const spareAvg=sparePicks.length?Math.round(sparePicks.reduce((s,p)=>s+p.cycleMin,0)/sparePicks.length):0;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-indigo-200 text-sm"},parseInt(pickFilterMonth.split('-')[1]),"\uC6D4 \uBD88\uCD9C \uC644\uB8CC"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},completedPicks.length,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"text-indigo-200 text-xs"},"\uB300\uAE30 ",pendingPicks.length,"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-emerald-200 text-sm"},"Maxwell 48"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},mx48Picks.length,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"text-emerald-200 text-xs"},"\uD3C9\uADE0 ",mx48Avg,"\uBD84")),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-blue-200 text-sm"},"Maxwell 16"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},mx16Picks.length,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"text-blue-200 text-xs"},"\uD3C9\uADE0 ",mx16Avg,"\uBD84")),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-orange-200 text-sm"},"HSM 3.0"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},hsmPicks.length,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"text-orange-200 text-xs"},"\uD3C9\uADE0 ",hsmAvg,"\uBD84")),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-gray-500 to-gray-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-gray-200 text-sm"},"Spare Parts"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},sparePicks.length,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"text-gray-200 text-xs"},"\uD3C9\uADE0 ",spareAvg,"\uBD84")));})()),selectedPicks.size>0&&/*#__PURE__*/React.createElement("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3 flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium text-indigo-700"},selectedPicks.size,"\uAC1C \uC120\uD0DD\uB428"),/*#__PURE__*/React.createElement("button",{onClick:startSelectedPicks,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700"},"\u25B6\uFE0F \uC77C\uAD04 \uC2DC\uC791"),/*#__PURE__*/React.createElement("button",{onClick:completeSelectedPicks,className:"px-3 py-1 bg-emerald-600 text-white text-sm rounded hover:bg-emerald-700"},"\u2705 \uC77C\uAD04 \uC644\uB8CC"),/*#__PURE__*/React.createElement("button",{onClick:deleteSelectedPicks,className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700"},"\uD83D\uDDD1\uFE0F \uC77C\uAD04 \uC0AD\uC81C"),/*#__PURE__*/React.createElement("button",{onClick:()=>setSelectedPicks(new Set()),className:"px-3 py-1 bg-gray-500 text-white text-sm rounded hover:bg-gray-600 ml-auto"},"\uC120\uD0DD \uD574\uC81C")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4"},/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap items-center gap-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement(Search,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"Production Order / Description \uAC80\uC0C9...",className:"border rounded-lg px-3 py-1.5 text-sm w-64",value:pickSearchTerm,onChange:e=>setPickSearchTerm(e.target.value)})),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement(Filter,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:pickFilterModel,onChange:e=>setPickFilterModel(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"all"},"\uC804\uCCB4 Model"),/*#__PURE__*/React.createElement("option",{value:"RSC48"},"RSC48"),/*#__PURE__*/React.createElement("option",{value:"CSC48"},"CSC48"),/*#__PURE__*/React.createElement("option",{value:"RSC16"},"RSC16"),/*#__PURE__*/React.createElement("option",{value:"CSC16"},"CSC16"),/*#__PURE__*/React.createElement("option",{value:"FSC16"},"FSC16"),/*#__PURE__*/React.createElement("option",{value:"HSM3.0"},"HSM3.0"),/*#__PURE__*/React.createElement("option",{value:"Spare Parts"},"Spare Parts"),/*#__PURE__*/React.createElement("option",{value:"Sub-com."},"Sub-com."))),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:pickFilterStatus,onChange:e=>setPickFilterStatus(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"all"},"\uC804\uCCB4 \uC0C1\uD0DC"),/*#__PURE__*/React.createElement("option",{value:"waiting"},"\uB300\uAE30"),/*#__PURE__*/React.createElement("option",{value:"in-progress"},"\uC9C4\uD589\uC911"),/*#__PURE__*/React.createElement("option",{value:"paused"},"\uC77C\uC2DC\uC815\uC9C0"),/*#__PURE__*/React.createElement("option",{value:"completed"},"\uC644\uB8CC")),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:pickFilterWorker,onChange:e=>setPickFilterWorker(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"all"},"\uC804\uCCB4 \uB2F4\uB2F9\uC790"),/*#__PURE__*/React.createElement("option",{value:"Z01"},"Z01"),/*#__PURE__*/React.createElement("option",{value:"Z02"},"Z02"),/*#__PURE__*/React.createElement("option",{value:"Z03"},"Z03"),/*#__PURE__*/React.createElement("option",{value:"Z04"},"Z04"),/*#__PURE__*/React.createElement("option",{value:"Z06"},"Z06")),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:pickFilterUrgent,onChange:e=>setPickFilterUrgent(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"all"},"\uC804\uCCB4"),/*#__PURE__*/React.createElement("option",{value:"urgent"},"\uD83D\uDEA8 \uAE34\uAE09\uB9CC"),/*#__PURE__*/React.createElement("option",{value:"normal"},"\uC77C\uBC18\uB9CC")),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 ml-auto"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},"\uC815\uB82C:"),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:pickSortBy,onChange:e=>setPickSortBy(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"productionOrder"},"Production Order"),/*#__PURE__*/React.createElement("option",{value:"basicStartDate"},"\uC2DC\uC791\uC608\uC815\uC77C"),/*#__PURE__*/React.createElement("option",{value:"model"},"Model"),/*#__PURE__*/React.createElement("option",{value:"status"},"\uC0C1\uD0DC")),/*#__PURE__*/React.createElement("button",{onClick:()=>setPickSortOrder(prev=>prev==='asc'?'desc':'asc'),className:"px-3 py-1.5 border rounded-lg text-sm hover:bg-gray-50"},pickSortOrder==='asc'?'↑ 오름차순':'↓ 내림차순'))),/*#__PURE__*/React.createElement("div",{className:"mt-3 text-sm text-gray-500"},"\uCD1D ",pickCycles.length,"\uAC1C \uC911 ",filteredSortedPicks.length,"\uAC1C \uD45C\uC2DC",(pickSearchTerm||pickFilterModel!=='all'||pickFilterStatus!=='all'||pickFilterWorker!=='all'||pickFilterUrgent!=='all')&&/*#__PURE__*/React.createElement("button",{onClick:()=>{setPickSearchTerm('');setPickFilterModel('all');setPickFilterStatus('all');setPickFilterWorker('all');setPickFilterUrgent('all');},className:"ml-2 text-indigo-600 hover:text-indigo-800"},"\uD544\uD130 \uCD08\uAE30\uD654"))),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-4 gap-4"},(()=>{const picks=pickCycles.filter(p=>['RSC48','CSC48'].includes(p.model)&&p.cycleMin);const avg=picks.length?(picks.reduce((s,p)=>s+p.cycleMin,0)/picks.length).toFixed(0):'-';return/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4 text-center border-l-4 border-green-500"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700"},"Maxwell 48"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mb-1"},"RSC48 + CSC48"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-green-600"},avg,"\uBD84"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"\uD3C9\uADE0 (n=",picks.length,")"));})(),(()=>{const picks=pickCycles.filter(p=>['RSC16','CSC16','FSC16'].includes(p.model)&&p.cycleMin);const avg=picks.length?(picks.reduce((s,p)=>s+p.cycleMin,0)/picks.length).toFixed(0):'-';return/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4 text-center border-l-4 border-blue-500"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700"},"Maxwell 16"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mb-1"},"RSC16 + CSC16 + FSC16"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-blue-600"},avg,"\uBD84"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"\uD3C9\uADE0 (n=",picks.length,")"));})(),(()=>{const picks=pickCycles.filter(p=>p.model==='HSM3.0'&&p.cycleMin);const avg=picks.length?(picks.reduce((s,p)=>s+p.cycleMin,0)/picks.length).toFixed(0):'-';return/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4 text-center border-l-4 border-orange-500"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700"},"HSM 3.0"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mb-1"},"\xA0"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-orange-600"},avg,"\uBD84"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"\uD3C9\uADE0 (n=",picks.length,")"));})(),(()=>{const picks=pickCycles.filter(p=>p.model==='Spare Parts'&&p.cycleMin);const avg=picks.length?(picks.reduce((s,p)=>s+p.cycleMin,0)/picks.length).toFixed(0):'-';return/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4 text-center border-l-4 border-gray-400"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700"},"Spare Parts"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mb-1"},"\xA0"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-gray-600"},avg,"\uBD84"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"\uD3C9\uADE0 (n=",picks.length,")"));})()),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm min-w-[1200px]"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-50"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center w-10 sticky left-0 bg-slate-50 z-10"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:filteredSortedPicks.length>0&&selectedPicks.size===filteredSortedPicks.length,onChange:()=>{if(selectedPicks.size===filteredSortedPicks.length){setSelectedPicks(new Set());}else{setSelectedPicks(new Set(filteredSortedPicks.map(p=>p.id)));}},className:"w-4 h-4 rounded"})),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-left whitespace-nowrap"},"PO"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-left whitespace-nowrap"},"Model"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uB2F4\uB2F9\uC790"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uAE34\uAE09"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-left whitespace-nowrap"},"Part No."),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-left whitespace-nowrap"},"Description"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uC2DC\uC791\uC608\uC815\uC77C"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uC2DC\uC791\uC2DC\uAC04"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uBD88\uCD9C\uC644\uB8CC"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"Cycle Time"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uC0C1\uD0DC"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uC561\uC158"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},filteredSortedPicks.map(p=>{// A5 개선: 긴급 + 미완료인 경우 강조 스타일
const isUrgentPending=p.isUrgent&&p.status!=='completed';// 모델별 색상 설정
const getModelColor=model=>{switch(model){case'RSC48':return'bg-emerald-100 text-emerald-700';case'CSC48':return'bg-green-100 text-green-700';case'RSC16':return'bg-blue-100 text-blue-700';case'CSC16':return'bg-sky-100 text-sky-700';case'FSC16':return'bg-cyan-100 text-cyan-700';case'HSM3.0':return'bg-orange-100 text-orange-700';case'Spare Parts':return'bg-gray-100 text-gray-700';default:return'bg-indigo-100 text-indigo-700';}};// 날짜 축약 함수 (2026-02-06 → 26-02-06)
const shortDate=dateStr=>{if(!dateStr)return'-';return dateStr.replace(/^20(\d{2})/,'$1');};return/*#__PURE__*/React.createElement("tr",{key:p.id,className:`hover:bg-slate-50 transition-all ${selectedPicks.has(p.id)?'bg-indigo-50':isUrgentPending?'bg-red-50 border-l-4 border-red-500 animate-pulse':''}`},/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center sticky left-0 bg-white z-10"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:selectedPicks.has(p.id),onChange:()=>togglePickSelection(p.id),className:"w-4 h-4 rounded"})),/*#__PURE__*/React.createElement("td",{className:`px-2 py-2 font-medium whitespace-nowrap ${isUrgentPending?'text-red-700 font-bold':''}`},isUrgentPending&&/*#__PURE__*/React.createElement("span",{className:"mr-1"},"\uD83D\uDEA8"),p.productionOrder||p.orderId),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2"},/*#__PURE__*/React.createElement("select",{className:`px-2 py-1 rounded text-xs border-0 cursor-pointer font-medium ${getModelColor(p.model)}`,value:p.model,onChange:e=>{setPickCycles(prev=>prev.map(pick=>pick.id===p.id?{...pick,model:e.target.value}:pick));}},/*#__PURE__*/React.createElement("option",{value:"RSC48"},"RSC48"),/*#__PURE__*/React.createElement("option",{value:"CSC48"},"CSC48"),/*#__PURE__*/React.createElement("option",{value:"RSC16"},"RSC16"),/*#__PURE__*/React.createElement("option",{value:"CSC16"},"CSC16"),/*#__PURE__*/React.createElement("option",{value:"FSC16"},"FSC16"),/*#__PURE__*/React.createElement("option",{value:"HSM3.0"},"HSM3.0"),/*#__PURE__*/React.createElement("option",{value:"Spare Parts"},"Spare Parts"),/*#__PURE__*/React.createElement("option",{value:"Sub-com."},"Sub-com."))),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center"},/*#__PURE__*/React.createElement("select",{className:"px-2 py-1 bg-slate-100 text-slate-700 rounded text-xs border-0 cursor-pointer hover:bg-slate-200 font-medium",value:p.worker||'',onChange:e=>{setPickCycles(prev=>prev.map(pick=>pick.id===p.id?{...pick,worker:e.target.value}:pick));}},/*#__PURE__*/React.createElement("option",{value:""},"-"),/*#__PURE__*/React.createElement("option",{value:"Z01"},"Z01"),/*#__PURE__*/React.createElement("option",{value:"Z02"},"Z02"),/*#__PURE__*/React.createElement("option",{value:"Z03"},"Z03"),/*#__PURE__*/React.createElement("option",{value:"Z04"},"Z04"),/*#__PURE__*/React.createElement("option",{value:"Z06"},"Z06"))),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center whitespace-nowrap"},/*#__PURE__*/React.createElement("label",{className:"cursor-pointer"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:p.isUrgent||false,onChange:e=>{setPickCycles(prev=>prev.map(pick=>pick.id===p.id?{...pick,isUrgent:e.target.checked}:pick));},className:"hidden"}),p.isUrgent?/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-red-500 text-white rounded text-xs font-bold whitespace-nowrap"},"\uD83D\uDEA8\uAE34\uAE09"):/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-gray-200 text-gray-500 rounded text-xs hover:bg-red-100 whitespace-nowrap"},"\uC77C\uBC18"))),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-xs font-mono text-gray-600 whitespace-nowrap"},p.materialNum||'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-sm text-gray-600 whitespace-nowrap",title:p.materialDesc||''},p.materialDesc?.slice(0,20)||'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center text-xs whitespace-nowrap"},shortDate(p.basicStartDate)||shortDate(p.received?.slice(0,10))||'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center text-xs whitespace-nowrap"},p.startTime?/*#__PURE__*/React.createElement("span",{className:"text-blue-600"},(()=>{const d=new Date(p.startTime);return`${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;})()):/*#__PURE__*/React.createElement("span",{className:"text-gray-400"},"-")),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center text-xs whitespace-nowrap"},p.completed?/*#__PURE__*/React.createElement("span",null,(()=>{// 한국 형식 "2026-02-12 15:30" 그대로 표시 (MM-DD HH:MM)
try{const parts=p.completed.replace(/[^\d\s:-]/g,'').trim().split(/[\s-]+/);if(parts.length>=4){return`${parts[1]}-${parts[2]} ${parts[3]}`;}else if(parts.length>=3){return`${parts[1]}-${parts[2]}`;}return p.completed;}catch(e){return p.completed;}})()):'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center whitespace-nowrap"},p.cycleMin?/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-xs ${p.cycleMin>60?'bg-red-100 text-red-700':p.cycleMin>45?'bg-amber-100 text-yellow-600':'bg-emerald-100 text-emerald-700'}`},p.cycleMin,"\uBD84"):'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center whitespace-nowrap"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-xs ${p.status==='completed'?'bg-emerald-100 text-emerald-700':p.status==='paused'?'bg-orange-100 text-orange-600':p.status==='in-progress'?'bg-blue-100 text-blue-700':'bg-gray-100 text-gray-700'}`},p.status==='completed'?'완료':p.status==='paused'?'일시정지':p.status==='in-progress'?'진행중':'대기')),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center whitespace-nowrap"},/*#__PURE__*/React.createElement("div",{className:"flex gap-1 justify-center"},p.status==='waiting'&&/*#__PURE__*/React.createElement("button",{onClick:()=>startPick(p.id),className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 flex items-center gap-1"},/*#__PURE__*/React.createElement(Play,{className:"w-3 h-3"}),"\uC2DC\uC791"),p.status==='in-progress'&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("button",{onClick:()=>pausePick(p.id),className:"px-2 py-1 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 whitespace-nowrap"},"\uC815\uC9C0"),/*#__PURE__*/React.createElement("button",{onClick:()=>completePick(p.id),className:"px-2 py-1 bg-emerald-600 text-white text-xs rounded hover:bg-emerald-700"},"\uC644\uB8CC")),p.status==='paused'&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("button",{onClick:()=>resumePick(p.id),className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 flex items-center gap-1"},/*#__PURE__*/React.createElement(Play,{className:"w-3 h-3"}),"\uC7AC\uAC1C"),/*#__PURE__*/React.createElement("button",{onClick:()=>completePick(p.id),className:"px-2 py-1 bg-emerald-600 text-white text-xs rounded hover:bg-emerald-700"},"\uC644\uB8CC")),/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingPick({...p,worker:p.worker||'Z01',isUrgent:p.isUrgent||false}),className:"px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600"},"\u270F\uFE0F"))));})))))),activeTab==='kitting'&&/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("h2",{className:"text-lg font-semibold"},"Kitting \uD604\uD669 (Lead Time \uAD00\uB9AC)"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1"},/*#__PURE__*/React.createElement("button",{onClick:()=>{const d=new Date(kittingFilterMonth+'-01');d.setMonth(d.getMonth()-1);setKittingFilterMonth(d.toISOString().slice(0,7));},className:"p-1 hover:bg-white rounded"},/*#__PURE__*/React.createElement(ChevronLeft,{className:"w-4 h-4"})),/*#__PURE__*/React.createElement("span",{className:"px-2 font-medium text-teal-600"},kittingFilterMonth.split('-')[0],"\uB144 ",parseInt(kittingFilterMonth.split('-')[1]),"\uC6D4"),/*#__PURE__*/React.createElement("button",{onClick:()=>{const d=new Date(kittingFilterMonth+'-01');d.setMonth(d.getMonth()+1);setKittingFilterMonth(d.toISOString().slice(0,7));},className:"p-1 hover:bg-white rounded"},/*#__PURE__*/React.createElement(ChevronRight,{className:"w-4 h-4"}))),kittingFilterMonth!==new Date().toISOString().slice(0,7)&&/*#__PURE__*/React.createElement("button",{onClick:()=>setKittingFilterMonth(new Date().toISOString().slice(0,7)),className:"text-xs text-teal-600 hover:underline"},"\uC774\uBC88 \uB2EC\uB85C")),/*#__PURE__*/React.createElement("div",{className:"flex gap-2"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowKittingGraphModal(true),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},/*#__PURE__*/React.createElement(BarChart3,{className:"w-4 h-4"})," \uD83D\uDCCA \uADF8\uB798\uD504"),/*#__PURE__*/React.createElement("label",{className:"flex items-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 cursor-pointer"},/*#__PURE__*/React.createElement(Upload,{className:"w-4 h-4"})," Order CSV \uC5C5\uB85C\uB4DC",/*#__PURE__*/React.createElement("input",{type:"file",accept:".csv",onChange:handleOrderCsvUpload,className:"hidden"})),/*#__PURE__*/React.createElement("button",{onClick:downloadKittingExcel,className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"})," \uC5D1\uC140 \uB2E4\uC6B4\uB85C\uB4DC"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowKittingModal(true),className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700"},/*#__PURE__*/React.createElement(Plus,{className:"w-4 h-4"})," \uC0C8 \uAE30\uB85D"))),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-5 gap-4"},(()=>{const monthKittings=filteredSortedKittings;const completedKittings=monthKittings.filter(k=>k.status==='completed');const pendingKittings=monthKittings.filter(k=>k.status!=='completed');// 3일 이내 완료율
const within3Days=completedKittings.filter(k=>k.leadTimeDays&&k.leadTimeDays<=3).length;const within3DaysRate=completedKittings.length>0?Math.round(within3Days/completedKittings.length*100):0;// 평균 Lead Time
const avgLeadTime=completedKittings.length>0?(completedKittings.reduce((sum,k)=>sum+(k.leadTimeDays||0),0)/completedKittings.length).toFixed(1):0;// 지연 건수 (시작예정일이 지났는데 미완료)
const today=new Date().toISOString().split('T')[0];const delayedCount=pendingKittings.filter(k=>k.basicStartDate&&k.basicStartDate<today).length;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-teal-500 to-teal-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-teal-200 text-sm"},parseInt(kittingFilterMonth.split('-')[1]),"\uC6D4 Kitting \uC644\uB8CC"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},completedKittings.length,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"text-teal-200 text-xs"},"\uB300\uAE30/\uC9C4\uD589 ",pendingKittings.length,"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-green-200 text-sm"},"3\uC77C \uC774\uB0B4 \uC644\uB8CC\uC728"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},within3DaysRate,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"%")),/*#__PURE__*/React.createElement("div",{className:"text-green-200 text-xs"},within3Days,"/",completedKittings.length,"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-blue-200 text-sm"},"\uD3C9\uADE0 Lead Time"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},avgLeadTime,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uC77C")),/*#__PURE__*/React.createElement("div",{className:"text-blue-200 text-xs"},"\uBAA9\uD45C: 3\uC77C \uC774\uB0B4")),/*#__PURE__*/React.createElement("div",{className:`bg-gradient-to-br ${delayedCount>0?'from-red-500 to-red-600':'from-gray-400 to-gray-500'} rounded-xl p-4 text-white`},/*#__PURE__*/React.createElement("div",{className:`${delayedCount>0?'text-red-200':'text-gray-200'} text-sm`},"\uC9C0\uC5F0 \uD604\uD669"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},delayedCount,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:`${delayedCount>0?'text-red-200':'text-gray-200'} text-xs`},"\uC2DC\uC791\uC608\uC815\uC77C \uCD08\uACFC")),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-purple-200 text-sm"},"\uC804\uCCB4 \uB4F1\uB85D"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},monthKittings.length,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"text-purple-200 text-xs"},"\uC774\uBC88 \uB2EC \uAE30\uC900")));})()),selectedKittings.size>0&&/*#__PURE__*/React.createElement("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-3 flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium text-teal-700"},selectedKittings.size,"\uAC1C \uC120\uD0DD\uB428"),/*#__PURE__*/React.createElement("button",{onClick:completeSelectedKittings,className:"px-3 py-1 bg-emerald-600 text-white text-sm rounded hover:bg-emerald-700"},"\u2705 \uC77C\uAD04 \uC644\uB8CC"),/*#__PURE__*/React.createElement("button",{onClick:deleteSelectedKittings,className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700"},"\uD83D\uDDD1\uFE0F \uC77C\uAD04 \uC0AD\uC81C"),/*#__PURE__*/React.createElement("button",{onClick:()=>setSelectedKittings(new Set()),className:"px-3 py-1 bg-gray-500 text-white text-sm rounded hover:bg-gray-600 ml-auto"},"\uC120\uD0DD \uD574\uC81C")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4"},/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap items-center gap-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement(Search,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"Production Order / Description \uAC80\uC0C9...",className:"border rounded-lg px-3 py-1.5 text-sm w-64",value:kittingSearchTerm,onChange:e=>setKittingSearchTerm(e.target.value)})),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement(Filter,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:kittingFilterModel,onChange:e=>setKittingFilterModel(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"all"},"\uC804\uCCB4 Model"),/*#__PURE__*/React.createElement("option",{value:"Maxwell 48"},"Maxwell 48 (RSC48/CSC48)"),/*#__PURE__*/React.createElement("option",{value:"Maxwell 16"},"Maxwell 16 (RSC16/CSC16/FSC16)"),/*#__PURE__*/React.createElement("option",{value:"HSM3.0"},"HSM 3.0"),/*#__PURE__*/React.createElement("option",{value:"Spare Parts"},"Spare Parts"),/*#__PURE__*/React.createElement("option",{value:"Sub-com."},"Sub-com."))),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:kittingFilterStatus,onChange:e=>setKittingFilterStatus(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"all"},"\uC804\uCCB4 \uC0C1\uD0DC"),/*#__PURE__*/React.createElement("option",{value:"waiting"},"\uB300\uAE30"),/*#__PURE__*/React.createElement("option",{value:"in-progress"},"\uC9C4\uD589\uC911"),/*#__PURE__*/React.createElement("option",{value:"paused"},"\uC77C\uC2DC\uC815\uC9C0"),/*#__PURE__*/React.createElement("option",{value:"completed"},"\uC644\uB8CC")),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 ml-auto"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},"\uC815\uB82C:"),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:kittingSortBy,onChange:e=>setKittingSortBy(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"productionOrder"},"Production Order"),/*#__PURE__*/React.createElement("option",{value:"basicStartDate"},"\uC2DC\uC791\uC608\uC815\uC77C"),/*#__PURE__*/React.createElement("option",{value:"completedAt"},"\uC644\uB8CC\uC77C")),/*#__PURE__*/React.createElement("button",{onClick:()=>setKittingSortOrder(prev=>prev==='asc'?'desc':'asc'),className:"border rounded-lg px-3 py-1.5 text-sm hover:bg-gray-50"},kittingSortOrder==='asc'?'↑ 오름차순':'↓ 내림차순'))),/*#__PURE__*/React.createElement("div",{className:"mt-3 text-sm text-gray-500"},"\uCD1D ",filteredSortedKittings.length,"\uAC1C \uC911 ",filteredSortedKittings.length,"\uAC1C \uD45C\uC2DC")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm min-w-[1200px]"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-50"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center w-10 sticky left-0 bg-slate-50 z-10"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:filteredSortedKittings.length>0&&selectedKittings.size===filteredSortedKittings.length,onChange:()=>{if(selectedKittings.size===filteredSortedKittings.length){setSelectedKittings(new Set());}else{setSelectedKittings(new Set(filteredSortedKittings.map(k=>k.id)));}},className:"w-4 h-4 rounded"})),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-left whitespace-nowrap"},"PO"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-left whitespace-nowrap"},"Model"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uB2F4\uB2F9\uC790"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uAE34\uAE09"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-left whitespace-nowrap"},"Part No."),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-left whitespace-nowrap"},"Description"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uC2DC\uC791\uC608\uC815\uC77C"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uC2DC\uC791\uC2DC\uAC04"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uC644\uB8CC\uC77C"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"Lead Time"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uC0C1\uD0DC"),/*#__PURE__*/React.createElement("th",{className:"px-2 py-3 text-center whitespace-nowrap"},"\uC561\uC158"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},filteredSortedKittings.map(k=>{const today=new Date().toISOString().split('T')[0];const isDelayed=k.status!=='completed'&&k.basicStartDate&&k.basicStartDate<today;// 모델별 색상 설정 (불출과 동일)
const getModelColor=model=>{switch(model){case'RSC48':return'bg-emerald-100 text-emerald-700';case'CSC48':return'bg-green-100 text-green-700';case'RSC16':return'bg-blue-100 text-blue-700';case'CSC16':return'bg-sky-100 text-sky-700';case'FSC16':return'bg-cyan-100 text-cyan-700';case'HSM3.0':return'bg-orange-100 text-orange-700';case'Spare Parts':return'bg-gray-100 text-gray-700';default:return'bg-teal-100 text-teal-700';}};// 날짜 축약 함수 (2026-02-06 → 26-02-06)
const shortDate=dateStr=>{if(!dateStr)return'-';return dateStr.replace(/^20(\d{2})/,'$1');};return/*#__PURE__*/React.createElement("tr",{key:k.id,className:`hover:bg-slate-50 ${selectedKittings.has(k.id)?'bg-teal-50':''} ${isDelayed?'bg-red-50':''}`},/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center sticky left-0 bg-white z-10"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:selectedKittings.has(k.id),onChange:()=>toggleKittingSelection(k.id),className:"w-4 h-4 rounded"})),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 font-medium whitespace-nowrap"},k.productionOrder),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2"},/*#__PURE__*/React.createElement("select",{className:`px-2 py-1 rounded text-xs border-0 cursor-pointer font-medium ${getModelColor(k.model)}`,value:k.model,onChange:e=>setKittingData(prev=>prev.map(item=>item.id===k.id?{...item,model:e.target.value}:item))},/*#__PURE__*/React.createElement("option",{value:"RSC48"},"RSC48"),/*#__PURE__*/React.createElement("option",{value:"CSC48"},"CSC48"),/*#__PURE__*/React.createElement("option",{value:"RSC16"},"RSC16"),/*#__PURE__*/React.createElement("option",{value:"CSC16"},"CSC16"),/*#__PURE__*/React.createElement("option",{value:"FSC16"},"FSC16"),/*#__PURE__*/React.createElement("option",{value:"HSM3.0"},"HSM3.0"),/*#__PURE__*/React.createElement("option",{value:"Spare Parts"},"Spare Parts"),/*#__PURE__*/React.createElement("option",{value:"Sub-com."},"Sub-com."))),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center"},/*#__PURE__*/React.createElement("select",{className:"px-2 py-1 bg-slate-100 text-slate-700 rounded text-xs border-0 cursor-pointer hover:bg-slate-200 font-medium",value:k.worker||'',onChange:e=>setKittingData(prev=>prev.map(item=>item.id===k.id?{...item,worker:e.target.value}:item))},/*#__PURE__*/React.createElement("option",{value:""},"-"),/*#__PURE__*/React.createElement("option",{value:"Z01"},"Z01"),/*#__PURE__*/React.createElement("option",{value:"Z02"},"Z02"),/*#__PURE__*/React.createElement("option",{value:"Z03"},"Z03"),/*#__PURE__*/React.createElement("option",{value:"Z04"},"Z04"),/*#__PURE__*/React.createElement("option",{value:"Z06"},"Z06"))),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center whitespace-nowrap"},/*#__PURE__*/React.createElement("label",{className:"cursor-pointer"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:k.isUrgent||false,onChange:e=>setKittingData(prev=>prev.map(item=>item.id===k.id?{...item,isUrgent:e.target.checked}:item)),className:"hidden"}),k.isUrgent?/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-red-500 text-white rounded text-xs font-bold whitespace-nowrap"},"\uD83D\uDEA8\uAE34\uAE09"):/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-gray-200 text-gray-500 rounded text-xs hover:bg-red-100 whitespace-nowrap"},"\uC77C\uBC18"))),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-xs font-mono text-gray-600 whitespace-nowrap"},k.materialNum||'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-sm text-gray-600 whitespace-nowrap",title:k.materialDesc||''},k.materialDesc?.slice(0,20)||'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center text-xs whitespace-nowrap"},shortDate(k.basicStartDate)||'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center text-xs whitespace-nowrap"},k.startedAt?/*#__PURE__*/React.createElement("span",{className:"text-blue-600"},(()=>{const d=new Date(k.startedAt);return`${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;})()):/*#__PURE__*/React.createElement("span",{className:"text-gray-400"},"-")),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center text-xs whitespace-nowrap"},k.completedAt?/*#__PURE__*/React.createElement("span",null,k.completedAt):'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center whitespace-nowrap"},k.leadTimeDays?/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-xs ${k.leadTimeDays<=3?'bg-emerald-100 text-emerald-700':k.leadTimeDays<=5?'bg-amber-100 text-yellow-600':'bg-red-100 text-red-700'}`},k.leadTimeDays,"\uC77C"):'-'),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center whitespace-nowrap"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-xs ${k.status==='completed'?'bg-emerald-100 text-emerald-700':k.status==='paused'?'bg-orange-100 text-orange-600':k.status==='in-progress'?'bg-blue-100 text-blue-700':isDelayed?'bg-red-100 text-red-700':'bg-gray-100 text-gray-700'}`},k.status==='completed'?'완료':k.status==='paused'?'일시정지':k.status==='in-progress'?'진행중':isDelayed?'⚠️ 지연':'대기')),/*#__PURE__*/React.createElement("td",{className:"px-2 py-2 text-center whitespace-nowrap"},/*#__PURE__*/React.createElement("div",{className:"flex gap-1 justify-center"},k.status==='waiting'&&/*#__PURE__*/React.createElement("button",{onClick:()=>startKitting(k.id),className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700"},"\uC2DC\uC791"),k.status==='in-progress'&&/*#__PURE__*/React.createElement("button",{onClick:()=>pauseKitting(k.id),className:"px-2 py-1 bg-orange-500 text-white text-xs rounded hover:bg-orange-600"},"\uC815\uC9C0"),k.status==='paused'&&/*#__PURE__*/React.createElement("button",{onClick:()=>resumeKitting(k.id),className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700"},"\uC7AC\uAC1C"),(k.status==='waiting'||k.status==='in-progress'||k.status==='paused')&&/*#__PURE__*/React.createElement("button",{onClick:()=>completeKitting(k.id),className:"px-2 py-1 bg-emerald-600 text-white text-xs rounded hover:bg-emerald-700"},"\uC644\uB8CC"),/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingKitting(k),className:"px-2 py-1 bg-amber-500 text-white text-xs rounded hover:bg-amber-600"},"\u270F\uFE0F"))));})))),filteredSortedKittings.length===0&&/*#__PURE__*/React.createElement("div",{className:"text-center py-12 text-gray-500"},/*#__PURE__*/React.createElement(Package,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),/*#__PURE__*/React.createElement("p",null,"\uB4F1\uB85D\uB41C Kitting \uD56D\uBAA9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4."),/*#__PURE__*/React.createElement("p",{className:"text-sm mt-1"},"CSV \uC5C5\uB85C\uB4DC \uB610\uB294 \uC0C8 \uAE30\uB85D \uBC84\uD2BC\uC73C\uB85C \uCD94\uAC00\uD558\uC138\uC694.")))),activeTab==='receive'&&/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("h2",{className:"text-lg font-semibold"},"\uC785\uACE0 \uCC98\uB9AC Cycle Time (\uB0A9\uD488 \u2192 MIGO)"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1"},/*#__PURE__*/React.createElement("button",{onClick:()=>{const d=new Date(receiveFilterMonth+'-01');d.setMonth(d.getMonth()-1);setReceiveFilterMonth(d.toISOString().slice(0,7));},className:"p-1 hover:bg-white rounded"},/*#__PURE__*/React.createElement(ChevronLeft,{className:"w-4 h-4"})),/*#__PURE__*/React.createElement("span",{className:"px-2 font-medium text-purple-600"},receiveFilterMonth.split('-')[0],"\uB144 ",parseInt(receiveFilterMonth.split('-')[1]),"\uC6D4"),/*#__PURE__*/React.createElement("button",{onClick:()=>{const d=new Date(receiveFilterMonth+'-01');d.setMonth(d.getMonth()+1);setReceiveFilterMonth(d.toISOString().slice(0,7));},className:"p-1 hover:bg-white rounded"},/*#__PURE__*/React.createElement(ChevronRight,{className:"w-4 h-4"}))),receiveFilterMonth!==new Date().toISOString().slice(0,7)&&/*#__PURE__*/React.createElement("button",{onClick:()=>setReceiveFilterMonth(new Date().toISOString().slice(0,7)),className:"text-xs text-purple-600 hover:underline"},"\uC774\uBC88 \uB2EC\uB85C")),/*#__PURE__*/React.createElement("div",{className:"flex gap-2"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowReceiveGraphModal(true),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},/*#__PURE__*/React.createElement(BarChart3,{className:"w-4 h-4"})," \uD83D\uDCCA \uADF8\uB798\uD504"),/*#__PURE__*/React.createElement("button",{onClick:()=>downloadCycleExcel('receive'),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"})," \uC5D1\uC140 \uB2E4\uC6B4\uB85C\uB4DC"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowReceiveModal(true),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},/*#__PURE__*/React.createElement(Plus,{className:"w-4 h-4"})," \uC0C8 \uAE30\uB85D"))),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4"},(()=>{const monthReceives=receiveCycles.filter(r=>r.delivery?.startsWith(receiveFilterMonth)||r.migoTime?.startsWith(receiveFilterMonth));const completedReceives=monthReceives.filter(r=>r.status==='completed'&&r.cycleMin);const avgTime=completedReceives.length>0?Math.round(completedReceives.reduce((sum,r)=>sum+r.cycleMin,0)/completedReceives.length):0;const uniqueVendors=[...new Set(monthReceives.map(r=>r.vendor).filter(Boolean))];const monthCompleted=monthReceives.filter(r=>r.status==='completed').length;const pendingCount=monthReceives.filter(r=>r.status!=='completed').length;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-purple-200 text-sm"},"\uD3C9\uADE0 \uC785\uACE0 \uC2DC\uAC04"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},avgTime,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uBD84")),/*#__PURE__*/React.createElement("div",{className:"text-purple-200 text-xs"},"\uC644\uB8CC ",completedReceives.length,"\uAC74 \uAE30\uC900")),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-emerald-200 text-sm"},parseInt(receiveFilterMonth.split('-')[1]),"\uC6D4 \uC785\uACE0 \uC644\uB8CC"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},monthCompleted,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"text-emerald-200 text-xs"},uniqueVendors.length,"\uAC1C \uC5C5\uCCB4")),/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"text-orange-200 text-sm"},"\uB300\uAE30/\uC9C4\uD589\uC911"),/*#__PURE__*/React.createElement("div",{className:"text-3xl font-bold"},pendingCount,/*#__PURE__*/React.createElement("span",{className:"text-lg ml-1"},"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"text-orange-200 text-xs"},"\uCC98\uB9AC \uD544\uC694")));})()),selectedReceives.size>0&&/*#__PURE__*/React.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium text-purple-700"},selectedReceives.size,"\uAC1C \uC120\uD0DD\uB428"),/*#__PURE__*/React.createElement("button",{onClick:startSelectedReceives,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700"},"\u25B6\uFE0F \uC77C\uAD04 \uC2DC\uC791"),/*#__PURE__*/React.createElement("button",{onClick:completeSelectedReceives,className:"px-3 py-1 bg-emerald-600 text-white text-sm rounded hover:bg-emerald-700"},"\u2705 \uC77C\uAD04 MIGO"),/*#__PURE__*/React.createElement("button",{onClick:deleteSelectedReceives,className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700"},"\uD83D\uDDD1\uFE0F \uC77C\uAD04 \uC0AD\uC81C"),/*#__PURE__*/React.createElement("button",{onClick:()=>setSelectedReceives(new Set()),className:"px-3 py-1 bg-gray-500 text-white text-sm rounded hover:bg-gray-600 ml-auto"},"\uC120\uD0DD \uD574\uC81C")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4"},/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap items-center gap-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement(Search,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"No. / \uD611\uB825\uC5C5\uCCB4 \uAC80\uC0C9...",className:"border rounded-lg px-3 py-1.5 text-sm w-64",value:receiveSearchTerm,onChange:e=>setReceiveSearchTerm(e.target.value)})),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement(Filter,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:receiveFilterStatus,onChange:e=>setReceiveFilterStatus(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"all"},"\uC804\uCCB4 \uC0C1\uD0DC"),/*#__PURE__*/React.createElement("option",{value:"waiting"},"\uB300\uAE30"),/*#__PURE__*/React.createElement("option",{value:"in-progress"},"\uC9C4\uD589\uC911"),/*#__PURE__*/React.createElement("option",{value:"paused"},"\uC77C\uC2DC\uC815\uC9C0"),/*#__PURE__*/React.createElement("option",{value:"completed"},"\uC644\uB8CC"))),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 ml-auto"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},"\uC815\uB82C:"),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-1.5 text-sm",value:receiveSortBy,onChange:e=>setReceiveSortBy(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"delivery"},"\uB0A9\uD488 \uC2DC\uAC01"),/*#__PURE__*/React.createElement("option",{value:"poNo"},"No."),/*#__PURE__*/React.createElement("option",{value:"vendor"},"\uD611\uB825\uC5C5\uCCB4")),/*#__PURE__*/React.createElement("button",{onClick:()=>setReceiveSortOrder(prev=>prev==='asc'?'desc':'asc'),className:"px-3 py-1.5 border rounded-lg text-sm hover:bg-gray-50"},receiveSortOrder==='asc'?'↑ 오름차순':'↓ 내림차순'))),/*#__PURE__*/React.createElement("div",{className:"mt-3 text-sm text-gray-500"},"\uCD1D ",receiveCycles.length,"\uAC1C \uC911 ",filteredSortedReceives.length,"\uAC1C \uD45C\uC2DC",(receiveSearchTerm||receiveFilterStatus!=='all')&&/*#__PURE__*/React.createElement("button",{onClick:()=>{setReceiveSearchTerm('');setReceiveFilterStatus('all');},className:"ml-2 text-purple-600 hover:text-purple-800"},"\uD544\uD130 \uCD08\uAE30\uD654"))),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-50"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center w-10"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:filteredSortedReceives.length>0&&selectedReceives.size===filteredSortedReceives.length,onChange:()=>{if(selectedReceives.size===filteredSortedReceives.length){setSelectedReceives(new Set());}else{setSelectedReceives(new Set(filteredSortedReceives.map(r=>r.id)));}},className:"w-4 h-4 rounded"})),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-left"},"No."),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-left"},"\uD611\uB825\uC5C5\uCCB4"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uB0A9\uD488 \uC2DC\uAC01"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"MIGO \uC644\uB8CC"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"Cycle Time"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uC0C1\uD0DC"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-left"},"Comments"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-center"},"\uC561\uC158"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},filteredSortedReceives.map(r=>/*#__PURE__*/React.createElement("tr",{key:r.id,className:`hover:bg-slate-50 ${selectedReceives.has(r.id)?'bg-purple-50':''}`},/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:selectedReceives.has(r.id),onChange:()=>toggleReceiveSelection(r.id),className:"w-4 h-4 rounded"})),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 font-medium"},r.poNo),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3"},r.vendor),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center text-sm"},r.delivery?r.delivery.replace(/^(\d{4}-\d{2}-\d{2})[\-T](\d{2}:\d{2}).*/,'$1 $2'):'-'),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center text-sm"},r.migo?convertToKoreaTime(r.migo):'-'),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center"},r.cycleMin?`${r.cycleMin}분`:'-'),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-xs ${r.status==='completed'?'bg-emerald-100 text-blue-600':r.status==='paused'?'bg-orange-100 text-orange-600':r.status==='in-progress'?'bg-blue-100 text-blue-700':'bg-gray-100 text-gray-700'}`},r.status==='completed'?'완료':r.status==='paused'?'일시정지':r.status==='in-progress'?'진행중':'대기')),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-left max-w-xs"},/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full px-2 py-1 text-xs border border-gray-200 rounded hover:border-purple-400 focus:border-purple-500 focus:outline-none",placeholder:"\uBA54\uBAA8 \uC785\uB825...",value:r.comments||'',onChange:e=>{const newComments=e.target.value;setReceiveCycles(prev=>prev.map(item=>item.id===r.id?{...item,comments:newComments}:item));}})),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-center"},/*#__PURE__*/React.createElement("div",{className:"flex gap-1 justify-center"},r.status==='waiting'&&/*#__PURE__*/React.createElement("button",{onClick:()=>startReceive(r.id),className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 flex items-center gap-1"},/*#__PURE__*/React.createElement(Play,{className:"w-3 h-3"})," \uC2DC\uC791"),r.status==='in-progress'&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("button",{onClick:()=>pauseReceive(r.id),className:"px-2 py-1 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 flex items-center gap-1"},/*#__PURE__*/React.createElement(Pause,{className:"w-3 h-3"})," \uC77C\uC2DC\uC815\uC9C0"),/*#__PURE__*/React.createElement("button",{onClick:()=>completeReceive(r.id),className:"px-2 py-1 bg-emerald-600 text-white text-xs rounded hover:bg-emerald-700"},"MIGO \uC644\uB8CC")),r.status==='paused'&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("button",{onClick:()=>resumeReceive(r.id),className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 flex items-center gap-1"},/*#__PURE__*/React.createElement(Play,{className:"w-3 h-3"})," \uC7AC\uAC1C"),/*#__PURE__*/React.createElement("button",{onClick:()=>completeReceive(r.id),className:"px-2 py-1 bg-emerald-600 text-white text-xs rounded hover:bg-emerald-700"},"MIGO \uC644\uB8CC")),/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingReceive({...r}),className:"px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600"},"\u270F\uFE0F"))))))))),activeTab==='weight'&&/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold mb-4 flex items-center gap-2"},/*#__PURE__*/React.createElement(Scale,{className:"w-5 h-5"})," \uBAA8\uB378\uBCC4 BOM \uBB34\uAC8C (\uC2E4\uC81C \uACC4\uC0B0\uAC12)"),/*#__PURE__*/React.createElement("div",{className:"mb-4"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mb-2 font-medium"},"Maxwell 48 \uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 gap-3"},Object.entries(MODEL_WEIGHTS).filter(([_,d])=>d.series==='48').map(([model,data])=>/*#__PURE__*/React.createElement("div",{key:model,className:"bg-emerald-50 rounded-lg p-3 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},data.code),/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700"},data.name)),/*#__PURE__*/React.createElement("div",{className:"text-right"},/*#__PURE__*/React.createElement("p",{className:"text-lg font-bold text-emerald-600"},data.avgWeight," kg"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"BOM ",data.bomItems,"\uAC1C")))))),/*#__PURE__*/React.createElement("div",{className:"mb-4"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mb-2 font-medium"},"Maxwell 16 \uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-3"},Object.entries(MODEL_WEIGHTS).filter(([_,d])=>d.series==='16').map(([model,data])=>/*#__PURE__*/React.createElement("div",{key:model,className:"bg-blue-50 rounded-lg p-3 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},data.code),/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700"},data.name)),/*#__PURE__*/React.createElement("div",{className:"text-right"},/*#__PURE__*/React.createElement("p",{className:"text-lg font-bold text-blue-600"},data.avgWeight," kg"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"BOM ",data.bomItems,"\uAC1C")))))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mb-2 font-medium"},"HSM \uC2DC\uB9AC\uC988"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-3"},Object.entries(MODEL_WEIGHTS).filter(([_,d])=>d.series==='HSM').map(([model,data])=>/*#__PURE__*/React.createElement("div",{key:model,className:"bg-orange-50 rounded-lg p-3 flex items-center justify-between"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},data.code),/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700"},data.name)),/*#__PURE__*/React.createElement("div",{className:"text-right"},/*#__PURE__*/React.createElement("p",{className:"text-lg font-bold text-orange-600"},data.avgWeight," kg"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"BOM ",data.bomItems,"\uAC1C"))))))),/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h2",{className:"text-lg font-semibold"},"Material\uBCC4 \uBB34\uAC8C \uC815\uBCF4"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},Object.keys(weightData).length,"\uAC1C Material \uB4F1\uB85D\uB428")),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("div",{className:"relative group"},/*#__PURE__*/React.createElement("label",{className:"flex items-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 cursor-pointer"},/*#__PURE__*/React.createElement(Upload,{className:"w-4 h-4"})," \uC5D1\uC140 \uB300\uB7C9 \uC5C5\uB85C\uB4DC",/*#__PURE__*/React.createElement("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:handleWeightExcelUpload,className:"hidden"})),/*#__PURE__*/React.createElement("div",{className:"absolute right-0 top-full mt-2 w-72 p-3 bg-gray-800 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity z-50 pointer-events-none"},/*#__PURE__*/React.createElement("p",{className:"font-bold mb-2"},"\uD83D\uDCCB \uC5D1\uC140 \uD615\uC2DD \uAC00\uC774\uB4DC"),/*#__PURE__*/React.createElement("p",{className:"mb-1"},"\uD544\uC218 \uCEEC\uB7FC: Material (\uD488\uBC88)"),/*#__PURE__*/React.createElement("p",{className:"mb-1"},"\uC120\uD0DD \uCEEC\uB7FC: Description, Net Weight (g), Storage Bin"),/*#__PURE__*/React.createElement("p",{className:"text-gray-300 mt-2"},"* \uBB34\uAC8C\uB294 g \uB2E8\uC704\uB85C \uC785\uB825 \uAD8C\uC7A5"),/*#__PURE__*/React.createElement("p",{className:"text-gray-300"},"* \uAE30\uC874 Material\uC740 \uC5C5\uB370\uC774\uD2B8\uB428"))),/*#__PURE__*/React.createElement("button",{onClick:exportWeightData,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"})," \uC5D1\uC140 \uB0B4\uBCF4\uB0B4\uAE30"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowWeightModal(true),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700"},/*#__PURE__*/React.createElement(Plus,{className:"w-4 h-4"})," \uC2E0\uADDC Material \uCD94\uAC00"))),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-4"},/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap items-center gap-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement(Search,{className:"w-4 h-4 text-gray-400"}),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"Material / Description \uAC80\uC0C9...",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:"border rounded-lg px-3 py-2 text-sm w-64"})),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},"\uC815\uB82C:"),/*#__PURE__*/React.createElement("select",{value:weightSortBy,onChange:e=>setWeightSortBy(e.target.value),className:"border rounded-lg px-3 py-2 text-sm"},/*#__PURE__*/React.createElement("option",{value:"bin"},"Bin"),/*#__PURE__*/React.createElement("option",{value:"material"},"Material"),/*#__PURE__*/React.createElement("option",{value:"description"},"Description"),/*#__PURE__*/React.createElement("option",{value:"weight"},"\uBB34\uAC8C")),/*#__PURE__*/React.createElement("button",{onClick:()=>setWeightSortOrder(prev=>prev==='asc'?'desc':'asc'),className:"border rounded-lg px-3 py-2 text-sm hover:bg-gray-50"},weightSortOrder==='asc'?'↑ 오름차순':'↓ 내림차순')),/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-500"},Object.entries(weightData).filter(([m,info])=>!searchTerm||m.toLowerCase().includes(searchTerm.toLowerCase())||info.d&&info.d.toLowerCase().includes(searchTerm.toLowerCase())).length,"\uAC1C \uD45C\uC2DC"),/*#__PURE__*/React.createElement("button",{onClick:()=>{if(confirm('무게 데이터를 초기값으로 리셋하시겠습니까?')){setWeightData(DEFAULT_WEIGHT_DATA);}},className:"ml-auto text-sm text-gray-500 hover:text-red-600"},"\uCD08\uAE30\uAC12\uC73C\uB85C \uB9AC\uC14B"))),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto max-h-[500px]"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-50 sticky top-0"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-3 text-left cursor-pointer hover:bg-slate-100",onClick:()=>{setWeightSortBy('material');setWeightSortOrder(prev=>weightSortBy==='material'?prev==='asc'?'desc':'asc':'asc');}},"Material ",weightSortBy==='material'&&(weightSortOrder==='asc'?'↑':'↓')),/*#__PURE__*/React.createElement("th",{className:"px-3 py-3 text-left cursor-pointer hover:bg-slate-100",onClick:()=>{setWeightSortBy('description');setWeightSortOrder(prev=>weightSortBy==='description'?prev==='asc'?'desc':'asc':'asc');}},"Description ",weightSortBy==='description'&&(weightSortOrder==='asc'?'↑':'↓')),/*#__PURE__*/React.createElement("th",{className:"px-3 py-3 text-center cursor-pointer hover:bg-slate-100",onClick:()=>{setWeightSortBy('bin');setWeightSortOrder(prev=>weightSortBy==='bin'?prev==='asc'?'desc':'asc':'asc');}},"Bin ",weightSortBy==='bin'&&(weightSortOrder==='asc'?'↑':'↓')),/*#__PURE__*/React.createElement("th",{className:"px-3 py-3 text-center"},"\uBB34\uAC8C (g)"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-3 text-center cursor-pointer hover:bg-slate-100",onClick:()=>{setWeightSortBy('weight');setWeightSortOrder(prev=>weightSortBy==='weight'?prev==='asc'?'desc':'asc':'asc');}},"\uBB34\uAC8C (kg) ",weightSortBy==='weight'&&(weightSortOrder==='asc'?'↑':'↓')),/*#__PURE__*/React.createElement("th",{className:"px-3 py-3 text-center"},"\uD604\uC7AC \uC7AC\uACE0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-3 text-center"},"\uCD1D \uBB34\uAC8C"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-3 text-center"},"\uC561\uC158"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},Object.entries(weightData).filter(([material,info])=>!searchTerm||material.toLowerCase().includes(searchTerm.toLowerCase())||info.d&&info.d.toLowerCase().includes(searchTerm.toLowerCase())).sort(([aMat,aInfo],[bMat,bInfo])=>{let aVal,bVal;switch(weightSortBy){case'bin':aVal=aInfo.b||'';bVal=bInfo.b||'';break;case'material':aVal=aMat||'';bVal=bMat||'';break;case'description':aVal=aInfo.d||'';bVal=bInfo.d||'';break;case'weight':aVal=aInfo.w||0;bVal=bInfo.w||0;break;default:aVal=aInfo.b||'';bVal=bInfo.b||'';}if(typeof aVal==='number'){return weightSortOrder==='asc'?aVal-bVal:bVal-aVal;}return weightSortOrder==='asc'?aVal.localeCompare(bVal):bVal.localeCompare(aVal);}).slice(0,200).map(([material,info])=>{const invItem=inventoryData.find(i=>i.material===material);const stock=invItem?.stock||0;const totalWeight=stock*(info.w||0);const isEditing=editingWeight===material;return/*#__PURE__*/React.createElement("tr",{key:material,className:"hover:bg-slate-50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-mono text-xs"},material),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},isEditing?/*#__PURE__*/React.createElement("input",{type:"text",value:info.d||'',onChange:e=>updateWeight(material,'d',e.target.value),className:"border rounded px-2 py-1 text-xs w-full"}):/*#__PURE__*/React.createElement("span",{className:"text-xs"},info.d||'-')),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},isEditing?/*#__PURE__*/React.createElement("input",{type:"text",value:info.b||'',onChange:e=>updateWeight(material,'b',e.target.value),className:"border rounded px-2 py-1 text-xs w-20 text-center"}):/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-indigo-50 text-indigo-700 rounded text-xs"},info.b||'-')),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},isEditing?/*#__PURE__*/React.createElement("input",{type:"number",step:"0.1",value:((info.w||0)*1000).toFixed(1),onChange:e=>updateWeight(material,'w',parseFloat(e.target.value)/1000),className:"border rounded px-2 py-1 text-xs w-20 text-center"}):((info.w||0)*1000).toFixed(1)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center text-xs text-gray-500"},(info.w||0).toFixed(4)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center font-medium"},stock>0?stock.toLocaleString():'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},totalWeight>0?`${totalWeight.toFixed(2)} kg`:'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},isEditing?/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingWeight(null),className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded"},/*#__PURE__*/React.createElement(Check,{className:"w-4 h-4"})):/*#__PURE__*/React.createElement("div",{className:"flex gap-1 justify-center"},/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingWeight(material),className:"p-1 text-indigo-600 hover:bg-indigo-50 rounded"},/*#__PURE__*/React.createElement(Edit2,{className:"w-4 h-4"})),/*#__PURE__*/React.createElement("button",{onClick:()=>deleteMaterial(material),className:"p-1 text-red-500 hover:bg-red-50 rounded"},/*#__PURE__*/React.createElement(X,{className:"w-4 h-4"})))));})))))),activeTab==='temphumidity'&&/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h2",{className:"text-lg font-semibold flex items-center gap-2"},/*#__PURE__*/React.createElement(Thermometer,{className:"w-5 h-5 text-red-500"}),"\uC628\uC2B5\uB3C4 \uAD00\uB9AC (ESD Check Sheet)")),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("input",{type:"month",value:tempHumidityMonth,onChange:e=>setTempHumidityMonth(e.target.value),className:"border rounded-lg px-3 py-2 text-sm"}),/*#__PURE__*/React.createElement("button",{type:"button",onClick:()=>setTempHumidityMonth(new Date().toISOString().slice(0,7)),className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm",title:"\uC624\uB298 \uB0A0\uC9DC\uB85C \uC774\uB3D9"},"\uC624\uB298"),/*#__PURE__*/React.createElement("button",{type:"button",onClick:()=>setShowTempHumidityExportModal(true),className:"flex items-center gap-2 px-3 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"}),"Excel"),/*#__PURE__*/React.createElement("button",{type:"button",onClick:e=>{e.stopPropagation();e.preventDefault();generateTempHumidityPDF();},className:"flex items-center gap-2 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm"},/*#__PURE__*/React.createElement(Printer,{className:"w-4 h-4"}),"\uBB38\uC11C \uCD9C\uB825"))),/*#__PURE__*/React.createElement("div",{className:"mt-4 flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-600"},"Recorded by:"),/*#__PURE__*/React.createElement("input",{type:"text",value:tempHumidityRecorder,onChange:e=>setTempHumidityRecorder(e.target.value),className:"border rounded px-2 py-1 text-sm w-32",placeholder:"\uC774\uB984"}))),/*#__PURE__*/React.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4"},/*#__PURE__*/React.createElement("h3",{className:"font-medium text-blue-800 mb-2"},"\uD83D\uDCCB \uC628\uC2B5\uB3C4 \uAD00\uB9AC \uAE30\uC900 (NS-205B)"),/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap items-center gap-6 text-sm"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded"},"\uC628\uB3C4"),/*#__PURE__*/React.createElement("span",null,"+5 ~ 40\u2103")),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-cyan-100 text-cyan-700 rounded"},"\uC2B5\uB3C4"),/*#__PURE__*/React.createElement("span",null,"0 ~ 75%"))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mt-2"},"Equipment & Tool: NS-205B / Check method: write down the digit")),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold mb-4"},"\uD83D\uDCCA ",parseInt(tempHumidityMonth.split('-')[1]),"\uC6D4 \uD1B5\uACC4"),(()=>{const[year,month]=tempHumidityMonth.split('-').map(Number);const daysInMonth=new Date(year,month,0).getDate();// 영업일 수 계산 (주말 + 공휴일 제외)
let workdays=0;for(let d=1;d<=daysInMonth;d++){const dt=new Date(year,month-1,d);const dow=dt.getDay();const dk=`${tempHumidityMonth}-${String(d).padStart(2,'0')}`;if(dow!==0&&dow!==6&&!KR_HOLIDAYS.has(dk))workdays++;}let tempSum=0,humidSum=0,count=0;let tempMin=Infinity,tempMax=-Infinity;let humidMin=Infinity,humidMax=-Infinity;for(let day=1;day<=daysInMonth;day++){const dateKey=`${tempHumidityMonth}-${String(day).padStart(2,'0')}`;const data=tempHumidityData[dateKey];if(data&&data.temp&&data.humidity){const t=parseFloat(data.temp);const h=parseFloat(data.humidity);if(!isNaN(t)&&!isNaN(h)){tempSum+=t;humidSum+=h;count++;tempMin=Math.min(tempMin,t);tempMax=Math.max(tempMax,t);humidMin=Math.min(humidMin,h);humidMax=Math.max(humidMax,h);}}}const avgTemp=count>0?(tempSum/count).toFixed(1):'-';const avgHumid=count>0?(humidSum/count).toFixed(1):'-';return/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"},/*#__PURE__*/React.createElement("div",{className:"bg-red-50 rounded-lg p-4 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-red-600"},"\uD3C9\uADE0 \uC628\uB3C4"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-red-700"},avgTemp,"\u2103"),count>0&&/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},tempMin.toFixed(1),"~",tempMax.toFixed(1),"\u2103")),/*#__PURE__*/React.createElement("div",{className:"bg-cyan-50 rounded-lg p-4 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-cyan-600"},"\uD3C9\uADE0 \uC2B5\uB3C4"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-cyan-700"},avgHumid,"%"),count>0&&/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},humidMin.toFixed(1),"~",humidMax.toFixed(1),"%")),/*#__PURE__*/React.createElement("div",{className:"bg-green-50 rounded-lg p-4 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-green-600"},"\uAE30\uB85D\uC77C\uC218"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-green-700"},count,"\uC77C"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"/ ",workdays,"\uC77C (\uC601\uC5C5\uC77C)")),/*#__PURE__*/React.createElement("div",{className:"bg-purple-50 rounded-lg p-4 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-purple-600"},"\uC785\uB825\uB960"),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-purple-700"},workdays>0?Math.round(count/workdays*100):0,"%")));})()),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold mb-4 flex items-center gap-2"},/*#__PURE__*/React.createElement(TrendingUp,{className:"w-5 h-5 text-blue-500"}),"Temp & Humidity Trend"),/*#__PURE__*/React.createElement("div",{className:"h-96"},/*#__PURE__*/React.createElement(ResponsiveContainer,{width:"100%",height:"100%"},/*#__PURE__*/React.createElement(ScatterChart,{margin:{top:20,right:60,bottom:20,left:20}},/*#__PURE__*/React.createElement(CartesianGrid,{strokeDasharray:"3 3"}),/*#__PURE__*/React.createElement(XAxis,{dataKey:"date",type:"category",allowDuplicatedCategory:false,tick:{fontSize:10},tickFormatter:value=>{const d=new Date(value);return`${d.getFullYear()}년 ${d.getMonth()+1}월`;},interval:60}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"temp",domain:[15,50],ticks:[15,20,25,30,35,40,45,50],tick:{fontSize:10},label:{value:'Temp.',angle:-90,position:'insideLeft',fontSize:12,fill:'#0369a1'},stroke:"#0369a1"}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"humidity",orientation:"right",domain:[0,70],ticks:[0,10,20,30,40,50,60,70],tick:{fontSize:10},label:{value:'Humidity',angle:90,position:'insideRight',fontSize:12,fill:'#ea580c'},stroke:"#ea580c"}),/*#__PURE__*/React.createElement(Tooltip,{content:({active,payload})=>{if(active&&payload&&payload.length){const data=payload[0].payload;return/*#__PURE__*/React.createElement("div",{className:"bg-white p-2 border rounded shadow text-xs"},/*#__PURE__*/React.createElement("p",{className:"font-medium"},data.date),/*#__PURE__*/React.createElement("p",{className:"text-sky-700"},"\uC628\uB3C4: ",data.temp,"\u2103"),/*#__PURE__*/React.createElement("p",{className:"text-orange-600"},"\uC2B5\uB3C4: ",data.humidity,"%"));}return null;}}),/*#__PURE__*/React.createElement(Scatter,{yAxisId:"temp",name:"Temperature",data:Object.entries(tempHumidityData).filter(([_,v])=>v.temp).map(([date,v])=>({date,temp:parseFloat(v.temp),humidity:parseFloat(v.humidity)})).sort((a,b)=>a.date.localeCompare(b.date)),fill:"#0369a1",dataKey:"temp",shape:props=>{const{cx,cy}=props;return/*#__PURE__*/React.createElement("circle",{cx:cx,cy:cy,r:3,fill:"#0369a1"});}}),/*#__PURE__*/React.createElement(Scatter,{yAxisId:"humidity",name:"Humidity",data:Object.entries(tempHumidityData).filter(([_,v])=>v.humidity).map(([date,v])=>({date,temp:parseFloat(v.temp),humidity:parseFloat(v.humidity)})).sort((a,b)=>a.date.localeCompare(b.date)),fill:"#ea580c",dataKey:"humidity",shape:props=>{const{cx,cy}=props;return/*#__PURE__*/React.createElement("circle",{cx:cx,cy:cy,r:3,fill:"#ea580c"});}})))),/*#__PURE__*/React.createElement("div",{className:"mt-2 flex items-center justify-center gap-6 text-xs text-gray-500"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 bg-sky-700 rounded-full"})," Temperature (\uC88C\uCD95, \u2103)"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 bg-orange-600 rounded-full"})," Humidity (\uC6B0\uCD95, %)"))),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden"},/*#__PURE__*/React.createElement("div",{className:"p-4 border-b bg-gray-50"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold"},tempHumidityMonth.split('-')[0],"\uB144 ",parseInt(tempHumidityMonth.split('-')[1]),"\uC6D4 \uC628\uC2B5\uB3C4 \uAE30\uB85D")),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-100"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center w-16"},"Day"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center w-24"},"\uC694\uC77C"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center w-32"},"Temp (\u2103)"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center w-32"},"Humidity (%)"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uC0C1\uD0DC"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},(()=>{const[year,month]=tempHumidityMonth.split('-').map(Number);const daysInMonth=new Date(year,month,0).getDate();const weekdays=['일','월','화','수','목','금','토'];return Array.from({length:daysInMonth},(_,i)=>{const day=i+1;const dateKey=`${tempHumidityMonth}-${String(day).padStart(2,'0')}`;const dayOfWeek=new Date(year,month-1,day).getDay();const isWeekend=dayOfWeek===0||dayOfWeek===6;const isHoliday=KR_HOLIDAYS.has(dateKey);const isOff=isWeekend||isHoliday;const data=tempHumidityData[dateKey]||{temp:'',humidity:''};// 온습도 상태 체크 (회사 기준: Temp +5~40℃, Humidity 0~75%)
const tempNum=parseFloat(data.temp);const humidNum=parseFloat(data.humidity);const tempOk=!isNaN(tempNum)&&tempNum>=5&&tempNum<=40;const humidOk=!isNaN(humidNum)&&humidNum>=0&&humidNum<=75;const hasData=data.temp||data.humidity;return/*#__PURE__*/React.createElement("tr",{key:day,className:`${isOff?'bg-gray-50':''} hover:bg-blue-50`},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center font-medium"},day),/*#__PURE__*/React.createElement("td",{className:`px-3 py-2 text-center ${dayOfWeek===0||isHoliday?'text-red-500':dayOfWeek===6?'text-blue-500':''}`},weekdays[dayOfWeek]),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},/*#__PURE__*/React.createElement("input",{type:"number",step:"0.1",placeholder:"-",className:`w-full border rounded px-2 py-1 text-center ${hasData&&!isNaN(tempNum)?tempOk?'bg-green-50 border-green-300':'bg-red-50 border-red-300':''}`,value:data.temp,onChange:e=>{setTempHumidityData(prev=>({...prev,[dateKey]:{...prev[dateKey],temp:e.target.value}}));}})),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},/*#__PURE__*/React.createElement("input",{type:"number",step:"0.1",placeholder:"-",className:`w-full border rounded px-2 py-1 text-center ${hasData&&!isNaN(humidNum)?humidOk?'bg-green-50 border-green-300':'bg-red-50 border-red-300':''}`,value:data.humidity,onChange:e=>{setTempHumidityData(prev=>({...prev,[dateKey]:{...prev[dateKey],humidity:e.target.value}}));}})),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},hasData?tempOk&&humidOk?/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs"},"\uC815\uC0C1"):/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded text-xs"},!tempOk&&!humidOk?'온도/습도 이상':!tempOk?'온도 이상':'습도 이상'):isOff?/*#__PURE__*/React.createElement("span",{className:"text-gray-400 text-xs"},isHoliday&&!isWeekend?'공휴일':'주말'):/*#__PURE__*/React.createElement("span",{className:"text-gray-400 text-xs"},"\uBBF8\uC785\uB825")));});})()))))),activeTab==='kpi'&&/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl shadow-lg p-6 text-white"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h2",{className:"text-2xl font-bold flex items-center gap-2"},"\uD83D\uDCCA KPI Dashboard"),/*#__PURE__*/React.createElement("p",{className:"text-indigo-200 mt-1"},"\uC6D4\uAC04 \uC131\uACFC \uC9C0\uD45C \uAD00\uB9AC")),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 flex-wrap justify-end"},/*#__PURE__*/React.createElement("label",{className:"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 rounded-lg transition cursor-pointer text-white text-sm font-medium"},/*#__PURE__*/React.createElement(FileSpreadsheet,{className:"w-4 h-4"}),"GR Cancel \uC5C5\uB85C\uB4DC",/*#__PURE__*/React.createElement("input",{type:"file",accept:".xlsx,.xls",className:"hidden",onChange:e=>{const file=e.target.files?.[0];if(file)parseGRCancelExcel(file);e.target.value='';}})),/*#__PURE__*/React.createElement("label",{className:"flex items-center gap-2 px-4 py-2 bg-violet-500 hover:bg-violet-600 rounded-lg transition cursor-pointer text-white text-sm font-medium"},/*#__PURE__*/React.createElement(FileSpreadsheet,{className:"w-4 h-4"}),"\uC7AC\uACE0\uC190\uC2E4\uC728 \uC5C5\uB85C\uB4DC",/*#__PURE__*/React.createElement("input",{type:"file",accept:".xlsx,.xls",className:"hidden",onChange:e=>{const file=e.target.files?.[0];if(file)parseInventoryLossExcel(file);e.target.value='';}})),/*#__PURE__*/React.createElement("button",{onClick:()=>{setKpiData({grCancel:DEFAULT_GR_CANCEL_DATA,grCancelQty:{},inventoryAdjust:{}});setGrCancelUploadStatus(null);setGrCancelUploadMsg('');setInventoryLossUploadStatus(null);setInventoryLossUploadMsg('');showToast('KPI 데이터가 초기화되었습니다.','success');},className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 rounded-lg transition"},/*#__PURE__*/React.createElement(RefreshCw,{className:"w-4 h-4"}),"\uB9AC\uC14B"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowKpiInputModal(true),className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition"},/*#__PURE__*/React.createElement(Plus,{className:"w-5 h-5"}),"\uC218\uB3D9 \uC785\uB825")))),/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-gray-600"},"\uC5F0\uB3C4 \uC120\uD0DD:"),[2024,2025,2026].map(year=>/*#__PURE__*/React.createElement("button",{key:year,onClick:()=>setKpiSelectedYear(year),className:`px-4 py-2 rounded-lg font-medium transition ${kpiSelectedYear===year?'bg-indigo-600 text-white':darkMode?'bg-gray-700 text-gray-300 hover:bg-gray-600':'bg-gray-100 text-gray-700 hover:bg-gray-200'}`},year,"\uB144"))),/*#__PURE__*/React.createElement("div",{className:"flex flex-col gap-1 text-sm"},/*#__PURE__*/React.createElement("span",{className:"text-gray-500"},"GR Cancel: ",Object.keys(kpiData.grCancel).length,"\uAC1C\uC6D4 / GR Qty: ",Object.keys(kpiData.grCancelQty).length,"\uAC1C\uC6D4 \uB85C\uB4DC\uB428"),grCancelUploadMsg&&/*#__PURE__*/React.createElement("span",{className:`text-xs px-2 py-1 rounded ${grCancelUploadStatus==='success'?'bg-blue-50 text-blue-700':grCancelUploadStatus==='error'?'bg-red-50 text-red-700':'bg-gray-50 text-gray-500'}`},grCancelUploadMsg),inventoryLossUploadMsg&&/*#__PURE__*/React.createElement("span",{className:`text-xs px-2 py-1 rounded ${inventoryLossUploadStatus==='success'?'bg-violet-50 text-violet-700':inventoryLossUploadStatus==='error'?'bg-red-50 text-red-700':'bg-gray-50 text-gray-500'}`},inventoryLossUploadMsg))),(()=>{const selectedYear=kpiSelectedYear;const currentMonth=new Date().getMonth()+1;const isCurrentYear=selectedYear===new Date().getFullYear();// 선택된 연도 데이터 집계
const yearMonths=Array.from({length:12},(_,i)=>`${selectedYear}-${String(i+1).padStart(2,'0')}`);// GR Cancel 평균
const grCancelValues=yearMonths.map(m=>kpiData.grCancel[m]).filter(v=>v!==undefined);const grCancelAvg=grCancelValues.length>0?grCancelValues.reduce((a,b)=>a+b,0)/grCancelValues.length:null;const grCancelScore=calculateKpiScore('grCancel',grCancelAvg);// Inventory Adjust 평균
const invAdjustValues=yearMonths.map(m=>kpiData.inventoryAdjust[m]).filter(v=>v!==undefined);const invAdjustAvg=invAdjustValues.length>0?invAdjustValues.reduce((a,b)=>a+b,0)/invAdjustValues.length:null;const invAdjustScore=calculateKpiScore('inventoryAdjust',invAdjustAvg);// Kitting Lead Time 평균 (자동 집계)
const kittingLTByMonth={};kittingData.filter(k=>k.status==='completed'&&k.leadTimeDays).forEach(k=>{const month=k.completedAt?.slice(0,7);if(month&&month.startsWith(String(selectedYear))){if(!kittingLTByMonth[month])kittingLTByMonth[month]=[];kittingLTByMonth[month].push(k.leadTimeDays);}});const kittingLTValues=Object.values(kittingLTByMonth).map(arr=>arr.reduce((a,b)=>a+b,0)/arr.length);const kittingLTAvg=kittingLTValues.length>0?kittingLTValues.reduce((a,b)=>a+b,0)/kittingLTValues.length:null;const kittingLTScore=calculateKpiScore('kittingLeadTime',kittingLTAvg);// Kitting Cycle Time 월별 집계
const kittingCTByMonth={};pickCycles.filter(p=>p.status==='completed'&&p.cycleMin).forEach(p=>{const month=p.completed?.slice(0,7);if(month&&month.startsWith(String(selectedYear))){if(!kittingCTByMonth[month])kittingCTByMonth[month]=[];kittingCTByMonth[month].push(p.cycleMin);}});const kittingCTValues=Object.values(kittingCTByMonth).map(arr=>arr.reduce((a,b)=>a+b,0)/arr.length);const kittingCTAvg=kittingCTValues.length>0?kittingCTValues.reduce((a,b)=>a+b,0)/kittingCTValues.length:null;// 입고 Cycle Time 월별 집계 (migo 날짜 기준)
const receiveCTByMonth={};receiveCycles.filter(r=>r.status==='completed'&&r.cycleMin).forEach(r=>{const month=r.migo?.slice(0,7);if(month&&month.startsWith(String(selectedYear))){if(!receiveCTByMonth[month])receiveCTByMonth[month]=[];receiveCTByMonth[month].push(r.cycleMin);}});const receiveCTValues=Object.values(receiveCTByMonth).map(arr=>arr.reduce((a,b)=>a+b,0)/arr.length);const receiveCTAvg=receiveCTValues.length>0?receiveCTValues.reduce((a,b)=>a+b,0)/receiveCTValues.length:null;const getScoreColor=score=>{if(score===null)return'bg-gray-100 text-gray-500';if(score>=80)return'bg-emerald-100 text-emerald-700 border-emerald-300';if(score>=60)return'bg-amber-100 text-amber-700 border-amber-300';return'bg-red-100 text-red-700 border-red-300';};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4"},/*#__PURE__*/React.createElement("div",{className:`rounded-xl p-5 border-2 ${getScoreColor(grCancelScore)}`},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium"},"GR Cancel"),grCancelScore!==null&&/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${grCancelScore>=80?'bg-emerald-500 text-white':grCancelScore>=60?'bg-amber-500 text-white':'bg-red-500 text-white'}`},grCancelScore,"\uC810")),/*#__PURE__*/React.createElement("p",{className:"text-3xl font-bold"},grCancelAvg!==null?grCancelAvg.toFixed(1):'-',/*#__PURE__*/React.createElement("span",{className:"text-lg font-normal ml-1"},"\uAC74/\uC6D4")),(()=>{const totalQty=yearMonths.reduce((s,m)=>s+(kpiData.grCancelQty[m]||0),0);const totalCancel=yearMonths.reduce((s,m)=>s+(kpiData.grCancel[m]||0),0);const rateVals=yearMonths.filter(m=>kpiData.grCancelQty[m]&&kpiData.grCancel[m]!==undefined).map(m=>kpiData.grCancel[m]/kpiData.grCancelQty[m]*100);const avgRate=rateVals.length>0?rateVals.reduce((a,b)=>a+b,0)/rateVals.length:null;return/*#__PURE__*/React.createElement(React.Fragment,null,totalQty>0&&/*#__PURE__*/React.createElement("p",{className:"text-xs mt-1 opacity-80"},"\uC785\uACE0: ",totalQty,"\uAC74 / Cancel: ",totalCancel,"\uAC74"),avgRate!==null&&/*#__PURE__*/React.createElement("p",{className:"text-sm font-semibold mt-0.5 opacity-80"},"\uCDE8\uC18C\uC728: ",avgRate.toFixed(3),"% \uD3C9\uADE0"));})(),/*#__PURE__*/React.createElement("p",{className:"text-xs mt-1 opacity-70"},"\uBAA9\uD45C: 2\uAC74 \uC774\uD558 (80\uC810)"),/*#__PURE__*/React.createElement("p",{className:"text-xs opacity-50"},selectedYear,"\uB144 ",grCancelValues.length,"\uAC1C\uC6D4 \uD3C9\uADE0")),/*#__PURE__*/React.createElement("div",{className:`rounded-xl p-5 border-2 ${getScoreColor(invAdjustScore)}`},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium"},"\uC7AC\uACE0 \uC190\uC2E4\uC728"),invAdjustScore!==null&&/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${invAdjustScore>=80?'bg-emerald-500 text-white':invAdjustScore>=60?'bg-amber-500 text-white':'bg-red-500 text-white'}`},invAdjustScore,"\uC810")),/*#__PURE__*/React.createElement("p",{className:"text-3xl font-bold"},invAdjustAvg!==null?invAdjustAvg.toFixed(3):'-',/*#__PURE__*/React.createElement("span",{className:"text-lg font-normal ml-1"},"%")),/*#__PURE__*/React.createElement("p",{className:"text-xs mt-2 opacity-70"},"\uBAA9\uD45C: 0.064% \uC774\uD558 (80\uC810)"),/*#__PURE__*/React.createElement("p",{className:"text-xs opacity-50"},selectedYear,"\uB144 ",invAdjustValues.length,"\uAC1C\uC6D4 \uD3C9\uADE0")),/*#__PURE__*/React.createElement("div",{className:`rounded-xl p-5 border-2 ${getScoreColor(kittingLTScore)}`},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium"},"Kitting Lead Time"),kittingLTScore!==null&&/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${kittingLTScore>=80?'bg-emerald-500 text-white':kittingLTScore>=60?'bg-amber-500 text-white':'bg-red-500 text-white'}`},kittingLTScore,"\uC810")),/*#__PURE__*/React.createElement("p",{className:"text-3xl font-bold"},kittingLTAvg!==null?kittingLTAvg.toFixed(1):'-',/*#__PURE__*/React.createElement("span",{className:"text-lg font-normal ml-1"},"\uC77C")),/*#__PURE__*/React.createElement("p",{className:"text-xs mt-2 opacity-70"},"\uBAA9\uD45C: 3\uC77C \uC774\uD558 (80\uC810)"),/*#__PURE__*/React.createElement("p",{className:"text-xs opacity-50"},selectedYear,"\uB144 \uC790\uB3D9 \uC9D1\uACC4")),/*#__PURE__*/React.createElement("div",{className:"rounded-xl p-5 border-2 bg-gray-50 text-gray-600 border-gray-200"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium"},"Kitting Cycle Time"),/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-300 text-gray-600"},"\uBAA9\uD45C \uBBF8\uC815")),/*#__PURE__*/React.createElement("p",{className:"text-3xl font-bold"},kittingCTAvg!==null?kittingCTAvg.toFixed(0):'-',/*#__PURE__*/React.createElement("span",{className:"text-lg font-normal ml-1"},"\uBD84")),/*#__PURE__*/React.createElement("p",{className:"text-xs mt-2 opacity-70"},"\uBAA9\uD45C: \uAC80\uD1A0 \uC911"),/*#__PURE__*/React.createElement("p",{className:"text-xs opacity-50"},selectedYear,"\uB144 \uC790\uB3D9 \uC9D1\uACC4")),/*#__PURE__*/React.createElement("div",{className:"rounded-xl p-5 border-2 bg-gray-50 text-gray-600 border-gray-200"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-2"},/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium"},"\uC785\uACE0 Cycle Time"),/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-300 text-gray-600"},"\uBAA9\uD45C \uBBF8\uC815")),/*#__PURE__*/React.createElement("p",{className:"text-3xl font-bold"},receiveCTAvg!==null?receiveCTAvg.toFixed(0):'-',/*#__PURE__*/React.createElement("span",{className:"text-lg font-normal ml-1"},"\uBD84")),/*#__PURE__*/React.createElement("p",{className:"text-xs mt-2 opacity-70"},"\uBAA9\uD45C: \uAC80\uD1A0 \uC911"),/*#__PURE__*/React.createElement("p",{className:"text-xs opacity-50"},selectedYear,"\uB144 \uC790\uB3D9 \uC9D1\uACC4"))),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold mb-4 flex items-center gap-2"},"\uD83D\uDCC8 ",selectedYear,"\uB144 \uC6D4\uBCC4 KPI \uCD94\uC774"),/*#__PURE__*/React.createElement("div",{className:"mb-8"},/*#__PURE__*/React.createElement("h4",{className:"text-base font-bold text-gray-700 mb-3"},"\uD83D\uDCCA GR Cancel Rate \uC5F0\uB3C4\uBCC4 \uCD94\uC774",Object.keys(kpiData.grCancelQty).length>0&&/*#__PURE__*/React.createElement("span",{className:"ml-2 text-xs text-blue-600 bg-blue-50 px-2 py-0.5 rounded"},"\uD83D\uDCC2 \uC5D1\uC140 \uB370\uC774\uD130 \uBC18\uC601\uB428")),(()=>{// 연도별 확정 데이터 (SUM 시트 기준 - 정적 사용)
// SUM 시트의 연간 합계 컬럼에서 추출한 값
const annualData=[{year:2020,qty:3294,cancel:141},{year:2021,qty:1773,cancel:31},{year:2022,qty:1411,cancel:24},{year:2023,qty:1220,cancel:6},{year:2024,qty:1277,cancel:2},{year:2025,qty:1377,cancel:5}];const maxRate=Math.max(...annualData.map(d=>d.qty>0?d.cancel/d.qty*100:0));return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-6 gap-3"},annualData.map(d=>{const rate=d.qty>0?d.cancel/d.qty*100:0;return/*#__PURE__*/React.createElement("div",{key:d.year,className:"bg-gray-50 rounded-lg p-3 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mb-1"},d.year),/*#__PURE__*/React.createElement("p",{className:`text-lg font-bold ${rate<=0.5?'text-emerald-600':rate<=2?'text-amber-600':'text-red-600'}`},rate.toFixed(2),"%"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mt-1"},d.cancel,"/",d.qty,"\uAC74"));})),/*#__PURE__*/React.createElement("div",{className:"mt-3 flex items-end gap-1 h-16"},annualData.map((d,i)=>{const rate=d.qty>0?d.cancel/d.qty*100:0;return/*#__PURE__*/React.createElement("div",{key:i,className:"flex-1 flex flex-col items-center"},/*#__PURE__*/React.createElement("div",{className:`w-full rounded-t ${rate<=0.5?'bg-emerald-500':rate<=2?'bg-amber-500':'bg-red-500'}`,style:{height:`${maxRate>0?rate/maxRate*100:0}%`}}),/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400 mt-1"},String(d.year).slice(2)));})));})()),(()=>{const grChartData=yearMonths.map((month,idx)=>{const qty=kpiData.grCancelQty[month]||null;const cancel=kpiData.grCancel[month]!==undefined?kpiData.grCancel[month]:null;// 월별 취소율 (cancel/qty*100)
const rate=qty&&cancel!==null?parseFloat((cancel/qty*100).toFixed(3)):null;// 누적 취소율
const cumQty=yearMonths.slice(0,idx+1).reduce((s,m)=>s+(kpiData.grCancelQty[m]||0),0);const cumCancel=yearMonths.slice(0,idx+1).reduce((s,m)=>{const v=kpiData.grCancel[m];return s+(v!==undefined?v:0);},0);const cumRate=cumQty>0?parseFloat((cumCancel/cumQty*100).toFixed(3)):null;return{name:`${idx+1}월`,qty,cancel,rate,cumRate};});const hasData=grChartData.some(d=>d.qty!==null);const qtyMax=Math.max(...grChartData.map(d=>d.qty||0),10);const rateMax=Math.max(...grChartData.map(d=>d.cumRate||0),1);// 막대(GR Qty)를 하단 25%로 — 왼쪽 Y축 max = qtyMax * 4
const leftMax=qtyMax*4;const rightMax=parseFloat((rateMax*1.8).toFixed(2))||1;// 연간 요약
const totalQty=yearMonths.reduce((s,m)=>s+(kpiData.grCancelQty[m]||0),0);const totalCancel=yearMonths.reduce((s,m)=>{const v=kpiData.grCancel[m];return s+(v!==undefined?v:0);},0);const finalRate=totalQty>0?totalCancel/totalQty*100:0;return/*#__PURE__*/React.createElement("div",{className:"mb-8"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-2"},/*#__PURE__*/React.createElement("h4",{className:"text-base font-bold text-gray-700"},"GR Cancel - \uC790\uB3D9 \uC9D1\uACC4"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-4 text-xs"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1 text-gray-400"},/*#__PURE__*/React.createElement("span",{className:"inline-block w-3 h-3 rounded bg-blue-400 opacity-70"}),"\uB9C9\uB300 = GR Qty"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1 text-gray-400"},/*#__PURE__*/React.createElement("span",{className:"inline-block w-4 border-t-2 border-violet-500"}),"\uAEBE\uC740\uC120 = \uB204\uC801 \uCDE8\uC18C\uC728(%)"),/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded font-medium ${totalCancel<=2?'bg-emerald-50 text-emerald-700':'bg-red-50 text-red-600'}`},selectedYear," Target: 2\uAC74 | Actual: ",totalCancel,"\uAC74"))),/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mb-3 text-xs"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 rounded"},"Total GR: ",/*#__PURE__*/React.createElement("b",null,totalQty.toLocaleString()),"\uAC74"),/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-orange-50 text-orange-700 rounded"},"Total Cancel: ",/*#__PURE__*/React.createElement("b",null,totalCancel),"\uAC74"),/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded ${finalRate===0?'bg-emerald-50 text-emerald-700':finalRate<=0.5?'bg-amber-50 text-amber-700':'bg-red-50 text-red-600'}`},"Cancel Rate: ",/*#__PURE__*/React.createElement("b",null,finalRate.toFixed(2),"%"))),/*#__PURE__*/React.createElement(ResponsiveContainer,{width:"100%",height:260},/*#__PURE__*/React.createElement(ComposedChart,{data:grChartData,margin:{top:30,right:60,left:5,bottom:5}},/*#__PURE__*/React.createElement(CartesianGrid,{strokeDasharray:"3 3",stroke:"#f3f4f6",vertical:false}),/*#__PURE__*/React.createElement(XAxis,{dataKey:"name",tick:{fontSize:11},axisLine:false,tickLine:false}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"left",orientation:"left",tick:{fontSize:10,fill:'#3b82f6'},domain:[0,leftMax],allowDecimals:false,tickFormatter:v=>v<=qtyMax?v:'',width:30}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"right",orientation:"right",tick:{fontSize:10,fill:'#7c3aed'},domain:[0,rightMax],width:40,tickFormatter:v=>`${v.toFixed(2)}%`}),/*#__PURE__*/React.createElement(Tooltip,{contentStyle:{borderRadius:8,border:'1px solid #e5e7eb',fontSize:12},formatter:(v,name)=>{if(v===null||v===undefined)return['-',name];if(name==='누적 취소율(%)')return[`${v.toFixed(3)}%`,name];return[`${v}건`,name];}}),/*#__PURE__*/React.createElement(Legend,{verticalAlign:"bottom",wrapperStyle:{fontSize:11,paddingTop:8}}),/*#__PURE__*/React.createElement(ReferenceLine,{yAxisId:"left",y:2,stroke:"#10b981",strokeDasharray:"5 3"}),/*#__PURE__*/React.createElement(Bar,{yAxisId:"left",dataKey:"qty",name:"GR Qty",radius:[4,4,0,0],maxBarSize:40,fillOpacity:0.75,label:props=>{const{x,y,width,value}=props;if(!value)return null;return/*#__PURE__*/React.createElement("text",{x:x+width/2,y:y-5,fill:"#1d4ed8",textAnchor:"middle",fontSize:12,fontWeight:700},value,"\uAC74");}},grChartData.map((d,i)=>/*#__PURE__*/React.createElement(Cell,{key:i,fill:!d.qty?'#e5e7eb':'#60a5fa'}))),/*#__PURE__*/React.createElement(Line,{yAxisId:"right",type:"monotone",dataKey:"cumRate",name:"\uB204\uC801 \uCDE8\uC18C\uC728(%)",stroke:"#7c3aed",strokeWidth:3,dot:{r:6,fill:'#fff',stroke:'#7c3aed',strokeWidth:2.5},activeDot:{r:8},label:props=>{const{x,y,value}=props;if(value===null||value===undefined)return null;const text=value.toFixed(2)+'%';const tw=text.length*6+6;return/*#__PURE__*/React.createElement("g",null,/*#__PURE__*/React.createElement("rect",{x:x-tw/2,y:y-26,width:tw,height:15,rx:3,fill:"rgba(124,58,237,0.12)"}),/*#__PURE__*/React.createElement("text",{x:x,y:y-15,fill:"#7c3aed",textAnchor:"middle",fontSize:10,fontWeight:700},text));},connectNulls:false}))));})(),/*#__PURE__*/React.createElement("div",{className:"mb-8"},/*#__PURE__*/React.createElement("h4",{className:"text-base font-bold text-gray-700 mb-3"},"\uC7AC\uACE0 \uC190\uC2E4\uC728 (%)"),/*#__PURE__*/React.createElement("div",{className:"relative h-48 border-b border-l border-gray-300"},/*#__PURE__*/React.createElement("div",{className:"absolute left-0 right-0 border-t-2 border-dashed border-emerald-500",style:{bottom:`${0.064/0.25*100}%`}},/*#__PURE__*/React.createElement("span",{className:"absolute -top-3 right-0 text-xs text-emerald-600 bg-white px-1"},"\uBAA9\uD45C 0.064%")),/*#__PURE__*/React.createElement("div",{className:"absolute -left-10 top-0 text-xs text-gray-400"},"0.25"),/*#__PURE__*/React.createElement("div",{className:"absolute -left-6 bottom-0 text-xs text-gray-400"},"0"),/*#__PURE__*/React.createElement("div",{className:"absolute inset-0 flex items-end justify-around px-2"},yearMonths.map((month,idx)=>{const value=kpiData.inventoryAdjust[month];const height=value!==undefined?value/0.25*100:0;const isPast=selectedYear<new Date().getFullYear()||isCurrentYear&&idx+1<=currentMonth;return/*#__PURE__*/React.createElement("div",{key:month,className:"flex flex-col items-center gap-1 flex-1"},/*#__PURE__*/React.createElement("div",{className:"w-full flex flex-col items-center"},value!==undefined&&/*#__PURE__*/React.createElement("span",{className:"text-xs font-medium mb-1"},value.toFixed(3)),/*#__PURE__*/React.createElement("div",{className:`w-6 rounded-t transition-all ${value===undefined?isPast?'bg-gray-200':'bg-gray-100':value<=0.064?'bg-emerald-500':value<=0.12?'bg-amber-500':'bg-red-500'}`,style:{height:`${Math.max(height,value!==undefined?5:0)}%`}})),/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-400"},idx+1,"\uC6D4"));})))),(()=>{const ltChartData=yearMonths.map((month,idx)=>{const md=kittingLTByMonth[month];const lt=md?parseFloat((md.reduce((a,b)=>a+b,0)/md.length).toFixed(2)):null;const count=md?md.length:null;return{name:`${idx+1}월`,lt,count};});const hasData=ltChartData.some(d=>d.lt!==null);const countMax=Math.max(...ltChartData.map(d=>d.count||0),3);const ltMax=Math.max(...ltChartData.map(d=>d.lt||0),5);// 막대를 하단 25%에 → 왼쪽 Y축 max = countMax * 4
const leftDomainMax=countMax*4;// 꺾은선을 상단 75%에 → 오른쪽 Y축 max에 충분한 여백
const rightDomainMax=Math.ceil(ltMax*1.4/1)+1;return/*#__PURE__*/React.createElement("div",{className:"mb-8"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-2"},/*#__PURE__*/React.createElement("h4",{className:"text-base font-bold text-gray-700"},"Kitting Lead Time - \uC790\uB3D9 \uC9D1\uACC4"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-4 text-xs text-gray-400"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"inline-block w-3 h-3 rounded bg-indigo-400 opacity-70"}),"\uB9C9\uB300 = Order \uAC74\uC218"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"inline-block w-4 border-t-2 border-red-500"}),"\uAEBE\uC740\uC120 = L/T(\uC77C)"),!hasData&&/*#__PURE__*/React.createElement("span",{className:"text-gray-400"},"Kitting L/T \uD0ED \uC644\uB8CC \uAC74\uBD80\uD130 \uC9D1\uACC4"))),(()=>{const totalOrders=Object.values(kittingLTByMonth).reduce((s,arr)=>s+arr.length,0);const allLT=Object.values(kittingLTByMonth).flat();const avgLT=allLT.length>0?allLT.reduce((a,b)=>a+b,0)/allLT.length:null;return/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mb-3 text-xs"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-indigo-50 text-indigo-700 rounded"},"Total Orders: ",/*#__PURE__*/React.createElement("b",null,totalOrders),"\uAC74"),avgLT!==null&&/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded ${avgLT<=3?'bg-emerald-50 text-emerald-700':avgLT<=5?'bg-amber-50 text-amber-700':'bg-red-50 text-red-600'}`},"\uD3C9\uADE0 L/T: ",/*#__PURE__*/React.createElement("b",null,avgLT.toFixed(1)),"\uC77C"),/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded ${avgLT===null?'bg-gray-50 text-gray-400':avgLT<=3?'bg-emerald-50 text-emerald-700':'bg-red-50 text-red-600'}`},"\uBAA9\uD45C: 3\uC77C \uC774\uD558"));})(),/*#__PURE__*/React.createElement(ResponsiveContainer,{width:"100%",height:260},/*#__PURE__*/React.createElement(ComposedChart,{data:ltChartData,margin:{top:30,right:55,left:5,bottom:5}},/*#__PURE__*/React.createElement(CartesianGrid,{strokeDasharray:"3 3",stroke:"#f3f4f6",vertical:false}),/*#__PURE__*/React.createElement(XAxis,{dataKey:"name",tick:{fontSize:11},axisLine:false,tickLine:false}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"left",orientation:"left",tick:{fontSize:10,fill:'#6366f1'},domain:[0,leftDomainMax],allowDecimals:false,tickFormatter:v=>v<=countMax?v:'',width:28}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"right",orientation:"right",tick:{fontSize:10,fill:'#ef4444'},domain:[0,rightDomainMax],width:32,tickFormatter:v=>`${v}일`}),/*#__PURE__*/React.createElement(Tooltip,{contentStyle:{borderRadius:8,border:'1px solid #e5e7eb',fontSize:12},formatter:(v,name)=>[v===null?'-':name==='Lead Time(일)'?`${v}일`:`${v}건`,name]}),/*#__PURE__*/React.createElement(Legend,{verticalAlign:"bottom",wrapperStyle:{fontSize:11,paddingTop:8}}),/*#__PURE__*/React.createElement(ReferenceLine,{yAxisId:"right",y:3,stroke:"#10b981",strokeDasharray:"5 3",label:{value:'목표 3일',position:'insideTopRight',fontSize:10,fill:'#10b981'}}),/*#__PURE__*/React.createElement(Bar,{yAxisId:"left",dataKey:"count",name:"Order \uAC74\uC218",radius:[4,4,0,0],maxBarSize:40,fillOpacity:0.75,label:props=>{const{x,y,width,value}=props;if(!value)return null;return/*#__PURE__*/React.createElement("text",{x:x+width/2,y:y-5,fill:"#4338ca",textAnchor:"middle",fontSize:12,fontWeight:700},value,"\uAC74");}},ltChartData.map((d,i)=>/*#__PURE__*/React.createElement(Cell,{key:i,fill:!d.count?'#e5e7eb':d.lt<=3?'#818cf8':d.lt<=5?'#fbbf24':d.count?'#818cf8':'#e5e7eb'}))),/*#__PURE__*/React.createElement(Line,{yAxisId:"right",type:"monotone",dataKey:"lt",name:"Lead Time(\uC77C)",stroke:"#ef4444",strokeWidth:3,dot:{r:6,fill:'#fff',stroke:'#ef4444',strokeWidth:2.5},activeDot:{r:8},label:props=>{const{x,y,value}=props;if(!value)return null;return/*#__PURE__*/React.createElement("text",{x:x,y:y-12,fill:"#ef4444",textAnchor:"middle",fontSize:11,fontWeight:700},value,"\uC77C");},connectNulls:false}))));})(),(()=>{const ctChartData=yearMonths.map((month,idx)=>{const md=kittingCTByMonth[month];const ct=md?parseFloat((md.reduce((a,b)=>a+b,0)/md.length).toFixed(0)):null;const count=md?md.length:null;return{name:`${idx+1}월`,ct,count};});const hasData=ctChartData.some(d=>d.ct!==null);const ctCountMax=Math.max(...ctChartData.map(d=>d.count||0),3);const ctMax=Math.max(...ctChartData.map(d=>d.ct||0),60);const ctLeftMax=ctCountMax*4;const ctRightMax=Math.ceil(ctMax*1.4/10)*10+20;return/*#__PURE__*/React.createElement("div",{className:"mb-8"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-2"},/*#__PURE__*/React.createElement("h4",{className:"text-base font-bold text-gray-700"},"Kitting Cycle Time - \uC790\uB3D9 \uC9D1\uACC4"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-4 text-xs text-gray-400"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"inline-block w-3 h-3 rounded bg-blue-400 opacity-70"}),"\uB9C9\uB300 = Order \uAC74\uC218"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"inline-block w-4 border-t-2 border-purple-500"}),"\uAEBE\uC740\uC120 = CT(\uBD84)"),!hasData&&/*#__PURE__*/React.createElement("span",null,"Kitting Cycle \uD0ED \uC644\uB8CC \uAC74\uBD80\uD130 \uC9D1\uACC4"))),(()=>{const totalOrders=Object.values(kittingCTByMonth).reduce((s,arr)=>s+arr.length,0);const allCT=Object.values(kittingCTByMonth).flat();const avgCT=allCT.length>0?Math.round(allCT.reduce((a,b)=>a+b,0)/allCT.length):null;return/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mb-3 text-xs"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 rounded"},"Total Orders: ",/*#__PURE__*/React.createElement("b",null,totalOrders),"\uAC74"),avgCT!==null&&/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-purple-50 text-purple-700 rounded"},"\uD3C9\uADE0 CT: ",/*#__PURE__*/React.createElement("b",null,avgCT),"\uBD84"),/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-gray-50 text-gray-400 rounded"},"\uBAA9\uD45C: \uAC80\uD1A0 \uC911"));})(),/*#__PURE__*/React.createElement(ResponsiveContainer,{width:"100%",height:260},/*#__PURE__*/React.createElement(ComposedChart,{data:ctChartData,margin:{top:30,right:60,left:5,bottom:5}},/*#__PURE__*/React.createElement(CartesianGrid,{strokeDasharray:"3 3",stroke:"#f3f4f6",vertical:false}),/*#__PURE__*/React.createElement(XAxis,{dataKey:"name",tick:{fontSize:11},axisLine:false,tickLine:false}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"left",orientation:"left",tick:{fontSize:10,fill:'#3b82f6'},domain:[0,ctLeftMax],allowDecimals:false,tickFormatter:v=>v<=ctCountMax?v:'',width:28}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"right",orientation:"right",tick:{fontSize:10,fill:'#8b5cf6'},domain:[0,ctRightMax],width:40,tickFormatter:v=>`${v}분`}),/*#__PURE__*/React.createElement(Tooltip,{contentStyle:{borderRadius:8,border:'1px solid #e5e7eb',fontSize:12},formatter:(v,name)=>[v===null?'-':name==='Cycle Time(분)'?`${v}분`:`${v}건`,name]}),/*#__PURE__*/React.createElement(Legend,{verticalAlign:"bottom",wrapperStyle:{fontSize:11,paddingTop:8}}),/*#__PURE__*/React.createElement(Bar,{yAxisId:"left",dataKey:"count",name:"Order \uAC74\uC218",radius:[4,4,0,0],maxBarSize:40,fillOpacity:0.75,label:props=>{const{x,y,width,value}=props;if(!value)return null;return/*#__PURE__*/React.createElement("text",{x:x+width/2,y:y-5,fill:"#1d4ed8",textAnchor:"middle",fontSize:12,fontWeight:700},value,"\uAC74");}},ctChartData.map((d,i)=>/*#__PURE__*/React.createElement(Cell,{key:i,fill:!d.count?'#e5e7eb':'#60a5fa'}))),/*#__PURE__*/React.createElement(Line,{yAxisId:"right",type:"monotone",dataKey:"ct",name:"Cycle Time(\uBD84)",stroke:"#8b5cf6",strokeWidth:3,dot:{r:6,fill:'#fff',stroke:'#8b5cf6',strokeWidth:2.5},activeDot:{r:8},label:props=>{const{x,y,value}=props;if(!value)return null;return/*#__PURE__*/React.createElement("text",{x:x,y:y-12,fill:"#7c3aed",textAnchor:"middle",fontSize:11,fontWeight:700},value,"\uBD84");},connectNulls:false}))));})(),(()=>{const rcChartData=yearMonths.map((month,idx)=>{const md=receiveCTByMonth[month];const rc=md?parseFloat((md.reduce((a,b)=>a+b,0)/md.length).toFixed(0)):null;const count=md?md.length:null;return{name:`${idx+1}월`,rc,count};});const hasData=rcChartData.some(d=>d.rc!==null);const rcCountMax=Math.max(...rcChartData.map(d=>d.count||0),3);const rcMax=Math.max(...rcChartData.map(d=>d.rc||0),60);const rcLeftMax=rcCountMax*4;const rcRightMax=Math.ceil(rcMax*1.4/10)*10+20;return/*#__PURE__*/React.createElement("div",{className:"mb-8"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-2"},/*#__PURE__*/React.createElement("h4",{className:"text-base font-bold text-gray-700"},"\uC785\uACE0 Cycle Time - \uC790\uB3D9 \uC9D1\uACC4"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-4 text-xs text-gray-400"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"inline-block w-3 h-3 rounded bg-sky-400 opacity-70"}),"\uB9C9\uB300 = \uC785\uACE0 \uAC74\uC218"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"inline-block w-4 border-t-2 border-orange-400"}),"\uAEBE\uC740\uC120 = \uD3C9\uADE0\uC2DC\uAC04(\uBD84)"),!hasData&&/*#__PURE__*/React.createElement("span",null,"\uC785\uACE0 Cycle \uD0ED \uC644\uB8CC \uAC74\uBD80\uD130 \uC9D1\uACC4"))),(()=>{const totalReceives=Object.values(receiveCTByMonth).reduce((s,arr)=>s+arr.length,0);const allRC=Object.values(receiveCTByMonth).flat();const avgRC=allRC.length>0?Math.round(allRC.reduce((a,b)=>a+b,0)/allRC.length):null;return/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mb-3 text-xs"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-sky-50 text-sky-700 rounded"},"Total \uC785\uACE0: ",/*#__PURE__*/React.createElement("b",null,totalReceives),"\uAC74"),avgRC!==null&&/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-orange-50 text-orange-700 rounded"},"\uD3C9\uADE0 \uC785\uACE0\uC2DC\uAC04: ",/*#__PURE__*/React.createElement("b",null,avgRC),"\uBD84"),/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-gray-50 text-gray-400 rounded"},"\uBAA9\uD45C: \uAC80\uD1A0 \uC911"));})(),/*#__PURE__*/React.createElement(ResponsiveContainer,{width:"100%",height:260},/*#__PURE__*/React.createElement(ComposedChart,{data:rcChartData,margin:{top:30,right:60,left:5,bottom:5}},/*#__PURE__*/React.createElement(CartesianGrid,{strokeDasharray:"3 3",stroke:"#f3f4f6",vertical:false}),/*#__PURE__*/React.createElement(XAxis,{dataKey:"name",tick:{fontSize:11},axisLine:false,tickLine:false}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"left",orientation:"left",tick:{fontSize:10,fill:'#0ea5e9'},domain:[0,rcLeftMax],allowDecimals:false,tickFormatter:v=>v<=rcCountMax?v:'',width:28}),/*#__PURE__*/React.createElement(YAxis,{yAxisId:"right",orientation:"right",tick:{fontSize:10,fill:'#f97316'},domain:[0,rcRightMax],width:40,tickFormatter:v=>`${v}분`}),/*#__PURE__*/React.createElement(Tooltip,{contentStyle:{borderRadius:8,border:'1px solid #e5e7eb',fontSize:12},formatter:(v,name)=>[v===null?'-':name==='평균 입고시간(분)'?`${v}분`:`${v}건`,name]}),/*#__PURE__*/React.createElement(Legend,{verticalAlign:"bottom",wrapperStyle:{fontSize:11,paddingTop:8}}),/*#__PURE__*/React.createElement(Bar,{yAxisId:"left",dataKey:"count",name:"\uC785\uACE0 \uAC74\uC218",radius:[4,4,0,0],maxBarSize:40,fillOpacity:0.75,label:props=>{const{x,y,width,value}=props;if(!value)return null;return/*#__PURE__*/React.createElement("text",{x:x+width/2,y:y-5,fill:"#0369a1",textAnchor:"middle",fontSize:12,fontWeight:700},value,"\uAC74");}},rcChartData.map((d,i)=>/*#__PURE__*/React.createElement(Cell,{key:i,fill:!d.count?'#e5e7eb':'#38bdf8'}))),/*#__PURE__*/React.createElement(Line,{yAxisId:"right",type:"monotone",dataKey:"rc",name:"\uD3C9\uADE0 \uC785\uACE0\uC2DC\uAC04(\uBD84)",stroke:"#f97316",strokeWidth:3,dot:{r:6,fill:'#fff',stroke:'#f97316',strokeWidth:2.5},activeDot:{r:8},label:props=>{const{x,y,value}=props;if(!value)return null;return/*#__PURE__*/React.createElement("text",{x:x,y:y-12,fill:"#ea580c",textAnchor:"middle",fontSize:11,fontWeight:700},value,"\uBD84");},connectNulls:false}))));})()),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold mb-4 flex items-center gap-2"},"\uD83D\uDCCB ",selectedYear,"\uB144 \uC6D4\uBCC4 \uB370\uC774\uD130"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",null,/*#__PURE__*/React.createElement("tr",{className:"border-b bg-gray-50"},/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left font-medium"},"\uC6D4"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center font-medium"},"GR Qty",/*#__PURE__*/React.createElement("br",null),/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal text-gray-500"},"(\uAC74)")),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center font-medium"},"GR Cancel",/*#__PURE__*/React.createElement("br",null),/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal text-gray-500"},"(\uAC74)")),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center font-medium"},"\uCDE8\uC18C\uC728",/*#__PURE__*/React.createElement("br",null),/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal text-gray-500"},"(%)")),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center font-medium"},"\uC7AC\uACE0 \uC190\uC2E4\uC728",/*#__PURE__*/React.createElement("br",null),/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal text-gray-500"},"(%)")),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center font-medium"},"Kitting L/T",/*#__PURE__*/React.createElement("br",null),/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal text-gray-500"},"(\uC77C)")),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center font-medium"},"Kitting CT",/*#__PURE__*/React.createElement("br",null),/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal text-gray-500"},"(\uBD84/\uAC74)")),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center font-medium"},"\uC785\uACE0 CT",/*#__PURE__*/React.createElement("br",null),/*#__PURE__*/React.createElement("span",{className:"text-xs font-normal text-gray-500"},"(\uBD84/\uAC74)")),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center font-medium"},"\uC561\uC158"))),/*#__PURE__*/React.createElement("tbody",null,yearMonths.map((month,idx)=>{const monthNum=idx+1;const grVal=kpiData.grCancel[month];const grQtyVal=kpiData.grCancelQty[month];const grRate=grVal!==undefined&&grQtyVal?grVal/grQtyVal*100:null;const invVal=kpiData.inventoryAdjust[month];const ltData=kittingLTByMonth[month];const ltVal=ltData?ltData.reduce((a,b)=>a+b,0)/ltData.length:null;const ctData=kittingCTByMonth[month];const ctVal=ctData?ctData.reduce((a,b)=>a+b,0)/ctData.length:null;const rcData=receiveCTByMonth[month];const rcVal=rcData?rcData.reduce((a,b)=>a+b,0)/rcData.length:null;const rcCount=rcData?rcData.length:null;const isPast=selectedYear<new Date().getFullYear()||isCurrentYear&&monthNum<=currentMonth;return/*#__PURE__*/React.createElement("tr",{key:month,className:`border-b ${!isPast?'bg-gray-50 text-gray-400':''}`},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-medium"},monthNum,"\uC6D4"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},grQtyVal!==undefined?/*#__PURE__*/React.createElement("span",{className:"text-gray-600"},grQtyVal):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},grVal!==undefined?/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded ${grVal<=2?'bg-emerald-100 text-emerald-700':grVal<=5?'bg-amber-100 text-amber-700':'bg-red-100 text-red-700'}`},grVal):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},grRate!==null?/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs ${grRate===0?'bg-emerald-100 text-emerald-700':grRate<=0.5?'bg-amber-100 text-amber-700':'bg-red-100 text-red-700'}`},grRate.toFixed(3),"%"):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},invVal!==undefined?/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded ${invVal<=0.064?'bg-emerald-100 text-emerald-700':invVal<=0.12?'bg-amber-100 text-amber-700':'bg-red-100 text-red-700'}`},invVal.toFixed(3)):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},ltVal!==null?/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded ${ltVal<=3?'bg-emerald-100 text-emerald-700':ltVal<=5?'bg-amber-100 text-amber-700':'bg-red-100 text-red-700'}`},ltVal.toFixed(1)):/*#__PURE__*/React.createElement("span",{className:"text-gray-400"},"-")),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},ctVal!==null?/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 rounded bg-blue-100 text-blue-700"},ctVal.toFixed(0),"\uBD84 / ",ctData.length,"\uAC74"):/*#__PURE__*/React.createElement("span",{className:"text-gray-400"},"-")),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},rcVal!==null?/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 rounded bg-sky-100 text-sky-700"},rcVal.toFixed(0),"\uBD84 / ",rcCount,"\uAC74"):/*#__PURE__*/React.createElement("span",{className:"text-gray-400"},"-")),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},isPast&&/*#__PURE__*/React.createElement("button",{onClick:()=>{setKpiInputMonth(month);setShowKpiInputModal(true);},className:"text-indigo-600 hover:text-indigo-800 text-xs"},grVal!==undefined||invVal!==undefined?'수정':'입력')));})),/*#__PURE__*/React.createElement("tfoot",null,(()=>{// 연간 합계/평균 계산
const totalGRQty=yearMonths.reduce((s,m)=>s+(kpiData.grCancelQty[m]||0),0);const totalGRCancel=yearMonths.reduce((s,m)=>s+(kpiData.grCancel[m]!==undefined?kpiData.grCancel[m]:0),0);const totalCancelRate=totalGRQty>0?totalGRCancel/totalGRQty*100:null;const invVals=yearMonths.map(m=>kpiData.inventoryAdjust[m]).filter(v=>v!==undefined);const avgInv=invVals.length>0?invVals.reduce((a,b)=>a+b,0)/invVals.length:null;const ltVals=Object.values(kittingLTByMonth).map(arr=>arr.reduce((a,b)=>a+b,0)/arr.length);const avgLT=ltVals.length>0?ltVals.reduce((a,b)=>a+b,0)/ltVals.length:null;const allCT=Object.values(kittingCTByMonth).flat();const avgCT=allCT.length>0?allCT.reduce((a,b)=>a+b,0)/allCT.length:null;const totalKittingOrders=Object.values(kittingCTByMonth).reduce((s,arr)=>s+arr.length,0);const allRC=Object.values(receiveCTByMonth).flat();const avgRC=allRC.length>0?allRC.reduce((a,b)=>a+b,0)/allRC.length:null;const totalReceiveOrders=Object.values(receiveCTByMonth).reduce((s,arr)=>s+arr.length,0);return/*#__PURE__*/React.createElement("tr",{className:"bg-indigo-50 font-medium text-sm"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-gray-600"},"\uC5F0\uAC04 \uD569\uACC4/\uD3C9\uADE0"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},totalGRQty>0?/*#__PURE__*/React.createElement("span",{className:"text-blue-700"},totalGRQty,"\uAC74"):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},/*#__PURE__*/React.createElement("span",{className:totalGRCancel<=2?'text-emerald-700':'text-red-600'},totalGRCancel,"\uAC74")),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},totalCancelRate!==null?/*#__PURE__*/React.createElement("span",{className:totalCancelRate===0?'text-emerald-700':totalCancelRate<=0.5?'text-amber-600':'text-red-600'},totalCancelRate.toFixed(3),"%"):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},avgInv!==null?/*#__PURE__*/React.createElement("span",{className:avgInv<=0.064?'text-emerald-700':'text-amber-600'},avgInv.toFixed(3),"%"):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},avgLT!==null?/*#__PURE__*/React.createElement("span",{className:avgLT<=3?'text-emerald-700':avgLT<=5?'text-amber-600':'text-red-600'},avgLT.toFixed(1),"\uC77C \uD3C9\uADE0"):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},avgCT!==null?/*#__PURE__*/React.createElement("span",{className:"text-blue-700"},Math.round(avgCT),"\uBD84 / ",totalKittingOrders,"\uAC74"):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},avgRC!==null?/*#__PURE__*/React.createElement("span",{className:"text-sky-700"},Math.round(avgRC),"\uBD84 / ",totalReceiveOrders,"\uAC74"):'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"}));})())))));})()),showKpiInputModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>setShowKpiInputModal(false)},/*#__PURE__*/React.createElement("div",{className:`${darkMode?'bg-gray-800 text-white':'bg-white'} rounded-xl shadow-xl p-6 w-full max-w-md m-4`,onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCCA KPI \uB370\uC774\uD130 \uC785\uB825"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowKpiInputModal(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium mb-1"},"\uC6D4 \uC120\uD0DD"),/*#__PURE__*/React.createElement("input",{type:"month",value:kpiInputMonth,onChange:e=>setKpiInputMonth(e.target.value),className:`w-full px-3 py-2 border rounded-lg ${darkMode?'bg-gray-700 border-gray-600':'border-gray-300'}`})),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 gap-3"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium mb-1"},"GR Qty (\uCD1D \uAC74\uC218)"),/*#__PURE__*/React.createElement("input",{type:"number",min:"0",value:kpiData.grCancelQty[kpiInputMonth]??'',onChange:e=>setKpiData(prev=>({...prev,grCancelQty:{...prev.grCancelQty,[kpiInputMonth]:e.target.value===''?undefined:parseInt(e.target.value)}})),placeholder:"\uC608: 83",className:`w-full px-3 py-2 border rounded-lg ${darkMode?'bg-gray-700 border-gray-600':'border-gray-300'}`})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium mb-1"},"GR Cancel (\uAC74\uC218)",/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-500 ml-1"},"\uBAA9\uD45C 2\uAC74\u2193")),/*#__PURE__*/React.createElement("input",{type:"number",min:"0",value:kpiData.grCancel[kpiInputMonth]??'',onChange:e=>setKpiData(prev=>({...prev,grCancel:{...prev.grCancel,[kpiInputMonth]:e.target.value===''?undefined:parseInt(e.target.value)}})),placeholder:"\uC608: 0",className:`w-full px-3 py-2 border rounded-lg ${darkMode?'bg-gray-700 border-gray-600':'border-gray-300'}`}))),kpiData.grCancelQty[kpiInputMonth]>0&&kpiData.grCancel[kpiInputMonth]!==undefined&&/*#__PURE__*/React.createElement("div",{className:"text-xs text-blue-600 bg-blue-50 rounded px-2 py-1"},"\uCDE8\uC18C\uC728: ",(kpiData.grCancel[kpiInputMonth]/kpiData.grCancelQty[kpiInputMonth]*100).toFixed(3),"%"),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium mb-1"},"\uC7AC\uACE0 \uC190\uC2E4\uC728 (%)",/*#__PURE__*/React.createElement("span",{className:"text-xs text-gray-500 ml-2"},"\uBAA9\uD45C: 0.064% \uC774\uD558")),/*#__PURE__*/React.createElement("input",{type:"number",min:"0",step:"0.001",value:kpiData.inventoryAdjust[kpiInputMonth]??'',onChange:e=>setKpiData(prev=>({...prev,inventoryAdjust:{...prev.inventoryAdjust,[kpiInputMonth]:e.target.value===''?undefined:parseFloat(e.target.value)}})),placeholder:"\uC608: 0.112",className:`w-full px-3 py-2 border rounded-lg ${darkMode?'bg-gray-700 border-gray-600':'border-gray-300'}`})),/*#__PURE__*/React.createElement("div",{className:`p-3 rounded-lg ${darkMode?'bg-gray-700':'bg-gray-50'}`},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium mb-2"},"\uC810\uC218 \uBBF8\uB9AC\uBCF4\uAE30"),/*#__PURE__*/React.createElement("div",{className:"flex gap-4 text-sm"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("span",{className:"text-gray-500"},"GR Cancel:"),/*#__PURE__*/React.createElement("span",{className:`ml-2 font-bold ${calculateKpiScore('grCancel',kpiData.grCancel[kpiInputMonth])>=80?'text-emerald-600':calculateKpiScore('grCancel',kpiData.grCancel[kpiInputMonth])>=60?'text-amber-600':'text-red-600'}`},calculateKpiScore('grCancel',kpiData.grCancel[kpiInputMonth])??'-',"\uC810")),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("span",{className:"text-gray-500"},"\uC7AC\uACE0 \uC190\uC2E4\uC728:"),/*#__PURE__*/React.createElement("span",{className:`ml-2 font-bold ${calculateKpiScore('inventoryAdjust',kpiData.inventoryAdjust[kpiInputMonth])>=80?'text-emerald-600':calculateKpiScore('inventoryAdjust',kpiData.inventoryAdjust[kpiInputMonth])>=60?'text-amber-600':'text-red-600'}`},calculateKpiScore('inventoryAdjust',kpiData.inventoryAdjust[kpiInputMonth])??'-',"\uC810"))))),/*#__PURE__*/React.createElement("div",{className:"flex justify-end gap-2 mt-6"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowKpiInputModal(false),className:`px-4 py-2 rounded-lg ${darkMode?'bg-gray-700 hover:bg-gray-600':'bg-gray-200 hover:bg-gray-300'}`},"\uB2EB\uAE30"),/*#__PURE__*/React.createElement("button",{onClick:()=>{showToast(`${kpiInputMonth} KPI 데이터가 저장되었습니다.`,'success');setShowKpiInputModal(false);},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},"\uC800\uC7A5")))),activeTab==='todo'&&/*#__PURE__*/React.createElement("div",{className:"space-y-6"},showDueSoonAlert&&dueSoonTodos.length>0&&/*#__PURE__*/React.createElement("div",{className:"bg-gradient-to-r from-red-500 to-orange-500 rounded-xl shadow-lg p-4 text-white"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("span",{className:"text-3xl"},"\u23F0"),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h3",{className:"font-bold text-lg"},"\uB9C8\uAC10 \uC784\uBC15 \uC54C\uB9BC!"),/*#__PURE__*/React.createElement("p",{className:"text-sm opacity-90"},dueSoonTodos.filter(t=>t.dueDate<new Date().toISOString().split('T')[0]).length>0&&`⚠️ 기한 지남 ${dueSoonTodos.filter(t=>t.dueDate<new Date().toISOString().split('T')[0]).length}개`,dueSoonTodos.filter(t=>t.dueDate===new Date().toISOString().split('T')[0]).length>0&&` 🔴 오늘 마감 ${dueSoonTodos.filter(t=>t.dueDate===new Date().toISOString().split('T')[0]).length}개`))),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowDueSoonAlert(false),className:"text-white/80 hover:text-white"},/*#__PURE__*/React.createElement(X,{className:"w-6 h-6"}))),/*#__PURE__*/React.createElement("div",{className:"mt-3 space-y-1"},dueSoonTodos.slice(0,3).map(todo=>/*#__PURE__*/React.createElement("div",{key:todo.id,className:"bg-white/20 rounded px-3 py-2 text-sm flex items-center gap-2"},/*#__PURE__*/React.createElement("span",null,todo.priority==='high'?'🔴':todo.priority==='medium'?'🟡':'🟢'),/*#__PURE__*/React.createElement("span",{className:"flex-1"},todo.text),/*#__PURE__*/React.createElement("span",{className:"opacity-75"},todo.dueDate))))),/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-sm p-6"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-4"},/*#__PURE__*/React.createElement("h2",{className:"text-lg font-semibold flex items-center gap-2"},/*#__PURE__*/React.createElement(Check,{className:"w-5 h-5"}),"TO DO \uB9AC\uC2A4\uD2B8"),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("div",{className:"flex bg-gray-100 rounded-lg p-1"},/*#__PURE__*/React.createElement("button",{onClick:()=>setTodoViewMode('list'),className:`flex items-center gap-1 px-3 py-1.5 rounded text-sm transition ${todoViewMode==='list'?'bg-white shadow text-indigo-600':'text-gray-600 hover:text-gray-900'}`},/*#__PURE__*/React.createElement(List,{className:"w-4 h-4"})," \uB9AC\uC2A4\uD2B8"),/*#__PURE__*/React.createElement("button",{onClick:()=>setTodoViewMode('calendar'),className:`flex items-center gap-1 px-3 py-1.5 rounded text-sm transition ${todoViewMode==='calendar'?'bg-white shadow text-indigo-600':'text-gray-600 hover:text-gray-900'}`},/*#__PURE__*/React.createElement(Calendar,{className:"w-4 h-4"})," \uCE98\uB9B0\uB354")),/*#__PURE__*/React.createElement("button",{onClick:exportTodoList,className:"flex items-center gap-1 px-3 py-1.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4"})," \uC5D1\uC140"),dueSoonTodos.length>0?/*#__PURE__*/React.createElement("span",{className:"text-sm text-orange-600 flex items-center gap-1 bg-orange-50 px-3 py-1 rounded-lg"},/*#__PURE__*/React.createElement(Bell,{className:"w-4 h-4"})," (",dueSoonTodos.length,")\uAC1C \uC54C\uB9BC"):/*#__PURE__*/React.createElement("span",{className:"text-sm text-green-600 flex items-center gap-1"},/*#__PURE__*/React.createElement(Check,{className:"w-4 h-4"})," \uB9C8\uAC10 \uC784\uBC15 \uC5C6\uC74C"))),/*#__PURE__*/React.createElement("div",{className:"bg-gray-50 rounded-lg p-4 mb-6"},/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap gap-3 items-center"},/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"\uC0C8\uB85C\uC6B4 \uD560 \uC77C\uC744 \uC785\uB825\uD558\uC138\uC694...",className:"flex-1 min-w-[200px] border rounded-lg px-4 py-2",value:newTodo,onChange:e=>setNewTodo(e.target.value),onKeyPress:e=>{if(e.key==='Enter'&&newTodo.trim()){setTodoList([...todoList,{id:Date.now(),text:newTodo.trim(),category:newTodoCategory,priority:newTodoPriority,completed:false,createdAt:new Date().toISOString().split('T')[0],dueDate:newTodoDueDate}]);setNewTodo('');setNewTodoDueDate('');}}}),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-2 text-sm",value:newTodoCategory,onChange:e=>setNewTodoCategory(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"general"},"\uD83D\uDCCB \uC77C\uBC18"),/*#__PURE__*/React.createElement("option",{value:"data"},"\uD83D\uDCCA \uB370\uC774\uD130"),/*#__PURE__*/React.createElement("option",{value:"process"},"\u2699\uFE0F \uD504\uB85C\uC138\uC2A4"),/*#__PURE__*/React.createElement("option",{value:"kpi"},"\uD83D\uDCC8 KPI"),/*#__PURE__*/React.createElement("option",{value:"system"},"\uD83D\uDCBB \uC2DC\uC2A4\uD15C"),/*#__PURE__*/React.createElement("option",{value:"idea"},"\uD83D\uDCA1 \uC544\uC774\uB514\uC5B4")),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-2 text-sm",value:newTodoPriority,onChange:e=>setNewTodoPriority(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"high"},"\uD83D\uDD34 \uB192\uC74C"),/*#__PURE__*/React.createElement("option",{value:"medium"},"\uD83D\uDFE1 \uBCF4\uD1B5"),/*#__PURE__*/React.createElement("option",{value:"low"},"\uD83D\uDFE2 \uB0AE\uC74C")),/*#__PURE__*/React.createElement("input",{type:"date",className:"border rounded-lg px-3 py-2 text-sm",value:newTodoDueDate,onChange:e=>setNewTodoDueDate(e.target.value)}),/*#__PURE__*/React.createElement("button",{className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 flex items-center gap-2",onClick:()=>{if(newTodo.trim()){setTodoList([...todoList,{id:Date.now(),text:newTodo.trim(),category:newTodoCategory,priority:newTodoPriority,completed:false,createdAt:new Date().toISOString().split('T')[0],dueDate:newTodoDueDate}]);setNewTodo('');setNewTodoDueDate('');}}},/*#__PURE__*/React.createElement(Plus,{className:"w-4 h-4"})," \uCD94\uAC00"))),todoViewMode==='list'&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"flex gap-2 mb-4 flex-wrap"},[{id:'active',label:'진행중'},{id:'all',label:'전체'},{id:'completed',label:'완료'},{id:'overdue',label:'⚠️ 기한 지남'},{id:'upcoming',label:'📅 7일 이내'}].map(f=>/*#__PURE__*/React.createElement("button",{key:f.id,className:`px-3 py-1 rounded-lg text-sm ${todoFilter===f.id?'bg-indigo-600 text-white':'bg-gray-100 text-gray-600 hover:bg-gray-200'}`,onClick:()=>setTodoFilter(f.id)},f.label,f.id==='overdue'&&(()=>{const today=new Date().toISOString().split('T')[0];const count=todoList.filter(t=>!t.completed&&t.dueDate&&t.dueDate<today).length;return count>0?/*#__PURE__*/React.createElement("span",{className:"ml-1 px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full"},count):null;})()))),/*#__PURE__*/React.createElement("div",{className:"space-y-2"},todoList.filter(todo=>{const today=new Date().toISOString().split('T')[0];const weekLater=new Date(Date.now()+7*24*60*60*1000).toISOString().split('T')[0];if(todoFilter==='active')return!todo.completed;if(todoFilter==='completed')return todo.completed;if(todoFilter==='overdue')return!todo.completed&&todo.dueDate&&todo.dueDate<today;if(todoFilter==='upcoming')return!todo.completed&&todo.dueDate&&todo.dueDate>=today&&todo.dueDate<=weekLater;return true;}).sort((a,b)=>{const today=new Date().toISOString().split('T')[0];const aOverdue=!a.completed&&a.dueDate&&a.dueDate<today;const bOverdue=!b.completed&&b.dueDate&&b.dueDate<today;if(aOverdue&&!bOverdue)return-1;if(!aOverdue&&bOverdue)return 1;const priorityOrder={high:0,medium:1,low:2};if(priorityOrder[a.priority]!==priorityOrder[b.priority]){return priorityOrder[a.priority]-priorityOrder[b.priority];}if(a.dueDate&&b.dueDate)return a.dueDate.localeCompare(b.dueDate);return 0;}).map(todo=>{const today=new Date().toISOString().split('T')[0];const weekLater=new Date(Date.now()+7*24*60*60*1000).toISOString().split('T')[0];const isOverdue=!todo.completed&&todo.dueDate&&todo.dueDate<today;const isUpcoming=!todo.completed&&todo.dueDate&&todo.dueDate>=today&&todo.dueDate<=weekLater;return/*#__PURE__*/React.createElement("div",{key:todo.id,className:`flex items-center gap-3 p-3 rounded-lg border ${todo.completed?'bg-gray-50 border-gray-200':isOverdue?'bg-red-50 border-red-300':isUpcoming?'border-orange-300':'border-gray-200'}`},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:todo.completed,onChange:e=>updateTodo(todo.id,'completed',e.target.checked),className:"w-5 h-5 rounded"}),/*#__PURE__*/React.createElement("input",{type:"text",value:todo.text,onChange:e=>updateTodo(todo.id,'text',e.target.value),className:`flex-1 bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded px-2 py-1 ${todo.completed?'line-through text-gray-400':''}`}),isOverdue&&/*#__PURE__*/React.createElement("span",{className:"text-red-500 text-sm"},"\u26A0\uFE0F \uAE30\uD55C \uC9C0\uB0A8"),/*#__PURE__*/React.createElement("select",{className:`px-2 py-1 rounded text-xs border-0 cursor-pointer ${todo.category==='data'?'bg-blue-100 text-blue-700':todo.category==='process'?'bg-purple-100 text-purple-700':todo.category==='kpi'?'bg-orange-100 text-orange-600':todo.category==='system'?'bg-cyan-100 text-cyan-700':todo.category==='idea'?'bg-pink-100 text-pink-700':'bg-gray-100 text-gray-700'}`,value:todo.category,onChange:e=>updateTodo(todo.id,'category',e.target.value)},/*#__PURE__*/React.createElement("option",{value:"general"},"\uD83D\uDCCB \uC77C\uBC18"),/*#__PURE__*/React.createElement("option",{value:"data"},"\uD83D\uDCCA \uB370\uC774\uD130"),/*#__PURE__*/React.createElement("option",{value:"process"},"\u2699\uFE0F \uD504\uB85C\uC138\uC2A4"),/*#__PURE__*/React.createElement("option",{value:"kpi"},"\uD83D\uDCC8 KPI"),/*#__PURE__*/React.createElement("option",{value:"system"},"\uD83D\uDCBB \uC2DC\uC2A4\uD15C"),/*#__PURE__*/React.createElement("option",{value:"idea"},"\uD83D\uDCA1 \uC544\uC774\uB514\uC5B4")),/*#__PURE__*/React.createElement("select",{className:"px-2 py-1 rounded text-xs border-0 cursor-pointer",value:todo.priority,onChange:e=>updateTodo(todo.id,'priority',e.target.value)},/*#__PURE__*/React.createElement("option",{value:"high"},"\uD83D\uDD34 \uB192\uC74C"),/*#__PURE__*/React.createElement("option",{value:"medium"},"\uD83D\uDFE1 \uBCF4\uD1B5"),/*#__PURE__*/React.createElement("option",{value:"low"},"\uD83D\uDFE2 \uB0AE\uC74C")),/*#__PURE__*/React.createElement("input",{type:"date",className:"border rounded px-2 py-1 text-xs",value:todo.dueDate||'',onChange:e=>updateTodo(todo.id,'dueDate',e.target.value)}),/*#__PURE__*/React.createElement("button",{onClick:()=>setDeleteConfirm({show:true,type:'todo',id:todo.id,text:todo.text,count:0}),className:"text-red-500 hover:text-red-700 p-1"},/*#__PURE__*/React.createElement(X,{className:"w-4 h-4"})));})),/*#__PURE__*/React.createElement("div",{className:"mt-6 pt-4 border-t flex flex-wrap justify-between gap-2 text-sm text-gray-500"},/*#__PURE__*/React.createElement("span",null,"\uCD1D ",todoList.length,"\uAC1C"),/*#__PURE__*/React.createElement("span",null,"\uC644\uB8CC ",todoList.filter(t=>t.completed).length,"\uAC1C"),/*#__PURE__*/React.createElement("span",null,"\uC9C4\uD589\uC911 ",todoList.filter(t=>!t.completed).length,"\uAC1C"),/*#__PURE__*/React.createElement("span",{className:"text-red-500"},"\u26A0\uFE0F \uAE30\uD55C \uC9C0\uB0A8 ",todoList.filter(t=>!t.completed&&t.dueDate&&t.dueDate<new Date().toISOString().split('T')[0]).length,"\uAC1C"))),todoViewMode==='calendar'&&/*#__PURE__*/React.createElement("div",{className:"mt-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-4"},/*#__PURE__*/React.createElement("button",{onClick:()=>setCalendarMonth(new Date(calendarMonth.getFullYear(),calendarMonth.getMonth()-1)),className:"p-2 hover:bg-gray-100 rounded-lg"},/*#__PURE__*/React.createElement(ChevronLeft,{className:"w-5 h-5"})),/*#__PURE__*/React.createElement("h3",{className:"text-lg font-semibold"},calendarMonth.getFullYear(),"\uB144 ",calendarMonth.getMonth()+1,"\uC6D4"),/*#__PURE__*/React.createElement("button",{onClick:()=>setCalendarMonth(new Date(calendarMonth.getFullYear(),calendarMonth.getMonth()+1)),className:"p-2 hover:bg-gray-100 rounded-lg"},/*#__PURE__*/React.createElement(ChevronRight,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-7 gap-1 mb-2"},['일','월','화','수','목','금','토'].map((day,i)=>/*#__PURE__*/React.createElement("div",{key:day,className:`text-center text-sm font-medium py-2 ${i===0?'text-red-500':i===6?'text-blue-500':'text-gray-600'}`},day))),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-7 gap-1"},(()=>{const year=calendarMonth.getFullYear();const month=calendarMonth.getMonth();const firstDay=new Date(year,month,1).getDay();const lastDate=new Date(year,month+1,0).getDate();const today=new Date().toISOString().split('T')[0];const days=[];for(let i=0;i<firstDay;i++){days.push(/*#__PURE__*/React.createElement("div",{key:`empty-${i}`,className:"min-h-[100px] bg-gray-50 rounded"}));}for(let date=1;date<=lastDate;date++){const dateStr=`${year}-${String(month+1).padStart(2,'0')}-${String(date).padStart(2,'0')}`;const dayTodos=todoList.filter(t=>t.dueDate===dateStr);const isToday=dateStr===today;const dayOfWeek=new Date(year,month,date).getDay();days.push(/*#__PURE__*/React.createElement("div",{key:date,className:`min-h-[100px] border rounded-lg p-1 ${isToday?'bg-indigo-50 border-indigo-300':'bg-white border-gray-200'}`},/*#__PURE__*/React.createElement("div",{className:`text-sm font-medium mb-1 ${isToday?'text-indigo-600':dayOfWeek===0?'text-red-500':dayOfWeek===6?'text-blue-500':'text-gray-700'}`},date,isToday&&/*#__PURE__*/React.createElement("span",{className:"ml-1 text-xs bg-indigo-600 text-white px-1 rounded"},"\uC624\uB298")),/*#__PURE__*/React.createElement("div",{className:"space-y-0.5 overflow-y-auto max-h-[70px]"},dayTodos.map(todo=>/*#__PURE__*/React.createElement("div",{key:todo.id,className:`text-xs p-1 rounded truncate cursor-pointer hover:opacity-80 ${todo.completed?'bg-gray-100 text-gray-400 line-through':todo.priority==='high'?'bg-red-100 text-red-700':todo.priority==='medium'?'bg-yellow-100 text-yellow-700':'bg-green-100 text-green-700'}`,title:"\uD074\uB9AD\uD558\uC5EC \uC0C1\uC138\uBCF4\uAE30",onClick:()=>setSelectedCalendarTodo(todo)},todo.completed?'✓ ':'',todo.text)))));}return days;})()),/*#__PURE__*/React.createElement("div",{className:"mt-4 flex gap-4 justify-center text-xs"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 bg-red-100 rounded"})," \uB192\uC74C"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 bg-yellow-100 rounded"})," \uBCF4\uD1B5"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 bg-green-100 rounded"})," \uB0AE\uC74C"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 bg-gray-100 rounded"})," \uC644\uB8CC")))),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4"},[{id:'general',label:'일반',icon:'📋',color:'gray'},{id:'data',label:'데이터',icon:'📊',color:'blue'},{id:'process',label:'프로세스',icon:'⚙️',color:'purple'},{id:'kpi',label:'KPI',icon:'📈',color:'orange'},{id:'system',label:'시스템',icon:'💻',color:'cyan'},{id:'idea',label:'아이디어',icon:'💡',color:'pink'}].map(cat=>{const activeTodos=todoList.filter(t=>t.category===cat.id&&!t.completed);const completedTodos=todoList.filter(t=>t.category===cat.id&&t.completed);const count=activeTodos.length;return/*#__PURE__*/React.createElement("div",{key:cat.id,className:`bg-white rounded-xl shadow-sm p-4 text-center border-t-4 border-${cat.color}-400 cursor-pointer hover:shadow-md transition transform hover:-translate-y-1`,onClick:()=>setSelectedCategory({...cat,activeTodos,completedTodos})},/*#__PURE__*/React.createElement("div",{className:"text-2xl mb-1"},cat.icon),/*#__PURE__*/React.createElement("div",{className:"font-medium text-gray-700"},cat.label),/*#__PURE__*/React.createElement("div",{className:`text-2xl font-bold text-${cat.color}-600`},count),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-400"},"\uC9C4\uD589\uC911"));}))),spaceAnalysisModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl m-4 max-h-[90vh] flex flex-col"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center p-6 border-b sticky top-0 bg-white rounded-t-xl z-10"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},spaceAnalysisModal.type==='over'&&'📦 과다 재고 모델 상세',spaceAnalysisModal.type==='ok'&&'✅ 적정 재고 모델 상세',spaceAnalysisModal.type==='warning'&&'⚠️ 부족 주의 모델 상세',spaceAnalysisModal.type==='shortage'&&'🚨 부족 긴급 모델 상세',/*#__PURE__*/React.createElement("span",{className:"text-sm font-normal text-gray-500 ml-2"},"(",spaceAnalysisModal.data.length,"\uAC1C \uBAA8\uB378)")),/*#__PURE__*/React.createElement("button",{onClick:()=>setSpaceAnalysisModal(null),className:"p-2 hover:bg-gray-100 rounded-lg"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"overflow-y-auto flex-1 p-6"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:`sticky top-0 ${spaceAnalysisModal.type==='over'?'bg-purple-50':spaceAnalysisModal.type==='ok'?'bg-emerald-50':spaceAnalysisModal.type==='warning'?'bg-amber-50':'bg-red-50'}`},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uBAA8\uB378"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-right"},"\uD604\uC7AC \uC7AC\uACE0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-right"},"\uC801\uC815 \uBC94\uC704"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uBCD1\uBAA9 \uC790\uC7AC"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uC81C\uC548"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},spaceAnalysisModal.data.map(item=>{const bottleneck=producibleUnits[item.model]?.bottleneck;return/*#__PURE__*/React.createElement("tr",{key:item.model,className:"hover:bg-gray-50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-medium"},item.model),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-right font-bold"},item.current,"\uB300"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-right text-gray-600"},item.min,"~",item.max,"\uB300"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-gray-600 text-xs"},bottleneck?`${bottleneck.material} (${bottleneck.currentStock} EA)`:'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},item.status==='over'&&/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded"},"\uD83D\uDCC5 \uBC1C\uC8FC \uC5F0\uAE30"),item.status==='ok'&&/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-700 text-xs rounded"},"\u2705 \uC801\uC815"),item.status==='warning'&&/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded"},"\u26A0\uFE0F \uBAA8\uB2C8\uD130\uB9C1"),item.status==='shortage'&&/*#__PURE__*/React.createElement("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded"},"\uD83D\uDED2 \uBC1C\uC8FC \uD544\uC694")));})))),/*#__PURE__*/React.createElement("div",{className:"p-4 border-t bg-gray-50 rounded-b-xl"},/*#__PURE__*/React.createElement("button",{onClick:()=>setSpaceAnalysisModal(null),className:"w-full py-2 bg-gray-200 hover:bg-gray-300 rounded-lg font-medium"},"\uB2EB\uAE30")))),binDetailModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl flex flex-col",style:{maxHeight:'calc(100vh - 2rem)'}},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center p-6 border-b bg-white rounded-t-xl flex-shrink-0"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg flex items-center gap-2"},"\uD83D\uDCE6 ",binDetailModal.bin," \uD488\uBAA9 \uC0C1\uC138",/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 text-xs rounded ${binDetailModal.data.stock/binDetailModal.BIN_CAPACITY>2?'bg-red-500 text-white':binDetailModal.data.stock/binDetailModal.BIN_CAPACITY>1.5?'bg-orange-400 text-white':'bg-orange-200 text-orange-800'}`},(binDetailModal.data.stock/binDetailModal.BIN_CAPACITY*100).toFixed(0),"%")),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500 mt-1"},"\uCD1D \uC7AC\uACE0: ",binDetailModal.data.stock.toLocaleString()," EA | \uC801\uC815: ",binDetailModal.BIN_CAPACITY," EA | \uCD08\uACFC: ",/*#__PURE__*/React.createElement("span",{className:"text-orange-600 font-medium"},"+",(binDetailModal.data.stock-binDetailModal.BIN_CAPACITY).toLocaleString()," EA"))),/*#__PURE__*/React.createElement("button",{onClick:()=>setBinDetailModal(null),className:"p-2 hover:bg-gray-100 rounded-lg"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"overflow-y-auto flex-1 min-h-0"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"sticky top-0 bg-orange-50 z-10"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-left"},"Part No."),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-left"},"Description"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-right"},"Qty (\uC7AC\uACE0)"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-right"},"\uACFC\uC801 \uC218\uB7C9"),/*#__PURE__*/React.createElement("th",{className:"px-4 py-3 text-right"},"\uACFC\uC801\uB960"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},binDetailModal.data.items.sort((a,b)=>(b.stock||0)-(a.stock||0)).map((item,idx)=>{// 품목별 과적 수량 계산 (비율 기준)
const itemRatio=(item.stock||0)/binDetailModal.data.stock;const totalOver=binDetailModal.data.stock-binDetailModal.BIN_CAPACITY;const itemOver=Math.round(itemRatio*totalOver);const itemOverPercent=totalOver>0?((item.stock||0)/binDetailModal.BIN_CAPACITY*100).toFixed(0):0;return/*#__PURE__*/React.createElement("tr",{key:idx,className:"hover:bg-orange-50/50"},/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 font-medium"},item.material),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-gray-600 truncate max-w-xs",title:item.description},item.description?.slice(0,35)||'-'),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-right font-bold"},(item.stock||0).toLocaleString()," EA"),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-right"},itemOver>0?/*#__PURE__*/React.createElement("span",{className:"text-orange-600 font-medium"},"+",itemOver.toLocaleString()," EA"):/*#__PURE__*/React.createElement("span",{className:"text-gray-400"},"-")),/*#__PURE__*/React.createElement("td",{className:"px-4 py-3 text-right"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs ${itemOverPercent>100?'bg-red-100 text-red-700':itemOverPercent>50?'bg-orange-100 text-orange-700':'bg-gray-100 text-gray-600'}`},itemOverPercent,"%")));})))),/*#__PURE__*/React.createElement("div",{className:"p-4 border-t bg-gray-50 rounded-b-xl flex-shrink-0"},/*#__PURE__*/React.createElement("button",{onClick:()=>setBinDetailModal(null),className:"w-full py-2 bg-gray-200 hover:bg-gray-300 rounded-lg font-medium"},"\uB2EB\uAE30"))))),showDataUploadModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl flex flex-col",style:{maxHeight:'90vh'}},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center p-6 border-b flex-shrink-0"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-xl flex items-center gap-2"},/*#__PURE__*/React.createElement(Database,{className:"w-6 h-6 text-indigo-600"}),"\uB370\uC774\uD130 \uAD00\uB9AC"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowDataUploadModal(false),className:"p-1 hover:bg-gray-100 rounded"},/*#__PURE__*/React.createElement(X,{className:"w-6 h-6"}))),/*#__PURE__*/React.createElement("div",{className:"flex-1 overflow-y-auto p-6"},/*#__PURE__*/React.createElement("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700 mb-3"},"\uD83D\uDCCA \uB370\uC774\uD130 \uC5C5\uB370\uC774\uD2B8 \uD604\uD669"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4 text-sm"},/*#__PURE__*/React.createElement("div",{className:`p-3 rounded-lg ${lastUpdated?'bg-emerald-50 border border-emerald-200':'bg-gray-100'}`},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mb-1"},"SAP Stock"),/*#__PURE__*/React.createElement("p",{className:`font-medium ${lastUpdated?'text-emerald-700':'text-gray-400'}`},lastUpdated?lastUpdated.replace(/^20(\d{2})/,'$1'):'미업로드')),/*#__PURE__*/React.createElement("div",{className:`p-3 rounded-lg ${openPOLastUpdated?'bg-amber-50 border border-amber-200':'bg-gray-100'}`},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mb-1"},"Open PO"),/*#__PURE__*/React.createElement("p",{className:`font-medium ${openPOLastUpdated?'text-amber-700':'text-gray-400'}`},openPOLastUpdated?openPOLastUpdated.replace(/^20(\d{2})/,'$1'):'미업로드')),/*#__PURE__*/React.createElement("div",{className:`p-3 rounded-lg ${bomLastUpdated?'bg-purple-50 border border-purple-200':'bg-gray-100'}`},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mb-1"},"BOM"),/*#__PURE__*/React.createElement("p",{className:`font-medium ${bomLastUpdated?'text-purple-700':'text-gray-400'}`},bomLastUpdated?bomLastUpdated.replace(/^20(\d{2})/,'$1'):'기본값')))),/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",{className:"border-2 border-dashed rounded-xl p-4 hover:border-emerald-400 transition",onDragOver:e=>{e.preventDefault();e.currentTarget.classList.add('border-emerald-500','bg-emerald-50');},onDragLeave:e=>{e.preventDefault();e.currentTarget.classList.remove('border-emerald-500','bg-emerald-50');},onDrop:e=>{e.preventDefault();e.currentTarget.classList.remove('border-emerald-500','bg-emerald-50');const file=e.dataTransfer.files[0];if(file&&(file.name.endsWith('.xlsx')||file.name.endsWith('.xls'))){setShowDataUploadModal(false);setShowUploadModal(true);setTimeout(()=>{const input=document.getElementById('fileInput');if(input){const dt=new DataTransfer();dt.items.add(file);input.files=dt.files;handleFileSelect({target:{files:[file]}});}},100);}else{alert('xlsx 또는 xls 파일만 업로드 가능합니다.');}}},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-3"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center"},/*#__PURE__*/React.createElement(Upload,{className:"w-5 h-5 text-emerald-600"})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-medium text-gray-800"},"SAP Stock \uC5C5\uB85C\uB4DC"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"Zbindata_latest.xlsx"))),/*#__PURE__*/React.createElement("label",{className:"px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg cursor-pointer transition text-sm font-medium"},"\uD30C\uC77C \uC120\uD0DD",/*#__PURE__*/React.createElement("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{const file=e.target.files[0];if(file){setShowDataUploadModal(false);setShowUploadModal(true);setTimeout(()=>{const input=document.getElementById('fileInput');if(input){const dt=new DataTransfer();dt.items.add(file);input.files=dt.files;handleFileSelect({target:{files:[file]}});}},100);}},className:"hidden"}))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 text-center mb-2"},"\uB610\uB294 \uD30C\uC77C\uC744 \uC5EC\uAE30\uB85C \uB4DC\uB798\uADF8\uD558\uC138\uC694"),/*#__PURE__*/React.createElement("a",{href:"https://promega-my.sharepoint.com/:f:/p/jimin_jung/IgA_AwP1xtjuS4G9pD9RQZD2AelK_uC-h4A9YaW6Jy68kuc?e=GU2XLo",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700"},/*#__PURE__*/React.createElement(ExternalLink,{className:"w-4 h-4"}),"OneDrive \uD3F4\uB354 \uC5F4\uAE30")),/*#__PURE__*/React.createElement("div",{className:"border-2 border-dashed rounded-xl p-4 hover:border-amber-400 transition",onDragOver:e=>{e.preventDefault();e.currentTarget.classList.add('border-amber-500','bg-amber-50');},onDragLeave:e=>{e.preventDefault();e.currentTarget.classList.remove('border-amber-500','bg-amber-50');},onDrop:e=>{e.preventDefault();e.currentTarget.classList.remove('border-amber-500','bg-amber-50');const file=e.dataTransfer.files[0];if(file&&(file.name.endsWith('.xlsx')||file.name.endsWith('.xls'))){parseOpenPOFile(file);setShowDataUploadModal(false);}else{alert('xlsx 또는 xls 파일만 업로드 가능합니다.');}}},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-3"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center"},/*#__PURE__*/React.createElement(FileSpreadsheet,{className:"w-5 h-5 text-amber-600"})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-medium text-gray-800"},"Open PO \uC5C5\uB85C\uB4DC"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"\uB0A9\uD488 \uC608\uC815 \uC790\uC7AC \uB370\uC774\uD130"))),/*#__PURE__*/React.createElement("label",{className:"px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-lg cursor-pointer transition text-sm font-medium"},"\uD30C\uC77C \uC120\uD0DD",/*#__PURE__*/React.createElement("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{const file=e.target.files[0];if(file){parseOpenPOFile(file);setShowDataUploadModal(false);}e.target.value='';},className:"hidden"}))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 text-center mb-2"},"\uB610\uB294 \uD30C\uC77C\uC744 \uC5EC\uAE30\uB85C \uB4DC\uB798\uADF8\uD558\uC138\uC694"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"\uD544\uC218 \uCEEC\uB7FC: Material, Order Quantity, Order Unit, Document Number")),/*#__PURE__*/React.createElement("div",{className:"border-2 border-dashed rounded-xl p-4 hover:border-purple-400 transition",onDragOver:e=>{e.preventDefault();e.currentTarget.classList.add('border-purple-500','bg-purple-50');},onDragLeave:e=>{e.preventDefault();e.currentTarget.classList.remove('border-purple-500','bg-purple-50');},onDrop:e=>{e.preventDefault();e.currentTarget.classList.remove('border-purple-500','bg-purple-50');const file=e.dataTransfer.files[0];if(file&&(file.name.endsWith('.xlsx')||file.name.endsWith('.xls'))){handleBOMFileSelect({target:{files:[file]}});setShowDataUploadModal(false);}else{alert('xlsx 또는 xls 파일만 업로드 가능합니다.');}}},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-3"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center"},/*#__PURE__*/React.createElement(Package,{className:"w-5 h-5 text-purple-600"})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-medium text-gray-800"},"BOM \uC5C5\uB85C\uB4DC"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"\uBAA8\uB378\uBCC4 \uC790\uC7AC \uC18C\uC694\uB7C9"))),/*#__PURE__*/React.createElement("div",{className:"flex gap-2"},/*#__PURE__*/React.createElement("label",{className:"px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg cursor-pointer transition text-sm font-medium"},"\uD30C\uC77C \uC120\uD0DD",/*#__PURE__*/React.createElement("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{handleBOMFileSelect(e);setShowDataUploadModal(false);},className:"hidden"})))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 text-center mb-2"},"\uB610\uB294 \uD30C\uC77C\uC744 \uC5EC\uAE30\uB85C \uB4DC\uB798\uADF8\uD558\uC138\uC694"),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500 space-y-1"},/*#__PURE__*/React.createElement("p",null,"\u2022 \uCEEC\uB7FC: Component number (Part No.), Comp. Qty (CUn) (\uC218\uB7C9)"),/*#__PURE__*/React.createElement("p",null,"\u2022 Phantom item = X \uC778 \uD488\uBAA9\uC740 \uC790\uB3D9 \uC81C\uC678"),/*#__PURE__*/React.createElement("p",null,"\u2022 Item category = L \uC778 \uD488\uBAA9\uB9CC \uD3EC\uD568 (D, T \uC81C\uC678)"),/*#__PURE__*/React.createElement("p",null,"\u2022 \uC2DC\uD2B8 \uD0ED: AS/A2715 \u2192 \uC644\uC81C\uD488, KB \u2192 Sub-component"),/*#__PURE__*/React.createElement("p",null,"\u2022 \uD604\uC7AC: ",customBomData?`📦 완제품 ${Object.keys(customBomData).length}개 모델`+(subComponentBomData?` | 🔧 Sub-com ${Object.keys(subComponentBomData).length}개`:''):'기본 BOM 사용 중'))),/*#__PURE__*/React.createElement("div",{className:"border-2 border-dashed rounded-xl p-4 hover:border-slate-400 transition"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-3"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center"},/*#__PURE__*/React.createElement(Scale,{className:"w-5 h-5 text-slate-600"})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-medium text-gray-800"},"\uBB34\uAC8C \uC815\uBCF4"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"Material\uBCC4 \uBB34\uAC8C(g) \uAD00\uB9AC \u2022 ",Object.keys(weightData).length,"\uAC1C \uD488\uBAA9"))),/*#__PURE__*/React.createElement("button",{onClick:()=>{setShowDataUploadModal(false);setActiveTab('weight');},className:"px-4 py-2 bg-slate-500 hover:bg-slate-600 text-white rounded-lg transition text-sm font-medium"},"\uC0C1\uC138 \uBCF4\uAE30")),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500 space-y-1"},/*#__PURE__*/React.createElement("p",null,"\u2022 Material\uBCC4 \uBB34\uAC8C(g) \uC870\uD68C/\uC218\uC815/\uCD94\uAC00"),/*#__PURE__*/React.createElement("p",null,"\u2022 Kitting \uC644\uB8CC \uC2DC \uCD1D \uBB34\uAC8C \uACC4\uC0B0\uC5D0 \uC0AC\uC6A9"))),/*#__PURE__*/React.createElement("div",{className:"border-2 border-dashed rounded-xl p-4 hover:border-blue-400 transition"},/*#__PURE__*/React.createElement("div",{className:"flex items-center justify-between mb-3"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},/*#__PURE__*/React.createElement(FileSpreadsheet,{className:"w-5 h-5 text-blue-600"})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-medium text-gray-800"},"\uC7AC\uACE0 \uBAA9\uB85D"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"SAP \uC7AC\uACE0 \uD604\uD669 \uC870\uD68C \u2022 ",inventoryData.length,"\uAC1C \uD488\uBAA9"))),/*#__PURE__*/React.createElement("button",{onClick:()=>{setShowDataUploadModal(false);setActiveTab('inventory');},className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition text-sm font-medium"},"\uC0C1\uC138 \uBCF4\uAE30")),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500 space-y-1"},/*#__PURE__*/React.createElement("p",null,"\u2022 Material\uBCC4 \uC7AC\uACE0 \uC218\uB7C9, Bin \uC704\uCE58 \uC870\uD68C"),/*#__PURE__*/React.createElement("p",null,"\u2022 \uD488\uBC88/\uD488\uBA85 \uAC80\uC0C9 \uAE30\uB2A5"))))),/*#__PURE__*/React.createElement("div",{className:"flex justify-end p-6 border-t flex-shrink-0 bg-gray-50"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowDataUploadModal(false),className:"px-6 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg transition"},"\uB2EB\uAE30")))),showUploadModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg m-4"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"SAP \uC7AC\uACE0 \uB370\uC774\uD130 \uC5C5\uB85C\uB4DC"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowUploadModal(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"mb-4"},/*#__PURE__*/React.createElement("a",{href:"https://promega-my.sharepoint.com/:f:/p/jimin_jung/IgA_AwP1xtjuS4G9pD9RQZD2AelK_uC-h4A9YaW6Jy68kuc?e=GU2XLo",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition font-medium"},/*#__PURE__*/React.createElement(ExternalLink,{className:"w-5 h-5"}),"\uD83D\uDCC2 OneDrive \uD3F4\uB354 \uC5F4\uAE30 (Zbindata_latest.xlsx)"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 text-center mt-2"},"\uD83D\uDCA1 \uD3F4\uB354 \uC5F4\uAE30 \u2192 \uD30C\uC77C\uC744 \uC544\uB798 \uC601\uC5ED\uC73C\uB85C \uB4DC\uB798\uADF8 \uC564 \uB4DC\uB86D!")),/*#__PURE__*/React.createElement("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-indigo-400 transition cursor-pointer",onDrop:handleDrop,onDragOver:e=>e.preventDefault(),onClick:()=>document.getElementById('fileInput').click()},isLoading?/*#__PURE__*/React.createElement("div",{className:"flex flex-col items-center"},/*#__PURE__*/React.createElement(RefreshCw,{className:"w-12 h-12 text-indigo-500 animate-spin mb-4"}),/*#__PURE__*/React.createElement("p",{className:"text-gray-600"},"\uD30C\uC77C \uCC98\uB9AC \uC911...")):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Upload,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),/*#__PURE__*/React.createElement("p",{className:"text-gray-600 mb-2"},"SAP \uC5D1\uC140 \uD30C\uC77C\uC744 \uB4DC\uB798\uADF8\uD558\uAC70\uB098 \uD074\uB9AD\uD558\uC5EC \uC120\uD0DD"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-400"},"\uC9C0\uC6D0 \uD615\uC2DD: .xlsx, .xls")),/*#__PURE__*/React.createElement("input",{id:"fileInput",type:"file",accept:".xlsx,.xls",onChange:handleFileSelect,className:"hidden"})),uploadError&&/*#__PURE__*/React.createElement("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm"},uploadError),/*#__PURE__*/React.createElement("div",{className:"mt-6 p-4 bg-slate-50 rounded-lg"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700 mb-2"},"\uD83D\uDCCB SAP \uC5D1\uC140 \uD615\uC2DD \uC548\uB0B4"),/*#__PURE__*/React.createElement("ul",{className:"text-xs text-gray-500 space-y-1"},/*#__PURE__*/React.createElement("li",null,"\u2022 ",/*#__PURE__*/React.createElement("strong",null,"Description\uC774 \uBE44\uC5B4\uC788\uB294 \uD589 (\uB178\uB780\uC0C9)"),"\uC758 \uCD1D \uC7AC\uACE0\uB97C \uC778\uC2DD\uD569\uB2C8\uB2E4"),/*#__PURE__*/React.createElement("li",null,"\u2022 Storage Bin \uC815\uBCF4\uB294 Description\uC774 \uC788\uB294 \uD589\uC5D0\uC11C \uB9E4\uD551\uD569\uB2C8\uB2E4"),/*#__PURE__*/React.createElement("li",null,"\u2022 Production Order Bin (\uC22B\uC790 \uC2DC\uC791)\uC740 \uC790\uB3D9 \uC81C\uC678\uB429\uB2C8\uB2E4"))),lastUpdated&&/*#__PURE__*/React.createElement("div",{className:"mt-4 flex justify-between items-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},"\uD604\uC7AC \uB370\uC774\uD130: ",lastUpdated),/*#__PURE__*/React.createElement("button",{onClick:clearData,className:"text-sm text-red-500 hover:text-red-700"},"\uB370\uC774\uD130 \uCD08\uAE30\uD654")))),showOpenPOModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg m-4"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCE6 Open PO \uC5C5\uB85C\uB4DC (\uB0A9\uD488 \uC608\uC815 \uC790\uC7AC)"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowOpenPOModal(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"border-2 border-dashed border-amber-300 rounded-xl p-8 text-center hover:border-amber-500 transition cursor-pointer bg-amber-50/30",onDrop:handleOpenPODrop,onDragOver:e=>e.preventDefault(),onClick:()=>document.getElementById('openPOFileInput').click()},isLoading?/*#__PURE__*/React.createElement("div",{className:"flex flex-col items-center"},/*#__PURE__*/React.createElement(RefreshCw,{className:"w-12 h-12 text-amber-500 animate-spin mb-4"}),/*#__PURE__*/React.createElement("p",{className:"text-gray-600"},"\uD30C\uC77C \uCC98\uB9AC \uC911...")):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(FileSpreadsheet,{className:"w-12 h-12 text-amber-400 mx-auto mb-4"}),/*#__PURE__*/React.createElement("p",{className:"text-gray-600 mb-2"},"Open PO \uC5D1\uC140 \uD30C\uC77C\uC744 \uB4DC\uB798\uADF8\uD558\uAC70\uB098 \uD074\uB9AD\uD558\uC5EC \uC120\uD0DD"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-400"},"\uC9C0\uC6D0 \uD615\uC2DD: .xlsx, .xls")),/*#__PURE__*/React.createElement("input",{id:"openPOFileInput",type:"file",accept:".xlsx,.xls",onChange:handleOpenPOFileSelect,className:"hidden"})),openPOError&&/*#__PURE__*/React.createElement("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm"},openPOError),/*#__PURE__*/React.createElement("div",{className:"mt-6 p-4 bg-amber-50 rounded-lg"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-700 mb-2"},"\uD83D\uDCCB Open PO \uC5D1\uC140 \uD615\uC2DD \uC548\uB0B4"),/*#__PURE__*/React.createElement("ul",{className:"text-xs text-gray-500 space-y-1"},/*#__PURE__*/React.createElement("li",null,"\u2022 ",/*#__PURE__*/React.createElement("strong",null,"Still to be delivered (qty) > 0"),"\uC778 \uD56D\uBAA9\uB9CC \uC778\uC2DD\uB429\uB2C8\uB2E4"),/*#__PURE__*/React.createElement("li",null,"\u2022 Material (M\uC5F4), Short Text (N\uC5F4)\uC5D0\uC11C \uC790\uC7AC \uC815\uBCF4\uB97C \uC77D\uC2B5\uB2C8\uB2E4"),/*#__PURE__*/React.createElement("li",null,"\u2022 \uB3D9\uC77C \uC790\uC7AC\uC758 \uB0A9\uD488 \uC608\uC815 \uC218\uB7C9\uC740 \uC790\uB3D9 \uD569\uC0B0\uB429\uB2C8\uB2E4"))),openPOLastUpdated&&/*#__PURE__*/React.createElement("div",{className:"mt-4 flex justify-between items-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500"},"\uD604\uC7AC \uB370\uC774\uD130: ",openPOLastUpdated),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-4"},/*#__PURE__*/React.createElement("span",{className:"text-sm text-amber-600 font-medium"},openPOData.length,"\uAC1C \uC790\uC7AC"),/*#__PURE__*/React.createElement("button",{onClick:()=>{setOpenPOData([]);setOpenPOLastUpdated(null);safeStorage.removeItem('pbk_open_po');safeStorage.removeItem('pbk_open_po_updated');},className:"text-sm text-red-500 hover:text-red-700"},"\uCD08\uAE30\uD654"))))),showPickModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md m-4"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uC0C8 \uBD88\uCD9C \uAE30\uB85D"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowPickModal(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Production Order"),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"\uC608: 1000012345",className:"w-full border rounded-lg px-3 py-2",value:newPick.productionOrder,onChange:e=>setNewPick({...newPick,productionOrder:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Model"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:newPick.model,onChange:e=>setNewPick({...newPick,model:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"RSC48"},"RSC48"),/*#__PURE__*/React.createElement("option",{value:"CSC48"},"CSC48"),/*#__PURE__*/React.createElement("option",{value:"RSC16"},"RSC16"),/*#__PURE__*/React.createElement("option",{value:"CSC16"},"CSC16"),/*#__PURE__*/React.createElement("option",{value:"FSC16"},"FSC16"),/*#__PURE__*/React.createElement("option",{value:"HSM3.0"},"HSM3.0"),/*#__PURE__*/React.createElement("option",{value:"Spare Parts"},"Spare Parts"),/*#__PURE__*/React.createElement("option",{value:"Sub-com."},"Sub-com."))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uB2F4\uB2F9\uC790"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:newPick.worker,onChange:e=>setNewPick({...newPick,worker:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"Z01"},"Z01"),/*#__PURE__*/React.createElement("option",{value:"Z02"},"Z02"),/*#__PURE__*/React.createElement("option",{value:"Z03"},"Z03"),/*#__PURE__*/React.createElement("option",{value:"Z04"},"Z04"),/*#__PURE__*/React.createElement("option",{value:"Z06"},"Z06"))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Pick List \uC218\uB839 \uC2DC\uAC01"),/*#__PURE__*/React.createElement("input",{type:"datetime-local",className:"w-full border rounded-lg px-3 py-2",onChange:e=>setNewPick({...newPick,received:e.target.value.replace('T',' ')})})),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("label",{className:"flex items-center gap-2 cursor-pointer"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:newPick.isUrgent,onChange:e=>setNewPick({...newPick,isUrgent:e.target.checked}),className:"w-5 h-5 text-red-600 rounded"}),/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium text-red-600"},"\uD83D\uDEA8 \uAE34\uAE09")))),/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mt-6"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowPickModal(false),className:"flex-1 px-4 py-2 border rounded-lg"},"\uCDE8\uC18C"),/*#__PURE__*/React.createElement("button",{onClick:addPick,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg"},"\uCD94\uAC00")))),showReceiveModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md m-4"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uC0C8 \uC785\uACE0 \uAE30\uB85D"),/*#__PURE__*/React.createElement("button",{onClick:()=>{setShowReceiveModal(false);setShowVendorSuggestions(false);}},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"No."),/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 bg-gray-100",readOnly:true,value:(()=>{const maxNo=receiveCycles.reduce((max,r)=>{const num=parseInt(r.poNo)||0;return num>max?num:max;},0);return maxNo+1;})()})),/*#__PURE__*/React.createElement("div",{className:"relative"},/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uD611\uB825\uC5C5\uCCB4"),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"\uC5C5\uCCB4\uBA85 \uC785\uB825 (\uC790\uB3D9\uC644\uC131)",className:"w-full border rounded-lg px-3 py-2",value:newReceive.vendor,onChange:e=>{setNewReceive({...newReceive,vendor:e.target.value});setShowVendorSuggestions(true);},onFocus:()=>setShowVendorSuggestions(true),onBlur:()=>setTimeout(()=>setShowVendorSuggestions(false),200)}),showVendorSuggestions&&filteredVendorSuggestions.length>0&&/*#__PURE__*/React.createElement("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-40 overflow-y-auto"},filteredVendorSuggestions.map((vendor,idx)=>/*#__PURE__*/React.createElement("button",{key:idx,className:"w-full text-left px-3 py-2 hover:bg-indigo-50 text-sm",onClick:()=>{setNewReceive({...newReceive,vendor});setShowVendorSuggestions(false);}},vendor)))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uB0A9\uD488 \uC2DC\uAC01"),/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 bg-gray-100",readOnly:true,value:new Date().toLocaleString('ko-KR',{timeZone:'Asia/Seoul',year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',hour12:false}).replace(/\. /g,'-').replace('.','')}))),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mt-3"},"\uD83D\uDCA1 \uB2E8\uCD95\uD0A4: Ctrl+M (\uC0C8 \uC785\uACE0)"),/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mt-4"},/*#__PURE__*/React.createElement("button",{onClick:()=>{setShowReceiveModal(false);setShowVendorSuggestions(false);},className:"flex-1 px-4 py-2 border rounded-lg"},"\uCDE8\uC18C"),/*#__PURE__*/React.createElement("button",{onClick:addReceive,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg"},"\uCD94\uAC00")))),showWeightModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md m-4"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uC2E0\uADDC Material \uCD94\uAC00"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowWeightModal(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Material (\uD488\uBC88) *"),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"\uC608: 712626",className:"w-full border rounded-lg px-3 py-2",value:newMaterial.material,onChange:e=>setNewMaterial({...newMaterial,material:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Description (\uD488\uBA85)"),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"\uC608: LED INDICATOR BRACKET",className:"w-full border rounded-lg px-3 py-2",value:newMaterial.desc,onChange:e=>setNewMaterial({...newMaterial,desc:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uBB34\uAC8C (g)"),/*#__PURE__*/React.createElement("input",{type:"number",step:"0.1",placeholder:"\uC608: 244",className:"w-full border rounded-lg px-3 py-2",value:newMaterial.weight,onChange:e=>setNewMaterial({...newMaterial,weight:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Storage Bin"),/*#__PURE__*/React.createElement("input",{type:"text",placeholder:"\uC608: A1-01",className:"w-full border rounded-lg px-3 py-2",value:newMaterial.bin,onChange:e=>setNewMaterial({...newMaterial,bin:e.target.value})}))),/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mt-6"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowWeightModal(false),className:"flex-1 px-4 py-2 border rounded-lg"},"\uCDE8\uC18C"),/*#__PURE__*/React.createElement("button",{onClick:addNewMaterial,className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg"},"\uCD94\uAC00")))),editingPick&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md m-4 max-h-[90vh] overflow-y-auto"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uBD88\uCD9C \uAE30\uB85D \uC218\uC815"),/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingPick(null)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Production Order"),/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full border rounded-lg px-3 py-2",value:editingPick.productionOrder||editingPick.orderId||'',onChange:e=>setEditingPick({...editingPick,productionOrder:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Model"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:editingPick.model,onChange:e=>setEditingPick({...editingPick,model:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"RSC48"},"RSC48"),/*#__PURE__*/React.createElement("option",{value:"CSC48"},"CSC48"),/*#__PURE__*/React.createElement("option",{value:"RSC16"},"RSC16"),/*#__PURE__*/React.createElement("option",{value:"CSC16"},"CSC16"),/*#__PURE__*/React.createElement("option",{value:"FSC16"},"FSC16"),/*#__PURE__*/React.createElement("option",{value:"HSM3.0"},"HSM3.0"),/*#__PURE__*/React.createElement("option",{value:"Spare Parts"},"Spare Parts"),/*#__PURE__*/React.createElement("option",{value:"Sub-com."},"Sub-com."))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uB2F4\uB2F9\uC790"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:editingPick.worker||'Z01',onChange:e=>setEditingPick({...editingPick,worker:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"Z01"},"Z01"),/*#__PURE__*/React.createElement("option",{value:"Z02"},"Z02"),/*#__PURE__*/React.createElement("option",{value:"Z03"},"Z03"),/*#__PURE__*/React.createElement("option",{value:"Z04"},"Z04"),/*#__PURE__*/React.createElement("option",{value:"Z06"},"Z06"))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Material Description"),/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full border rounded-lg px-3 py-2",value:editingPick.materialDesc||'',onChange:e=>setEditingPick({...editingPick,materialDesc:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC2DC\uC791\uC608\uC815\uC77C"),/*#__PURE__*/React.createElement("input",{type:"date",className:"w-full border rounded-lg px-3 py-2",value:editingPick.basicStartDate||'',onChange:e=>setEditingPick({...editingPick,basicStartDate:e.target.value})})),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("label",{className:"flex items-center gap-2 cursor-pointer"},/*#__PURE__*/React.createElement("input",{type:"checkbox",checked:editingPick.isUrgent||false,onChange:e=>setEditingPick({...editingPick,isUrgent:e.target.checked}),className:"w-5 h-5 text-red-600 rounded"}),/*#__PURE__*/React.createElement("span",{className:"text-sm font-medium text-red-600"},"\uD83D\uDEA8 \uAE34\uAE09"))),/*#__PURE__*/React.createElement("div",{className:"border-t pt-4"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-500 mb-3"},"\u23F1\uFE0F \uD0C0\uC774\uBA38 \uC815\uBCF4"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 gap-3"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC2DC\uC791 \uC2DC\uAC04"),/*#__PURE__*/React.createElement("input",{type:"datetime-local",className:"w-full border rounded-lg px-3 py-2 text-sm",value:editingPick.startTime?(()=>{const d=new Date(editingPick.startTime);return d.getFullYear()+'-'+String(d.getMonth()+1).padStart(2,'0')+'-'+String(d.getDate()).padStart(2,'0')+'T'+String(d.getHours()).padStart(2,'0')+':'+String(d.getMinutes()).padStart(2,'0');})():'',onChange:e=>setEditingPick({...editingPick,startTime:e.target.value?new Date(e.target.value).toISOString():null})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC644\uB8CC \uC2DC\uAC04"),/*#__PURE__*/React.createElement("input",{type:"datetime-local",className:"w-full border rounded-lg px-3 py-2 text-sm",value:editingPick.completed?editingPick.completed.replace(' ','T'):'',onChange:e=>setEditingPick({...editingPick,completed:e.target.value?e.target.value.replace('T',' '):null})}))),/*#__PURE__*/React.createElement("div",{className:"mt-3"},/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Cycle Time (\uBD84)"),/*#__PURE__*/React.createElement("input",{type:"number",className:"w-full border rounded-lg px-3 py-2",value:editingPick.cycleMin||'',onChange:e=>setEditingPick({...editingPick,cycleMin:e.target.value?parseInt(e.target.value):null})}))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC0C1\uD0DC"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:editingPick.status,onChange:e=>setEditingPick({...editingPick,status:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"waiting"},"\uB300\uAE30"),/*#__PURE__*/React.createElement("option",{value:"in-progress"},"\uC9C4\uD589\uC911"),/*#__PURE__*/React.createElement("option",{value:"paused"},"\uC77C\uC2DC\uC815\uC9C0"),/*#__PURE__*/React.createElement("option",{value:"completed"},"\uC644\uB8CC")))),/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mt-6"},/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingPick(null),className:"flex-1 px-4 py-2 border rounded-lg"},"\uCDE8\uC18C"),/*#__PURE__*/React.createElement("button",{onClick:saveEditPick,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg"},"\uC800\uC7A5")))),editingReceive&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md m-4 max-h-[90vh] overflow-y-auto"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uC785\uACE0 \uAE30\uB85D \uC218\uC815"),/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingReceive(null)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"No."),/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full border rounded-lg px-3 py-2 bg-gray-100",readOnly:true,value:editingReceive.poNo||''})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uD611\uB825\uC5C5\uCCB4"),/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full border rounded-lg px-3 py-2",value:editingReceive.vendor||'',onChange:e=>setEditingReceive({...editingReceive,vendor:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uB0A9\uD488 \uC2DC\uAC01"),/*#__PURE__*/React.createElement("input",{type:"datetime-local",className:"w-full border rounded-lg px-3 py-2",value:editingReceive.delivery?(()=>{const m=editingReceive.delivery.match(/(\d{4})-(\d{2})-(\d{2})[\s\-T](\d{2}):(\d{2})/);return m?m[1]+'-'+m[2]+'-'+m[3]+'T'+m[4]+':'+m[5]:'';})():'',onChange:e=>{const v=e.target.value.replace('T',' ');setEditingReceive({...editingReceive,delivery:v,startTime:e.target.value?new Date(e.target.value).toISOString():null});}})),/*#__PURE__*/React.createElement("div",{className:"border-t pt-4"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-500 mb-3"},"\u23F1\uFE0F \uD0C0\uC774\uBA38 \uC815\uBCF4"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-1 gap-3"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"MIGO \uC644\uB8CC"),/*#__PURE__*/React.createElement("input",{type:"datetime-local",className:"w-full border rounded-lg px-3 py-2 text-sm",value:editingReceive.migo?editingReceive.migo.replace(' ','T'):'',onChange:e=>setEditingReceive({...editingReceive,migo:e.target.value?e.target.value.replace('T',' '):null})}))),/*#__PURE__*/React.createElement("div",{className:"mt-3"},/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Cycle Time (\uBD84)"),/*#__PURE__*/React.createElement("input",{type:"number",className:"w-full border rounded-lg px-3 py-2",value:editingReceive.cycleMin||'',onChange:e=>setEditingReceive({...editingReceive,cycleMin:e.target.value?parseInt(e.target.value):null})}))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC0C1\uD0DC"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:editingReceive.status,onChange:e=>setEditingReceive({...editingReceive,status:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"waiting"},"\uB300\uAE30"),/*#__PURE__*/React.createElement("option",{value:"in-progress"},"\uC9C4\uD589\uC911"),/*#__PURE__*/React.createElement("option",{value:"paused"},"\uC77C\uC2DC\uC815\uC9C0"),/*#__PURE__*/React.createElement("option",{value:"completed"},"\uC644\uB8CC"))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Comments"),/*#__PURE__*/React.createElement("textarea",{className:"w-full border rounded-lg px-3 py-2 text-sm",rows:"2",placeholder:"\uC9C0\uC5F0 \uC0AC\uC720 \uB4F1 \uBA54\uBAA8 \uC785\uB825...",value:editingReceive.comments||'',onChange:e=>setEditingReceive({...editingReceive,comments:e.target.value})}))),/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mt-6"},/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingReceive(null),className:"flex-1 px-4 py-2 border rounded-lg"},"\uCDE8\uC18C"),/*#__PURE__*/React.createElement("button",{onClick:saveEditReceive,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg"},"\uC800\uC7A5")))),showPickDetailModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>setShowPickDetailModal(false)},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-3xl flex flex-col",style:{maxHeight:'calc(100vh - 2rem)'},onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center p-6 pb-4 border-b flex-shrink-0"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCCA Model\uBCC4 \uD3C9\uADE0 Kitting \uC2DC\uAC04"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowPickDetailModal(false),className:"p-1 hover:bg-gray-100 rounded"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"overflow-y-auto p-6",style:{minHeight:0}},/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},['RSC48','CSC48','RSC16','CSC16','FSC16','HSM3.0','Spare Parts'].map(model=>{const completedPicks=pickCycles.filter(p=>p.model===model&&p.status==='completed'&&p.cycleMin);const avgTime=completedPicks.length>0?Math.round(completedPicks.reduce((s,p)=>s+p.cycleMin,0)/completedPicks.length):0;const minTime=completedPicks.length>0?Math.min(...completedPicks.map(p=>p.cycleMin)):0;const maxTime=completedPicks.length>0?Math.max(...completedPicks.map(p=>p.cycleMin)):0;return/*#__PURE__*/React.createElement("div",{key:model,className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg p-4 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-600 mb-1"},model),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-purple-600"},avgTime,"\uBD84"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"\uC644\uB8CC: ",completedPicks.length,"\uAC74"),completedPicks.length>0&&/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 mt-1"},"\uCD5C\uC18C ",minTime,"\uBD84 / \uCD5C\uB300 ",maxTime,"\uBD84"));})),/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-3"},"\uD83D\uDCCB \uCD5C\uADFC \uC644\uB8CC \uAE30\uB85D (\uCD5C\uADFC 20\uAC74)"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-50"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Production Order"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Model"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uC644\uB8CC\uC77C"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"Cycle Time"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},pickCycles.filter(p=>p.status==='completed'&&p.cycleMin).sort((a,b)=>(b.completed||'').localeCompare(a.completed||'')).slice(0,20).map(p=>/*#__PURE__*/React.createElement("tr",{key:p.id},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-medium"},p.productionOrder||p.orderId),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded text-xs"},p.model)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center text-gray-600"},p.completed),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs ${p.cycleMin>60?'bg-red-100 text-red-700':p.cycleMin>45?'bg-amber-100 text-yellow-600':'bg-emerald-100 text-blue-600'}`},p.cycleMin,"\uBD84")))))),pickCycles.filter(p=>p.status==='completed'&&p.cycleMin).length===0&&/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-400 py-8"},"\uC644\uB8CC\uB41C \uAE30\uB85D\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"))))),showReceiveDetailModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>setShowReceiveDetailModal(false)},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-3xl m-4 flex flex-col",style:{maxHeight:'85vh'},onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center p-6 pb-4 border-b flex-shrink-0"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCCA \uD611\uB825\uC5C5\uCCB4\uBCC4 \uD3C9\uADE0 \uC785\uACE0\uC2DC\uAC04"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowReceiveDetailModal(false),className:"p-1 hover:bg-gray-100 rounded"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"p-6",style:{overflowY:'auto',flex:1}},/*#__PURE__*/React.createElement("div",{className:"mb-6"},/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4"},(()=>{const vendorStats={};receiveCycles.filter(r=>r.status==='completed'&&r.cycleMin&&r.vendor).forEach(r=>{if(!vendorStats[r.vendor]){vendorStats[r.vendor]={total:0,count:0,min:Infinity,max:0};}vendorStats[r.vendor].total+=r.cycleMin;vendorStats[r.vendor].count+=1;vendorStats[r.vendor].min=Math.min(vendorStats[r.vendor].min,r.cycleMin);vendorStats[r.vendor].max=Math.max(vendorStats[r.vendor].max,r.cycleMin);});return Object.entries(vendorStats).sort((a,b)=>b[1].count-a[1].count).slice(0,9).map(([vendor,stats])=>/*#__PURE__*/React.createElement("div",{key:vendor,className:"bg-gradient-to-br from-slate-50 to-indigo-50 rounded-lg p-4"},/*#__PURE__*/React.createElement("p",{className:"text-sm font-medium text-gray-600 truncate mb-1",title:vendor},vendor),/*#__PURE__*/React.createElement("p",{className:"text-2xl font-bold text-indigo-600"},Math.round(stats.total/stats.count),"\uBD84"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"\uC644\uB8CC: ",stats.count,"\uAC74"),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400"},"\uCD5C\uC18C ",stats.min,"\uBD84 / \uCD5C\uB300 ",stats.max,"\uBD84")));})()),receiveCycles.filter(r=>r.status==='completed'&&r.cycleMin).length===0&&/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-400 py-4"},"\uC644\uB8CC\uB41C \uAE30\uB85D\uC774 \uC5C6\uC2B5\uB2C8\uB2E4")),/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-3"},"\uD83D\uDCCB \uCD5C\uADFC \uC644\uB8CC \uAE30\uB85D (\uCD5C\uADFC 20\uAC74)"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-50"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"No."),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uD611\uB825\uC5C5\uCCB4"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"MIGO \uC644\uB8CC"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"Cycle Time"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},receiveCycles.filter(r=>r.status==='completed'&&r.cycleMin).sort((a,b)=>(b.migo||'').localeCompare(a.migo||'')).slice(0,20).map(r=>/*#__PURE__*/React.createElement("tr",{key:r.id},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-medium"},r.poNo),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},r.vendor),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center text-gray-600"},convertToKoreaTime(r.migo)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs ${r.cycleMin>90?'bg-red-100 text-red-600':r.cycleMin>60?'bg-amber-100 text-amber-700':'bg-green-100 text-green-700'}`},r.cycleMin,"\uBD84")))))),receiveCycles.filter(r=>r.status==='completed'&&r.cycleMin).length===0&&/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-400 py-8"},"\uC644\uB8CC\uB41C \uAE30\uB85D\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"))),/*#__PURE__*/React.createElement("div",{className:"flex-shrink-0 border-t p-4 flex justify-end"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowPickDetailModal(false),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},"\uB2EB\uAE30")))),showLeadTimeDetailModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>setShowLeadTimeDetailModal(false)},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl flex flex-col",style:{maxHeight:'calc(100vh - 2rem)'},onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center p-6 pb-4 border-b flex-shrink-0"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCCA Model\uBCC4 \uD3C9\uADE0 Kitting \uB9AC\uB4DC\uD0C0\uC784"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowLeadTimeDetailModal(false),className:"p-1 hover:bg-gray-100 rounded"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"overflow-y-auto p-6",style:{minHeight:0}},/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-3 gap-4 mb-6"},Object.keys(MODEL_WEIGHTS).map(model=>{const modelKittings=kittingData.filter(k=>k.model===model&&k.leadTimeDays&&k.leadTimeDays>0);const avgLT=modelKittings.length>0?(modelKittings.reduce((s,k)=>s+k.leadTimeDays,0)/modelKittings.length).toFixed(1):'-';const count=modelKittings.length;return/*#__PURE__*/React.createElement("div",{key:model,className:`p-4 rounded-xl border-l-4 ${MODEL_WEIGHTS[model].series==='16'?'bg-purple-50 border-purple-500':MODEL_WEIGHTS[model].series==='48'?'bg-blue-50 border-blue-500':'bg-orange-50 border-orange-500'}`},/*#__PURE__*/React.createElement("p",{className:"font-bold text-gray-800"},model),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},MODEL_WEIGHTS[model].code),/*#__PURE__*/React.createElement("p",{className:`text-2xl font-bold mt-2 ${avgLT==='-'?'text-gray-400':parseFloat(avgLT)<=1?'text-green-600':parseFloat(avgLT)<=2?'text-amber-600':'text-red-600'}`},avgLT==='-'?'-':`${avgLT}일`),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},count,"\uAC74 \uC644\uB8CC"));})),/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-3"},"\uD83D\uDCCB \uCD5C\uADFC \uC644\uB8CC \uAE30\uB85D (\uB9AC\uB4DC\uD0C0\uC784 \uAE30\uC900)"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-cyan-50"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uC0DD\uC0B0\uC624\uB354"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uBAA8\uB378"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uB2F4\uB2F9\uC790"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uC2DC\uC791\uC77C"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uC644\uB8CC\uC77C"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uB9AC\uB4DC\uD0C0\uC784"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},kittingData.filter(k=>k.status==='completed'&&k.leadTimeDays&&k.leadTimeDays>0).sort((a,b)=>(b.completedAt||'').localeCompare(a.completedAt||'')).slice(0,20).map(k=>/*#__PURE__*/React.createElement("tr",{key:k.id},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-medium"},k.productionOrder),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs ${MODEL_WEIGHTS[k.model]?.series==='16'?'bg-purple-100 text-purple-700':MODEL_WEIGHTS[k.model]?.series==='48'?'bg-blue-100 text-blue-700':'bg-orange-100 text-orange-700'}`},k.model)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},k.worker),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center text-gray-600"},k.basicStartDate),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center text-gray-600"},k.completedAt),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${k.leadTimeDays<=1?'bg-green-100 text-green-700':k.leadTimeDays<=2?'bg-amber-100 text-amber-700':'bg-red-100 text-red-700'}`},k.leadTimeDays,"\uC77C")))))),kittingData.filter(k=>k.status==='completed'&&k.leadTimeDays).length===0&&/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-400 py-8"},"\uC644\uB8CC\uB41C \uAE30\uB85D\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"))),/*#__PURE__*/React.createElement("div",{className:"flex-shrink-0 border-t p-4 flex justify-end"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowLeadTimeDetailModal(false),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},"\uB2EB\uAE30")))),selectedRackDetail&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-4xl m-4 max-h-[90vh] overflow-y-auto"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-6"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-xl flex items-center gap-2"},"\uD83D\uDCE6 ",selectedRackDetail.id," \uB799 Bin \uC0C1\uC138 \uD604\uD669",/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-xs ${RACK_MODEL_SERIES[selectedRackDetail.id]==='Maxwell 16'?'bg-blue-100 text-blue-700':RACK_MODEL_SERIES[selectedRackDetail.id]==='Maxwell 48'?'bg-emerald-100 text-blue-600':RACK_MODEL_SERIES[selectedRackDetail.id]==='HSM 3.0'?'bg-orange-100 text-orange-600':'bg-gray-100 text-gray-700'}`},RACK_MODEL_SERIES[selectedRackDetail.id]||'기타')),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500 mt-1"},"\uCD1D ",selectedRackDetail.bins,"\uAC1C Bin \uC0AC\uC6A9 \uC911 / \uCD5C\uB300 ",selectedRackDetail.maxBins,"\uAC1C")),/*#__PURE__*/React.createElement("button",{onClick:()=>setSelectedRackDetail(null),className:"p-2 hover:bg-gray-100 rounded-lg"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-4 gap-4 mb-6"},/*#__PURE__*/React.createElement("div",{className:"bg-slate-50 rounded-lg p-3 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"\uD488\uBAA9 \uC218"),/*#__PURE__*/React.createElement("p",{className:"text-xl font-bold text-indigo-600"},selectedRackDetail.items,"\uAC1C")),/*#__PURE__*/React.createElement("div",{className:"bg-slate-50 rounded-lg p-3 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"\uCD1D \uC7AC\uACE0"),/*#__PURE__*/React.createElement("p",{className:"text-xl font-bold text-emerald-600"},selectedRackDetail.stock.toLocaleString()," EA")),/*#__PURE__*/React.createElement("div",{className:"bg-slate-50 rounded-lg p-3 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"\uCD1D \uBB34\uAC8C"),/*#__PURE__*/React.createElement("p",{className:"text-xl font-bold text-amber-600"},selectedRackDetail.weight.toFixed(1)," kg")),/*#__PURE__*/React.createElement("div",{className:"bg-slate-50 rounded-lg p-3 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500"},"\uBB34\uAC8C \uD65C\uC6A9\uB960"),/*#__PURE__*/React.createElement("p",{className:`text-xl font-bold ${selectedRackDetail.weight/selectedRackDetail.maxWeight*100>=90?'text-red-600':selectedRackDetail.weight/selectedRackDetail.maxWeight*100>=70?'text-amber-600':'text-emerald-600'}`},selectedRackDetail.maxWeight>=99999?'무제한':`${(selectedRackDetail.weight/selectedRackDetail.maxWeight*100).toFixed(0)}%`))),/*#__PURE__*/React.createElement("div",{className:"mb-6"},/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-3"},"\uD83D\uDDC4\uFE0F Bin \uBC30\uCE58 \uD604\uD669"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-6 md:grid-cols-10 gap-2"},(()=>{const rackId=selectedRackDetail.id;const maxBins=selectedRackDetail.maxBins;const bins=[];// 해당 랙의 모든 Bin 가져오기
const rackItems=inventoryData.filter(item=>{const itemRack=item.bin?.split('-')?.[0];return itemRack===rackId;});// Bin별로 그룹화
const binData={};rackItems.forEach(item=>{if(!binData[item.bin]){binData[item.bin]={items:0,stock:0};}binData[item.bin].items+=1;binData[item.bin].stock+=item.stock||0;});for(let i=1;i<=maxBins;i++){const binId=`${rackId}-${String(i).padStart(2,'0')}`;const data=binData[binId];const isUsed=!!data;bins.push(/*#__PURE__*/React.createElement("div",{key:binId,className:`p-2 rounded-lg text-center text-xs border-2 transition ${isUsed?'bg-indigo-100 border-indigo-300 text-indigo-700':'bg-gray-50 border-gray-200 text-gray-400'}`,title:isUsed?`${binId}: ${data.items}개 품목, ${data.stock.toLocaleString()} EA`:`${binId}: 비어있음`},/*#__PURE__*/React.createElement("p",{className:"font-medium"},String(i).padStart(2,'0')),isUsed&&/*#__PURE__*/React.createElement("p",{className:"text-[10px] mt-0.5"},data.items,"\uD488\uBAA9")));}return bins;})()),/*#__PURE__*/React.createElement("div",{className:"flex gap-4 mt-3 text-xs"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-4 h-4 rounded bg-indigo-100 border-2 border-indigo-300"})," \uC0AC\uC6A9 \uC911"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-4 h-4 rounded bg-gray-50 border-2 border-gray-200"})," \uBE44\uC5B4\uC788\uC74C"))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-3"},"\uD83D\uDCCB Bin\uBCC4 \uD488\uBAA9 \uC0C1\uC138"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto max-h-[300px]"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-slate-50 sticky top-0"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"Bin"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uD488\uBC88"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uD488\uBA85"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uC7AC\uACE0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uBC15\uC2A4 \uC218"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uACF5\uAC04 \uC0AC\uC6A9\uB960"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},(()=>{const rackItems=inventoryData.filter(item=>{const itemRack=item.bin?.split('-')?.[0];return itemRack===selectedRackDetail.id||item.bin===selectedRackDetail.id;}).sort((a,b)=>(a.bin||'').localeCompare(b.bin||''));// Bin별 총 박스 수 계산
const binTotals={};rackItems.forEach(item=>{const bin=item.bin||selectedRackDetail.id;if(!binTotals[bin])binTotals[bin]={curBoxes:0,maxBoxes:0};const qtyPerBox=MATERIAL_QTY_PER_BOX[item.material]||1;binTotals[bin].curBoxes+=(item.stock||0)/qtyPerBox;});// 각 Bin의 최대 박스 계산
Object.keys(binTotals).forEach(bin=>{const binInfo=BIN_RACK_INFO[bin]||{rackType:'경량랙',rackCount:1};const binItems=rackItems.filter(i=>i.bin===bin);const binBoxTypes=binItems.map(i=>MATERIAL_BOX_MAP[i.material]||'PLASTIC-S');const tc={};binBoxTypes.forEach(t=>{tc[t]=(tc[t]||0)+1;});const mainBT=Object.entries(tc).sort((a,b)=>b[1]-a[1])[0]?.[0]||'PLASTIC-S';if(binInfo.maxBoxes){binTotals[bin].maxBoxes=binInfo.maxBoxes;}else if(binInfo.mixed){let mx=0;binInfo.mixed.forEach(m=>{const s=BOXES_PER_SHELF[m.type]||BOXES_PER_SHELF['경량랙'];mx+=(s[mainBT]||s['PLASTIC-S']||2)*m.count;});binTotals[bin].maxBoxes=mx;}else{const s=BOXES_PER_SHELF[binInfo.rackType]||BOXES_PER_SHELF['경량랙'];binTotals[bin].maxBoxes=(s[mainBT]||s['PLASTIC-S']||2)*binInfo.rackCount*(binInfo.shelves||1);}});return rackItems.map((item,idx)=>{const qtyPerBox=MATERIAL_QTY_PER_BOX[item.material]||1;const boxes=(item.stock||0)/qtyPerBox;const bin=item.bin||selectedRackDetail.id;const bt=binTotals[bin];const binUtil=bt&&bt.maxBoxes>0?bt.curBoxes/bt.maxBoxes*100:0;return/*#__PURE__*/React.createElement("tr",{key:idx,className:"hover:bg-slate-50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2"},/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded text-xs font-medium"},item.bin)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-mono text-xs"},item.material),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-sm"},item.description?.slice(0,30)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center font-medium"},item.stock?.toLocaleString()),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center text-xs"},boxes.toFixed(1)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-1 justify-center"},/*#__PURE__*/React.createElement("div",{className:"w-12 bg-gray-200 rounded-full h-1.5"},/*#__PURE__*/React.createElement("div",{className:`h-1.5 rounded-full ${binUtil>100?'bg-red-500':binUtil>=80?'bg-amber-500':binUtil>=50?'bg-emerald-500':'bg-blue-500'}`,style:{width:`${Math.min(binUtil,100)}%`}})),/*#__PURE__*/React.createElement("span",{className:`text-xs font-medium ${binUtil>100?'text-red-600':binUtil>=80?'text-amber-600':'text-emerald-600'}`},binUtil.toFixed(0),"%"))));});})())))),/*#__PURE__*/React.createElement("div",{className:"mt-6 flex justify-end"},/*#__PURE__*/React.createElement("button",{onClick:()=>setSelectedRackDetail(null),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},"\uB2EB\uAE30")))),showModelDetailModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg m-4 max-h-[80vh] flex flex-col"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},showModelDetailModal==='excess'&&'📦 과다 재고 모델',showModelDetailModal==='normal'&&'✅ 적정 재고 모델',showModelDetailModal==='caution'&&'⚠️ 부족 주의 모델',showModelDetailModal==='urgent'&&'🚨 부족 긴급 모델'),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowModelDetailModal(null)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"overflow-y-auto flex-1"},(()=>{const TARGET_STOCK={'RSC16':{min:10,max:30},'CSC16':{min:5,max:10},'FSC16':{min:2,max:2},'RSC48':{min:10,max:20},'CSC48':{min:3,max:10},'HSM3':{min:1,max:5}};const modelList=Object.entries(TARGET_STOCK).map(([model,range])=>{const info=MODEL_WEIGHTS[model];const currentStock=inventoryData.filter(i=>i.material===info?.code).reduce((sum,i)=>sum+(i.stock||0),0);let status='ok';if(currentStock>range.max)status='over';else if(currentStock>=range.min)status='ok';else if(currentStock>=range.min*0.5)status='warning';else status='shortage';return{model,currentStock,range,status};}).filter(m=>{if(showModelDetailModal==='excess')return m.status==='over';if(showModelDetailModal==='normal')return m.status==='ok';if(showModelDetailModal==='caution')return m.status==='warning';if(showModelDetailModal==='urgent')return m.status==='shortage';return false;});if(modelList.length===0){return/*#__PURE__*/React.createElement("p",{className:"text-gray-500 text-center py-8"},"\uD574\uB2F9 \uC0C1\uD0DC\uC758 \uBAA8\uB378\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");}return/*#__PURE__*/React.createElement("div",{className:"space-y-3"},modelList.map((m,idx)=>/*#__PURE__*/React.createElement("div",{key:idx,className:`p-4 rounded-lg border ${m.status==='over'?'bg-purple-50 border-purple-200':m.status==='ok'?'bg-emerald-50 border-emerald-200':m.status==='warning'?'bg-amber-50 border-amber-200':'bg-red-50 border-red-200'}`},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("span",{className:"font-medium text-gray-800"},m.model),/*#__PURE__*/React.createElement("span",{className:"font-bold text-lg"},m.currentStock,"\uB300")),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mt-1"},"\uAE30\uC900: ",m.range.min,"~",m.range.max,"\uB300"))));})()),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowModelDetailModal(null),className:"mt-4 w-full px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg"},"\uB2EB\uAE30"))),showSubcomDetailModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>setShowSubcomDetailModal(null)},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg flex flex-col",style:{maxHeight:'calc(100vh - 2rem)'},onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center p-6 pb-4 border-b flex-shrink-0"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},showSubcomDetailModal==='excess'&&'📦 과다 재고 Sub-component',showSubcomDetailModal==='normal'&&'✅ 적정 재고 Sub-component',showSubcomDetailModal==='caution'&&'⚠️ 부족 주의 Sub-component',showSubcomDetailModal==='urgent'&&'🚨 부족 긴급 Sub-component'),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowSubcomDetailModal(null),className:"p-1 hover:bg-gray-100 rounded"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"overflow-y-auto p-6",style:{minHeight:0}},(()=>{const SUBCOM_SAFETY={min:10,max:50};const SUBCOM_SAFETY_KB0770={min:20,max:100};const subcomList=Object.entries(subComponentUnits).map(([name,info])=>{const currentStock=inventoryData.filter(i=>i.material===name).reduce((sum,i)=>sum+(i.stock||0),0);const range=name==='KB0770'?SUBCOM_SAFETY_KB0770:SUBCOM_SAFETY;let status='ok';if(currentStock>range.max)status='over';else if(currentStock>=range.min)status='ok';else if(currentStock>=range.min*0.5)status='warning';else status='shortage';return{name,currentStock,units:info.units,range,status};}).filter(m=>{if(showSubcomDetailModal==='excess')return m.status==='over';if(showSubcomDetailModal==='normal')return m.status==='ok';if(showSubcomDetailModal==='caution')return m.status==='warning';if(showSubcomDetailModal==='urgent')return m.status==='shortage';return false;}).sort((a,b)=>a.units-b.units);if(subcomList.length===0){return/*#__PURE__*/React.createElement("p",{className:"text-gray-500 text-center py-8"},"\uD574\uB2F9 \uC0C1\uD0DC\uC758 Sub-component\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");}return/*#__PURE__*/React.createElement("div",{className:"space-y-3"},subcomList.map((m,idx)=>/*#__PURE__*/React.createElement("div",{key:idx,className:`p-4 rounded-lg border ${m.status==='over'?'bg-purple-50 border-purple-200':m.status==='ok'?'bg-emerald-50 border-emerald-200':m.status==='warning'?'bg-amber-50 border-amber-200':'bg-red-50 border-red-200'}`},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("span",{className:"font-medium text-gray-800"},m.name),/*#__PURE__*/React.createElement("span",{className:"font-bold text-lg"},m.units,"\uB300")),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mt-1"},"\uD604\uC7AC\uACE0: ",m.currentStock,"EA | \uAE30\uC900: ",m.range.min,"~",m.range.max,"\uB300"))));})()),/*#__PURE__*/React.createElement("div",{className:"flex-shrink-0 border-t p-4 flex justify-end"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowSubcomDetailModal(null),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},"\uB2EB\uAE30")))),showShortageDetailModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>setShowShortageDetailModal(null)},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl flex flex-col",style:{maxHeight:'calc(100vh - 2rem)'},onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center p-6 pb-4 border-b flex-shrink-0"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},showShortageDetailModal==='critical'&&'🚨 생산불가 자재 (0대)',showShortageDetailModal==='high'&&'⚠️ 긴급 자재 (1~4대)',showShortageDetailModal==='withPO'&&'✅ 발주 진행중 자재',showShortageDetailModal==='noPO'&&'🛒 발주 필요 자재'),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowShortageDetailModal(null),className:"p-1 hover:bg-gray-100 rounded"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"overflow-y-auto p-6",style:{minHeight:0}},(()=>{const stockByMaterial={};const descByMaterial={};inventoryData.forEach(item=>{stockByMaterial[item.material]=(stockByMaterial[item.material]||0)+item.stock;descByMaterial[item.material]=item.description||'';});const bomToUse=customBomData||MODEL_BOM_DATA;const allShortages=[];Object.entries(bomToUse).forEach(([model,bom])=>{Object.entries(bom).forEach(([material,requiredQty])=>{const currentStock=stockByMaterial[material]||0;const possibleUnits=Math.floor(currentStock/requiredQty);const threshold2=model==='HSM3'||model==='HSM3.0'?3:10;if(possibleUnits<threshold2&&requiredQty>0){const openPO=openPOData.find(po=>po.material===material);const existingIdx=allShortages.findIndex(s=>s.material===material);if(existingIdx===-1){allShortages.push({material,description:descByMaterial[material]||openPO?.description||'-',currentStock,requiredQty,possibleUnits,models:[model],openPO:openPO?{qty:openPO.totalQty,poNumbers:openPO.poNumbers}:null,urgency:possibleUnits===0?'critical':possibleUnits<Math.ceil(threshold2/2)?'high':'medium'});}else{if(!allShortages[existingIdx].models.includes(model))allShortages[existingIdx].models.push(model);}}});});let filtered=allShortages;if(showShortageDetailModal==='critical')filtered=allShortages.filter(s=>s.urgency==='critical');else if(showShortageDetailModal==='high')filtered=allShortages.filter(s=>s.urgency==='high');else if(showShortageDetailModal==='withPO')filtered=allShortages.filter(s=>s.openPO);else if(showShortageDetailModal==='noPO')filtered=allShortages.filter(s=>!s.openPO);filtered.sort((a,b)=>a.possibleUnits-b.possibleUnits);return filtered.length>0?/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-gray-50 sticky top-0"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uD488\uBC88"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-left"},"\uD488\uBA85"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uD604\uC7AC\uACE0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uC0DD\uC0B0\uAC00\uB2A5"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"\uBAA8\uB378"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 text-center"},"Open PO"))),/*#__PURE__*/React.createElement("tbody",{className:"divide-y"},filtered.map((s,idx)=>/*#__PURE__*/React.createElement("tr",{key:idx,className:"hover:bg-gray-50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 font-mono text-xs"},s.material),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-xs"},s.description?.slice(0,35)),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center font-medium"},s.currentStock),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${s.urgency==='critical'?'bg-red-100 text-red-700':s.urgency==='high'?'bg-amber-100 text-amber-700':'bg-blue-100 text-blue-700'}`},s.possibleUnits,"\uB300")),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center text-xs"},s.models.join(', ')),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 text-center text-xs"},s.openPO?/*#__PURE__*/React.createElement("span",{className:"text-green-600"},"\u2705 ",s.openPO.qty,"EA"):/*#__PURE__*/React.createElement("span",{className:"text-red-500"},"\u274C \uC5C6\uC74C")))))):/*#__PURE__*/React.createElement("p",{className:"text-center text-gray-400 py-8"},"\uD574\uB2F9 \uD56D\uBAA9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4");})()),/*#__PURE__*/React.createElement("div",{className:"flex-shrink-0 border-t p-4 flex justify-end"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowShortageDetailModal(null),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},"\uB2EB\uAE30")))),showTempHumidityExportModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md m-4"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCCA \uC628\uC2B5\uB3C4 \uB370\uC774\uD130 Excel \uC800\uC7A5"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowTempHumidityExportModal(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("p",{className:"text-gray-600 mb-6"},"\uC800\uC7A5\uD560 \uB370\uC774\uD130 \uBC94\uC704\uB97C \uC120\uD0DD\uD558\uC138\uC694."),/*#__PURE__*/React.createElement("div",{className:"space-y-3"},/*#__PURE__*/React.createElement("button",{onClick:()=>{// 선택된 달만 저장
const[year,month]=tempHumidityMonth.split('-').map(Number);const daysInMonth=new Date(year,month,0).getDate();const dayNames=['일','월','화','수','목','금','토'];let csvContent='\uFEFF';csvContent+='ESD Check Sheet - '+year+'년 '+month+'월\n';csvContent+='Equipment: NS-205B / Spec: Temp +5~40℃, Humidity 0~75%\n';csvContent+='Recorded by: '+tempHumidityRecorder+'\n\n';csvContent+='날짜,요일,온도(℃),습도(%),상태\n';for(let day=1;day<=daysInMonth;day++){const dateKey=tempHumidityMonth+'-'+String(day).padStart(2,'0');const date=new Date(year,month-1,day);const dayName=dayNames[date.getDay()];const isWeekend=date.getDay()===0||date.getDay()===6;const isHoliday=KR_HOLIDAYS.has(dateKey);const isOff=isWeekend||isHoliday;const data=tempHumidityData[dateKey];if(data&&data.temp&&data.humidity){const t=parseFloat(data.temp);const h=parseFloat(data.humidity);const tempOk=t>=5&&t<=40;const humidOk=h>=0&&h<=75;const status=tempOk&&humidOk?'OK':'NG';csvContent+=day+','+dayName+','+data.temp+','+data.humidity+','+status+'\n';}else if(isOff){csvContent+=day+','+dayName+','+(isHoliday&&!isWeekend?'공휴일':'주말')+','+(isHoliday&&!isWeekend?'공휴일':'주말')+',-\n';}else{csvContent+=day+','+dayName+',-,-,미입력\n';}}const blob=new Blob([csvContent],{type:'text/csv;charset=utf-8;'});const link=document.createElement('a');link.href=URL.createObjectURL(blob);link.download='ESD_Check_Sheet_'+tempHumidityMonth+'.csv';link.click();setShowTempHumidityExportModal(false);},className:"w-full py-4 px-4 bg-blue-50 hover:bg-blue-100 border-2 border-blue-200 rounded-xl text-left transition"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center"},/*#__PURE__*/React.createElement(Calendar,{className:"w-6 h-6 text-white"})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-semibold text-blue-800"},"\uC120\uD0DD\uB41C \uB2EC\uB9CC \uC800\uC7A5"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-blue-600"},tempHumidityMonth.replace('-','년 '),"\uC6D4 \uB370\uC774\uD130")))),/*#__PURE__*/React.createElement("button",{onClick:()=>{// 모든 데이터 저장
const dayNames=['일','월','화','수','목','금','토'];const allDates=Object.keys(tempHumidityData).sort();if(allDates.length===0){alert('저장할 데이터가 없습니다.');return;}let csvContent='\uFEFF';csvContent+='ESD Check Sheet - 전체 데이터\n';csvContent+='Equipment: NS-205B / Spec: Temp +5~40℃, Humidity 0~75%\n';csvContent+='Recorded by: '+tempHumidityRecorder+'\n';csvContent+='총 '+allDates.length+'개 기록\n\n';csvContent+='날짜,요일,온도(℃),습도(%),상태\n';allDates.forEach(dateKey=>{const data=tempHumidityData[dateKey];const date=new Date(dateKey);const dayName=dayNames[date.getDay()];if(data&&data.temp&&data.humidity){const t=parseFloat(data.temp);const h=parseFloat(data.humidity);const tempOk=t>=5&&t<=40;const humidOk=h>=0&&h<=75;const status=tempOk&&humidOk?'OK':'NG';csvContent+=dateKey+','+dayName+','+data.temp+','+data.humidity+','+status+'\n';}});const blob=new Blob([csvContent],{type:'text/csv;charset=utf-8;'});const link=document.createElement('a');link.href=URL.createObjectURL(blob);link.download='ESD_Check_Sheet_All_Data.csv';link.click();setShowTempHumidityExportModal(false);},className:"w-full py-4 px-4 bg-emerald-50 hover:bg-emerald-100 border-2 border-emerald-200 rounded-xl text-left transition"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-3"},/*#__PURE__*/React.createElement("div",{className:"w-12 h-12 bg-emerald-500 rounded-lg flex items-center justify-center"},/*#__PURE__*/React.createElement(Database,{className:"w-6 h-6 text-white"})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-semibold text-emerald-800"},"\uBAA8\uB4E0 \uB370\uC774\uD130 \uC800\uC7A5"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-emerald-600"},"\uCD1D ",Object.keys(tempHumidityData).length,"\uAC1C \uAE30\uB85D"))))),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowTempHumidityExportModal(false),className:"w-full mt-4 py-2 text-gray-500 hover:text-gray-700"},"\uCDE8\uC18C"))),showBackupModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-2xl m-4 max-h-[90vh] overflow-y-auto"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCE6 \uB370\uC774\uD130 \uBC31\uC5C5 / \uBCF5\uC6D0"),/*#__PURE__*/React.createElement("button",{onClick:()=>{setShowBackupModal(false);setBackupData('');}},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"mb-6"},/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-800 mb-2 flex items-center gap-2"},/*#__PURE__*/React.createElement(Download,{className:"w-4 h-4 text-emerald-600"})," \uBC31\uC5C5"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-600 mb-3"},"\uBAA8\uB4E0 \uB370\uC774\uD130\uB97C JSON \uD615\uC2DD\uC73C\uB85C \uBC31\uC5C5\uD569\uB2C8\uB2E4."),!backupData?/*#__PURE__*/React.createElement("button",{onClick:exportAllData,className:"w-full px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 flex items-center justify-center gap-2"},/*#__PURE__*/React.createElement(Database,{className:"w-5 h-5"})," \uBC31\uC5C5 \uB370\uC774\uD130 \uC0DD\uC131"):/*#__PURE__*/React.createElement("div",{className:"space-y-3"},/*#__PURE__*/React.createElement("div",{className:"flex gap-2"},/*#__PURE__*/React.createElement("button",{onClick:selectAllBackupText,className:"flex-1 px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 flex items-center justify-center gap-2"},/*#__PURE__*/React.createElement(Check,{className:"w-5 h-5"})," \uC804\uCCB4 \uC120\uD0DD (\uADF8 \uB2E4\uC74C Ctrl+C)"),/*#__PURE__*/React.createElement("button",{onClick:()=>setBackupData(''),className:"px-4 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600"},/*#__PURE__*/React.createElement(RefreshCw,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"bg-gray-100 rounded-lg p-2"},/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-500 mb-1"},"\uD83D\uDCCB \uBC31\uC5C5 \uB370\uC774\uD130 (",(backupData.length/1024).toFixed(1)," KB) - \uC544\uB798 \uD14D\uC2A4\uD2B8\uB97C Ctrl+A \u2192 Ctrl+C\uB85C \uBCF5\uC0AC\uD558\uC138\uC694"),/*#__PURE__*/React.createElement("textarea",{id:"backup-textarea",readOnly:true,value:backupData,className:"w-full h-48 text-xs font-mono bg-white border rounded p-2 resize-none select-all",onClick:e=>e.target.select()})),/*#__PURE__*/React.createElement("p",{className:"text-xs text-blue-600 font-medium"},"\uD83D\uDCA1 \uBCF5\uC0AC \uBC29\uBC95: \uD14D\uC2A4\uD2B8\uBC15\uC2A4 \uD074\uB9AD \u2192 Ctrl+A (\uC804\uCCB4\uC120\uD0DD) \u2192 Ctrl+C (\uBCF5\uC0AC) \u2192 \uBA54\uBAA8\uC7A5\uC5D0 Ctrl+V (\uBD99\uC5EC\uB123\uAE30) \u2192 .json\uC73C\uB85C \uC800\uC7A5"))),/*#__PURE__*/React.createElement("hr",{className:"my-4"}),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-800 mb-2 flex items-center gap-2"},/*#__PURE__*/React.createElement(Upload,{className:"w-4 h-4 text-amber-600"})," \uBCF5\uC6D0"),/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-600 mb-3"},"\uBC31\uC5C5\uD55C JSON \uD30C\uC77C\uC744 \uC120\uD0DD\uD558\uC5EC \uB370\uC774\uD130\uB97C \uBCF5\uC6D0\uD569\uB2C8\uB2E4.",/*#__PURE__*/React.createElement("br",null),/*#__PURE__*/React.createElement("span",{className:"text-red-500"},"\u26A0\uFE0F \uD604\uC7AC \uB370\uC774\uD130\uAC00 \uB36E\uC5B4\uC50C\uC6CC\uC9D1\uB2C8\uB2E4.")),/*#__PURE__*/React.createElement("label",{className:"w-full px-4 py-3 bg-amber-600 text-white rounded-lg hover:bg-amber-700 flex items-center justify-center gap-2 cursor-pointer"},/*#__PURE__*/React.createElement(Upload,{className:"w-5 h-5"})," JSON \uD30C\uC77C \uC120\uD0DD",/*#__PURE__*/React.createElement("input",{type:"file",accept:".json",onChange:e=>{importAllData(e);setShowBackupModal(false);setBackupData('');},className:"hidden"}))),/*#__PURE__*/React.createElement("div",{className:"flex justify-end mt-6"},/*#__PURE__*/React.createElement("button",{onClick:()=>{setShowBackupModal(false);setBackupData('');},className:"px-4 py-2 border rounded-lg"},"\uB2EB\uAE30")))),showGraphModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-5xl m-4 max-h-[90vh] overflow-y-auto"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCCA Cycle Time \uADF8\uB798\uD504"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowGraphModal(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"bg-gray-50 rounded-lg p-4 mb-6"},/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap gap-4 items-end"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC870\uD68C \uBC29\uC2DD"),/*#__PURE__*/React.createElement("select",{className:"border rounded-lg px-3 py-2",value:graphViewType,onChange:e=>setGraphViewType(e.target.value)},/*#__PURE__*/React.createElement("option",{value:"monthly"},"\uC6D4\uBCC4 \uCD94\uC774"),/*#__PURE__*/React.createElement("option",{value:"daily"},"\uC77C\uBCC4 (\uD2B9\uC815 \uC6D4)"),/*#__PURE__*/React.createElement("option",{value:"custom"},"\uAE30\uAC04 \uC9C0\uC815"))),graphViewType==='daily'&&/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC6D4 \uC120\uD0DD"),/*#__PURE__*/React.createElement("input",{type:"month",className:"border rounded-lg px-3 py-2",value:selectedMonth,onChange:e=>setSelectedMonth(e.target.value)})),graphViewType==='custom'&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC2DC\uC791\uC77C"),/*#__PURE__*/React.createElement("input",{type:"date",className:"border rounded-lg px-3 py-2",value:graphDateRange.start,onChange:e=>setGraphDateRange({...graphDateRange,start:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC885\uB8CC\uC77C"),/*#__PURE__*/React.createElement("input",{type:"date",className:"border rounded-lg px-3 py-2",value:graphDateRange.end,onChange:e=>setGraphDateRange({...graphDateRange,end:e.target.value})}))))),(()=>{// 완료된 데이터만 필터링
const completedPicks=pickCycles.filter(p=>p.status==='completed'&&p.cycleMin&&p.completed);let chartData=[];let chartTitle='';if(graphViewType==='monthly'){// 월별 데이터 집계
const monthlyData={};completedPicks.forEach(p=>{const month=p.completed.slice(0,7);// YYYY-MM
if(!monthlyData[month]){monthlyData[month]={total:0,count:0,mx48:[],mx16:[],hsm:[],spare:[]};}monthlyData[month].total+=p.cycleMin;monthlyData[month].count+=1;if(['RSC48','CSC48'].includes(p.model))monthlyData[month].mx48.push(p.cycleMin);else if(['RSC16','CSC16','FSC16'].includes(p.model))monthlyData[month].mx16.push(p.cycleMin);else if(p.model==='HSM3.0')monthlyData[month].hsm.push(p.cycleMin);else monthlyData[month].spare.push(p.cycleMin);});chartData=Object.entries(monthlyData).sort((a,b)=>a[0].localeCompare(b[0])).map(([month,data])=>({label:month,avg:Math.round(data.total/data.count),count:data.count,mx48:data.mx48.length?Math.round(data.mx48.reduce((a,b)=>a+b,0)/data.mx48.length):null,mx16:data.mx16.length?Math.round(data.mx16.reduce((a,b)=>a+b,0)/data.mx16.length):null,hsm:data.hsm.length?Math.round(data.hsm.reduce((a,b)=>a+b,0)/data.hsm.length):null,spare:data.spare.length?Math.round(data.spare.reduce((a,b)=>a+b,0)/data.spare.length):null}));chartTitle='월별 평균 Cycle Time 추이';}else if(graphViewType==='daily'){// 특정 월의 일별 데이터
const dailyData={};completedPicks.filter(p=>p.completed.startsWith(selectedMonth)).forEach(p=>{const day=p.completed.slice(0,10);// YYYY-MM-DD
if(!dailyData[day]){dailyData[day]={total:0,count:0,mx48:[],mx16:[],hsm:[],spare:[]};}dailyData[day].total+=p.cycleMin;dailyData[day].count+=1;if(['RSC48','CSC48'].includes(p.model))dailyData[day].mx48.push(p.cycleMin);else if(['RSC16','CSC16','FSC16'].includes(p.model))dailyData[day].mx16.push(p.cycleMin);else if(p.model==='HSM3.0')dailyData[day].hsm.push(p.cycleMin);else dailyData[day].spare.push(p.cycleMin);});chartData=Object.entries(dailyData).sort((a,b)=>a[0].localeCompare(b[0])).map(([day,data])=>({label:day.slice(5),// MM-DD
avg:Math.round(data.total/data.count),count:data.count,mx48:data.mx48.length?Math.round(data.mx48.reduce((a,b)=>a+b,0)/data.mx48.length):null,mx16:data.mx16.length?Math.round(data.mx16.reduce((a,b)=>a+b,0)/data.mx16.length):null,hsm:data.hsm.length?Math.round(data.hsm.reduce((a,b)=>a+b,0)/data.hsm.length):null,spare:data.spare.length?Math.round(data.spare.reduce((a,b)=>a+b,0)/data.spare.length):null}));chartTitle=`${selectedMonth} 일별 평균 Cycle Time`;}else{// 기간 지정
const{start,end}=graphDateRange;if(start&&end){const dailyData={};completedPicks.filter(p=>{const date=p.completed.slice(0,10);return date>=start&&date<=end;}).forEach(p=>{const day=p.completed.slice(0,10);if(!dailyData[day]){dailyData[day]={total:0,count:0,mx48:[],mx16:[],hsm:[],spare:[]};}dailyData[day].total+=p.cycleMin;dailyData[day].count+=1;if(['RSC48','CSC48'].includes(p.model))dailyData[day].mx48.push(p.cycleMin);else if(['RSC16','CSC16','FSC16'].includes(p.model))dailyData[day].mx16.push(p.cycleMin);else if(p.model==='HSM3.0')dailyData[day].hsm.push(p.cycleMin);else dailyData[day].spare.push(p.cycleMin);});chartData=Object.entries(dailyData).sort((a,b)=>a[0].localeCompare(b[0])).map(([day,data])=>({label:day.slice(5),avg:Math.round(data.total/data.count),count:data.count,mx48:data.mx48.length?Math.round(data.mx48.reduce((a,b)=>a+b,0)/data.mx48.length):null,mx16:data.mx16.length?Math.round(data.mx16.reduce((a,b)=>a+b,0)/data.mx16.length):null,hsm:data.hsm.length?Math.round(data.hsm.reduce((a,b)=>a+b,0)/data.hsm.length):null,spare:data.spare.length?Math.round(data.spare.reduce((a,b)=>a+b,0)/data.spare.length):null}));chartTitle=`${start} ~ ${end} Cycle Time`;}}const maxValue=Math.max(...chartData.flatMap(d=>[d.avg,d.mx48,d.mx16,d.hsm,d.spare].filter(v=>v!==null)),60);return/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-4"},chartTitle),chartData.length===0?/*#__PURE__*/React.createElement("div",{className:"text-center py-12 text-gray-500"},"\uD574\uB2F9 \uAE30\uAC04\uC5D0 \uC644\uB8CC\uB41C \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"flex gap-4 mb-4 text-sm"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded bg-indigo-500"})," \uC804\uCCB4 \uD3C9\uADE0"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded bg-green-500"})," Maxwell 48"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded bg-blue-500"})," Maxwell 16"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded bg-orange-500"})," HSM 3.0"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-1"},/*#__PURE__*/React.createElement("span",{className:"w-3 h-3 rounded bg-gray-400"})," Spare Parts")),/*#__PURE__*/React.createElement("div",{className:"bg-gray-50 rounded-lg p-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2 h-64 overflow-x-auto pb-4"},chartData.map((d,i)=>/*#__PURE__*/React.createElement("div",{key:i,className:"flex flex-col items-center min-w-[80px]"},/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-1 h-48"},/*#__PURE__*/React.createElement("div",{className:"w-4 bg-indigo-500 rounded-t transition-all hover:bg-indigo-600",style:{height:`${d.avg/maxValue*100}%`},title:`전체: ${d.avg}분`}),d.mx48&&/*#__PURE__*/React.createElement("div",{className:"w-4 bg-green-500 rounded-t transition-all hover:bg-green-600",style:{height:`${d.mx48/maxValue*100}%`},title:`MX48: ${d.mx48}분`}),d.mx16&&/*#__PURE__*/React.createElement("div",{className:"w-4 bg-blue-500 rounded-t transition-all hover:bg-blue-600",style:{height:`${d.mx16/maxValue*100}%`},title:`MX16: ${d.mx16}분`}),d.hsm&&/*#__PURE__*/React.createElement("div",{className:"w-4 bg-orange-500 rounded-t transition-all hover:bg-orange-600",style:{height:`${d.hsm/maxValue*100}%`},title:`HSM: ${d.hsm}분`}),d.spare&&/*#__PURE__*/React.createElement("div",{className:"w-4 bg-gray-400 rounded-t transition-all hover:bg-gray-500",style:{height:`${d.spare/maxValue*100}%`},title:`Spare: ${d.spare}분`})),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-600 mt-2 font-medium"},d.label),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-400"},"n=",d.count)))),/*#__PURE__*/React.createElement("div",{className:"flex justify-between text-xs text-gray-400 mt-2"},/*#__PURE__*/React.createElement("span",null,"0\uBD84"),/*#__PURE__*/React.createElement("span",null,Math.round(maxValue/2),"\uBD84"),/*#__PURE__*/React.createElement("span",null,maxValue,"\uBD84"))),/*#__PURE__*/React.createElement("div",{className:"mt-6"},/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-2"},"\uC0C1\uC138 \uB370\uC774\uD130"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm border"},/*#__PURE__*/React.createElement("thead",{className:"bg-gray-100"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uAE30\uAC04"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uAC74\uC218"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uC804\uCCB4 \uD3C9\uADE0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border text-green-600"},"Maxwell 48"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border text-blue-600"},"Maxwell 16"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border text-orange-600"},"HSM 3.0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border text-gray-600"},"Spare Parts"))),/*#__PURE__*/React.createElement("tbody",null,chartData.map((d,i)=>/*#__PURE__*/React.createElement("tr",{key:i,className:"hover:bg-gray-50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border font-medium"},d.label),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center"},d.count),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center font-bold text-indigo-600"},d.avg,"\uBD84"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center text-green-600"},d.mx48?`${d.mx48}분`:'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center text-blue-600"},d.mx16?`${d.mx16}분`:'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center text-orange-600"},d.hsm?`${d.hsm}분`:'-'),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center text-gray-600"},d.spare?`${d.spare}분`:'-')))))))));})(),/*#__PURE__*/React.createElement("div",{className:"flex justify-end mt-6"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowGraphModal(false),className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},"\uB2EB\uAE30")))),selectedCategory&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg m-4 max-h-[80vh] overflow-hidden flex flex-col"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-2xl"},selectedCategory.icon),/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},selectedCategory.label," \uCE74\uD14C\uACE0\uB9AC")),/*#__PURE__*/React.createElement("button",{onClick:()=>setSelectedCategory(null),className:"text-gray-400 hover:text-gray-600"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"flex gap-4 mb-4"},/*#__PURE__*/React.createElement("div",{className:"flex-1 bg-blue-50 rounded-lg p-3 text-center"},/*#__PURE__*/React.createElement("div",{className:"text-2xl font-bold text-blue-600"},selectedCategory.activeTodos.length),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500"},"\uC9C4\uD589\uC911")),/*#__PURE__*/React.createElement("div",{className:"flex-1 bg-green-50 rounded-lg p-3 text-center"},/*#__PURE__*/React.createElement("div",{className:"text-2xl font-bold text-green-600"},selectedCategory.completedTodos.length),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500"},"\uC644\uB8CC")),/*#__PURE__*/React.createElement("div",{className:"flex-1 bg-gray-50 rounded-lg p-3 text-center"},/*#__PURE__*/React.createElement("div",{className:"text-2xl font-bold text-gray-600"},selectedCategory.activeTodos.length+selectedCategory.completedTodos.length),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500"},"\uC804\uCCB4"))),/*#__PURE__*/React.createElement("div",{className:"flex-1 overflow-y-auto"},selectedCategory.activeTodos.length>0&&/*#__PURE__*/React.createElement("div",{className:"mb-4"},/*#__PURE__*/React.createElement("h4",{className:"text-sm font-medium text-gray-500 mb-2"},"\uD83D\uDCCC \uC9C4\uD589\uC911 (",selectedCategory.activeTodos.length,")"),/*#__PURE__*/React.createElement("div",{className:"space-y-2"},selectedCategory.activeTodos.map(todo=>/*#__PURE__*/React.createElement("div",{key:todo.id,className:`p-3 rounded-lg border-l-4 ${todo.priority==='high'?'bg-red-50 border-red-400':todo.priority==='medium'?'bg-yellow-50 border-yellow-400':'bg-green-50 border-green-400'}`},/*#__PURE__*/React.createElement("div",{className:"flex items-start justify-between gap-2"},/*#__PURE__*/React.createElement("div",{className:"flex-1"},/*#__PURE__*/React.createElement("p",{className:"font-medium"},todo.text),/*#__PURE__*/React.createElement("div",{className:"flex gap-2 mt-1 text-xs text-gray-500"},/*#__PURE__*/React.createElement("span",null,todo.priority==='high'?'🔴 높음':todo.priority==='medium'?'🟡 보통':'🟢 낮음'),todo.dueDate&&/*#__PURE__*/React.createElement("span",null,"\uD83D\uDCC5 ",todo.dueDate))),/*#__PURE__*/React.createElement("button",{onClick:()=>{updateTodo(todo.id,'completed',true);setSelectedCategory({...selectedCategory,activeTodos:selectedCategory.activeTodos.filter(t=>t.id!==todo.id),completedTodos:[...selectedCategory.completedTodos,{...todo,completed:true}]});},className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700"},"\uC644\uB8CC")))))),selectedCategory.completedTodos.length>0&&/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("h4",{className:"text-sm font-medium text-gray-500 mb-2"},"\u2705 \uC644\uB8CC (",selectedCategory.completedTodos.length,")"),/*#__PURE__*/React.createElement("div",{className:"space-y-2"},selectedCategory.completedTodos.map(todo=>/*#__PURE__*/React.createElement("div",{key:todo.id,className:"p-3 rounded-lg bg-gray-50 border-l-4 border-gray-300"},/*#__PURE__*/React.createElement("div",{className:"flex items-start justify-between gap-2"},/*#__PURE__*/React.createElement("div",{className:"flex-1"},/*#__PURE__*/React.createElement("p",{className:"text-gray-400 line-through"},todo.text),/*#__PURE__*/React.createElement("div",{className:"flex gap-2 mt-1 text-xs text-gray-400"},todo.dueDate&&/*#__PURE__*/React.createElement("span",null,"\uD83D\uDCC5 ",todo.dueDate))),/*#__PURE__*/React.createElement("button",{onClick:()=>{updateTodo(todo.id,'completed',false);setSelectedCategory({...selectedCategory,completedTodos:selectedCategory.completedTodos.filter(t=>t.id!==todo.id),activeTodos:[...selectedCategory.activeTodos,{...todo,completed:false}]});},className:"px-2 py-1 bg-gray-400 text-white text-xs rounded hover:bg-gray-500"},"\uB418\uB3CC\uB9AC\uAE30")))))),selectedCategory.activeTodos.length===0&&selectedCategory.completedTodos.length===0&&/*#__PURE__*/React.createElement("div",{className:"text-center py-8 text-gray-400"},/*#__PURE__*/React.createElement("div",{className:"text-4xl mb-2"},"\uD83D\uDCED"),/*#__PURE__*/React.createElement("p",null,"\uC774 \uCE74\uD14C\uACE0\uB9AC\uC5D0 \uD560\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4."))),/*#__PURE__*/React.createElement("div",{className:"mt-4 pt-4 border-t"},/*#__PURE__*/React.createElement("button",{onClick:()=>setSelectedCategory(null),className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"},"\uB2EB\uAE30")))),selectedCalendarTodo&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md m-4"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-start mb-4"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"text-2xl"},selectedCalendarTodo.priority==='high'?'🔴':selectedCalendarTodo.priority==='medium'?'🟡':'🟢'),/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD560\uC77C \uC0C1\uC138")),/*#__PURE__*/React.createElement("button",{onClick:()=>setSelectedCalendarTodo(null),className:"text-gray-400 hover:text-gray-600"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:`p-4 rounded-lg mb-4 ${selectedCalendarTodo.completed?'bg-gray-100':selectedCalendarTodo.priority==='high'?'bg-red-50':selectedCalendarTodo.priority==='medium'?'bg-yellow-50':'bg-green-50'}`},/*#__PURE__*/React.createElement("p",{className:`text-lg ${selectedCalendarTodo.completed?'line-through text-gray-400':'font-medium'}`},selectedCalendarTodo.text)),/*#__PURE__*/React.createElement("div",{className:"space-y-3 mb-6"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("span",{className:"text-gray-500"},"\uC0C1\uD0DC"),/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-sm ${selectedCalendarTodo.completed?'bg-gray-200 text-gray-600':'bg-blue-100 text-blue-700'}`},selectedCalendarTodo.completed?'✓ 완료':'진행중')),/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("span",{className:"text-gray-500"},"\uCE74\uD14C\uACE0\uB9AC"),/*#__PURE__*/React.createElement("span",{className:`px-2 py-1 rounded text-sm ${selectedCalendarTodo.category==='data'?'bg-blue-100 text-blue-700':selectedCalendarTodo.category==='process'?'bg-purple-100 text-purple-700':selectedCalendarTodo.category==='kpi'?'bg-orange-100 text-orange-600':selectedCalendarTodo.category==='system'?'bg-cyan-100 text-cyan-700':selectedCalendarTodo.category==='idea'?'bg-pink-100 text-pink-700':'bg-gray-100 text-gray-700'}`},selectedCalendarTodo.category==='data'?'📊 데이터':selectedCalendarTodo.category==='process'?'⚙️ 프로세스':selectedCalendarTodo.category==='kpi'?'📈 KPI':selectedCalendarTodo.category==='system'?'💻 시스템':selectedCalendarTodo.category==='idea'?'💡 아이디어':'📋 일반')),/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("span",{className:"text-gray-500"},"\uC6B0\uC120\uC21C\uC704"),/*#__PURE__*/React.createElement("span",null,selectedCalendarTodo.priority==='high'?'🔴 높음':selectedCalendarTodo.priority==='medium'?'🟡 보통':'🟢 낮음')),/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("span",{className:"text-gray-500"},"\uB9C8\uAC10\uC77C"),/*#__PURE__*/React.createElement("span",{className:"font-medium"},selectedCalendarTodo.dueDate||'-')),/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("span",{className:"text-gray-500"},"\uC0DD\uC131\uC77C"),/*#__PURE__*/React.createElement("span",null,selectedCalendarTodo.createdAt))),/*#__PURE__*/React.createElement("div",{className:"flex gap-3"},/*#__PURE__*/React.createElement("button",{onClick:()=>{updateTodo(selectedCalendarTodo.id,'completed',!selectedCalendarTodo.completed);setSelectedCalendarTodo({...selectedCalendarTodo,completed:!selectedCalendarTodo.completed});},className:`flex-1 px-4 py-2 rounded-lg font-medium ${selectedCalendarTodo.completed?'bg-blue-600 text-white hover:bg-blue-700':'bg-green-600 text-white hover:bg-green-700'}`},selectedCalendarTodo.completed?'↩️ 미완료로 변경':'✓ 완료하기'),/*#__PURE__*/React.createElement("button",{onClick:()=>{setDeleteConfirm({show:true,type:'todo',id:selectedCalendarTodo.id,text:selectedCalendarTodo.text,count:0});setSelectedCalendarTodo(null);},className:"px-4 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-400"},"\uD83D\uDDD1\uFE0F \uC0AD\uC81C")))),deleteConfirm.show&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-sm m-4"},/*#__PURE__*/React.createElement("div",{className:"text-center"},/*#__PURE__*/React.createElement("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},/*#__PURE__*/React.createElement(AlertTriangle,{className:"w-8 h-8 text-red-600"})),/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg mb-2"},"\uC0AD\uC81C \uD655\uC778"),/*#__PURE__*/React.createElement("p",{className:"text-gray-600 mb-2"},deleteConfirm.type==='todo'&&/*#__PURE__*/React.createElement(React.Fragment,null,"\"",deleteConfirm.text,"\" \uD56D\uBAA9\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"),deleteConfirm.type==='pick'&&/*#__PURE__*/React.createElement(React.Fragment,null,"\uC120\uD0DD\uD55C ",/*#__PURE__*/React.createElement("strong",null,deleteConfirm.count,"\uAC1C")," \uBD88\uCD9C \uAE30\uB85D\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"),deleteConfirm.type==='receive'&&/*#__PURE__*/React.createElement(React.Fragment,null,"\uC120\uD0DD\uD55C ",/*#__PURE__*/React.createElement("strong",null,deleteConfirm.count,"\uAC1C")," \uC785\uACE0 \uAE30\uB85D\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"),deleteConfirm.type==='kitting'&&/*#__PURE__*/React.createElement(React.Fragment,null,"\uC120\uD0DD\uD55C ",/*#__PURE__*/React.createElement("strong",null,deleteConfirm.count,"\uAC1C")," Kitting \uAE30\uB85D\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")),/*#__PURE__*/React.createElement("p",{className:"text-sm text-red-500 mb-4"},"\u26A0\uFE0F \uC0AD\uC81C\uB41C \uB370\uC774\uD130\uB294 \uBCF5\uAD6C\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),/*#__PURE__*/React.createElement("div",{className:"flex gap-3"},/*#__PURE__*/React.createElement("button",{onClick:()=>setDeleteConfirm({show:false,type:'',id:null,text:'',count:0}),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"},"\uCDE8\uC18C"),/*#__PURE__*/React.createElement("button",{onClick:()=>{if(deleteConfirm.type==='todo')confirmDeleteTodo();else if(deleteConfirm.type==='pick')confirmDeletePicks();else if(deleteConfirm.type==='receive')confirmDeleteReceives();else if(deleteConfirm.type==='kitting')confirmDeleteKittings();},className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"},"\uC0AD\uC81C"))))),showKittingModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md m-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg mb-4"},"\uC0C8 Kitting \uAE30\uB85D"),/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Production Order *"),/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full border rounded-lg px-3 py-2",value:newKitting.productionOrder,onChange:e=>setNewKitting({...newKitting,productionOrder:e.target.value}),placeholder:"\uC608: 1426630"})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Model"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:newKitting.model,onChange:e=>setNewKitting({...newKitting,model:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"RSC48"},"RSC48"),/*#__PURE__*/React.createElement("option",{value:"CSC48"},"CSC48"),/*#__PURE__*/React.createElement("option",{value:"RSC16"},"RSC16"),/*#__PURE__*/React.createElement("option",{value:"CSC16"},"CSC16"),/*#__PURE__*/React.createElement("option",{value:"FSC16"},"FSC16"),/*#__PURE__*/React.createElement("option",{value:"HSM3.0"},"HSM3.0"),/*#__PURE__*/React.createElement("option",{value:"Spare Parts"},"Spare Parts"),/*#__PURE__*/React.createElement("option",{value:"Sub-com."},"Sub-com."))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC2DC\uC791\uC608\uC815\uC77C"),/*#__PURE__*/React.createElement("input",{type:"date",className:"w-full border rounded-lg px-3 py-2",value:newKitting.basicStartDate,onChange:e=>setNewKitting({...newKitting,basicStartDate:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uB2F4\uB2F9\uC790"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:newKitting.worker,onChange:e=>setNewKitting({...newKitting,worker:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"Z01"},"Z01"),/*#__PURE__*/React.createElement("option",{value:"Z02"},"Z02"),/*#__PURE__*/React.createElement("option",{value:"Z03"},"Z03"),/*#__PURE__*/React.createElement("option",{value:"Z04"},"Z04"),/*#__PURE__*/React.createElement("option",{value:"Z06"},"Z06"))),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("input",{type:"checkbox",id:"kitting-urgent",checked:newKitting.isUrgent,onChange:e=>setNewKitting({...newKitting,isUrgent:e.target.checked}),className:"w-4 h-4"}),/*#__PURE__*/React.createElement("label",{htmlFor:"kitting-urgent",className:"text-sm"},"\uD83D\uDEA8 \uAE34\uAE09"))),/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mt-6"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowKittingModal(false),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"},"\uCDE8\uC18C"),/*#__PURE__*/React.createElement("button",{onClick:addKitting,className:"flex-1 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700"},"\uCD94\uAC00")))),editingKitting&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md m-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg mb-4"},"Kitting \uC218\uC815"),/*#__PURE__*/React.createElement("div",{className:"space-y-4"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Production Order"),/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full border rounded-lg px-3 py-2",value:editingKitting.productionOrder,onChange:e=>setEditingKitting({...editingKitting,productionOrder:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Model"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:editingKitting.model,onChange:e=>setEditingKitting({...editingKitting,model:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"RSC48"},"RSC48"),/*#__PURE__*/React.createElement("option",{value:"CSC48"},"CSC48"),/*#__PURE__*/React.createElement("option",{value:"RSC16"},"RSC16"),/*#__PURE__*/React.createElement("option",{value:"CSC16"},"CSC16"),/*#__PURE__*/React.createElement("option",{value:"FSC16"},"FSC16"),/*#__PURE__*/React.createElement("option",{value:"HSM3.0"},"HSM3.0"),/*#__PURE__*/React.createElement("option",{value:"Spare Parts"},"Spare Parts"),/*#__PURE__*/React.createElement("option",{value:"Sub-com."},"Sub-com."))),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Material Description"),/*#__PURE__*/React.createElement("input",{type:"text",className:"w-full border rounded-lg px-3 py-2",value:editingKitting.materialDesc||'',onChange:e=>setEditingKitting({...editingKitting,materialDesc:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC2DC\uC791\uC608\uC815\uC77C"),/*#__PURE__*/React.createElement("input",{type:"date",className:"w-full border rounded-lg px-3 py-2",value:editingKitting.basicStartDate||'',onChange:e=>setEditingKitting({...editingKitting,basicStartDate:e.target.value})})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC644\uB8CC\uC77C"),/*#__PURE__*/React.createElement("input",{type:"date",className:"w-full border rounded-lg px-3 py-2",value:editingKitting.completedAt||'',onChange:e=>{const completedAt=e.target.value;let leadTimeDays=null;if(completedAt&&editingKitting.basicStartDate){const start=new Date(editingKitting.basicStartDate);const end=new Date(completedAt);leadTimeDays=Math.ceil((end-start)/(1000*60*60*24));}setEditingKitting({...editingKitting,completedAt,leadTimeDays,status:completedAt?'completed':editingKitting.status});}})),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"\uC0C1\uD0DC"),/*#__PURE__*/React.createElement("select",{className:"w-full border rounded-lg px-3 py-2",value:editingKitting.status,onChange:e=>setEditingKitting({...editingKitting,status:e.target.value})},/*#__PURE__*/React.createElement("option",{value:"waiting"},"\uB300\uAE30"),/*#__PURE__*/React.createElement("option",{value:"in-progress"},"\uC9C4\uD589\uC911"),/*#__PURE__*/React.createElement("option",{value:"completed"},"\uC644\uB8CC")))),/*#__PURE__*/React.createElement("div",{className:"flex gap-3 mt-6"},/*#__PURE__*/React.createElement("button",{onClick:()=>setEditingKitting(null),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"},"\uCDE8\uC18C"),/*#__PURE__*/React.createElement("button",{onClick:saveEditKitting,className:"flex-1 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700"},"\uC800\uC7A5")))),showKittingGraphModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-5xl m-4 max-h-[90vh] overflow-y-auto"},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-6"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCCA Kitting Lead Time \uADF8\uB798\uD504"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowKittingGraphModal(false),className:"text-gray-400 hover:text-gray-600"},/*#__PURE__*/React.createElement(X,{className:"w-6 h-6"}))),(()=>{// 최근 6개월 데이터 계산
const months=[];for(let i=5;i>=0;i--){const d=new Date();d.setMonth(d.getMonth()-i);months.push(d.toISOString().slice(0,7));}const chartData=months.map(month=>{const monthData=kittingData.filter(k=>k.basicStartDate?.startsWith(month)||k.completedAt?.startsWith(month));const completed=monthData.filter(k=>k.status==='completed');const within3Days=completed.filter(k=>k.leadTimeDays&&k.leadTimeDays<=3).length;const avgLeadTime=completed.length>0?(completed.reduce((sum,k)=>sum+(k.leadTimeDays||0),0)/completed.length).toFixed(1):0;const rate=completed.length>0?Math.round(within3Days/completed.length*100):0;// 모델별 통계
const mx48=completed.filter(k=>['RSC48','CSC48'].includes(k.model));const mx16=completed.filter(k=>['RSC16','CSC16','FSC16'].includes(k.model));const hsm=completed.filter(k=>k.model==='HSM3.0');const spare=completed.filter(k=>k.model==='Spare Parts');return{month,label:`${month.split('-')[1]}월`,total:monthData.length,completed:completed.length,avgLeadTime:parseFloat(avgLeadTime),rate,mx48:mx48.length,mx16:mx16.length,hsm:hsm.length,spare:spare.length};});const maxCompleted=Math.max(...chartData.map(d=>d.completed),1);const maxRate=100;return/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",{className:"bg-gray-50 rounded-lg p-4"},/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-4"},"\uC6D4\uBCC4 \uC644\uB8CC \uAC74\uC218 & 3\uC77C \uC774\uB0B4 \uC644\uB8CC\uC728"),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2 h-48"},chartData.map((d,i)=>/*#__PURE__*/React.createElement("div",{key:i,className:"flex-1 flex flex-col items-center"},/*#__PURE__*/React.createElement("div",{className:"w-full flex gap-1 justify-center items-end h-40"},/*#__PURE__*/React.createElement("div",{className:"w-6 bg-teal-500 rounded-t transition-all",style:{height:`${d.completed/maxCompleted*100}%`},title:`완료: ${d.completed}건`}),/*#__PURE__*/React.createElement("div",{className:"w-6 bg-green-400 rounded-t transition-all",style:{height:`${d.rate}%`},title:`3일 이내: ${d.rate}%`})),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500 mt-2"},d.label),/*#__PURE__*/React.createElement("div",{className:"text-xs font-medium text-teal-600"},d.completed,"\uAC74"),/*#__PURE__*/React.createElement("div",{className:"text-xs text-green-600"},d.rate,"%")))),/*#__PURE__*/React.createElement("div",{className:"flex justify-center gap-6 mt-4 text-sm"},/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"w-4 h-4 bg-teal-500 rounded"})," \uC644\uB8CC \uAC74\uC218"),/*#__PURE__*/React.createElement("span",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:"w-4 h-4 bg-green-400 rounded"})," 3\uC77C \uC774\uB0B4 \uC644\uB8CC\uC728"))),/*#__PURE__*/React.createElement("div",{className:"bg-gray-50 rounded-lg p-4"},/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-4"},"\uD3C9\uADE0 Lead Time \uCD94\uC774 (\uBAA9\uD45C: 3\uC77C \uC774\uB0B4)"),/*#__PURE__*/React.createElement("div",{className:"relative h-40"},/*#__PURE__*/React.createElement("div",{className:"absolute w-full border-t-2 border-dashed border-red-400",style:{bottom:'60%'}},/*#__PURE__*/React.createElement("span",{className:"absolute right-0 -top-4 text-xs text-red-500"},"\uBAA9\uD45C: 3\uC77C")),/*#__PURE__*/React.createElement("div",{className:"flex items-end gap-2 h-full"},chartData.map((d,i)=>/*#__PURE__*/React.createElement("div",{key:i,className:"flex-1 flex flex-col items-center"},/*#__PURE__*/React.createElement("div",{className:"w-full flex justify-center items-end h-32"},/*#__PURE__*/React.createElement("div",{className:`w-10 rounded-t transition-all ${d.avgLeadTime<=3?'bg-green-500':d.avgLeadTime<=5?'bg-amber-500':'bg-red-500'}`,style:{height:`${Math.min(d.avgLeadTime/7*100,100)}%`},title:`평균: ${d.avgLeadTime}일`})),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500 mt-2"},d.label),/*#__PURE__*/React.createElement("div",{className:`text-sm font-bold ${d.avgLeadTime<=3?'text-green-600':d.avgLeadTime<=5?'text-amber-600':'text-red-600'}`},d.avgLeadTime,"\uC77C")))))),/*#__PURE__*/React.createElement("div",{className:"bg-gray-50 rounded-lg p-4"},/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-4"},"\uBAA8\uB378\uBCC4 \uC644\uB8CC \uD604\uD669"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm border"},/*#__PURE__*/React.createElement("thead",{className:"bg-gray-100"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uC6D4"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uC804\uCCB4 \uC644\uB8CC"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uD3C9\uADE0 Lead Time"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"3\uC77C \uC774\uB0B4\uC728"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border text-emerald-600"},"Maxwell 48"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border text-blue-600"},"Maxwell 16"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border text-orange-600"},"HSM 3.0"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border text-gray-600"},"Spare Parts"))),/*#__PURE__*/React.createElement("tbody",null,chartData.map((d,i)=>/*#__PURE__*/React.createElement("tr",{key:i,className:"hover:bg-gray-50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border font-medium"},d.label),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center font-bold text-teal-600"},d.completed,"\uAC74"),/*#__PURE__*/React.createElement("td",{className:`px-3 py-2 border text-center font-bold ${d.avgLeadTime<=3?'text-green-600':d.avgLeadTime<=5?'text-amber-600':'text-red-600'}`},d.avgLeadTime,"\uC77C"),/*#__PURE__*/React.createElement("td",{className:`px-3 py-2 border text-center ${d.rate>=80?'text-green-600':d.rate>=60?'text-amber-600':'text-red-600'}`},d.rate,"%"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center text-emerald-600"},d.mx48,"\uAC74"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center text-blue-600"},d.mx16,"\uAC74"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center text-orange-600"},d.hsm,"\uAC74"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center text-gray-600"},d.spare,"\uAC74"))))))),/*#__PURE__*/React.createElement("div",{className:"flex justify-end"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowKittingGraphModal(false),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300"},"\uB2EB\uAE30")));})())),showReceiveGraphModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-5xl flex flex-col",style:{maxHeight:'calc(100vh - 2rem)'}},(()=>{// 최근 6개월 데이터 계산
const months=[];for(let i=5;i>=0;i--){const d=new Date();d.setMonth(d.getMonth()-i);months.push(d.toISOString().slice(0,7));}const chartData=months.map(month=>{const monthReceives=receiveCycles.filter(r=>r.status==='completed'&&(r.migo?.startsWith(month)||r.delivery?.startsWith(month)));const avgTime=monthReceives.length>0?Math.round(monthReceives.reduce((s,r)=>s+(r.cycleMin||0),0)/monthReceives.length):0;// 60분 이내 달성률
const under60=monthReceives.filter(r=>r.cycleMin&&r.cycleMin<=60).length;const rate=monthReceives.length>0?Math.round(under60/monthReceives.length*100):0;// 협력업체별 통계
const vendorStats={};monthReceives.forEach(r=>{if(r.vendor){if(!vendorStats[r.vendor])vendorStats[r.vendor]={count:0,totalTime:0};vendorStats[r.vendor].count++;vendorStats[r.vendor].totalTime+=r.cycleMin||0;}});return{month,label:`${month.split('-')[1]}월`,completed:monthReceives.length,avgTime,rate,vendorStats};});const maxCompleted=Math.max(...chartData.map(d=>d.completed),1);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("div",{className:"flex-shrink-0 flex justify-between items-center p-6 border-b"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCCA \uC785\uACE0 Cycle Time \uADF8\uB798\uD504"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowReceiveGraphModal(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"flex-1 overflow-y-auto min-h-0 p-6"},/*#__PURE__*/React.createElement("div",{className:"space-y-6"},/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-4 gap-4"},/*#__PURE__*/React.createElement("div",{className:"bg-purple-50 rounded-xl p-4 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-purple-600"},"6\uAC1C\uC6D4 \uCD1D \uC785\uACE0"),/*#__PURE__*/React.createElement("p",{className:"text-3xl font-bold text-purple-700"},chartData.reduce((s,d)=>s+d.completed,0),"\uAC74")),/*#__PURE__*/React.createElement("div",{className:"bg-blue-50 rounded-xl p-4 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-blue-600"},"6\uAC1C\uC6D4 \uD3C9\uADE0 \uC2DC\uAC04"),/*#__PURE__*/React.createElement("p",{className:"text-3xl font-bold text-blue-700"},chartData.filter(d=>d.completed>0).length>0?Math.round(chartData.filter(d=>d.completed>0).reduce((s,d)=>s+d.avgTime,0)/chartData.filter(d=>d.completed>0).length):0,"\uBD84")),/*#__PURE__*/React.createElement("div",{className:"bg-emerald-50 rounded-xl p-4 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-emerald-600"},"60\uBD84 \uC774\uB0B4 \uB2EC\uC131\uB960"),/*#__PURE__*/React.createElement("p",{className:"text-3xl font-bold text-emerald-700"},chartData.filter(d=>d.completed>0).length>0?Math.round(chartData.filter(d=>d.completed>0).reduce((s,d)=>s+d.rate,0)/chartData.filter(d=>d.completed>0).length):0,"%")),/*#__PURE__*/React.createElement("div",{className:"bg-orange-50 rounded-xl p-4 text-center"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-orange-600"},"\uC774\uBC88 \uB2EC \uC785\uACE0"),/*#__PURE__*/React.createElement("p",{className:"text-3xl font-bold text-orange-700"},chartData[chartData.length-1]?.completed||0,"\uAC74"))),/*#__PURE__*/React.createElement("div",{className:"bg-gray-50 rounded-xl p-6"},/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-4"},"\uC6D4\uBCC4 \uC785\uACE0 \uC644\uB8CC \uAC74\uC218 & \uD3C9\uADE0 \uC2DC\uAC04"),/*#__PURE__*/React.createElement("div",{className:"flex items-end justify-between h-48 gap-4"},chartData.map((d,i)=>/*#__PURE__*/React.createElement("div",{key:i,className:"flex-1 flex flex-col items-center"},/*#__PURE__*/React.createElement("div",{className:"text-sm font-bold mb-1 text-purple-600"},d.completed,"\uAC74"),/*#__PURE__*/React.createElement("div",{className:"w-full flex flex-col items-center justify-end h-32"},/*#__PURE__*/React.createElement("div",{className:"w-full bg-gradient-to-t from-purple-500 to-purple-400 rounded-t transition-all hover:from-purple-600 hover:to-purple-500",style:{height:`${d.completed/maxCompleted*100}%`,minHeight:d.completed>0?'8px':'0'},title:`${d.completed}건 완료`})),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500 mt-2"},d.label),/*#__PURE__*/React.createElement("div",{className:`text-xs font-bold mt-1 ${d.avgTime<=60?'text-green-600':d.avgTime<=90?'text-amber-600':'text-red-600'}`},d.avgTime,"\uBD84"))))),/*#__PURE__*/React.createElement("div",{className:"bg-gray-50 rounded-xl p-6"},/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 mb-4"},"\uC6D4\uBCC4 60\uBD84 \uC774\uB0B4 \uB2EC\uC131\uB960 (\uBAA9\uD45C: 80%)"),/*#__PURE__*/React.createElement("div",{className:"flex items-end justify-between h-32 gap-4"},chartData.map((d,i)=>/*#__PURE__*/React.createElement("div",{key:i,className:"flex-1 flex flex-col items-center"},/*#__PURE__*/React.createElement("div",{className:`text-sm font-bold mb-1 ${d.rate>=80?'text-green-600':d.rate>=60?'text-amber-600':'text-red-600'}`},d.rate,"%"),/*#__PURE__*/React.createElement("div",{className:"w-full flex flex-col items-center justify-end h-24 relative"},/*#__PURE__*/React.createElement("div",{className:"absolute w-full border-t-2 border-dashed border-green-400",style:{bottom:'80%'}}),/*#__PURE__*/React.createElement("div",{className:`w-full rounded-t transition-all ${d.rate>=80?'bg-green-500':d.rate>=60?'bg-amber-500':'bg-red-500'}`,style:{height:`${d.rate}%`,minHeight:d.rate>0?'4px':'0'}})),/*#__PURE__*/React.createElement("div",{className:"text-xs text-gray-500 mt-2"},d.label))))),/*#__PURE__*/React.createElement("div",{className:"bg-white border rounded-xl overflow-hidden"},/*#__PURE__*/React.createElement("h4",{className:"font-medium text-gray-700 p-4 bg-gray-50 border-b"},"\uC6D4\uBCC4 \uC0C1\uC138 \uB370\uC774\uD130"),/*#__PURE__*/React.createElement("div",{className:"overflow-x-auto"},/*#__PURE__*/React.createElement("table",{className:"w-full text-sm"},/*#__PURE__*/React.createElement("thead",{className:"bg-gray-100"},/*#__PURE__*/React.createElement("tr",null,/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uC6D4"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uC644\uB8CC \uAC74\uC218"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uD3C9\uADE0 \uC2DC\uAC04"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"60\uBD84 \uC774\uB0B4\uC728"),/*#__PURE__*/React.createElement("th",{className:"px-3 py-2 border"},"\uCD5C\uB2E4 \uC5C5\uCCB4"))),/*#__PURE__*/React.createElement("tbody",null,chartData.map((d,i)=>{const topVendor=Object.entries(d.vendorStats).sort((a,b)=>b[1].count-a[1].count)[0];return/*#__PURE__*/React.createElement("tr",{key:i,className:"hover:bg-gray-50"},/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border font-medium"},d.label),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center font-bold text-purple-600"},d.completed,"\uAC74"),/*#__PURE__*/React.createElement("td",{className:`px-3 py-2 border text-center font-bold ${d.avgTime<=60?'text-green-600':d.avgTime<=90?'text-amber-600':'text-red-600'}`},d.avgTime,"\uBD84"),/*#__PURE__*/React.createElement("td",{className:`px-3 py-2 border text-center ${d.rate>=80?'text-green-600':d.rate>=60?'text-amber-600':'text-red-600'}`},d.rate,"%"),/*#__PURE__*/React.createElement("td",{className:"px-3 py-2 border text-center text-gray-600"},topVendor?`${topVendor[0]} (${topVendor[1].count}건)`:'-'));}))))))),/*#__PURE__*/React.createElement("div",{className:"flex-shrink-0 flex justify-end p-6 border-t bg-gray-50"},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowReceiveGraphModal(false),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300"},"\uB2EB\uAE30")));})())),showShortcutHelp&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>setShowShortcutHelp(false)},/*#__PURE__*/React.createElement("div",{className:`${darkMode?'bg-gray-800 text-white':'bg-white'} rounded-xl shadow-xl p-6 w-full max-w-md m-4`,onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg flex items-center gap-2"},/*#__PURE__*/React.createElement(Keyboard,{className:"w-5 h-5 text-indigo-500"})," \uD0A4\uBCF4\uB4DC \uB2E8\uCD95\uD0A4"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowShortcutHelp(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"space-y-3"},[{key:'Ctrl + D',desc:'대시보드로 이동'},{key:'Ctrl + M',desc:'새 입고 등록'},{key:'Ctrl + K',desc:'새 Kitting 등록'},{key:'Ctrl + B',desc:'백업/복원 열기'},{key:'Ctrl + N',desc:'알림 센터 열기'},{key:'Ctrl + ?',desc:'단축키 도움말 (현재)'},{key:'ESC',desc:'모달 닫기'}].map((item,idx)=>/*#__PURE__*/React.createElement("div",{key:idx,className:`flex justify-between items-center py-2 px-3 rounded-lg ${darkMode?'bg-gray-700':'bg-gray-100'}`},/*#__PURE__*/React.createElement("span",{className:`font-mono text-sm px-2 py-1 rounded ${darkMode?'bg-gray-600':'bg-white border'}`},item.key),/*#__PURE__*/React.createElement("span",{className:`text-sm ${darkMode?'text-gray-300':'text-gray-600'}`},item.desc)))))),showNotificationCenter&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>setShowNotificationCenter(false)},/*#__PURE__*/React.createElement("div",{className:`${darkMode?'bg-gray-800 text-white':'bg-white'} rounded-xl shadow-xl p-6 w-full max-w-lg m-4 max-h-[80vh] overflow-hidden flex flex-col`,onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg flex items-center gap-2"},/*#__PURE__*/React.createElement(Bell,{className:"w-5 h-5 text-indigo-500"})," \uC54C\uB9BC \uC13C\uD130",notifications.filter(n=>!n.read).length>0&&/*#__PURE__*/React.createElement("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs rounded-full"},notifications.filter(n=>!n.read).length," \uC0C8 \uC54C\uB9BC")),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},notifications.length>0&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("button",{onClick:markAllNotificationsAsRead,className:"text-xs text-blue-500 hover:text-blue-700"},"\uBAA8\uB450 \uC77D\uC74C"),/*#__PURE__*/React.createElement("button",{onClick:clearAllNotifications,className:"text-xs text-red-500 hover:text-red-700"},"\uBAA8\uB450 \uC0AD\uC81C")),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowNotificationCenter(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"})))),/*#__PURE__*/React.createElement("div",{className:"flex-1 overflow-y-auto space-y-2"},(()=>{const sysAlerts=[];if(showTempAlert)sysAlerts.push({id:'sys-temp',type:'warning',title:'🌡️ 온습도 미입력',message:'오늘의 온도/습도가 아직 입력되지 않았습니다.',action:()=>{setActiveTab('temphumidity');setShowNotificationCenter(false);}});if(showUploadAlert)sysAlerts.push({id:'sys-stock',type:'error',title:'📊 재고 데이터 미업로드',message:'ZBIN(Stock) 데이터를 업로드해주세요.',action:()=>{setShowDataUploadModal(true);setShowNotificationCenter(false);}});if(showOpenPOAlert)sysAlerts.push({id:'sys-po',type:'error',title:'📋 Open PO 미업로드',message:'ME2N(Open PO) 데이터를 업로드해주세요.',action:()=>{setShowOpenPOModal(true);setShowNotificationCenter(false);}});// 입고 미처리
const now=new Date();const overdueReceives=receiveCycles.filter(r=>{if(r.status==='completed')return false;if(!r.startTime)return false;return(now-new Date(r.startTime))/(1000*60*60)>=4;});if(overdueReceives.length>0)sysAlerts.push({id:'sys-receive',type:'error',title:`⚠️ 입고 미처리 ${overdueReceives.length}건`,message:`4시간 이상 MIGO 미완료: ${overdueReceives.map(r=>r.vendor).join(', ')}`,action:()=>{setActiveTab('receive');setShowNotificationCenter(false);}});return sysAlerts.length>0?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 font-medium mb-1"},"\uD83D\uDCCC \uC2DC\uC2A4\uD15C \uC54C\uB9BC"),sysAlerts.map(a=>/*#__PURE__*/React.createElement("div",{key:a.id,className:`p-3 rounded-lg border cursor-pointer hover:shadow-md transition ${a.type==='error'?'bg-red-50 border-red-200':'bg-amber-50 border-amber-200'}`,onClick:a.action},/*#__PURE__*/React.createElement("p",{className:"font-medium text-sm"},a.title),/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-600 mt-0.5"},a.message),/*#__PURE__*/React.createElement("p",{className:"text-xs text-indigo-500 mt-1"},"\uD074\uB9AD\uD558\uC5EC \uC774\uB3D9 \u2192"))),notifications.length>0&&/*#__PURE__*/React.createElement("p",{className:"text-xs text-gray-400 font-medium mt-3 mb-1"},"\uD83D\uDCDD \uC77C\uBC18 \uC54C\uB9BC")):null;})(),notifications.length===0&&!showTempAlert&&!showUploadAlert&&!showOpenPOAlert?/*#__PURE__*/React.createElement("div",{className:`text-center py-8 ${darkMode?'text-gray-400':'text-gray-500'}`},/*#__PURE__*/React.createElement(BellOff,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),/*#__PURE__*/React.createElement("p",null,"\uC54C\uB9BC\uC774 \uC5C6\uC2B5\uB2C8\uB2E4")):notifications.map(n=>/*#__PURE__*/React.createElement("div",{key:n.id,className:`p-3 rounded-lg border ${!n.read?darkMode?'bg-indigo-900/30 border-indigo-500':'bg-indigo-50 border-indigo-200':darkMode?'bg-gray-700 border-gray-600':'bg-gray-50 border-gray-200'}`},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-start"},/*#__PURE__*/React.createElement("div",{className:"flex items-start gap-2"},/*#__PURE__*/React.createElement("span",{className:`mt-1 w-2 h-2 rounded-full ${n.type==='success'?'bg-emerald-500':n.type==='warning'?'bg-amber-500':n.type==='error'?'bg-red-500':'bg-blue-500'}`}),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:"font-medium text-sm"},n.title),/*#__PURE__*/React.createElement("p",{className:`text-xs ${darkMode?'text-gray-400':'text-gray-500'}`},n.message),/*#__PURE__*/React.createElement("p",{className:`text-xs mt-1 ${darkMode?'text-gray-500':'text-gray-400'}`},getElapsedTimeDetail(n.timestamp)))),/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-1"},!n.read&&/*#__PURE__*/React.createElement("button",{onClick:()=>markNotificationAsRead(n.id),className:"text-xs text-blue-500 hover:text-blue-700"},"\uC77D\uC74C"),/*#__PURE__*/React.createElement("button",{onClick:()=>deleteNotification(n.id),className:"text-gray-400 hover:text-red-500"},/*#__PURE__*/React.createElement(X,{className:"w-4 h-4"}))))))))),showHistoryModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>setShowHistoryModal(false)},/*#__PURE__*/React.createElement("div",{className:`${darkMode?'bg-gray-800 text-white':'bg-white'} rounded-xl shadow-xl p-6 w-full max-w-lg m-4 max-h-[80vh] overflow-hidden flex flex-col`,onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center mb-4"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg flex items-center gap-2"},/*#__PURE__*/React.createElement(History,{className:"w-5 h-5 text-indigo-500"})," \uB370\uC774\uD130 \uC5C5\uB85C\uB4DC \uD788\uC2A4\uD1A0\uB9AC"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowHistoryModal(false)},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"flex-1 overflow-y-auto space-y-2"},dataHistory.length===0?/*#__PURE__*/React.createElement("div",{className:`text-center py-8 ${darkMode?'text-gray-400':'text-gray-500'}`},/*#__PURE__*/React.createElement(Archive,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),/*#__PURE__*/React.createElement("p",null,"\uC5C5\uB85C\uB4DC \uD788\uC2A4\uD1A0\uB9AC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4")):dataHistory.map(h=>/*#__PURE__*/React.createElement("div",{key:h.id,className:`p-3 rounded-lg ${darkMode?'bg-gray-700':'bg-gray-50'}`},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2"},/*#__PURE__*/React.createElement("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${h.type==='stock'?'bg-emerald-100 text-emerald-700':h.type==='openPO'?'bg-amber-100 text-amber-700':h.type==='bom'?'bg-purple-100 text-purple-700':'bg-gray-100 text-gray-700'}`},h.type==='stock'?'Stock':h.type==='openPO'?'Open PO':h.type==='bom'?'BOM':h.type),/*#__PURE__*/React.createElement("span",{className:"text-sm"},h.description)),/*#__PURE__*/React.createElement("span",{className:`text-xs ${darkMode?'text-gray-400':'text-gray-500'}`},getElapsedTimeDetail(h.timestamp)))))))),showSpaceOptimizationModal&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>setShowSpaceOptimizationModal(false)},/*#__PURE__*/React.createElement("div",{className:`${darkMode?'bg-gray-800 text-white':'bg-white'} rounded-xl shadow-xl w-full max-w-3xl flex flex-col`,style:{maxHeight:'calc(100vh - 2rem)'},onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:`flex-shrink-0 flex justify-between items-center p-4 border-b ${darkMode?'border-gray-700':'border-gray-200'}`},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg flex items-center gap-2"},/*#__PURE__*/React.createElement(Lightbulb,{className:"w-5 h-5 text-amber-500"})," \uACF5\uAC04 \uCD5C\uC801\uD654 \uB9AC\uD3EC\uD2B8"),/*#__PURE__*/React.createElement("button",{onClick:()=>setShowSpaceOptimizationModal(false),className:`p-2 rounded-lg hover:bg-gray-100 ${darkMode?'hover:bg-gray-700':''}`},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"flex-1 overflow-y-auto p-4",style:{minHeight:0}},inventoryData.length===0?/*#__PURE__*/React.createElement("div",{className:`text-center py-8 ${darkMode?'text-gray-400':'text-gray-500'}`},/*#__PURE__*/React.createElement(Database,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),/*#__PURE__*/React.createElement("p",null,"\uC7AC\uACE0 \uB370\uC774\uD130\uB97C \uBA3C\uC800 \uC5C5\uB85C\uB4DC\uD574\uC8FC\uC138\uC694")):/*#__PURE__*/React.createElement("div",{className:"space-y-4"},analyzeSpaceOptimization().map((suggestion,idx)=>/*#__PURE__*/React.createElement("div",{key:idx,className:`p-4 rounded-lg border-l-4 ${suggestion.priority==='danger'?'bg-red-50 border-red-500':suggestion.priority==='warning'?'bg-amber-50 border-amber-500':suggestion.priority==='success'?'bg-emerald-50 border-emerald-500':'bg-blue-50 border-blue-500'} ${darkMode?'bg-opacity-20':''}`},/*#__PURE__*/React.createElement("div",{className:"flex items-start gap-3"},/*#__PURE__*/React.createElement("div",{className:`p-2 rounded-full flex-shrink-0 ${suggestion.priority==='danger'?'bg-red-100':suggestion.priority==='warning'?'bg-amber-100':suggestion.priority==='success'?'bg-emerald-100':'bg-blue-100'}`},suggestion.type==='utilization_score'?/*#__PURE__*/React.createElement(BarChart3,{className:`w-5 h-5 ${suggestion.priority==='danger'?'text-red-600':suggestion.priority==='warning'?'text-amber-600':suggestion.priority==='success'?'text-emerald-600':'text-blue-600'}`}):suggestion.type==='empty_bins'?/*#__PURE__*/React.createElement(Package,{className:"w-5 h-5 text-emerald-600"}):suggestion.type==='overloaded_bins'?/*#__PURE__*/React.createElement(AlertTriangle,{className:"w-5 h-5 text-amber-600"}):suggestion.type==='weight_imbalance'?/*#__PURE__*/React.createElement(Scale,{className:"w-5 h-5 text-amber-600"}):suggestion.type==='low_efficiency'?/*#__PURE__*/React.createElement(TrendingUp,{className:"w-5 h-5 text-blue-600"}):suggestion.type==='relocation_recommendation'?/*#__PURE__*/React.createElement(ArrowRight,{className:"w-5 h-5 text-indigo-600"}):/*#__PURE__*/React.createElement(Zap,{className:"w-5 h-5 text-indigo-600"})),/*#__PURE__*/React.createElement("div",{className:"flex-1 min-w-0"},/*#__PURE__*/React.createElement("div",{className:"flex items-center gap-2 flex-wrap"},/*#__PURE__*/React.createElement("h4",{className:`font-semibold ${darkMode?'text-white':'text-gray-800'}`},suggestion.title),suggestion.score!==undefined&&/*#__PURE__*/React.createElement("span",{className:`text-2xl font-bold ${suggestion.score>85?'text-red-500':suggestion.score>70?'text-amber-500':suggestion.score>50?'text-blue-500':'text-emerald-500'}`},suggestion.score,"%")),/*#__PURE__*/React.createElement("p",{className:`text-sm mt-1 ${darkMode?'text-gray-300':'text-gray-600'}`},suggestion.description),suggestion.recommendation&&/*#__PURE__*/React.createElement("p",{className:`text-sm mt-1 italic ${darkMode?'text-gray-400':'text-gray-500'}`},"\uD83D\uDCA1 ",suggestion.recommendation),suggestion.action&&/*#__PURE__*/React.createElement("p",{className:`text-sm mt-2 font-medium flex items-center gap-1 ${suggestion.priority==='danger'?'text-red-600':suggestion.priority==='warning'?'text-amber-600':'text-blue-600'}`},/*#__PURE__*/React.createElement(ArrowRight,{className:"w-4 h-4 flex-shrink-0"})," ",suggestion.action),suggestion.details&&Array.isArray(suggestion.details)&&suggestion.details.length>0&&/*#__PURE__*/React.createElement("div",{className:"mt-3"},suggestion.type==='relocation_recommendation'?/*#__PURE__*/React.createElement("div",{className:"space-y-1"},suggestion.details.map((d,i)=>/*#__PURE__*/React.createElement("div",{key:i,className:`text-xs p-2 rounded flex items-center gap-2 ${darkMode?'bg-gray-700':'bg-white border'}`},/*#__PURE__*/React.createElement("span",{className:"font-medium text-red-500"},d.from),/*#__PURE__*/React.createElement(ArrowRight,{className:"w-3 h-3"}),/*#__PURE__*/React.createElement("span",{className:"font-medium text-emerald-500"},d.to),/*#__PURE__*/React.createElement("span",{className:`${darkMode?'text-gray-400':'text-gray-500'}`},"(",d.reason,")")))):suggestion.type==='weight_imbalance'||suggestion.type==='low_efficiency'?/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap gap-1"},suggestion.details.map((d,i)=>/*#__PURE__*/React.createElement("span",{key:i,className:`text-xs px-2 py-1 rounded ${darkMode?'bg-gray-700':'bg-white border'}`},/*#__PURE__*/React.createElement("span",{className:"font-medium"},d.rack),d.weight&&/*#__PURE__*/React.createElement("span",{className:"text-amber-600 ml-1"},d.weight,"kg"),d.efficiency!==undefined&&/*#__PURE__*/React.createElement("span",{className:"text-blue-600 ml-1"},d.efficiency,"%"),d.overAvg&&/*#__PURE__*/React.createElement("span",{className:"text-red-500 ml-1"},"(+",d.overAvg,"%)")))):/*#__PURE__*/React.createElement("div",{className:"flex flex-wrap gap-1"},suggestion.details.slice(0,12).map((d,i)=>/*#__PURE__*/React.createElement("span",{key:i,className:`text-xs px-2 py-1 rounded ${darkMode?'bg-gray-700':'bg-white border'}`},d.rack,"-",d.bin," ",d.count?/*#__PURE__*/React.createElement("span",{className:"text-amber-600"},"(",d.count,"\uAC1C)"):'',d.totalStock?/*#__PURE__*/React.createElement("span",{className:"text-blue-600 ml-1"},d.totalStock,"EA"):'')),suggestion.details.length>12&&/*#__PURE__*/React.createElement("span",{className:`text-xs px-2 py-1 ${darkMode?'text-gray-400':'text-gray-500'}`},"+",suggestion.details.length-12,"\uAC1C \uB354"))))))),/*#__PURE__*/React.createElement("div",{className:`mt-6 p-4 rounded-lg ${darkMode?'bg-gray-700':'bg-gray-100'}`},/*#__PURE__*/React.createElement("h4",{className:"font-semibold mb-2"},"\uD83D\uDCCA \uC694\uC57D"),/*#__PURE__*/React.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm"},/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:`${darkMode?'text-gray-400':'text-gray-500'}`},"\uCD1D \uD488\uBAA9"),/*#__PURE__*/React.createElement("p",{className:"font-bold"},inventoryData.length,"\uAC1C")),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:`${darkMode?'text-gray-400':'text-gray-500'}`},"\uC0AC\uC6A9 \uC911 \uB799"),/*#__PURE__*/React.createElement("p",{className:"font-bold"},rackSummary.length,"\uAC1C")),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:`${darkMode?'text-gray-400':'text-gray-500'}`},"\uC0AC\uC6A9 \uC911 Bin"),/*#__PURE__*/React.createElement("p",{className:"font-bold"},new Set(inventoryData.map(i=>`${i.rack}-${i.bin}`)).size,"\uAC1C")),/*#__PURE__*/React.createElement("div",null,/*#__PURE__*/React.createElement("p",{className:`${darkMode?'text-gray-400':'text-gray-500'}`},"\uCD1D \uBB34\uAC8C"),/*#__PURE__*/React.createElement("p",{className:"font-bold"},rackSummary.reduce((s,r)=>s+r.weight,0).toFixed(1),"kg")))))),/*#__PURE__*/React.createElement("div",{className:`flex justify-end gap-2 p-4 border-t ${darkMode?'border-gray-700':'border-gray-200'}`},/*#__PURE__*/React.createElement("button",{onClick:()=>setShowSpaceOptimizationModal(false),className:`px-6 py-2 rounded-lg font-medium ${darkMode?'bg-gray-700 hover:bg-gray-600':'bg-gray-200 hover:bg-gray-300'}`},"\uB2EB\uAE30")))),exportModalData&&/*#__PURE__*/React.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>setExportModalData(null)},/*#__PURE__*/React.createElement("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl flex flex-col",style:{maxHeight:'calc(100vh - 2rem)'},onClick:e=>e.stopPropagation()},/*#__PURE__*/React.createElement("div",{className:"flex justify-between items-center p-4 border-b"},/*#__PURE__*/React.createElement("h3",{className:"font-semibold text-lg"},"\uD83D\uDCCB \uB370\uC774\uD130 \uB0B4\uBCF4\uB0B4\uAE30 (",exportModalData.count,"\uD589)"),/*#__PURE__*/React.createElement("button",{onClick:()=>setExportModalData(null),className:"p-2 rounded-lg hover:bg-gray-100"},/*#__PURE__*/React.createElement(X,{className:"w-5 h-5"}))),/*#__PURE__*/React.createElement("div",{className:"p-4"},/*#__PURE__*/React.createElement("p",{className:"text-sm text-gray-500 mb-2"},"\uC544\uB798 \uD14D\uC2A4\uD2B8\uB97C \uC804\uCCB4 \uC120\uD0DD(Ctrl+A) \u2192 \uBCF5\uC0AC(Ctrl+C) \u2192 \uC5D1\uC140\uC5D0 \uBD99\uC5EC\uB123\uAE30(Ctrl+V)"),/*#__PURE__*/React.createElement("textarea",{readOnly:true,value:exportModalData.text,className:"w-full h-64 border rounded-lg p-3 text-xs font-mono bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500",onFocus:e=>e.target.select()})),/*#__PURE__*/React.createElement("div",{className:"flex justify-end gap-2 p-4 border-t"},/*#__PURE__*/React.createElement("button",{onClick:()=>{const textarea=document.querySelector('textarea[readOnly]');if(textarea){textarea.select();document.execCommand('copy');}},className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm"},"\uD83D\uDCCB \uC804\uCCB4 \uBCF5\uC0AC"),/*#__PURE__*/React.createElement("button",{onClick:()=>setExportModalData(null),className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300 text-sm"},"\uB2EB\uAE30")))));}// ═══ 자재 위치 미니맵 (실제 레이아웃 기반) ═══
function LocateMiniMap({layoutData,targetArea}){const cvRef=React.useRef(null);useEffect(()=>{const cv=cvRef.current;if(!cv||!layoutData)return;const ctx=cv.getContext('2d');const cW=cv.width,cH=cv.height;ctx.clearRect(0,0,cW,cH);// 배치도 상수 (픽셀)
var BX=50,BY=50;var WHW=564,WHH=1890,RX=982,JY=774;// px 단위
// 캔버스 스케일
var sc=Math.min((cW-16)/WHW,(cH-16)/WHH);var ox=8,oy=8;var mx=function(x){return ox+(x-BX)*sc;};var my=function(y){return oy+(y-BY)*sc;};// 배경
ctx.fillStyle='#0f172a';ctx.fillRect(0,0,cW,cH);// L자 건물 외곽
ctx.beginPath();ctx.moveTo(mx(BX),my(BY));ctx.lineTo(mx(BX+WHW),my(BY));ctx.lineTo(mx(BX+WHW),my(BY+JY));ctx.lineTo(mx(RX),my(BY+JY));ctx.lineTo(mx(RX),my(BY+WHH));ctx.lineTo(mx(BX),my(BY+WHH));ctx.closePath();ctx.fillStyle='#1e293b';ctx.fill();ctx.strokeStyle='#475569';ctx.lineWidth=1;ctx.stroke();// 시리즈 색상
var SC_HEX={mx48:'#dc2626',mx16:'#2563eb',hsm:'#d97706',semi:'#eab308',spare:'#7c3aed',etc:'#06b6d4'};var targetRack=null;// 랙 그리기
if(layoutData.R)layoutData.R.forEach(function(r){var nm=(r.a||'').toUpperCase();if(nm.indexOf('DOOR')>=0||nm.indexOf('PILLAR')>=0)return;var w,h;if(r.t==='custom'){w=(r.cw||1000)*0.06;h=(r.ch||500)*0.06;}else{w=(r.t==='heavy'?1800:900)*0.06;h=450*0.06;}if(r.rot===true||r.rot===90||r.rot===270){var tmp=w;w=h;h=tmp;}var rx=mx(r.x),ry=my(r.y),rw=w*sc,rh=h*sc;var area=(r.a||'').split('-')[0]||r.a||'';var isTarget=area===targetArea;if(isTarget){if(!targetRack)targetRack={x:rx,y:ry,w:rw,h:rh};else{// 병합
var nx=Math.min(targetRack.x,rx),ny=Math.min(targetRack.y,ry);targetRack={x:nx,y:ny,w:Math.max(targetRack.x+targetRack.w,rx+rw)-nx,h:Math.max(targetRack.y+targetRack.h,ry+rh)-ny};}}ctx.fillStyle=isTarget?'#f59e0b':SC_HEX[r.s]||'#64748b';ctx.globalAlpha=isTarget?1:0.6;ctx.fillRect(rx,ry,Math.max(rw,1),Math.max(rh,1));ctx.globalAlpha=1;});// 존 그리기
if(layoutData.zones)layoutData.zones.forEach(function(z){var zx=mx(z.x),zy=my(z.y),zw=z.w*sc,zh=z.h*sc;ctx.fillStyle='#22c55e';ctx.globalAlpha=0.25;ctx.fillRect(zx,zy,Math.max(zw,1),Math.max(zh,1));ctx.globalAlpha=1;});// 타겟 하이라이트
if(targetRack){ctx.strokeStyle='#fbbf24';ctx.lineWidth=3;ctx.setLineDash([6,3]);ctx.strokeRect(targetRack.x-4,targetRack.y-4,targetRack.w+8,targetRack.h+8);ctx.setLineDash([]);ctx.fillStyle='#fbbf24';ctx.font='bold 16px sans-serif';ctx.textAlign='center';ctx.fillText(targetArea,targetRack.x+targetRack.w/2,targetRack.y-10);}},[layoutData,targetArea]);return/*#__PURE__*/React.createElement("canvas",{ref:cvRef,width:340,height:420,className:"border rounded-lg",style:{display:'block'}});}// ═══ 워크스루 HUD 오버레이 ═══
function WalkHud({walkRef,ctrlRef,onClose}){const[tick,setTick]=useState(0);const miniRef=React.useRef(null);useEffect(()=>{const iv=setInterval(()=>setTick(t=>t+1),100);return()=>clearInterval(iv);},[]);// 미니맵 그리기
useEffect(()=>{const ws=walkRef.current;const cv=miniRef.current;if(!ws||!ws.active||!cv)return;const ctx=cv.getContext('2d');const cW=cv.width,cH=cv.height;ctx.clearRect(0,0,cW,cH);// 스케일 계산 (창고 전체가 캔버스에 맞게)
var maxDim=Math.max(ws.whw,ws.whh);var sc=(cH-20)/maxDim;// 여백 10px
var ox=10,oy=10;var mx=function(x){return ox+x*sc;};var mz=function(z){return oy+z*sc;};// 배경
ctx.fillStyle='rgba(15,23,42,0.9)';ctx.fillRect(0,0,cW,cH);// L자 건물 외곽
ctx.beginPath();ctx.moveTo(mx(0),mz(0));ctx.lineTo(mx(ws.whw),mz(0));ctx.lineTo(mx(ws.whw),mz(ws.jy));ctx.lineTo(mx(ws.rx),mz(ws.jy));ctx.lineTo(mx(ws.rx),mz(ws.whh));ctx.lineTo(mx(0),mz(ws.whh));ctx.closePath();ctx.fillStyle='#1e293b';ctx.fill();ctx.strokeStyle='#475569';ctx.lineWidth=1;ctx.stroke();// 장애물 (colliders)
if(ws.colliders){ws.colliders.forEach(function(c){if(c.name&&c.name.indexOf('wall')===0)return;var x1=mx(c.minX),z1=mz(c.minZ);var w=(c.maxX-c.minX)*sc,h=(c.maxZ-c.minZ)*sc;ctx.fillStyle='rgba(100,116,139,0.6)';ctx.fillRect(x1,z1,Math.max(w,1),Math.max(h,1));});}// 현재 위치 + 방향
var px=mx(ws.posX),pz=mz(ws.posZ);var arrowLen=12;var ax=Math.sin(ws.angle)*arrowLen,az=Math.cos(ws.angle)*arrowLen;// 파렛트 영역 (회전 적용)
ctx.save();ctx.translate(px,pz);ctx.rotate(-ws.angle);ctx.fillStyle='rgba(250,204,21,0.7)';var pw=1.1*sc/2,pd=1.1*sc/2;ctx.fillRect(-pw,-pd,pw*2,pd*2);ctx.restore();// 방향 화살표
ctx.beginPath();ctx.moveTo(px,pz);ctx.lineTo(px+ax,pz+az);ctx.strokeStyle='#f59e0b';ctx.lineWidth=2.5;ctx.stroke();// 화살표 머리
ctx.beginPath();ctx.arc(px+ax,pz+az,3,0,Math.PI*2);ctx.fillStyle='#f59e0b';ctx.fill();// 현재 위치 점
ctx.beginPath();ctx.arc(px,pz,4,0,Math.PI*2);ctx.fillStyle=ws.colliding?'#ef4444':'#22c55e';ctx.fill();ctx.strokeStyle='#fff';ctx.lineWidth=1;ctx.stroke();},[tick]);const ws=walkRef.current;if(!ws||!ws.active)return null;const fmtDist=d=>d>=100?'∞':(d*1000).toFixed(0)+'mm';const clrColor=d=>d<0.3?'text-red-400':d<0.5?'text-yellow-400':'text-green-400';return/*#__PURE__*/React.createElement("div",{className:"absolute inset-0 pointer-events-none",style:{zIndex:10}},/*#__PURE__*/React.createElement("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 bg-black/70 text-white px-4 py-2 rounded-lg text-sm pointer-events-auto"},/*#__PURE__*/React.createElement("span",{className:"font-bold text-yellow-400"},"\uD83D\uDE9C \uC6CC\uD06C\uC2A4\uB8E8 \uBAA8\uB4DC"),/*#__PURE__*/React.createElement("span",{className:"ml-3"},"W/S \uC804\uC9C4\xB7\uD6C4\uC9C4 | A/D \uC88C\uC6B0 | Q/E \uD68C\uC804 | \uB9C8\uC6B0\uC2A4 \uC2DC\uC810 | ESC \uC885\uB8CC")),/*#__PURE__*/React.createElement("div",{className:"absolute bottom-4 left-4 bg-black/80 text-white p-3 rounded-lg text-sm space-y-1 min-w-48"},/*#__PURE__*/React.createElement("div",{className:"font-bold text-xs text-gray-400 mb-1"},"\uD83D\uDCD0 \uC5EC\uC720 \uACF5\uAC04 (\uD30C\uB81B\uD2B8 \uAC00\uC7A5\uC790\uB9AC \uAE30\uC900)"),/*#__PURE__*/React.createElement("div",{className:"flex justify-between"},/*#__PURE__*/React.createElement("span",null,"\u25C0 \uC88C\uCE21:"),/*#__PURE__*/React.createElement("span",{className:clrColor(ws.nearestL)+' font-mono font-bold'},fmtDist(ws.nearestL))),/*#__PURE__*/React.createElement("div",{className:"flex justify-between"},/*#__PURE__*/React.createElement("span",null,"\u25B6 \uC6B0\uCE21:"),/*#__PURE__*/React.createElement("span",{className:clrColor(ws.nearestR)+' font-mono font-bold'},fmtDist(ws.nearestR))),/*#__PURE__*/React.createElement("div",{className:"flex justify-between"},/*#__PURE__*/React.createElement("span",null,"\u25B2 \uC804\uBC29:"),/*#__PURE__*/React.createElement("span",{className:clrColor(ws.nearestF)+' font-mono font-bold'},fmtDist(ws.nearestF))),/*#__PURE__*/React.createElement("div",{className:"border-t border-gray-600 pt-1 mt-1 text-xs text-gray-400"},"\uD30C\uB81B\uD2B8: 1100\xD71100mm | \uC790\uD0A4+\uD30C\uB81B\uD2B8 \uCD1D \uAE38\uC774: 1400mm"),ws.nearRack&&/*#__PURE__*/React.createElement("div",{className:"border-t border-gray-600 pt-1 mt-1"},/*#__PURE__*/React.createElement("span",{className:"text-yellow-400 font-bold text-xs"},"\uD83D\uDCCD ",ws.nearRack))),ws.colliding&&/*#__PURE__*/React.createElement("div",{className:"absolute bottom-4 right-4 bg-red-900/90 text-red-200 px-4 py-3 rounded-lg animate-pulse"},/*#__PURE__*/React.createElement("div",{className:"font-bold text-lg"},"\u26A0\uFE0F \uCDA9\uB3CC!"),/*#__PURE__*/React.createElement("div",{className:"text-sm"},ws.collideName," \uC5D0 \uC811\uCD09"),/*#__PURE__*/React.createElement("div",{className:"text-xs mt-1 text-red-300"},"\uC774\uB3D9 \uCC28\uB2E8\uB428 \u2014 \uD68C\uC804(Q/E)\uC73C\uB85C \uBC29\uD5A5 \uC804\uD658")),/*#__PURE__*/React.createElement("div",{className:"absolute top-3 right-3 bg-black/70 text-white px-3 py-2 rounded-lg text-xs pointer-events-auto"},/*#__PURE__*/React.createElement("div",{className:"text-gray-400"},"\uC704\uCE58: X=",ws.posX.toFixed(1),"m Z=",ws.posZ.toFixed(1),"m"),/*#__PURE__*/React.createElement("div",{className:"flex gap-2 mt-1"},/*#__PURE__*/React.createElement("button",{onClick:()=>{if(ctrlRef.current)ctrlRef.current.resetWalkPos();},className:"px-2 py-1 bg-slate-600 hover:bg-slate-500 rounded text-xs"},"\uD83D\uDD04 \uC2DC\uC791\uC810"),/*#__PURE__*/React.createElement("button",{onClick:()=>{if(ctrlRef.current)ctrlRef.current.resetWalkCam();},className:"px-2 py-1 bg-indigo-600 hover:bg-indigo-500 rounded text-xs"},"\uD83C\uDFA5 \uC2DC\uC810 \uB9AC\uC14B"),/*#__PURE__*/React.createElement("button",{onClick:()=>{if(ctrlRef.current)ctrlRef.current.captureScreenshot();},className:"px-2 py-1 bg-sky-600 hover:bg-sky-500 rounded text-xs"},"\uD83D\uDCF7 \uCEA1\uCC98"),/*#__PURE__*/React.createElement("button",{onClick:onClose,className:"px-2 py-1 bg-red-700 hover:bg-red-600 rounded text-xs"},"\u2715 \uC885\uB8CC"))),/*#__PURE__*/React.createElement("div",{className:"absolute top-14 left-3 pointer-events-auto"},/*#__PURE__*/React.createElement("div",{className:"bg-black/80 rounded-lg p-1 border border-slate-600"},/*#__PURE__*/React.createElement("div",{className:"text-[10px] text-gray-400 text-center mb-0.5"},"\uD83D\uDCCD \uC704\uCE58 \uB9F5"),/*#__PURE__*/React.createElement("canvas",{ref:miniRef,width:160,height:200,style:{display:'block',borderRadius:4}}))));}

ReactDOM.render(React.createElement(PBKWarehouseSystem), document.getElementById("root"));
</script>
</body>
</html>